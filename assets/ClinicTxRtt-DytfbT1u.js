import{_ as h}from"./ReportMixin.vue_vue_type_script_lang-Ce5B9pzq.js";import{T as u}from"./tx_report_service-VJGfRFjn.js";import{R as f}from"./TableReportTemplate-Dty_HdC-.js";import{d as R,L as e,ab as p,cz as m,_ as g,r as c,o as w,c as _,w as F,b as T}from"./index-BFG-WECc.js";import"./MultiFieldDateHelper-CAg9Dfet.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BasicReportTemplate-SATK8Q6M.js";import"./Export-CRv3Yrt4.js";import"./SIngleTouchField-OvqCQtJi.js";import"./Pagination-wn9n5xfa.js";import"./HisStandardForm-B3aw5EdY.js";import"./TouchScreenForm-DiI3Xfhg.js";import"./ToolbarMediumCard-C3iotOe-.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-0kHLdkku.js";import"./ReportErrors-DZ7hHT6a.js";const D=R({mixins:[h],components:{ReportTemplate:f},data:()=>({title:"TX RTT Report",cohort:{},rows:[],columns:[[e.thTxt("Age group"),e.thTxt("Gender"),e.thTxt("Returned <3 mo"),e.thTxt("Returned 3-5 mo"),e.thTxt("Returned 6+ mo")]],aggregated:[]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(o,i){this.rows=[],this.aggregated=[],this.report=new u,this.report.setStartDate(i.start_date),this.report.setEndDate(i.end_date),this.report.setOccupation(i.occupation),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getClinicTxRtt(),await this.setRows("F"),await this.setRows("M"),this.setMaleTotalsRow(),await this.setFemaleRows()},drillData(o,i,n,r){return this.aggregated.push({gender:n,ageGroup:i,column:r,data:o}),this.drill(o,"".concat(i," (").concat(n,"s) ").concat(r))},setMaleTotalsRow(){const o=i=>this.drill(this.aggregated.filter(n=>n.gender==="Male"&&n.column===i).reduce((n,r)=>n.concat(r.data),[]),"All Male ".concat(i));this.rows.push([e.td("All"),e.td("Male"),o("Returned <3 mo"),o("Returned 3-5 mo"),o("Returned 6+ mo")])},async setFemaleRows(){const o=this.aggregated.filter(a=>a.gender.match(/female/i)).reduce((a,t)=>a.concat(t.data),[]),i=await this.report.getMaternalStatus(p.uniq(o)),n=i.FBf.concat(i.FP),r=a=>this.aggregated.filter(t=>t.gender.match(/female/i)).filter(t=>t.column===a).reduce((t,d)=>p.uniq(t.concat(d.data)),[]),s=(a,t)=>this.drill(r(t).filter(d=>i[a].includes(d)),"All ".concat(t)),l=a=>this.drill(r(a).filter(t=>!n.includes(t)),"All ".concat(a));this.rows.push([e.td("All"),e.td("FP"),s("FP","Returned <3 mo"),s("FP","Returned 3-5 mo"),s("FP","Returned 6+ mo")]),this.rows.push([e.td("All"),e.td("FNP"),l("Returned <3 mo"),l("Returned 3-5 mo"),l("Returned 6+ mo")]),this.rows.push([e.td("All"),e.td("FBF"),s("FBf","Returned <3 mo"),s("FBf","Returned 3-5 mo"),s("FBf","Returned 6+ mo")])},async setRows(o){const i=(n,r)=>n.filter(s=>r(s.months)).map(s=>s.patient_id);for(const n in m){const r=m[n],s=this.formatGender(o);if(r in this.cohort){const l=this.cohort[r][o],a=t=>i(l,t);this.rows.push([e.td(r),e.td(s),this.drillData(a(t=>t<3),r,s,"Returned <3 mo"),this.drillData(a(t=>t>=3&&t<=5),r,s,"Returned 3-5 mo"),this.drillData(a(t=>t>=6),r,s,"Returned 6+ mo")])}else this.rows.push([e.td(r),e.td(s),e.td(0),e.td(0),e.td(0)])}}}});function P(o,i,n,r,s,l){const a=c("report-template"),t=c("ion-page");return w(),_(t,null,{default:F(()=>[T(a,{title:o.title,period:o.period,rows:o.rows,fields:o.fields,columns:o.columns,config:{showIndex:!0},reportPrefix:"Clinic",onReportConfiguration:o.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const L=g(D,[["render",P]]);export{L as default};
