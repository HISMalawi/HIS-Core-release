import{_ as u}from"./ReportMixin.vue_vue_type_script_lang-DYy2lpd9.js";import{T as m}from"./tx_report_service-CpvsloX5.js";import{R as f}from"./TableReportTemplate-BDV868op.js";import{d as R,L as e,ah as h,cW as c,_ as g,r as p,o as w,c as _,w as F,b as T}from"./index-BFVcutZq.js";import"./HisStandardForm-DO3sZVdL.js";import"./ReportErrors-B0y1wUIE.js";const D=R({mixins:[u],components:{ReportTemplate:f},data:()=>({title:"TX RTT Report",cohort:{},rows:[],columns:[[e.thTxt("Age group"),e.thTxt("Gender"),e.thTxt("Returned <3 mo"),e.thTxt("Returned 3-5 mo"),e.thTxt("Returned 6+ mo")]],aggregated:[]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(o,a){this.rows=[],this.aggregated=[],this.report=new m,this.report.setStartDate(a.start_date),this.report.setEndDate(a.end_date),this.report.setOccupation(a.occupation),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getClinicTxRtt(),await this.setRows("F"),await this.setRows("M"),this.setMaleTotalsRow(),await this.setFemaleRows()},drillData(o,a,n,r){return this.aggregated.push({gender:n,ageGroup:a,column:r,data:o}),this.drill(o,"".concat(a," (").concat(n,"s) ").concat(r))},setMaleTotalsRow(){const o=a=>this.drill(this.aggregated.filter(n=>n.gender==="Male"&&n.column===a).reduce((n,r)=>n.concat(r.data),[]),"All Male ".concat(a));this.rows.push([e.td("All"),e.td("Male"),o("Returned <3 mo"),o("Returned 3-5 mo"),o("Returned 6+ mo")])},async setFemaleRows(){const o=this.aggregated.filter(i=>i.gender.match(/female/i)).reduce((i,t)=>i.concat(t.data),[]),a=await this.report.getMaternalStatus(h.uniq(o)),n=a.FBf.concat(a.FP),r=i=>this.aggregated.filter(t=>t.gender.match(/female/i)).filter(t=>t.column===i).reduce((t,d)=>h.uniq(t.concat(d.data)),[]),s=(i,t)=>this.drill(r(t).filter(d=>a[i].includes(d)),"All ".concat(t)),l=i=>this.drill(r(i).filter(t=>!n.includes(t)),"All ".concat(i));this.rows.push([e.td("All"),e.td("FP"),s("FP","Returned <3 mo"),s("FP","Returned 3-5 mo"),s("FP","Returned 6+ mo")]),this.rows.push([e.td("All"),e.td("FNP"),l("Returned <3 mo"),l("Returned 3-5 mo"),l("Returned 6+ mo")]),this.rows.push([e.td("All"),e.td("FBF"),s("FBf","Returned <3 mo"),s("FBf","Returned 3-5 mo"),s("FBf","Returned 6+ mo")])},async setRows(o){const a=(n,r)=>n.filter(s=>r(s.months)).map(s=>s.patient_id);for(const n in c){const r=c[n],s=this.formatGender(o);if(r in this.cohort){const l=this.cohort[r][o],i=t=>a(l,t);this.rows.push([e.td(r),e.td(s),this.drillData(i(t=>t<3),r,s,"Returned <3 mo"),this.drillData(i(t=>t>=3&&t<=5),r,s,"Returned 3-5 mo"),this.drillData(i(t=>t>=6),r,s,"Returned 6+ mo")])}else this.rows.push([e.td(r),e.td(s),e.td(0),e.td(0),e.td(0)])}}}});function P(o,a,n,r,s,l){const i=p("report-template"),t=p("ion-page");return w(),_(t,null,{default:F(()=>[T(i,{title:o.title,period:o.period,rows:o.rows,fields:o.fields,columns:o.columns,config:{showIndex:!0},reportPrefix:"Clinic",onReportConfiguration:o.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const S=g(D,[["render",P]]);export{S as default};
