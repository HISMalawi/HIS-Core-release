import{d as f,r as c,o as g,D as _,a as b,w as D,f as d,b as R,e as v,cv as V,cw as n,x as h,m as w,q as C}from"./index-DrAzzURJ.js";import{v as x}from"./TableView-BsrlHHo8.js";import{a as q}from"./regimen_report_service-Oa5yNO3F.js";import{w as y,b as A}from"./v2utils-CJMcTe3d.js";import"./Export-CbpvcCGj.js";import"./index-CKDW3HWh.js";const k=f({__name:"ClinicRegimenReport",setup(B){const m=h("reports.png"),r=c([]),s=c(""),a=new q;a.setReportType("moh");const p=[[A(),{label:"Gender",ref:"gender",toValue:e=>V(e)},{label:"DOB",ref:"birthdate",toValue:e=>n(e)},{label:"ART start date",ref:"art_start_date",toValue:e=>n(e)},{label:"Weight(Kg)",ref:"current_weight"},{label:"Curr.Reg",ref:"current_regimen"},{label:"ARVs",ref:"medication",toValue:e=>e.map(t=>"".concat(t.medication," (").concat(t.quantity,")")).join(", ")},{label:"Curr.reg dispensed",ref:"last_dispensation_date",toValue:e=>n(e)},{label:"VL result",ref:"vl_result"},{label:"Date of VL result",ref:"vl_result_date",toValue:e=>n(e!=null?e:"")}]],l=()=>y(async()=>{if(!(a.startDate&&a.endDate))return C("Start date and end date required!");r.value=[];const e=await a.getRegimenReport();r.value=Object.values(e).map(t=>({...t,last_dispensation_date:t.medication.reduce((u,o)=>o.start_date,"")}))}),i=()=>_({onFinish:(e,t,u,o)=>{o&&a.setOccupation(o),s.value="".concat(u),a.startDate=e,a.endDate=t,l()}});return g(()=>!r.value.length&&i()),(e,t)=>(R(),b(d(w),null,{default:D(()=>[v(x,{"default-sort-order":"asc","default-sorted-column":"arv_number","icon-url":d(m),title:"Clinic Regimen Report","report-prefix":"Clinic",subtitle:s.value,columns:p,columnData:r.value,rowsPerPage:50,onConfigure:i,onRefresh:l},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{k as default};
