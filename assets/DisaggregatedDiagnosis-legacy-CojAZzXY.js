System.register(["./index-legacy-DzF0J2nr.js","./Export-legacy-nGdXEsf9.js","./aetc_report_service-legacy-Fm9bfoAO.js","./DrillPatientIds-legacy-BwxFUUet.js","./PopupKeyboard-legacy-D5AXh9gb.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./TableView-legacy-BJva-ODI.js","./fuse-legacy-CQoBB3MK.js","./HisKeyboard-legacy-BA3ln4in.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./KbLayouts-legacy-BKvPSxzZ.js","./BaseKeyboard-legacy-BtsNQhim.js","./KbHandler-legacy-De8o5nTq.js","./SIngleTouchField-legacy-C-DlUswk.js","./TouchScreenForm-legacy-CDzY5o9b.js","./ToolbarMediumCard-legacy-BDSK2XWR.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-BcrZm7RF.js","./HisKeypad-legacy-B0uHUR4Q.js"],(function(e,t){"use strict";var o,n,a,l,s,r,c,i,u,d,h,_,p,m,f,g,b,y,v,F,M,C,k,w,D,$,T,j,I,L,R,x,S,E,A,O,P,V,z,U,H,K,N,G,Q,B,Y,J,q,W,X;return{setters:[e=>{o=e.d,n=e.i,a=e.h,l=e.ao,s=e.C,r=e.k,c=e.j,i=e.f,u=e.m,d=e.l,h=e.bh,_=e.J,p=e.K,m=e.M,f=e.a8,g=e.cd,b=e.ce,y=e.cf,v=e.cg,F=e.ch,M=e.cR,C=e.ax,k=e.S,w=e.a$,D=e.ab,$=e._,T=e.r,j=e.o,I=e.x,L=e.b,R=e.w,x=e.u,S=e.v,E=e.z,A=e.A,O=e.c,P=e.F,V=e.y,z=e.ar,U=e.I,H=e.c4,K=e.N,N=e.O,G=e.cb,Q=e.V},e=>{B=e.b,Y=e.t},e=>{J=e.A},e=>{q=e.D},e=>{W=e.M},e=>{X=e.F},null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=M.createElement("style");t.textContent="th[data-v-e2910d5b],td[data-v-e2910d5b]{width:4%;border-collapse:collapse;text-align:center}td[data-v-e2910d5b]{border-bottom:1px solid rgb(165,165,165);padding:.6em;font-weight:500;font-size:.3em;text-align:left}.stick-report-header[data-v-e2910d5b]{background:#fff;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:1000}tr[data-v-e2910d5b]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-e2910d5b]{color:#0645ad;font-weight:600;font-size:1em}\n",M.head.appendChild(t);const Z=o({components:{IonToolbar:n,IonItem:a,IonIcon:l,IonLabel:s,IonTitle:r,IonHeader:c,IonButton:i,IonFooter:u,IonContent:d,IonButtons:h},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(e){const t=_(),o=p([]),n=p(""),a=p("desc"),l=m((()=>e.columns.slice(0,2))),s=m((()=>{const t=[];return e.columnData?.forEach((o=>{const n=e.columns[2].map((e=>{let t="";try{t=D.isEmpty(o)?"...":"function"==typeof e.value?e.value(o):o[e.ref]||""}catch(n){t="_ERROR_",console.error(n)}return{column:e,data:o,value:t,[e.ref||"nada"]:t}}));t.push({row:n,data:o,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})})),t})),r=m((()=>{const t=[];return e.columnData[1]?.forEach((o=>{const n=e.columns[2].map((e=>{let t="";try{t=D.isEmpty(o)?"...":"function"==typeof e.value?e.value(o):o[e.ref]||""}catch(n){t="_ERROR_",console.error(n)}return{column:e,data:o,value:t,[e.ref||"nada"]:t}}));t.push({row:n,data:o,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})})),t})),c=m((()=>{const t=[];return e.columnData[2]?.forEach((o=>{const n=e.columns[3].map((e=>{let t="";try{t=D.isEmpty(o)?"...":"function"==typeof e.value?e.value(o):o[e.ref]||""}catch(n){t="_ERROR_",console.error(n)}return{column:e,data:o,value:t,[e.ref||"nada"]:t}}));t.push({row:n,data:o,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})})),t})),i=m((()=>{const t=[];return e.columnData[3]?.forEach(((o,n)=>{const a=e.columns[8+n].map((e=>{let t="";try{t=D.isEmpty(o)?"...":"function"==typeof e.value?e.value(o):o[e.ref]||""}catch(n){t="_ERROR_",console.error(n)}return{column:e,data:o,value:t,[e.ref||"nada"]:t}}));t.push({row:a,data:o,searchIndex:[...a,a.map((e=>e.value)).join(" ")]})})),t})),u=e=>{for(const t in e)Array.isArray(e[t])?e[t]=e[t].length:"object"==typeof e[t]&&u(e[t])},d=t=>{t.forEach((t=>{const n=e.columns.reduce(((e,t)=>e.concat(t)),[]).filter((e=>e.value||e.ref)).map((e=>{let o="";try{o=D.isEmpty(t)?"...":"function"==typeof e.value?e.value(t):t[e.ref]||""}catch(n){o="_ERROR_",console.error(n)}return{column:e,data:t,value:o,[e.ref||"nada"]:o}}));o.value.push({row:n,data:t,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})}))};return f((()=>e.columnData),(e=>{o.value=[],Array.isArray(e)&&d(e)}),{immediate:!0,deep:!0}),{sortColumn:e=>{n.value=e,a.value="asc"===a.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(t){console.error(t)}},toPDF:()=>{const e=window?.document?.getElementById("report-content");B(`\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ${e.innerHTML}    \n                </body>\n                </html>\n            `)},toCSV:()=>{const t=(e=>{const t=JSON.parse(JSON.stringify(e));u(t);const o=(e=>{const t=[];for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const n=[o],a=Object.values(e[o]);for(const e of a)n.push(e);t.push(n)}return t})(t);return(e=>{const t=[];for(const o of e){const e=[];for(let t=0;t<o.length;t++)"object"==typeof o[t]?(e.push(o[t].M),e.push(o[t].F)):t>0&&e.push(o[t]);const n=e.slice(-2).reduce(((e,t)=>e+("number"==typeof t?t:0)),0);e.push(n),t.push(e)}return e.length=0,e.push(...t),e})(o)})(e.columnData);console.log("CSV ARRAY  ",t);const o=`${k.getLocationName()||"Unknown site"}-${e.title}-${e.subtitle}-${k.getSessionDate()}`;Y([e.headers],[...t,[`Date Created: ${w().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${k.getCoreVersion()}`],[`API Version: ${k.getApiVersion()}`],[`Site UUID: ${k.getSiteUUID()}`],[`Generated by: ${k.getUserName()}`]],o)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():t.push("/")},columnsMinusOne:l,sync:g,search:b,close:y,arrowUp:v,arrowDown:F,document:M,calendar:C,sortOrder:a,reportBody:s,sectionTwo:r,sectionThree:c,sectionTotals:i,columnSorted:n}}}),ee={key:0},te={class:"his-sm-text"},oe={id:"report-content"},ne={class:"art-report-theme"},ae={class:"stick-report-header"},le=["colspan","rowspan","onClick"],se=["onClick"],re={class:"his-sm-text"},ce=$(Z,[["render",function(e,t,o,n,a,l){const s=T("ion-title"),r=T("ion-icon"),c=T("ion-button"),i=T("ion-buttons"),u=T("ion-toolbar"),d=T("ion-header"),h=T("ion-label"),_=T("ion-item"),p=T("ion-content"),m=T("ion-footer");return j(),I(P,null,[L(d,null,{default:R((()=>[L(u,null,{default:R((()=>[L(s,{class:"his-md-text"},{default:R((()=>[x(S(e.title)+" ",1),e.subtitle?(j(),I("br",ee)):E("",!0),A("span",te,S(e.subtitle),1)])),_:1}),L(i,{slot:"end"},{default:R((()=>["function"==typeof e.onConfigure?(j(),O(c,{key:0,onClick:e.onConfigure},{default:R((()=>[L(r,{size:"large",icon:e.calendar},null,8,["icon"])])),_:1},8,["onClick"])):E("",!0),"function"==typeof e.onRefresh?(j(),O(c,{key:1,onClick:e.onRefresh,color:"success",size:"large"},{default:R((()=>[L(r,{size:"large",icon:e.sync},null,8,["icon"])])),_:1},8,["onClick"])):E("",!0)])),_:1})])),_:1})])),_:1}),L(p,{"scroll-y":"","scroll-x":""},{default:R((()=>[A("div",oe,[A("table",ne,[A("thead",ae,[(j(!0),I(P,null,V(e.columnsMinusOne,((t,o)=>(j(),I("tr",{key:o},[(j(!0),I(P,null,V(t,((t,o)=>(j(),I("th",{key:o,colspan:t?.span?.thColspan||1,rowspan:t?.span?.thRowspan||1,onClick:o=>e.sortColumn(t.ref)},[L(_,{lines:"none"},{default:R((()=>[e.columnSorted&&e.columnSorted===t.ref?(j(),O(r,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):E("",!0),L(h,{class:"ion-text-center"},{default:R((()=>[A("b",null,S(t.label),1)])),_:2},1024)])),_:2},1024)],8,le)))),128))])))),128))]),A("tbody",null,[(j(!0),I(P,null,V(e.reportBody,((t,o)=>(j(),I("tr",{key:o},[(j(!0),I(P,null,V(t.row||[],((t,o)=>(j(),I("td",{key:o,onClick:()=>e.onClickTablecell(t),class:z({"clickable-cell":t?.column?.tdClick})},[A("b",re,S(t.value),1)],10,se)))),128))])))),128))])])])])),_:1}),L(m,null,{default:R((()=>[L(u,{color:"dark"},{default:R((()=>[L(c,{onClick:t[0]||(t[0]=t=>e.toCSV()),size:"large"},{default:R((()=>[x(" CSV ")])),_:1}),L(c,{onClick:t[1]||(t[1]=t=>e.toPDF()),size:"large"},{default:R((()=>[x(" PDF ")])),_:1}),L(c,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:R((()=>[x(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-e2910d5b"]]),ie=p([]),ue=p(""),de=p(""),he=p(""),_e=p(!1),pe=p(""),me=o({components:{IonPage:U,IonLoading:H,v2Datatable:ce},setup(){const e=async()=>{const e=new J;e.startDate=ue.value,e.endDate=de.value;try{const t=await e.getClinicReport("DISAGGREGATED_DIAGNOSIS");ie.value=o(t)}catch(t){console.log(t)}},t=[[{label:"Diagnosis",ref:"",span:{thRowspan:2}},{label:"<6 Months>",ref:"",span:{thColspan:2}},{label:"6 Months to < 5",ref:"",span:{thColspan:2}},{label:"5 to 14",ref:"",span:{thColspan:2}},{label:">14",ref:"",span:{thColspan:2}},{label:"Total by gender",ref:"",span:{thColspan:2}},{label:"Total",ref:"",span:{thRowspan:2}}],[{label:"M",ref:""},{label:"F",ref:""},{label:"M",ref:""},{label:"F",ref:""},{label:"M",ref:""},{label:"F",ref:""},{label:"M",ref:""},{label:"F",ref:""},{label:"M",ref:""},{label:"F",ref:""}],[{label:"Diagnosis",ref:"data.diagnosis",value:e=>e.diagnosis},{label:"< 6 months M",ref:"data.< 6 months.M.length",secondaryLabel:"< 6 months Male diagnosed with",value:e=>e.ls_6_months.M.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.ls_6_months.M)},{label:"<6 months F",ref:"data.ls_6_months.F.length",secondaryLabel:"< 6 months Female diagnosed with",value:e=>e.ls_6_months.F.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.ls_6_months.F)},{label:"6 months to < 5",ref:"data.i6_months_to_ls_5.M.length",secondaryLabel:"6 months to < 5 Males with",value:e=>e.i6_months_to_ls_5.M.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.i6_months_to_ls_5.M)},{label:"6 months to < 5",ref:"data.i6_months_to_ls_5.F.length",secondaryLabel:"6 months to < 5 Females with",value:e=>e.i6_months_to_ls_5.F.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.i6_months_to_ls_5.F)},{label:"5 to 14",ref:"data.i5_to_14.M.length",secondaryLabel:"5 to 14 Males with",value:e=>e.i5_to_14.M.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.i5_to_14.M)},{label:"5 to 14",ref:"data.i5_to_14.F.length",secondaryLabel:"5 to 14 Females with",value:e=>e.i5_to_14.F.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.i5_to_14.F)},{label:">14",ref:"data.gt_14.M.length",secondaryLabel:"Greater than 14 males with",value:e=>e.gt_14.M.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.gt_14.M)},{label:">14",ref:"data.gt_14.F.length",secondaryLabel:"Greater than 14 females with",value:e=>e.gt_14.F.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} ${t.diagnosis} `,t.gt_14.F)},{label:"Total by gender",ref:"data.total_by_gender.M.length",secondaryLabel:"Total by gender males",value:e=>e.total_by_gender.M.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} `,t.total_by_gender.M)},{label:"5 to 14",ref:"data.total_by_gender.F.length",secondaryLabel:"Total by gender females",value:e=>e.total_by_gender.F.length,tdClick:({column:e,data:t})=>a(`${e.secondaryLabel} `,t.total_by_gender.F)},{label:"Total",ref:"Total",value:e=>[...e.ls_6_months.M,...e.ls_6_months.F,...e.i6_months_to_ls_5.M,...e.i6_months_to_ls_5.F,...e.i6_months_to_ls_5.M,...e.i6_months_to_ls_5.F,...e.i6_months_to_ls_5.M,...e.i6_months_to_ls_5.F,...e.i5_to_14.M,...e.i5_to_14.F,...e.gt_14.M,...e.gt_14.F].length,tdClick:({column:e,data:t})=>{const o=[...t.ls_6_months.M,...t.ls_6_months.F,...t.i6_months_to_ls_5.M,...t.i6_months_to_ls_5.F,...t.i6_months_to_ls_5.M,...t.i6_months_to_ls_5.F,...t.i6_months_to_ls_5.M,...t.i6_months_to_ls_5.F,...t.i5_to_14.M,...t.i5_to_14.F,...t.gt_14.M,...t.gt_14.F];a(`${e.label} `,o)}}]],o=e=>{const t=[];for(const o of e){const e=n(o);t.push(e)}return t},n=e=>{const t={};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){let a=o.replace(/ /g,"_");const l=e[o];/^\d/.test(a)&&(a="i"+a),a=a.replace(/[<>&]/g,(e=>{switch(e){case"<":return"ls";case">":return"gt";case"&":return"amp";default:return e}})),t[a]="object"!=typeof l||Array.isArray(l)?l:n(l)}return t},a=async(e,t)=>{t.length<=0||(await N.create({component:q,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:he,patientIdentifiers:t,onFinish:()=>N.getTop().then((e=>e&&N.dismiss()))}})).present()},l=()=>W([{id:"start_date",helpText:"Start Date",type:X.TT_FULL_DATE,validation:e=>Q.required(e),computedValue:e=>e.value},{id:"end_date",helpText:"End Date",type:X.TT_FULL_DATE,validation:e=>Q.required(e),computedValue:e=>e.value}],((t,o)=>{ue.value=o.start_date,de.value=o.end_date,he.value=`Period (${G(ue.value)} to ${G(de.value)})`,N.dismiss(),pe.value=`${G(ue.value)} to ${G(de.value)}`,e()}));return K((()=>!ie.value.length&&l())),{columns:t,isLoading:_e,reportData:ie,period:he,csvQuarter:pe,csvheaders:["Diagnosis","<6 Months> M","<6 Months> F","6 Months to < 5 M","6 Months to < 5 F","5 to 14 F","5 to 14 M",">14 M",">14 F","Total by gender M","Total by gender F","Total"],generate:e,configure:l}}});e("default",$(me,[["render",function(e,t,o,n,a,l){const s=T("ion-loading"),r=T("v2Datatable"),c=T("ion-page");return j(),O(c,null,{default:R((()=>[L(s,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),L(r,{title:"Disaggregated Diagnosis Report",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:25,onConfigure:e.configure,csvQuarter:e.csvQuarter,headers:e.csvheaders,onRefresh:()=>e.generate()},null,8,["subtitle","columns","columnData","onConfigure","csvQuarter","headers","onRefresh"])])),_:1})}]]))}}}));
