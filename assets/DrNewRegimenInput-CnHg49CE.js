import{d as B,bb as j,e as F,aj as R,ak as U,ai as Y,_ as G,r,o as l,c as C,w as h,b as d,x as _,F as x,y as $,A as i,v as c,u as L,z as w,ar as D,a3 as O,a4 as P}from"./index-BCTN_bnC.js";import{V as T}from"./ViewPort-BCxYiILf.js";import{_ as q}from"./FieldMixin.vue_vue_type_script_lang-BcY4Dt1h.js";const H=B({components:{IonInput:j,IonCheckbox:F,ViewPort:T,IonRow:R,IonCol:U,IonGrid:Y},mixins:[q],data:()=>({listData:[]}),mounted(){this.init()},activated(){this.init()},watch:{listData:{handler(t){const a=this.toDrugs(t).filter(s=>s.isChecked).reduce((s,n)=>{var o;return[...s,n,...(o=n.substitute)!=null&&o.concept?[n.substitute]:[]]},[]).map(s=>({label:s.name,value:s.concept.concept_id,other:this.regimenComposition}));this.$emit("onValue",a.length?a:null)},deep:!0},clear(){this.listData.forEach(t=>t.other.drugs.forEach(a=>{a.isChecked=!1,a.disabled=!1}))}},computed:{regimenComposition(){const t=[];return(this.toDrugs(this.listData).filter(s=>s.isChecked)||[]).forEach(s=>{if(Object.keys(s.substitute).length>0){const n="".concat(s.abbreviation,"/").concat(s.substitute.abbreviation),o="".concat(s.substitute.abbreviation,"/").concat(s.abbreviation);!t.includes(n)&&!t.includes(o)&&t.push(n)}else t.push(s.abbreviation)}),t.join("-")}},methods:{onCheck(t,a){var s;(s=a==null?void 0:a.substitute)!=null&&s.abbreviation&&this.listData.forEach(n=>{n.other.drugs.forEach(o=>{var u;a.abbreviation===((u=o==null?void 0:o.substitute)==null?void 0:u.abbreviation)&&(o.disabled=t.detail.checked)})})},toDrugs(t){return t.map(a=>a.other.drugs).flat(1)},async init(){this.$emit("onFieldActivated",this),this.listData=await this.options(this.fdata)}}}),I=t=>(O("data-v-1e1e7c97"),t=t(),P(),t),J={class:"his-md-text"},K=I(()=>i("br",null,null,-1)),M={style:{width:"100%","text-align":"left"}},Q=I(()=>i("thead",null,[i("th"),i("th",{class:"his-sm-text"},"Drug"),i("th",{class:"his-sm-text"},"Resistant"),i("th",{class:"his-sm-text"},"Side effects"),i("th",{class:"his-sm-text"},"Alternative")],-1)),W={class:"his-sm-text"},X={key:0},Z={key:1},g={class:"his-sm-text"};function tt(t,a,s,n,o,u){const y=r("ion-input"),p=r("ion-col"),V=r("ion-checkbox"),N=r("ion-row"),E=r("ion-grid"),A=r("view-port");return l(),C(A,null,{default:h(()=>[d(y,{value:t.regimenComposition,class:"input_display",disabled:!0},null,8,["value"]),d(E,{class:"view-port-content"},{default:h(()=>[(l(!0),_(x,null,$(t.listData,(b,S)=>(l(),C(N,{key:S},{default:h(()=>[d(p,{size:"3"},{default:h(()=>[i("b",J,c(b.label),1),L(),K,i("i",null,c(b.value),1)]),_:2},1024),d(p,{size:"9"},{default:h(()=>[i("table",M,[Q,i("tbody",null,[(l(!0),_(x,null,$(b.other.drugs,(e,z)=>{var f,v,k;return l(),_("tr",{key:z},[i("td",null,[d(V,{onIonChange:m=>t.onCheck(m,e),disabled:e.resistant||e.disabled,modelValue:e.isChecked,"onUpdate:modelValue":m=>e.isChecked=m},null,8,["onIonChange","disabled","modelValue","onUpdate:modelValue"])]),i("td",W,[e.disabled?(l(),_("s",X,c("".concat(e.name," (").concat(e.abbreviation,")")),1)):w("",!0),e.disabled?w("",!0):(l(),_("span",Z,c("".concat(e.name," (").concat(e.abbreviation,")")),1))]),i("td",{class:D(["his-sm-text",{drug_danger:e.resistant,drug_ok:!e.resistant}])},c(e.resistant?"Yes":"No"),3),i("td",{class:D(["his-sm-text",{drug_danger:e.side_effects,drug_ok:!e.side_effects}])},c(e.side_effects?"Yes":"No"),3),i("td",g,c((f=e.substitute)!=null&&f.name?"".concat((v=e.substitute)==null?void 0:v.name," (").concat((k=e.substitute)==null?void 0:k.abbreviation,")"):"N/A"),1)])}),128))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}const at=G(H,[["render",tt],["__scopeId","data-v-1e1e7c97"]]);export{at as default};
