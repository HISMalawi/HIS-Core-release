System.register(["./index-legacy-Dg5P6bX-.js","./HisStandardForm-legacy-BXV61qjj.js","./useEncounter-legacy-Bp6E5sCN.js","./dynamic-import-helper-legacy-arUa2LZV.js","./commons-legacy-CiEua9CM.js","./util-legacy-CjANJSja.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./isEmpty-legacy-rdjCNuhy.js","./_Set-legacy-BL8ow4HL.js","./_setToArray-legacy-jEwcQpqP.js","./encounter_guidelines-legacy-mRSBdMQj.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,a){"use strict";var l,t,i,o,d,u,n,s,c,_,p,r,T,E,S,m;return{setters:[e=>{l=e.d,t=e.K,i=e.b5,o=e.cV,d=e.V,u=e.o,n=e.c,s=e.w,c=e.b,_=e.cl,p=e.I},e=>{r=e.H},e=>{T=e.u},e=>{E=e.F},e=>{S=e.r},e=>{m=e.g},null,null,null,null,null,null,null,null,null],execute:function(){e("default",l({__name:"Microscopy",setup(e){const a=t([]),l=new i(-1,o.LAB_RESULTS),{goToNextTask:v,patientDashboardUrl:O}=T(((e,t)=>{l.patientID=t,l.providerID=e;const i=e=>({id:`sample${e}PhysicalAppearance`,helpText:`Sample ${e} Physical Appearance:`,type:E.TT_SELECT,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_PHYSICAL_APPEARANCE`),value_coded:m(`${a.value}`),obs_datetime:l.date}),validation:e=>d.required(e),options:()=>[{value:"MUCO_PURULENT",label:"Muco-purulent"},{value:"BLOOD_STAINED",label:"Blood-stained"},{value:"SALIVA",label:"Saliva"},{value:"OTHER",label:"Other"}]}),o=e=>({id:`sample${e}Procedure`,helpText:`Sample ${e} Procedure:`,type:E.TT_SELECT,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_PROCEDURE`),value_coded:m(`${a.value}`),obs_datetime:l.date}),validation:e=>d.required(e),options:()=>[{value:"ZIEHL_NEELSEN",label:"Ziehl-Neelsen"},{value:"FLUORESCENCE",label:"Fluorescence"}]}),u=e=>({id:`sample${e}Result`,helpText:`Sample ${e} Result:`,type:E.TT_SELECT,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_RESULT`),value_coded:m(`${a.value}`),obs_datetime:l.date}),validation:e=>d.required(e),options:()=>[{value:"AFB_POSITIVE",label:"AFB Positive"},{value:"AFB_NEGATIVE",label:"AFB Negative"}]}),n=e=>({id:`sample${e}Grading`,helpText:`Sample ${e} Grading:`,type:E.TT_SELECT,validation:e=>d.required(e),condition:a=>"AFB_POSITIVE"===a[`sample${e}Result`].value,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_GRADING`),value_text:a.value,obs_datetime:l.date}),options:()=>[{value:"1+",label:"1+"},{value:"2+",label:"2+"},{value:"3+",label:"3+"},{value:"OTHER",label:"Other"}]}),s=e=>({id:`sample${e}OtherGrading`,helpText:`Sample ${e} Other Grading:`,type:E.TT_TEXT,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_GRADING`),value_text:a.value,obs_datetime:l.date}),validation:e=>d.required(e),condition:a=>"OTHER"===a[`sample${e}Grading`].value}),c=e=>({id:`sample${e}BaciliSeen`,type:E.TT_NUMBER,helpText:`Sample ${e} no. Of Bacilli Seen:`,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_NUMBER_OF_BACILI_SEEN`),value_numeric:a.value,obs_datetime:l.date}),validation:e=>d.required(e),condition:a=>"OTHER"===a[`sample${e}Grading`].value}),_=e=>({id:`sample${e}ResultDate`,helpText:`Sample ${e} Result Date:`,type:E.TT_FULL_DATE,computedValue:a=>({concept_id:m(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_RESULT_DATE`),value_datetime:a.value,obs_datetime:l.date}),validation:e=>d.required(e)});a.value=[i("One"),o("One"),u("One"),n("One"),s("One"),c("One"),_("One"),i("Two"),o("Two"),u("Two"),n("Two"),s("Two"),c("Two"),_("Two")]}));function A(e){const a=[];return"AFB_POSITIVE"===e.sampleOneResult.value||"AFB_POSITIVE"===e.sampleTwoResult.value?(a.push({concept_id:m("TB_TYPE"),value_coded:m("PULMONARY_TB"),obs_datetime:l.date}),a.push({concept_id:m("TB_STATUS"),value_coded:m("POSITIVE"),obs_datetime:l.date}),a.push({concept_id:m("TUBERCULOSIS_CLASS"),value_coded:m("All Other"),obs_datetime:l.date})):a.push({concept_id:m("TB_STATUS"),value_coded:m("NEGATIVE"),obs_datetime:l.date}),a.push({concept_id:m("BACTERIOLOGICALLY_DIAGNOSED"),value_coded:m("YES_ANSWER"),obs_datetime:l.date}),a.push({concept_id:m("PROCEDURE_TYPE"),value_coded:m("MICROSCOPY"),obs_datetime:l.date}),a}async function C(e,a){await l.createEncounter(),await l.saveObservationList([...A(e),...await S(a)]),v()}return(e,l)=>(u(),n(_(p),null,{default:s((()=>[c(r,{cancelDestinationPath:_(O),onFinishAction:C,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
