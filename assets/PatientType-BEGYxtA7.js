import{F as i}from"./dynamic-import-helper-Bsjrd6Ro.js";import{H as s}from"./HisStandardForm-lonwENLb.js";import{d as r,aZ as n,T as p,V as e,_ as l,r as d,o as c,c as u}from"./index-DTBWhHAq.js";import{_ as y}from"./EncounterMixin.vue_vue_type_script_lang-DZZc0yNk.js";import{P as h}from"./PersonFieldHelper-DZSVURTv.js";import"./TouchScreenForm-BeJsJnwt.js";import"./ToolbarMediumCard-wr9sTFDK.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DbAo6hHM.js";import"./encounter_guidelines-BDvVJmZ6.js";import"./GuidelineEngine-D6V1_Znr.js";import"./LocationFieldOptions-C65wr29G.js";import"./MultiFieldDateHelper-BWKgkEkB.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";const m=r({mixins:[y],components:{HisStandardForm:s},data:()=>({patientType:{}}),watch:{ready:{async handler(t){t&&(this.patientType=new n(this.patientID,this.providerID),await this.patientType.loadPatientType(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(t,a){await this.patientType.createEncounter(),await this.patientType.saveObservationList(await this.resolveObs(a)),p("Observations and encounter created!"),this.nextTask()},patientTypeField(){return{id:"patient_type",helpText:"Current type: ".concat(this.patientType.getType()),type:i.TT_SELECT,validation:t=>e.required(t)||e.notTheSame(t.value,this.patientType.getType()),options:()=>n.getPatientTypes(),computedValue:t=>this.patientType.buildPatientType(t.value)}},facilityLocationField(){return{...h.getFacilityLocationField(),computedValue:t=>this.patientType.buildLocationClinic(t.value),condition:t=>["Emergency supply","External consultation"].includes(t.patient_type.value)}},entryPointField(){return{id:"entry",helpText:"Entry point",type:i.TT_SELECT,computedValue:t=>this.patientType.buildEntryPoint(t.value),condition:t=>/external/i.test(t.patient_type.value),validation:t=>e.required(t),options:()=>this.mapStrToOptions(["ART","ANC","IPD","OPD"])}},hasViralLoadField(){return{id:"has_vl",helpText:"Viral load result available?",type:i.TT_SELECT,condition:t=>/external/i.test(t.patient_type.value),validation:t=>e.required(t),options:()=>this.yesNoOptions()}},viralLoadField(){return{id:"vl",helpText:"Viral load",type:i.TT_NUMBER,computedValue:t=>this.patientType.buildVl(t.value),condition:t=>t.has_vl.value==="Yes",validation:t=>e.required(t)}},getFields(){return[this.patientTypeField(),this.facilityLocationField(),this.entryPointField(),this.hasViralLoadField(),this.viralLoadField()]}}});function T(t,a,v,_,f,F){const o=d("his-standard-form");return c(),u(o,{fields:t.fields,onFinishAction:t.onFinish,skipSummary:!0,cancelDestinationPath:t.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const A=l(m,[["render",T]]);export{A as default};
