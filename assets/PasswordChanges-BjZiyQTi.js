import{d as D,r as o,o as v,D as b,a as h,b as w,w as C,e as f,f as l,v as P,x,n as _,z as i,B as y,s as V,y as k}from"./index-3BeNlo1y.js";import{v as m}from"./TableView-C7p0Xx0H.js";import{D as M}from"./data_verification_service-sbegFjBz.js";import"./Export-CbOZpD_i.js";import"./index-DgFByFCT.js";const I=D({__name:"PasswordChanges",setup(Y){const c=o([]),d=o(""),n=o(!1),r=new M,g=[[{label:"#",ref:"index"},{label:"User",ref:"provider"},{label:"Count",ref:"count"},{label:"View",ref:"drilldown",toValue:()=>"View",tdClick:async e=>{e.refData.length&&(await i.create({component:m,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e.data.provider,columns:[[{label:"#",ref:"index"},{label:"Date changed",ref:"date",toValue:a=>y(a).format("DD/MMM/YYYY HH:mm:ss")}]],rowsPerPage:100,columnData:e.refData.reduce((a,t,s)=>[...a,{...t,index:s+1}],[]),onFinish:()=>i.getTop().then(a=>a&&i.dismiss())}})).present()}}]],u=async()=>{if(!(r.startDate&&r.endDate))return V("Start date and end date required!");n.value=!0;try{const e=await r.getPasswordChanges();c.value=Object.keys(e).reduce((a,t,s)=>[...a,{index:s+1,provider:t,count:e[t].length,drilldown:e[t]}],[])}catch(e){console.error(e),k("Unable to generate report!")}n.value=!1},p=()=>b({onFinish:(e,a,t)=>{d.value=t,r.startDate=e,r.endDate=a,u()}});return v(()=>p()),(e,a)=>(w(),h(l(_),null,{default:C(()=>[f(l(P),{"is-open":n.value,message:"Please wait.."},null,8,["is-open"]),f(m,{"icon-url":l(x)("reports.png"),title:"Password changes","report-prefix":"Clinic",subtitle:d.value,columns:g,columnData:c.value,rowsPerPage:100,onConfigure:p,onRefresh:u},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{I as default};
