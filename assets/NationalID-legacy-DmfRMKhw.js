System.register(["./index-legacy-Dg5P6bX-.js","./dynamic-import-helper-legacy-arUa2LZV.js","./HisStandardForm-legacy-BXV61qjj.js","./useEncounter-legacy-Bp6E5sCN.js","./identifier_service-legacy-_ZM-WDy-.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./isEmpty-legacy-rdjCNuhy.js","./_Set-legacy-BL8ow4HL.js","./_setToArray-legacy-jEwcQpqP.js","./encounter_guidelines-legacy-mRSBdMQj.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,a){"use strict";var t,n,i,l,s,r,u,o,c,d,y,g,I,T,f,p,v,j;return{setters:[e=>{t=e.d,n=e.K,i=e.E,l=e.V,s=e.o,r=e.c,u=e.w,o=e.b,c=e.cl,d=e.c_,y=e.ab,g=e.t,I=e.R,T=e.I},e=>{f=e.F},e=>{p=e.H},e=>{v=e.u},e=>{j=e.I},null,null,null,null,null,null,null,null,null],execute:function(){e("default",t({__name:"NationalID",setup(e){const a=n([]),t=n(),N=i(),m=()=>!/unknown/i.test(t.value.getMWNationalID()),{goToNextTask:_,patientDashboardUrl:D}=v(((e,n,i)=>{t.value=i,a.value=[{id:"currentNationalID",helpText:"Current national identifier:",type:f.TT_TEXT_BANNER,condition:()=>!N.query.reassign&&m(),options:()=>{const e=`<b>${i.getMWNationalID()}</b>`;return[{label:e,value:e}]}},{id:"patientIdentifier",helpText:"Malawi National ID",type:f.TT_TEXT,defaultValue:()=>m()?i.getMWNationalID():"",validation:e=>l.validateSeries([()=>l.required(e),()=>l.isMWNationalID(e)])}]}));async function h(e){const a=`${e.patientIdentifier.value}`,n=new j;if(n.identifierType=d.MW,!y.isEmpty(await n.getPatientsByIdentifier(a)))return g("ID was already assigned",15e3);if(N.query.reassign){const a=parseInt(`${N.query.reassign}`);await t.value.changeMwNationalId(a,e.patientIdentifier.value)}else await t.value.updateMWNationalId(e.patientIdentifier.value);I.invalidate("ACTIVE_PATIENT"),_()}return(e,t)=>(s(),r(c(T),null,{default:u((()=>[o(p,{cancelDestinationPath:c(D),onFinishAction:h,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
