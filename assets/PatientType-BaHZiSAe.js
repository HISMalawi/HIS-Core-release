import{d as p,bJ as a,al as s,am as r,aB as c,bI as l,s as d,q as y,ak as h,a as u,ap as T,b as m}from"./index-BCOAvIf2.js";import{H as _}from"./HisStandardForm-CejSRcn9.js";import{_ as E}from"./EncounterMixin.vue_vue_type_script_lang-BiqmNDbL.js";import"./encounter_guidelines-DtnttXhU.js";import"./GuidelineEngine-D6V1_Znr.js";const f=p({mixins:[E],components:{HisStandardForm:_},data:()=>({patientType:{},isEmergencyRefillEnabled:!1}),watch:{ready:{async handler(e){e&&(this.patientType=new a(this.patientID,this.providerID),await this.patientType.loadPatientType(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e){var i,n;if(!await this.patientType.createEncounter())return d("Unable to create encounter");this.patientType.setLocationName((i=e==null?void 0:e.location)==null?void 0:i.label),this.patientType.setPatientType((n=e==null?void 0:e.patient_type)==null?void 0:n.value),await this.patientType.save(),y("Observations and encounter created!"),this.nextTask()},facilityLocationField(){const e=l.getFacilityLocationField();return e.condition=t=>["Emergency supply","External consultation"].includes(t.patient_type.value),e},getFields(){return[{id:"patient_type",helpText:"Current type: ".concat(this.patientType.getType()),type:r.TT_SELECT,init:async()=>(this.isEmergencyRefillEnabled=await c.get("EMERGENCY_DRUG_REFILL_ENABLED"),!0),validation:e=>s.required(e)||s.notTheSame(e.value,this.patientType.getType()),options:()=>a.getPatientTypes(this.isEmergencyRefillEnabled)},this.facilityLocationField()]}}});function F(e,t,i,n,g,b){const o=T("his-standard-form");return m(),u(o,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const R=h(f,[["render",F]]);export{R as default};
