System.register(["./index-legacy-CA6M7ipO.js","./BasicReportTemplate-legacy-VHTBSvfP.js","./opd_report_service-legacy-DRQcBQZi.js","./MOHReportHeader-legacy-CHDBjGHE.js"],(function(t,e){"use strict";var a,r,n,o,s,i,l,d,c,h,p,u,m,D;return{setters:[t=>{a=t.d,r=t.H,n=t.aN,o=t.as,s=t.au,i=t.ad,l=t.ae,d=t.bC,c=t.ao,h=t.aV,p=t.al},t=>{u=t.D},t=>{m=t.O},t=>{D=t.a}],execute:function(){t("_",a({data:()=>({fields:[],report:{},reportReady:!1,period:"",startDate:"",endDate:"",customFileName:"",drillDownCache:{}}),methods:{toDate:t=>r.toStandardHisDisplayFormat(t),confirmPatient(t){return this.$router.push(`/patients/confirm?person_id=${t}`)},async exportToCustomPDF(t){const e=open("","","width:1024px, height:768px"),a=document.getElementById("report-content");a&&e&&(e.document.write(`\n                    <html>\n                    <head>\n                        <title>${t}</title>\n                        <link rel="stylesheet" media="print" href="/assets/css/cohort.css" />\n                    </head>\n                    <body>\n                        ${a.innerHTML}\n                    </body>\n                    </html>\n                `),setTimeout((()=>{e.print(),e.close()}),3500))},async onDrillDown(t,e){if(n.isEmpty(e))return;const a=[[o.thTxt("First name"),o.thTxt("Last name"),o.thTxt("Gender"),o.thTxt("Age"),o.thTxt("Phone"),o.thTxt("Address"),o.thTxt("Action")]];return this.drilldownData(t,a,e,(async t=>await Promise.all(t.map((async t=>{const e=await p.findByID(t),a=new p(e);return[o.td(a.getGivenName()),o.td(a.getFamilyName()),o.td(a.getGender()),o.td(a.getAge()),o.td(a.getPhoneNumber()),o.td(`${a.getCurrentDistrict()}, ${a.getCurrentVillage()}, ${a.getClosestLandmark()}`),o.tdBtn("Select",(async()=>{await s.dismiss({}),this.$router.push({path:`/patient/dashboard/${t}`})}))]})))))},async drilldownAsyncRows(t,e,a){(await s.create({component:u,cssClass:"large-modal",componentProps:{title:t,columns:e,asyncRows:a,showFilters:!0,rowsPerPage:50,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>s.dismiss()}})).present()},async drilldownData(t,e,a,r){(await s.create({component:u,cssClass:"large-modal",componentProps:{title:t,columns:e,rows:a,rowParser:r,rowsPerPage:50,showFilters:!0,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>s.dismiss()}})).present()},getDefaultDrillDownTable(){return{rowParser:t=>t.map((async t=>{const[e,a]=t;if(a in this.drillDownCache)return[e];const r=await p.findByID(a),n=new p(r),i=[e,o.td(n.getArvNumber()),o.td(n.getGender()),o.tdDate(n.getBirthdate().toString()),o.tdBtn("Show",(async()=>{await s.dismiss({}),this.$router.push({path:`/patient/dashboard/${a}`})}))];return this.drillDownCache[a]=i,i})),columns:[[o.thTxt("ARV number"),o.thTxt("Gender"),o.thTxt("Birth Date"),o.thTxt("Actions")]]}},runTableDrill(t,e="Drilldown patients"){const{columns:a,rowParser:r}=this.getDefaultDrillDownTable();this.drilldownData(e,a,t,r)},drill(t,e="Drill table"){return t&&t.length>0?o.tdLink(t.length,(()=>this.runTableDrill(t,e))):o.td(0)},getEpiweeksFields:()=>[{id:"epiweek",helpText:"Select EPI week",type:i.TT_SELECT,validation:t=>l.required(t),options:async()=>(await D.getReportEpiWeeks()).map((t=>({label:t.name+" - ("+d(t.start).format("DD/MMM/YYYY")+" - "+d(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getMonthlyFields:()=>[{id:"idsrmonth",helpText:"Select Month",type:i.TT_SELECT,validation:t=>l.required(t),options:async()=>(await D.getReportMonths()).map((t=>({label:t.name+" - ("+d(t.start).format("DD/MMM/YYYY")+" - "+d(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getDateDurationFields(t=!1,e=!1,a=5){const r=c.getSessionDate();return[{id:"quarter",helpText:"Select Quarter",type:i.TT_SELECT,condition:()=>t,validation:t=>l.required(t),options:()=>{let t=m.getReportQuarters(a).map((t=>({label:t.name,value:t.start,other:t})));return e&&(t=[{label:"Set custom period",value:"custom_period",other:{}},...t]),t}},...h({id:"start_date",helpText:"Start",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,minDate:()=>"2001-01-01",maxDate:()=>r,estimation:{allowUnknown:!1},computeValue:t=>t}),...h({id:"end_date",helpText:"End",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,unload:(t,e,a,r)=>{"next"===e&&(this.endDate=r.end_date)},minDate:(t,e)=>e.start_date,maxDate:()=>r,estimation:{allowUnknown:!1},computeValue:t=>t})]}}}))}}}));
