import{d as n,I as p,cn as l,L as t,cp as m,a$ as d,S as c,_ as h,r as s,o as u,c as _,w as f,b as x}from"./index-BCfs_J-V.js";import{_ as T}from"./ReportMixin.vue_vue_type_script_lang-CWVQISd9.js";import{R as w}from"./TableReportTemplate-BuIqEVhG.js";import"./MultiFieldDateHelper-CW6lfYIk.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BasicReportTemplate-Cx8Bs2Je.js";import"./Export-Ckt7Z8Mq.js";import"./SIngleTouchField-UCxZk0Bs.js";import"./Pagination-CEBNEafk.js";import"./HisStandardForm-DASCGMaQ.js";import"./TouchScreenForm-BEQyavf9.js";import"./ToolbarMediumCard-DFqt8bLl.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-CUJ1kut7.js";import"./ReportErrors-CN9j2LPZ.js";const D=n({mixins:[T],components:{ReportTemplate:w,IonPage:p},data:()=>({title:"Clinic Clients due for VL <small>(clients with appointments in specified period)</small>",rows:[],columns:[]}),async created(){const o=await l.filingNumbersEnabled();this.columns.push([t.thTxt(o?"Filing #":"ARV#"),t.thTxt("First name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Last name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Gender"),t.thTxt("Age"),t.thTxt("App."),t.thTxt("ART started"),t.thTxt("Months on ART"),t.thTxt("Milestone"),t.thTxt("Ordered"),t.thTxt("Result"),t.thTxt("Released")]),this.fields=this.getDateDurationFields(!1,!1,5,null)},methods:{async onPeriod(o,e){this.rows=[],this.report=new m,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.report.setOccupation(e.occupation),this.period=this.report.getDateIntervalPeriod();const r=await this.report.getClientsDueForVl();this.setRows(r)},async setRows(o){o.forEach(e=>{this.rows.push([t.tdLink(e.arv_number,()=>this.confirmPatient(e.patient_id)),t.td(e.given_name),t.td(e.family_name),t.td(this.formatGender(e.gender)),t.td(e.birthdate?d(c.getSessionDate()).diff(e.birthdate,"years"):"N/A"),t.tdDate(e.appointment_date),t.tdDate(e.start_date),t.td(e.months_on_art),t.tdDate(e.mile_stone),t.tdDate(e.last_result_order_date),t.td(e.last_result),t.tdDate(e.last_result_date)])})}}});function R(o,e,r,g,b,C){const a=s("report-template"),i=s("ion-page");return u(),_(i,null,{default:f(()=>[x(a,{title:o.title,period:o.period,rows:o.rows,fields:o.fields,columns:o.columns,showtitleOnly:!0,canExportPDf:!0,encryptPDF:!0,onReportConfiguration:o.onPeriod,"report-prefix":"Clinic"},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const j=h(D,[["render",R]]);export{j as default};
