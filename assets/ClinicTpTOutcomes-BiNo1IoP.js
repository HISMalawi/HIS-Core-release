import{_ as h}from"./ReportMixin.vue_vue_type_script_lang-DHsaLvda.js";import{C as u}from"./clinic_report_service-CnU_mvQx.js";import{R as T}from"./TableReportTemplate-vw3YSnxU.js";import{d as m,L as i,ab as p,_ as f,r as c,o as _,c as w,w as b,b as g}from"./index-BCTN_bnC.js";import"./MultiFieldDateHelper-CQ4seieZ.js";import"./dynamic-import-helper-BkBZiFw5.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BasicReportTemplate-ARrW1sF6.js";import"./Export-nPQsqN2_.js";import"./SIngleTouchField-DeaPtOu6.js";import"./Pagination-141LZS_a.js";import"./HisStandardForm-CaDwl-hA.js";import"./TouchScreenForm-TKB9q3ZD.js";import"./ToolbarMediumCard-O_J6wu7C.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-BCxYiILf.js";import"./ReportErrors-Dkeo3N9I.js";const s=[{indicator:"started_tpt_new",label:t=>"Started (New on ART) ".concat(t)},{indicator:"started_tpt_prev",label:t=>"Started (Previous on ART) ".concat(t)},{indicator:"completed_tpt_new",label:t=>"Completed (New on ART) ".concat(t)},{indicator:"completed_tpt_prev",label:t=>"Completed (Previous on ART) ".concat(t)},{indicator:"not_completed_tpt",label:t=>"Not completed ".concat(t)},{indicator:"died",label:t=>"Died on ".concat(t)},{indicator:"defaulted",label:t=>"Defaulted ".concat(t)},{indicator:"stopped",label:t=>"Stopped ".concat(t)},{indicator:"transfer_out",label:t=>"Transfer out with ".concat(t)},{indicator:"confirmed_tb",label:t=>"Confirmed TB on ".concat(t)},{indicator:"pregnant",label:t=>"Pregnant on ".concat(t)},{indicator:"breast_feeding",label:t=>"Breastfeeding ".concat(t)},{indicator:"skin_rash",label:t=>"Skin rash ".concat(t)},{indicator:"peripheral_neuropathy",label:t=>"Peripheral neuropathy ".concat(t)},{indicator:"yellow_eyes",label:t=>"Yellow eyes ".concat(t)},{indicator:"nausea",label:t=>"Nausea ".concat(t)},{indicator:"dizziness",label:t=>"Dizziness ".concat(t)}],P=m({mixins:[h],components:{ReportTemplate:T},data:()=>({title:"TPT Outcome",cohort:{},rows:[],columns:[[i.thTxt("Age group"),i.thTxt("TPT Type"),i.thTxt("Started TPT (New on ART)"),i.thTxt("Started TPT (Previous on ART)"),i.thTxt("Completed TPT (New on ART)"),i.thTxt("Completed TPT (Previous on ART)"),i.thTxt("Not completed TPT"),i.thTxt("Died"),i.thTxt("Defaulted"),i.thTxt("Stopped ART"),i.thTxt("TO"),i.thTxt("Confirmed TB "),i.thTxt("Pregnant"),i.thTxt("Breastfeeding"),i.thTxt("Skin rash"),i.thTxt("Peripheral neuropathy"),i.thTxt("Yellow eyes"),i.thTxt("Nausea"),i.thTxt("Dizziness")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,o){this.rows=[],this.report=new u,this.report.setStartDate(o.start_date),this.report.setEndDate(o.end_date),this.report.setOccupation(o.occupation),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTtpOutcomes()||[],this.setRows(),this.setMaleTotalsRow(),await this.setFemaleAggregations()},setMaleTotalsRow(){const t=this.cohort.reduce((o,n)=>(s.forEach(a=>{o[a.indicator]||(o[a.indicator]=[]),n[a.indicator]&&(o[a.indicator]=o[a.indicator].concat(n[a.indicator].filter(e=>e.gender==="M").map(e=>e.patient_id)))}),o),{});this.rows.push([i.td("All"),i.td("Male"),...s.map(o=>this.drill(t[o.indicator],o.label("All")))])},async setFemaleAggregations(){const t=this.cohort.reduce((e,r)=>(s.forEach(l=>{e[l.indicator]||(e[l.indicator]=[]),r[l.indicator]&&(e[l.indicator]=e[l.indicator].concat(r[l.indicator].filter(d=>d.gender==="F").map(d=>d.patient_id)),e.all=e.all.concat(e[l.indicator]))}),e),{all:[]}),o=this.cohort.reduce((e,r)=>p.uniq(e.concat(r.pregnant||[])),[]),n=this.cohort.reduce((e,r)=>p.uniq(e.concat(r.breast_feeding||[])),[]),a=o.concat(n);this.rows.push([i.td("All"),i.td("FP"),...s.map(e=>this.drill(t[e.indicator].filter(r=>o.includes(r)),e.label("All FP")))]),this.rows.push([i.td("All"),i.td("FNP"),...s.map(e=>this.drill(t[e.indicator].filter(r=>!a.includes(r)),e.label("All FNP")))]),this.rows.push([i.td("All"),i.td("FBF"),...s.map(e=>this.drill(t[e.indicator].filter(r=>n.includes(r)),e.label("All FBF")))])},setRows(){const t=[],o=[];this.cohort.forEach(n=>{const a=[i.td(n.age_group),i.td(n.tpt_type),...s.map(e=>this.drill((n[e.indicator]||[]).map(r=>r.patient_id),e.label(n.tpt_type)))];n.tpt_type==="3HP"?o.push(a):t.push(a)}),this.rows=o.concat(t)}}});function x(t,o,n,a,e,r){const l=c("report-template"),d=c("ion-page");return _(),w(d,null,{default:b(()=>[g(l,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},reportPrefix:"Clinic",onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const q=f(P,[["render",x]]);export{q as default};
