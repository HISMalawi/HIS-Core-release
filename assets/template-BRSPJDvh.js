import{L as v}from"./Layout-B9Yen0nT.js";import{a as k,ap as g,t as D,aN as C,aA as h,eh as M,bo as S,aj as _,O as T,el as w,dC as $,cj as x,em as H,d as A,a6 as B,ab as E,u as o,v as P,w as F,G as y,B as n,E as G,C as L,H as d,Z as c,aH as z}from"./index-CyYd6aWW.js";import{D as j}from"./PatientDrilldown-0ZhBhD2g.js";const s=k({model:[],indicators:{},dateGenerated:"",startDate:"",endDate:"",title:"",period:""}),p=g(()=>s.model.map(e=>{if(typeof e.value=="function"){const l=e.value(s.indicators);Array.isArray(l)?(e._value="".concat(l.length),e._drill=l):e._value=l}return e})),b=g(()=>{const[e,...l]=p.value.map(r=>[r.index||"",r.label,r.index?r._value||0:""]);return{rows:l,columns:[["#",p.value[0].label,"#"]]}});function N(e){e.title!=s.title&&(s.indicators={}),s.title=e.title,s.model=e.indicators;const l=async(a="",t="")=>{(await h.create({message:"Please wait .."})).present();try{const i=new M(e.name);i.startDate=a||s.startDate,i.endDate=t||s.endDate,s.indicators=await i.requestReport({type:"moh"}),s.dateGenerated=S(_.getSessionDate()).format("DD/MMM/YYYY HH:mm:ss")}catch(i){T("Unable to generate report")}h.dismiss()},r=()=>w({title:s.title,onFinish:(a,t,i)=>{s.period=i,s.startDate=a,s.endDate=t,l()}}),u=a=>{Array.isArray(a._drill)&&j(a.label,a._drill)},m=()=>{const a=document.getElementById("report-content");a&&$('\n                <html>\n                <head>\n                    <link rel="stylesheet" media="print"  href="/assets/css/hts-report-style-print.css"/>\n                    <style> \n                        #moh_template { border: solid 1px #3333; width: 100%; } td { font-size: var(--his-sm-font-size); padding: 0.3em; } .main-title { background: #8EAADB; font-weight: bold; border: solid 3px black; } .table-value { padding: 1em; text-align: center; color: #337ab7; font-weight: bold; font-size: var(--his-md-font-size); border: solid 2px black; } .table-section { font-weight: bold; background: #D9E2F3; border: solid 3px black; }\n                    </style>\n                </head>\n                <body>\n                    '.concat(a.innerHTML,"\n                </body>\n                </html>\n            "),50)},f=()=>{const{rows:a,columns:t}=b.value;x(t,H(a,s),"MOH-".concat(s.title,"-").concat(_.getLocationName(),"-").concat(s.period))};return D(()=>C.isEmpty(s.indicators)&&r()),{drill:u,data:s,indicators:p,exportable:b,generate:l,exportPdf:m,exportCsv:f,configure:r}}const R=A({components:{Layout:v},props:{params:{type:Object,required:!0}},setup(e){return N(e.params)}}),V={id:"report-content"},Y={id:"moh_template"},O={key:0,class:"main-title"},q={key:1,class:"main-title"},I={key:2,class:"main-title"},U={key:3,class:"table-section"},W={key:4,colspan:2,class:"table-section"},Z={key:5},J=["onClick"];function K(e,l,r,u,m,f){const a=E("layout");return o(),P(a,{logo:"login-logos/Malawi-Coat_of_arms_of_arms.png",title:e.data.title,toCSV:e.exportCsv,toPDF:e.exportPdf,period:e.data.period,dateGenerated:e.data.dateGenerated,refreshReport:e.generate,configure:e.configure},{default:F(()=>[y("div",V,[y("table",Y,[(o(!0),n(G,null,L(e.indicators,(t,i)=>(o(),n("tr",{key:i},[t.isMainTitle?(o(),n("td",O,"#")):d("",!0),t.isMainTitle?(o(),n("td",q,c(t.label),1)):d("",!0),t.isMainTitle?(o(),n("td",I,"#")):d("",!0),t.isSectionTitle?(o(),n("td",U)):d("",!0),t.isSectionTitle?(o(),n("td",W,c(t.label),1)):d("",!0),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",Z,c(t.index),1)),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",{key:6,style:z(t.style||{}),class:"table-key"},c(t.label),5)),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",{key:7,class:"table-value",onClick:Q=>e.drill(t)},c(t._value),9,J))]))),128))])])]),_:1},8,["title","toCSV","toPDF","period","dateGenerated","refreshReport","configure"])}const se=B(R,[["render",K],["__scopeId","data-v-43c9e0b5"]]);export{se as M};
