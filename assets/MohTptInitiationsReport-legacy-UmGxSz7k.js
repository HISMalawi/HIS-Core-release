System.register(["./index-legacy-uRreDP0D.js","./regimen_report_service-legacy-r1HOUFq0.js","./ReportMixin.vue_vue_type_script_lang-legacy-s5aFW3cm.js","./TableReportTemplate-legacy-oS9JYFBv.js","./moh_cohort_service-legacy-Lw38ry5U.js","./MultiFieldDateHelper-legacy-URVOEyak.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./KbLayouts-legacy-NQmKRJpJ.js","./HisKbConfigurations-legacy-AV_G95Cg.js","./BasicReportTemplate-legacy-ZeTx3OfK.js","./Export-legacy-ZKnTuBGa.js","./SIngleTouchField-legacy-mPV_2Ngo.js","./Pagination-legacy-OaAedp7t.js","./HisStandardForm-legacy-U_iL4SQp.js","./TouchScreenForm-legacy-ogo2k9RR.js","./ToolbarMediumCard-legacy-ppaO_MMI.js","./Transformers-legacy-PbfCTy2a.js","./ViewPort-legacy-ItUHAnm-.js","./ReportErrors-legacy-xQdMuo8Y.js"],(function(t,e){"use strict";var o,i,r,s,n,a,l,h,d,c,p,u,w,g,m;return{setters:[t=>{o=t.d,i=t.I,r=t.L,s=t.cx,n=t.ab,a=t._,l=t.r,h=t.o,d=t.c,c=t.w,p=t.b},t=>{u=t.a},t=>{w=t._},t=>{g=t.R},t=>{m=t.M},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=o({mixins:[w],components:{ReportTemplate:g,IonPage:i},data:()=>({title:"TPT new initiations report",rows:[],cohort:{},canValidate:!1,mohCohort:{},headerList:[],errors:[],showStatus:!1,columns:[[r.thTxt("District"),r.thTxt("Age group"),r.thTxt("Gender"),r.thNum("3HP (Started New on ART)"),r.thNum("6H (Started New on ART)"),r.thNum("3HP (Started Previously on ART)"),r.thNum("6H (Started Previously on ART)")]],totalIpt:[],total3hp:[]}),watch:{async canValidate(t){t&&await this.validateReport()}},created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.canValidate=!1,this.rows=[],this.errors=[],this.showStatus=!1,this.totalIpt=[],this.total3hp=[],this.report=new u,this.mohCohort=new m,this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.mohCohort.setOccupation(e.occupation),this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTptNewInitiations(),this.setRows("F"),this.setRows("M"),this.canValidate=!0,this.showStatus=!0},drilldown(t,e){const o=[[r.thTxt("ARV #"),r.thTxt("DOB"),r.thTxt("Dispensed date")]],i=()=>this.sortByArvNumber(t).map((t=>[r.td(t.arv_number),r.tdDate(t.birthdate),r.tdDate(t.dispensation_date)]));return t.length<=0?r.td(0):r.tdLink(t.length,(()=>this.drilldownAsyncRows(e,o,i)))},setRows(t){const e=this.formatGender(t);for(const o in s){const i=s[o],a=this.cohort.Location;if(!n.isEmpty(this.cohort)&&i in this.cohort&&o){const o=this.cohort[i];this.total3hp=n.uniq([...this.total3hp,...o["3HP_new"][t],...o["3HP_prev"][t]]),this.totalIpt=n.uniq([...this.totalIpt,...o["6H_new"][t],...o["6H_prev"][t]]),this.rows.push([r.td(a),r.td(i),r.td(e),this.drilldown(o["3HP_new"][t],`${i} ${e}s New on 3HP`),this.drilldown(o["6H_new"][t],`${i} ${e}s New on 6H`),this.drilldown(o["3HP_prev"][t],`${i} ${e}s Previously on 3HP`),this.drilldown(o["6H_prev"][t],`${i} ${e}s Previously on 6H`)])}else this.rows.push([r.td(i),r.td(e),r.td(0),r.td(0)])}},validateReport(){const t={newly_initiated_on_3hp:{param:this.total3hp.length,check:(t,e)=>t!=e,error:(t,e)=>`\n                        Total newly initiated on <b>3HP(${e})</b> is not matching newly \n                        initiated on 3HP in Cohort report <b>(${t})</b>.\n                    `},newly_initiated_on_ipt:{param:this.totalIpt.length,check:(t,e)=>t!=e,error:(t,e)=>`\n                        Total newly initiated on IPT <b>(${e})</b> is not matching \n                        newly initiated on IPT in Cohort report <b>(${t})</b>.\n                    `}};-1===this.mohCohort.validateIndicators(t,(t=>this.errors=t))&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}});t("default",a(e,[["render",function(t,e,o,i,r,s){const n=l("report-template"),a=l("ion-page");return h(),d(a,null,{default:c((()=>[p(n,{reportPrefix:"MoH",title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])])),_:1})}]]))}}}));
