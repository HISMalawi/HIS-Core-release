System.register(["./index-legacy-pSEoxn3J.js","./HisStandardForm-legacy-CGi-zolz.js","./useEncounter-legacy-D27v7I9F.js","./identifier_service-legacy-Diw83IXv.js","./isEmpty-legacy-De9HmsH6.js","./encounter_guidelines-legacy-mYSO8ZN5.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,a){"use strict";var t,i,n,l,s,r,u,o,d,c,y,g,f,I,p,T,v,N,D;return{setters:[e=>{t=e.d,i=e.r,n=e.ao,l=e.bI,s=e.an,r=e.u,u=e.a,o=e.w,d=e.e,c=e.f,y=e.m,g=e.b,f=e.e8,I=e.a_,p=e.q,T=e.aD},e=>{v=e.H},e=>{N=e.u},e=>{D=e.I},null,null,null],execute:function(){e("default",t({__name:"NationalID",setup(e){const a=i([]),t=i(),w=r(),_=()=>!/unknown/i.test(t.value.getMWNationalID()),{goToNextTask:m,patientDashboardUrl:E}=N(((e,i,r)=>{t.value=r,a.value=[{id:"currentNationalID",helpText:"Current national identifier:",type:n.TT_TEXT_BANNER,condition:()=>!w.query.reassign&&_(),options:()=>{const e=`<b>${r.getMWNationalID()}</b>`;return[{label:e,value:e}]}},{id:"patientIdentifier",helpText:"Malawi National ID",type:n.TT_TEXT,defaultValue:()=>_()?r.getMWNationalID():"",validation:e=>s.validateSeries([()=>s.required(e),()=>s.isMWNationalID(e)]),config:{customKeyboard:l}}]}));async function M(e){const a=`${e.patientIdentifier.value}`,i=new D;if(i.identifierType=f.MW,!I.isEmpty(await i.getPatientsByIdentifier(a)))return p("ID was already assigned",15e3);if(w.query.reassign){const a=parseInt(`${w.query.reassign}`);await t.value.changeMwNationalId(a,e.patientIdentifier.value)}else await t.value.updateMWNationalId(e.patientIdentifier.value);T.invalidate("ACTIVE_PATIENT"),m()}return(e,t)=>(g(),u(c(y),null,{default:o((()=>[d(v,{cancelDestinationPath:c(E),onFinishAction:M,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
