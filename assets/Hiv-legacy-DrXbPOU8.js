System.register(["./index-legacy-BsbMrqEO.js","./HisStandardForm-legacy-BbU4Bs9R.js","./useEncounter-legacy-D64YFiIH.js","./util-legacy-CjANJSja.js","./commons-legacy-Chic3QOO.js","./isEmpty-legacy-B5ngE3CS.js","./encounter_guidelines-legacy-o_0qujSe.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,i,l,u,d,o,n,T,s,r,_,c,v,S,E,p;return{setters:[e=>{a=e.d,i=e.r,l=e.bI,u=e.dP,d=e.ab,o=e.ac,n=e.u,T=e.v,s=e.w,r=e.x,_=e.y,c=e.a5},e=>{v=e.H},e=>{S=e.u},e=>{E=e.g},e=>{p=e.r},null,null,null],execute:function(){e("default",a({__name:"Hiv",setup(e){const t=i([]),a=new l(-1,u.UPDATE_HIV_STATUS),{goToNextTask:A,patientDashboardUrl:N}=S(((e,i,l)=>{a.patientID=i,a.providerID=e,t.value=[{id:"hivStatus",helpText:"HIV Status",type:d.TT_SELECT,requireNext:!1,validation:e=>o.required(e),computedValue:e=>"NOT_DONE"===e.value?{concept_id:E("HIV_TEST_DONE_TODAY"),value_coded:E("NO_ANSWER"),obs_datetime:a.date}:{concept_id:E("HIV_STATUS"),value_coded:E(`${e.value}`),obs_datetime:a.date},options:()=>[{value:"POSITIVE",label:"Positive"},{value:"NEGATIVE",label:"Negative"},{value:"NOT_DONE",label:"Not Tested"}]},{id:"timeOfHIVTest",helpText:"Time of HIV test",type:d.TT_SELECT,requireNext:!1,validation:e=>o.required(e),computedValue:e=>({concept_id:E("TIME_OF_HIV_TEST"),value_coded:E(`${e.value}`),obs_datetime:a.date}),condition:e=>"POSITIVE"===e.hivStatus.value||"NEGATIVE"===e.hivStatus.value,options:()=>[{value:"HIV_BEFORE_TB",label:"Before TB Registration"},{value:"HIV_AFTER_TB",label:"After TB Registration"}]},{id:"artStatus",helpText:"ART Started",type:d.TT_SELECT,requireNext:!1,validation:e=>o.required(e),condition:e=>"POSITIVE"===e.hivStatus.value,computedValue:e=>({concept_id:E("ON_ART"),value_coded:E(`${e.value}`),obs_datetime:a.date}),options:()=>[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}]},{id:"arvStatus",helpText:"ARV Status",type:d.TT_SELECT,requireNext:!1,validation:e=>o.required(e),condition:e=>"YES_ANSWER"===e.artStatus.value,computedValue:e=>({concept_id:E("ARV_STATUS"),value_coded:E(`${e.value}`),obs_datetime:a.date}),options:()=>[{value:"ARV_BEFORE_TB",label:"Started ARV before TB Treatment"},{value:"ARV_WHILE_TB",label:"Started ARV while on TB Treatment"},{value:"ARV_AFTER_DISCHARGE",label:"ARV not started by the time when discharged from TB treatment"}]},{id:"cptStatus",helpText:"Started CPT",type:d.TT_SELECT,requireNext:!1,validation:e=>o.required(e),condition:e=>"YES_ANSWER"===e.artStatus.value,computedValue:e=>({concept_id:E("ON_CPT"),value_coded:E(`${e.value}`),obs_datetime:a.date}),options:()=>[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}]},{id:"cptStartDate",helpText:"CPT Start Date",type:d.TT_FULL_DATE,validation:e=>o.validateSeries([()=>o.required(e),()=>o.dateRangeOf(e,`${l.getBirthdate()}`,a.date)]),computedValue:e=>({concept_id:E("CPT_START_DATE"),[/unknown/i.test(`${e.value}`)?"value_text":"value_datetime"]:e.value,obs_datetime:a.date}),condition:e=>"YES_ANSWER"===e.cptStatus.value,config:{allowUnknown:!0}}]}));async function m(e,t){await a.createEncounter(),await a.saveObservationList(await p(t)),A()}return(e,a)=>(n(),T(_(c),null,{default:s((()=>[r(v,{cancelDestinationPath:_(N),onFinishAction:m,fields:t.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
