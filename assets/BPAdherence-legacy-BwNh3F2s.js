System.register(["./ViewPort-legacy-CDi_rmkw.js","./index-legacy-C29Eb2Qm.js","./EncounterMixin.vue_vue_type_script_lang-legacy-rPdlUSmp.js","./htn_service-legacy-Cc4RDA95.js","./HisKeypad-legacy-CPvjpCHl.js","./encounter_guidelines-legacy-BDiBaLGJ.js","./GuidelineEngine-legacy-KsvQuFdF.js","./HisStandardForm-legacy-BpfFI5_j.js","./TouchScreenForm-legacy-BmEuIwWy.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./ToolbarMediumCard-legacy-CF38wqjC.js","./Transformers-legacy-DhNYVLaS.js","./BaseKeyboard-legacy-BwPGWdsO.js","./KbLayouts-legacy-BKvPSxzZ.js","./KbHandler-legacy-De8o5nTq.js"],(function(t,e){"use strict";var n,a,d,r,s,l,i,o,u,c,g,p,h,b,m,y,f,x,v,w,k,_,C,D,P,I,j,T,N,H,z,B,A,E;return{setters:[t=>{n=t.V},t=>{a=t.d,d=t.i,r=t.j,s=t.l,l=t.aj,i=t.bb,o=t.f,u=t.ak,c=t.m,g=t.I,p=t.e,h=t.ab,b=t.aa,m=t.O,y=t._,f=t.r,x=t.o,v=t.c,w=t.w,k=t.b,_=t.x,C=t.A,D=t.F,P=t.y,I=t.u,j=t.v,T=t.z,N=t.a3,H=t.a4},t=>{z=t._},t=>{B=t.B,A=t.H},t=>{E=t.H},null,null,null,null,null,null,null,null,null,null],execute:function(){var e=document.createElement("style");e.textContent="ion-checkbox[data-v-1bd40036]{--size: 30px}ion-input[data-v-1bd40036]{border-radius:9px;background-color:#f7f8c6;border:solid 2px rgb(117,117,117)}.col-borders[data-v-1bd40036]{border:1px dotted lightgray;border-radius:3px;padding:.3em}.holder[data-v-1bd40036]{width:99%;padding:1.5%}.dispensation-row[data-v-1bd40036]{text-align:center;font-size:1.6em}#main-table[data-v-1bd40036],#table-notes[data-v-1bd40036]{width:95%;margin:auto}#main-table th[data-v-1bd40036],#table-notes th[data-v-1bd40036]{font-size:20px;background-color:#b22222;color:#fff}#main-table th[data-v-1bd40036],#main-table td[data-v-1bd40036]{text-align:center;padding:10px}.td-title[data-v-1bd40036]{font-size:22px;text-shadow:2px 2px white}.td-title[data-v-1bd40036],.td-current[data-v-1bd40036],.td-remaining[data-v-1bd40036]{padding:2px!important}.td-current[data-v-1bd40036]{background-color:#eed5d2;text-shadow:2px 2px white;height:40px!important}.td-remaining[data-v-1bd40036]{background-color:#ffe5e5;text-shadow:2px 2px white}.td-value[data-v-1bd40036]{font-size:22px}#table-notes td[data-v-1bd40036]{background:rgba(210,220,240,.5);border-radius:5px}#table-notes th[data-v-1bd40036]{background:#d3d3d3;color:rgba(0,0,0,.8)}#table-notes td[data-v-1bd40036]{padding-left:1px}.date-td[data-v-1bd40036]{padding-left:4px!important;text-shadow:0 1px 1px rgba(0,0,0,.2);font-size:1em;background:rgba(235,235,240,.5)!important;color:rgba(0,0,0,.9);text-align:center}.note-td[data-v-1bd40036]{padding-left:20px!important;color:rgba(0,0,0,.8);text-shadow:2px 2px 3px rgba(255,255,255,.1)}.today-tr[data-v-1bd40036]{font-style:italic;font-weight:700;border-radius:10px!important}\n",document.head.appendChild(e);const F=a({mixins:[z],components:{ViewPort:n,IonToolbar:d,IonHeader:r,IonContent:s,IonRow:l,IonInput:i,IonButton:o,IonCol:u,IonFooter:c,IonPage:g,IonCheckbox:p},watch:{ready:{async handler(t){t&&(this.HTN=new B(this.patientID,this.providerID),this.drugs=this.HTN.getDrugs(),await this.getCurrentDrugs())},immediate:!0}},data:()=>({HTN:{},drugs:null}),methods:{onFinish(){this.selectNextAction()},goToPrescription(){this.$router.push(`/art/encounters/bp_prescription/${this.patientID}`)},gotoTreatment(){const t=this.selectedDrugs.map((t=>h.find(B.htnDrugReferences(),{drug_id:t.drugID}))),e={};e[this.patientID]=t,sessionStorage.setItem(A.Prescription,JSON.stringify(e)),this.$router.push(`/art/encounters/prescriptions/${this.patientID}`)},async selectNextAction(){const t=await b("Action confirmation","Please specify how to proceed with patient",["Continue with current BP Drugs","Continue without BP Drugs","Change BP drugs"],[{name:"Cancel",color:"danger",slot:"start"},{name:"Confirm",color:"primary",slot:"end",role:"action"}]);if(t.selection&&"Cancel"!=t.action)switch(t.selection){case"Continue without BP Drugs":return sessionStorage.removeItem(A.Prescription),this.nextTask();case"Continue with current BP Drugs":return this.gotoTreatment();case"Change BP drugs":this.goToPrescription()}},async getCurrentDrugs(){const t=await this.HTN.getCurrentDrugs(),e=await this.HTN.getLastDrugs();t.drugs.forEach((t=>{for(const n in this.drugs)this.drugs[n].drugs.forEach(((a,d)=>{t.drug_id===a.drugID&&(this.drugs[n].drugs[d].current=!0,this.drugs[n].drugs[d].selected=!0,this.drugs[n].selected=t.drug_id);const r=this.drugs[n].drugs[d].drugName;Object.prototype.hasOwnProperty.call(e,r)&&(this.drugs[n].drugs[d].expectedRemaining=e[r].remaining,this.drugs[n].drugs[d].dispensed=e[r].value_numeric)}))}))},async launchKeyPad(t,e){(await m.create({component:E,backdropDismiss:!1,cssClass:"keypad-modal",componentProps:{strictNumbers:!0,onKeyPress:async n=>{const a=await this.HTN.getAdherence(this.drugs[t].drugs[e].drugID,n);this.drugs[t].drugs[e].adherence=a.adherence,this.drugs[t].drugs[e].remaining=n}}})).present()}},computed:{selectedDrugs(){return Object.values(this.drugs).map((t=>t.drugs)).reduce(((t,e)=>t.concat(e)),[]).filter((t=>t.dispensed))}}}),K=t=>(N("data-v-1bd40036"),t=t(),H(),t),S=K((()=>C("label",{class:"his-title"}," BP Drug management ",-1))),V={key:0,class:"view-port-content"},O={id:"main-table",style:{width:"100%"}},R=K((()=>C("th",null,"Â ",-1))),$=K((()=>C("td",{class:"td-current td-title"},[C("span",null,"Current")],-1))),G=K((()=>C("td",{class:"td-remaining td-title"},[C("span",null,"Pills remaining")],-1))),L=K((()=>C("p",null,null,-1))),M={id:"table-notes",style:{width:"100%"}},U=K((()=>C("caption",{style:{"font-size":"1.4em"}}," Adherence summary ",-1))),J=K((()=>C("p",null,null,-1))),Q=K((()=>C("tr",null,[C("th",{style:{width:"25%"}},[C("span",null,"Drug")]),C("th",{style:{width:"25%"}},[C("span",null,"Pills dispensed during last visit")]),C("th",{style:{width:"25%"}},[C("span",null,"Expected pills remaining")]),C("th",{style:{width:"25%"}},[C("span",null,"Adherence for drug")])],-1))),q={class:"date-td today-td"},W={class:"date-td today-td"},X={class:"date-td today-td"},Y={class:"date-td today-td"};t("default",y(F,[["render",function(t,e,n,a,d,r){const s=f("ion-col"),l=f("ion-row"),i=f("ion-toolbar"),o=f("ion-header"),u=f("ion-checkbox"),c=f("ion-input"),g=f("view-port"),p=f("ion-content"),h=f("ion-button"),b=f("ion-footer"),m=f("ion-page");return x(),v(m,null,{default:w((()=>[k(o,null,{default:w((()=>[k(i,null,{default:w((()=>[k(l,null,{default:w((()=>[k(s,null,{default:w((()=>[S])),_:1})])),_:1})])),_:1})])),_:1}),k(p,null,{default:w((()=>[k(g,null,{default:w((()=>[t.drugs?(x(),_("div",V,[C("table",O,[C("tr",null,[R,(x(!0),_(D,null,P(t.drugs,((t,e)=>(x(),_("th",{key:e},[I(j(e)+" ",1),k(l,null,{default:w((()=>[(x(!0),_(D,null,P(t.drugs,((t,e)=>(x(),v(s,{class:"col-borders",key:e},{default:w((()=>[I(j(t.amount||"0mg"),1)])),_:2},1024)))),128))])),_:2},1024)])))),128))]),C("tr",null,[$,(x(!0),_(D,null,P(t.drugs,((t,e)=>(x(),_("td",{class:"td-current td-value",key:e},[k(l,null,{default:w((()=>[(x(!0),_(D,null,P(t.drugs,((t,e)=>(x(),v(s,{key:e},{default:w((()=>[t.current?(x(),v(u,{key:0,checked:t.current,disabled:""},null,8,["checked"])):T("",!0)])),_:2},1024)))),128))])),_:2},1024)])))),128))]),C("tr",null,[G,(x(!0),_(D,null,P(t.drugs,((e,n)=>(x(),_("td",{key:n,class:"td-current td-value"},[k(l,null,{default:w((()=>[(x(!0),_(D,null,P(e.drugs,((e,a)=>(x(),v(s,{key:a},{default:w((()=>[e.dispensed?(x(),v(c,{key:0,type:"number",modelValue:e.remaining,"onUpdate:modelValue":t=>e.remaining=t,onClick:e=>t.launchKeyPad(n,a)},null,8,["modelValue","onUpdate:modelValue","onClick"])):T("",!0)])),_:2},1024)))),128))])),_:2},1024)])))),128))])]),L,C("table",M,[U,J,Q,(x(!0),_(D,null,P(t.selectedDrugs,((t,e)=>(x(),_("tr",{key:e,class:"dispensation-row"},[C("td",q,j(t.drugName),1),C("td",W,j(t.dispensed),1),C("td",X,j(t.expectedRemaining),1),C("td",Y,j(t.adherence?`${t.adherence} %`:"?"),1)])))),128))])])):T("",!0)])),_:1})])),_:1}),k(b,null,{default:w((()=>[k(i,{color:"dark"},{default:w((()=>[k(h,{size:"large",color:"danger",slot:"start",onClick:t.gotoPatientDashboard},{default:w((()=>[I(" cancel ")])),_:1},8,["onClick"]),k(h,{size:"large",color:"primary",slot:"end",onClick:t.goToPrescription},{default:w((()=>[I(" Change drugs ")])),_:1},8,["onClick"]),k(h,{size:"large",color:"success",slot:"end",onClick:t.onFinish},{default:w((()=>[I(" Continue ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-1bd40036"]]))}}}));
