import{d as k,br as b,g as y,h as C,D as x,e as v,cB as w,ap as O,_ as $,r as i,o as l,c as r,w as o,b as a,x as F,B as V,y as g,A as B,v as E}from"./index-C6EjxQ0a.js";import{_ as I}from"./FieldMixin.vue_vue_type_script_lang-x6nXcbrX.js";import D from"./BaseTextInput-CEGkB-gc.js";import{H as L}from"./HisKeyboard-B8oB68Wv.js";import{F as S}from"./fuse-YdZE3OCN.js";const H=k({components:{ViewPort:b,IonList:y,IonItem:C,IonLabel:x,HisKeyboard:L,HisTextInput:D,IonCheckbox:v},mixins:[I],data:()=>({filter:"",keyboard:w,listOptions:[]}),mounted(){this.init()},activated(){this.init()},watch:{clear(){this.filter="",this.listOptions.forEach(e=>e.isChecked=!1),this.updateValue()}},computed:{displayList(){return this.filter?new S(this.listOptions,{threshold:.4,keys:["label"],useExtendedSearch:!0}).search(this.filter).map(t=>t.item):this.listOptions}},methods:{init(){this.$emit("onFieldActivated",this),this.options(this.fdata).then(e=>this.indexData(e))},updateValue(){this.$nextTick(()=>{this.$emit("onValue",this.listOptions.filter(e=>e.isChecked))})},indexData(e){const t=this.listOptions.map(n=>n.label);e.forEach(n=>{t.includes(n.label)||this.listOptions.push(n)})},onFilter(e){this.filter=e,this.options(this.fdata,this.filter).then(this.indexData)},onSelect(e){this.listOptions.forEach(t=>{t.label===e.label&&(t.isChecked=!t.isChecked)}),this.updateValue()},keypress(e){this.onFilter(O(e,this.filter))}}}),A={class:"his-md-text"};function K(e,t,n,P,T,N){const c=i("his-text-input"),h=i("ion-checkbox"),d=i("ion-label"),u=i("ion-item"),f=i("ion-list"),p=i("his-keyboard"),m=i("view-port");return l(),r(m,{showFull:!1},{default:o(()=>[a(c,{value:e.filter,onOnValue:t[0]||(t[0]=s=>e.onFilter(s))},null,8,["value"]),a(f,{class:"view-port-content"},{default:o(()=>[(l(!0),F(V,null,g(e.displayList,(s,_)=>(l(),r(u,{key:_,onClick:M=>e.onSelect(s),color:s.isChecked?"lightblue":"",lines:s.isChecked?"none":void 0},{default:o(()=>[a(h,{slot:"start",checked:s.isChecked,disabled:s==null?void 0:s.disabled},null,8,["checked","disabled"]),a(d,null,{default:o(()=>[B("span",A,E(s.label),1)]),_:2},1024)]),_:2},1032,["onClick","color","lines"]))),128))]),_:1}),a(p,{kbConfig:e.keyboard,onKeyPress:e.keypress},null,8,["kbConfig","onKeyPress"])]),_:1})}const q=$(H,[["render",K]]);export{q as default};
