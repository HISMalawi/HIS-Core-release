import{d as k,v as P,n as S,o as E,aE as I,r as n,z as u,s as V,y as w,am as D,al as f,aZ as x,H as M,S as X,B as Y,ct as i,ak as O,ap as h,a as N,b as F,w as H,e as R}from"./index-Ds0zDBhU.js";import{v as B}from"./TableView-CgIGpCdy.js";import{C as Q}from"./cxca_report_service-BO1TmHaZ.js";import{D as j}from"./DrillPatientIds-CRQKICUW.js";import"./Export-DFDKXGhs.js";import"./index-DZD2XSQD.js";import"./TableView-N12LtehS.js";const p=n([]),o=n(""),s=n(""),b=n(""),y=n(!1),A=n(""),q=k({components:{IonPage:S,IonLoading:P,v2Datatable:B},setup(){const t=(a,e)=>{const l=[d(a.first_time_screened),d(a.rescreened_after_prev_visit),d(a.post_treatment_followup)];return l.push(_(e)),l},d=a=>a.map(e=>{const{age_group:l,...c}=e;return{...c,age_group:l}}),_=a=>{const e=[];for(const l in a){const c={};c[l]=a[l],e.push(c)}return e},r=async(a,e)=>{e.length<=0||(await u.create({component:j,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:a,subtitle:b,patientIdentifiers:e,onFinish:()=>u.getTop().then(l=>l&&u.dismiss())}})).present()},m=["age_group","cryotherapy","thermocoagulation","leep","via_deffered","via_reffered","suspected_reffered"],C=["Age Disaggregate","Cryotherapy","Thermocoagulation","Leep","VIA + Defferred Tx","VIA + Referred","CxCa Suspect Referred"],g=[["","","","1st time screened","","",""],["","","","Rescreened after previous negative","","",""],["","","","Post-treatment follow-up","","",""],["","","","Month Summary","","",""]],v=[[{label:"Facility:",ref:""},{label:"Month/Year:",ref:"",span:{thColspan:3}},{label:"Report Officer:",ref:"",span:{thColspan:4}}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Cryotherapy",ref:"data.cryotherapy.length",secondaryLabel:"1st screened (cryotherapy)",value:a=>{var e;return(e=a.cryotherapy)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.cryotherapy)},{label:"Thermocoagulation",ref:"data.thermocoagulation.length",secondaryLabel:"1st screened (thermocoagulation)",value:a=>{var e;return(e=a.thermocoagulation)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.thermocoagulation)},{label:"LEEP",ref:"data.leep.length",secondaryLabel:"1st screened (LEEP)",value:a=>{var e;return(e=a.leep)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.leep)},{label:"VIA+Deferred Tx",ref:"data.via_deffered.length",secondaryLabel:"1st screened (VIA Deferred)",value:a=>{var e;return(e=a.via_deffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_deffered)},{label:"VIA+ Referred",ref:"data.via_reffered.length",secondaryLabel:"1st screened (VIA Referred)",value:a=>{var e;return(e=a.via_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_reffered)},{label:"CXCA Suspect Referred",ref:"data.suspected_reffered.length",secondaryLabel:"1st screened (CxCa Suspect Referred)",value:a=>{var e;return(e=a.suspected_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected_reffered)}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Cryotherapy",ref:"data.cryotherapy.length",secondaryLabel:"Rescreened after previous negative (cryotherapy)",value:a=>{var e;return(e=a.cryotherapy)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.cryotherapy)},{label:"Thermocoagulation",ref:"data.thermocoagulation.length",secondaryLabel:"Rescreened after previous negative (thermocoagulation)",value:a=>{var e;return(e=a.thermocoagulation)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.thermocoagulation)},{label:"LEEP",ref:"data.leep.length",secondaryLabel:"Rescreened after previous negative (LEEP)",value:a=>{var e;return(e=a.leep)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.leep)},{label:"VIA+Deferred Tx",ref:"data.via_deffered.length",secondaryLabel:"Rescreened after previous negative (VIA Deferred)",value:a=>{var e;return(e=a.via_deffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_deffered)},{label:"VIA+ Referred",ref:"first_time_screened_via_reffered",secondaryLabel:"Rescreened after previous negative (VIA Referred)",value:a=>{var e;return(e=a.via_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_reffered)},{label:"CXCA Suspect Referred",ref:"data.suspected_reffered.length",secondaryLabel:"Rescreened after previous negative (CxCa Suspect Referred)",value:a=>{var e;return(e=a.suspected_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected_reffered)}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Cryotherapy",ref:"data.cryotherapy.length",secondaryLabel:"Post-treatment follow-up (cryotherapy)",value:a=>{var e;return(e=a.cryotherapy)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.cryotherapy)},{label:"Thermocoagulation",ref:"data.thermocoagulation.length",secondaryLabel:"Post-treatment follow-up (thermocoagulation)",value:a=>{var e;return(e=a.thermocoagulation)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.thermocoagulation)},{label:"LEEP",ref:"data.leep.length",secondaryLabel:"Post-treatment follow-up (LEEP)",value:a=>{var e;return(e=a.leep)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.leep)},{label:"VIA+Deferred Tx",ref:"data.via_deffered.length",secondaryLabel:"Post-treatment follow-up (VIA Deferred)",value:a=>{var e;return(e=a.via_deffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_deffered)},{label:"VIA+ Referred",ref:"data.via_reffered.length",secondaryLabel:"Post-treatment follow-up (VIA Referred)",value:a=>{var e;return(e=a.via_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.via_reffered)},{label:"CXCA Suspect Referred",ref:"data.suspected_reffered.length",secondaryLabel:"Post-treatment follow-up (CxCa Suspect Referred)",value:a=>{var e;return(e=a.suspected_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected_reffered)}],[{label:"1st time Screened",ref:"",exportable:!1,span:{thColspan:7}}],[{label:"Rescreened after previous negative",ref:"",exportable:!1,span:{thColspan:7}}],[{label:"Post-treatment follow-up",ref:"",span:{thColspan:7}}],[{label:"Month Summary",ref:"",span:{thColspan:7}}],[{label:"Total Cryotherapy",ref:"data.total_cyrotherapy.length",secondaryLabel:"Total Cryotherapy",value:a=>{var e;return(e=a.total_cyrotherapy)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_cyrotherapy)}],[{label:"Total Thermocoagulation",ref:"data.total_thermocoagulation.length",secondaryLabel:"Total Thermocoagulation",value:a=>{var e;return(e=a.total_thermocoagulation)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_thermocoagulation)}],[{label:"Total LEEP",ref:"data.total_leep.length",secondaryLabel:"Total LEEP",value:a=>{var e;return(e=a.total_leep)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_leep)}],[{label:"Total # Same Day Tx",ref:"data.total_number_same_day_tx.length",secondaryLabel:"Total # Same Day Tx",value:a=>{var e;return(e=a.total_number_same_day_tx)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_number_same_day_tx)}],[{label:"Total VIA+ Deferred Tx",ref:"data.total_via_deffered.length",secondaryLabel:"Total VIA+ Deferred Tx",value:a=>{var e;return(e=a.total_via_deffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_via_deffered)}],[{label:"Total VIA+ Referred",ref:"data.total_via_reffered.length",secondaryLabel:"Total VIA+ Referred",value:a=>{var e;return(e=a.total_via_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_via_reffered)}],[{label:"Total CXCA Suspect Referred",ref:"data.suspects_reffered.length",secondaryLabel:"Total CXCA Suspect Referred",value:a=>{var e;return(e=a.suspects_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.suspects_reffered)}],[{label:"Total Referred",ref:"data.total_reffered.length",secondaryLabel:"Total Referred",value:a=>{var e;return(e=a.total_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>r("".concat(a.secondaryLabel),e.total_reffered)}]],$=async()=>{if(!(o.value&&s.value))return V("Start date and end date required!");y.value=!0,p.value=[];const a=new Q;a.startDate=o.value,a.endDate=s.value;try{const e=await a.getClinicReport("MONTHLY CECAP TX");p.value=t(e.data,e.totals)}catch(e){w("Unable to generate report!"),console.error(e)}y.value=!1},T=()=>I([{id:"year",helpText:"Select Year",type:D.TT_NUMBER,computedValue:a=>a.value,validation:a=>{const e=x.isPlainObject(a)?a.value:-1;return f.validateSeries([()=>f.required(a),()=>isNaN(parseInt("".concat(e)))?["Invalid year"]:null,()=>f.rangeOf(a,2e3,M.getYear(X.getSessionDate()))])}},{id:"month",helpText:"Select Month",type:D.TT_SELECT,validation:a=>f.required(a),computedValue:a=>a.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}],a=>{o.value="".concat(a.year.value,"-").concat(a.month.value,"-01"),s.value=Y(new Date(o.value).toISOString()).endOf("month").format("YYYY-MM-DD"),b.value="Period (".concat(i(o.value)," to ").concat(i(s.value),")"),u.dismiss(),A.value="".concat(i(o.value)," to ").concat(i(s.value)),$()});return E(()=>!p.value.length&&T()),{columns:v,isLoading:y,reportData:p,period:b,csvQuarter:A,generate:$,configure:T,order:m,csvheaders:C,spacing:5,subHeaders:g}}});function J(t,d,_,r,m,C){const g=h("ion-loading"),L=h("v2Datatable"),v=h("ion-page");return F(),N(v,null,{default:H(()=>[R(g,{"is-open":t.isLoading,message:"Please wait..."},null,8,["is-open"]),R(L,{title:"CECAP TX Report",subtitle:t.period,columns:t.columns,columnData:t.reportData,rowsPerPage:25,onConfigure:t.configure,csvQuarter:t.csvQuarter,onRefresh:()=>t.generate(),order:t.order,headers:t.csvheaders,"csv-spacing":t.spacing,"csv-sub-header":t.subHeaders},null,8,["subtitle","columns","columnData","onConfigure","csvQuarter","onRefresh","order","headers","csv-spacing","csv-sub-header"])]),_:1})}const ae=O(q,[["render",J]]);export{ae as default};
