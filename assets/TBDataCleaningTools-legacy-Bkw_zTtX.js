System.register(["./index-legacy-Dg5P6bX-.js","./ReportMixin.vue_vue_type_script_lang-legacy-kOBZLM0d.js","./TableReportTemplate-legacy-CKj3FIGR.js","./MultiFieldDateHelper-legacy-DBQBHUfA.js","./BasicReportTemplate-legacy-Q043r8R3.js","./Export-legacy-3ZHnhIid.js","./SIngleTouchField-legacy-SRHCPnWv.js","./dynamic-import-helper-legacy-arUa2LZV.js","./Pagination-legacy-DMKxolpC.js","./HisStandardForm-legacy-BXV61qjj.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./ReportErrors-legacy-BDEmzxBv.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js"],(function(t,e){"use strict";var a,o,s,r,l,n,i,u,d,m,c,h,T,p,_;return{setters:[t=>{a=t.S,o=t.d,s=t.I,r=t.L,l=t.ab,n=t.H,i=t._,u=t.r,d=t.o,m=t.c,c=t.w,h=t.b},t=>{T=t._},t=>{p=t.R},t=>{_=t.g},null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){class e extends a{programID;startDate;endDate;date;constructor(){super(),this.startDate="",this.endDate="",this.date=a.getSessionDate(),this.programID=a.getProgramID()}setStartDate(t){this.startDate=t}setEndDate(t){this.endDate=t}buildRequestParams(t){const e={};return this.startDate&&(e.start_date=this.startDate),this.endDate&&(e.end_date=this.endDate),this.date&&(e.date=this.date),this.programID&&(e.program_id=this.programID),{...e,...t}}}var g=(t=>(t.WITHOUT_PROGRAM="WITHOUT PROGRAM",t.WITHOUT_TB_NUMBER="WITHOUT TB NUMBER",t.BAD_TB_NUMBER="BAD TB NUMBER",t.IN_TREATMENT_BUT_COMPLETED="IN TREATMENT BUT COMPLETED",t.WITH_DISPENSATION_ANOMALIES="WITH DISPENSATION ANOMALIES",t.WITH_UNKNOWN_OUTCOME="WITH UNKNOWN OUTCOME",t.WITH_DUPLICATE_TB_NUMBER="WITH DUPLICATE TB NUMBER",t))(g||{});class R extends e{constructor(){super()}getDataToolReport(t){return e.getJson("tb_data_cleaning_tools",this.buildRequestParams({context:t}))}}const D=o({mixins:[T],components:{ReportTemplate:p,IonPage:s},data:()=>({title:"Data cleaning report",rows:[],columns:[[r.thTxt("National ID"),r.thTxt("TB Number"),r.thTxt("Name"),r.thTxt("Gender"),r.thTxt("Birthdate"),r.thTxt("Residence"),r.thTxt("State")]],defaultIndicator:{}}),created(){this.fields=[..._({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>a.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}}),..._({id:"end_date",helpText:"End",required:!0,minDate:()=>"2000-01-01",maxDate:()=>a.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}})],this.defaultIndicator=l.find(this.getIndicatorOptions(),{label:this.$route.query.case})||null},methods:{async onPeriod(t,e){const a=t=>n.toStandardHisDisplayFormat(t);this.rows=[];const o=this.defaultIndicator;this.title=o.label,this.columns=o.other.columns,this.report=new R,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=`${a(e.start_date)} - ${a(e.end_date)}`;const s=await this.report.getDataToolReport(o.value);console.log(o,s),l.isNull(s)||(this.rows=await Promise.all(s.map((t=>o.other.formatRow(t)))))},mapRow(t){return[r.td(t.identifier||"N/A"),r.td(t.tb_number||"N/A"),r.tdLink(t.name,(()=>this.$router.push({path:`/patient/dashboard/${t.patient_id}`}))),r.td(t.gender||"N/A"),r.td(t.birthdate||"N/A"),r.td(t.residence||"N/A"),r.td(t.state||"N/A")]},getIndicatorOptions(){return[{label:"without program",value:g.WITHOUT_PROGRAM,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with duplicate tb number",value:g.WITH_DUPLICATE_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with unknown outcome",value:g.WITH_UNKNOWN_OUTCOME,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with dispensation anomalies",value:g.WITH_DISPENSATION_ANOMALIES,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"in treatment but completed",value:g.IN_TREATMENT_BUT_COMPLETED,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"bad tb number",value:g.BAD_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"without tb number",value:g.WITHOUT_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}}]}}});t("default",i(D,[["render",function(t,e,a,o,s,r){const l=u("report-template"),n=u("ion-page");return d(),m(n,null,{default:c((()=>[h(l,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
