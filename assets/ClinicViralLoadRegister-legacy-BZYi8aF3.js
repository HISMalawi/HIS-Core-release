System.register(["./index-legacy-Dx_PXhkv.js","./BaseTableReport-legacy-UjoBYmfk.js","./ReportMixin.vue_vue_type_script_lang-legacy-DtxpZ9bH.js","./Export-legacy-CSZpFAtY.js","./HisStandardForm-legacy-Bo0Q8cyM.js","./BasicReportTemplate-legacy-CuxiSl_r.js","./Pagination-legacy-BiPimySX.js"],(function(t,e){"use strict";var s,r,a,o,l,d,i,n,u,h,c,m,p,_;return{setters:[t=>{s=t.d,r=t.I,a=t.L,o=t.bL,l=t.H,d=t.ad,i=t._,n=t.r,u=t.o,h=t.c,c=t.w,m=t.b},t=>{p=t.R},t=>{_=t._},null,null,null,null],execute:function(){const e=s({components:{ReportTemplate:p,IonPage:r},mixins:[_],data:()=>({reportFilter:"",title:"Viral Load Register",reportData:[],totalTAT:[],modalData:{},columns:[[a.thTxt("ARV #"),a.thTxt("Accession #"),a.thTxt("Status"),a.thTxt("Order Date"),a.thTxt("Result"),a.thTxt("Date received"),a.thTxt("Mode of Delivery"),a.thTxt("Test reason"),a.thTxt("TAT(Days)")]],customBtns:[]}),created(){this.fields=this.getDateDurationFields(),this.customBtns.push({name:"High level view",size:"large",slot:"start",color:"primary",visible:!0,onClick:async()=>this.showModal()})},computed:{rows(){return this.reportFilter?this.buildRows(this.reportData.filter((t=>"All"===this.reportFilter||"No results"===this.reportFilter&&!t.result||!("With Results"!==this.reportFilter||!t.result)||"Rejected"===this.reportFilter&&"test-rejected"===t.order_status||"Drawn"===this.reportFilter&&"drawn"===t.order_status||"Pending"===this.reportFilter&&"pending"===t.order_status||"Started"===this.reportFilter&&"started"===t.order_status||"Failed"===this.reportFilter&&"failed"===t.order_status||"Not-done"===this.reportFilter&&"not-done"===t.order_status||"Completed"===this.reportFilter&&"completed"===t.order_status))):this.buildRows(this.reportData)}},methods:{async init(t,e){this.reportFilter="";const s=new o;s.setStartDate(e.start_date),s.setEndDate(e.end_date),this.period=s.getDateIntervalPeriod(),this.reportData=await s.getClinicElectronicAlerts(),this.buildHighLevelView()},buildRows(t){return t.length?t.map((t=>{let e=l.dateDiffInDays(t.date_received,t.date_ordered);return e?this.totalTAT.push(e):e="",[a.td(t.arv_number),a.td(t.accession_number),a.td(t.order_status),a.tdDate(t.date_ordered),a.td(t.result?t.result.replace(/</g,"&lt;"):""),a.tdDate(t.date_received),a.td("test_results_delivered_to_site_electronically"==t.result_delivery_mode?"Electronic":"test_results_delivered_to_site_manually"==t.result_delivery_mode?"Manual":""),a.td(t.test_reason),a.td(e)]})):[]},async customFilter(){const t=await d("Select report filter","",["All","Rejected","With Results","No results","Drawn","Pending","Started","Failed","Not-done","Completed"],[{name:"Cancel",slot:"start"},{name:"Select",slot:"end",role:"action"}]);return this.reportFilter=t?.selection||"",this.reportFilter},buildHighLevelView(){this.modalData={withResults:[],noResults:[],rejected:[],targeted:[],targetedWithResult:[],drawn:[],pending:[],started:[],failed:[],notDone:[],completed:[]},this.reportData.map((t=>{t.result&&this.modalData.withResults.push(t.accession_number),t.result||this.modalData.noResults.push(t.accession_number),t.order_status&&("test-rejected"==t.order_status&&this.modalData.rejected.push(t.accession_number),"drawn"==t.order_status&&this.modalData.drawn.push(t.accession_number),"pending"==t.order_status&&this.modalData.pending.push(t.accession_number),"started"==t.order_status&&this.modalData.started.push(t.accession_number),"failed"==t.order_status&&this.modalData.failed.push(t.accession_number),"not-done"==t.order_status&&this.modalData.notDone.push(t.accession_number),"completed"==t.order_status&&this.modalData.completed.push(t.accession_number)),t.test_reason&&(t.test_reason.match(/target/i)&&this.modalData.targeted.push(t.accession_number),t.test_reason.match(/target/i)&&t.result&&this.modalData.targetedWithResult.push(t.accession_number))}))},async showModal(){const t=[[a.thTxt("Indicator"),a.thTxt("Count")]],e=[[a.td("Total Orders"),a.td(this.reportData.length)],[a.td("Total Orders With Results"),a.td(this.modalData.withResults.length)],[a.td("Total Orders No Results"),a.td(this.modalData.noResults.length)],[a.td("Total Orders Rejected"),a.td(this.modalData.rejected.length)],[a.td("Total Targeted Orders"),a.td(this.modalData.targeted.length)],[a.td("Total Targeted Orders With Results"),a.td(this.modalData.targetedWithResult.length)],[a.td("Total Orders Drawn"),a.td(this.modalData.drawn.length)],[a.td("Total Orders Pending"),a.td(this.modalData.pending.length)],[a.td("Total Orders Started"),a.td(this.modalData.started.length)],[a.td("Total Orders Failed"),a.td(this.modalData.failed.length)],[a.td("Total Orders Not-done"),a.td(this.modalData.notDone.length)],[a.td("Total Orders Completed"),a.td(this.modalData.completed.length)],[a.td("Average TAT (days)"),a.td(Math.floor(this.totalTAT.reduce(((t,e)=>t+e),0)/this.totalTAT.length))]];this.drilldownData("Register Summary",t,e,!1)}}});t("default",i(e,[["render",function(t,e,s,r,a,o){const l=n("report-template"),d=n("ion-page");return u(),h(d,null,{default:c((()=>[m(l,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,itemsPerPage:10,period:t.period,customFilter:t.customFilter,onReportConfiguration:t.init,customBtns:t.customBtns,showPerPageFilter:!1,showVLFilter:"","report-prefix":"Clinic"},null,8,["title","rows","fields","columns","period","customFilter","onReportConfiguration","customBtns"])])),_:1})}]]))}}}));
