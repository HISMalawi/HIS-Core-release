System.register(["./index-legacy-B837ziyX.js"],(function(t,e){"use strict";var i,n,a,u,l,s,r,c,o,d,p,h,m,g,f,C,b,y,v,k,A,_,I,S,B,P,F,D,R,w,V,x,N,H;return{setters:[t=>{i=t.d,n=t.ak,a=t.h,u=t.b,l=t.g,s=t.j,r=t.t,c=t.bb,o=t.b$,d=t.a5,p=t.b0,h=t.c0,m=t.a4,g=t.l,f=t.ad,C=t.ac,b=t.I,y=t.k,v=t.ai,k=t.n,A=t.b4,_=t.at,I=t.aZ,S=t.au,B=t.E,P=t.bq,F=t.y,D=t.ap,R=t.a,w=t.w,V=t.e,x=t.a6,N=t.a9,H=t.aa}],execute:function(){var e=document.createElement("style");e.textContent=".his-card[data-v-aae064fb]{padding:0;margin:3%}li[data-v-aae064fb]{padding:0;margin:0;list-style:none}.input-focused[data-v-c94412aa]{color:#3880ff;border-bottom:3px solid #3880ff}.result-section[data-v-c94412aa]{overflow-y:auto;height:70vh}\n/*$vite$:1*/",document.head.appendChild(e);const E=i({props:{patient:{type:Object,required:!0},isActive:{type:Boolean}},computed:{stateClass(){return{"active-card-color":this.isActive,"inactive-card-color":!this.isActive}}}}),M=i({components:{PatientCard:n(E,[["render",function(t,e,i,n,o,d){return u(),a("div",{class:c(["his-card clickable",t.stateClass])},[l("li",null,[l("ul",null,[e[0]||(e[0]=s(" NPID : ",-1)),l("b",null,r(t.patient.npid),1)]),l("ul",null,[e[1]||(e[1]=s(" Arv# : ",-1)),l("b",null,r(t.patient.arvNum),1)]),l("ul",null,[e[2]||(e[2]=s(" Name : ",-1)),l("b",null,r(t.patient.name),1)]),l("ul",null,[e[3]||(e[3]=s(" Birth date : ",-1)),l("b",null,r(t.patient.birthdate),1)]),l("ul",null,[e[4]||(e[4]=s(" Gender : ",-1)),l("b",null,r(t.patient.gender),1)]),l("ul",null,[e[5]||(e[5]=s(" Home District : ",-1)),l("b",null,r(t.patient.homeDistrict),1)]),l("ul",null,[e[6]||(e[6]=s(" Home Village : ",-1)),l("b",null,r(t.patient.homeVillage),1)]),l("ul",null,[e[7]||(e[7]=s(" Current District : ",-1)),l("b",null,r(t.patient.currentDistrict),1)]),l("ul",null,[e[8]||(e[8]=s(" Current Village : ",-1)),l("b",null,r(t.patient.currentVillage),1)])])],2)}],["__scopeId","data-v-aae064fb"]]),IonPage:k,IonInput:v,IonButton:y,IonContent:b,IonRow:C,IonCol:f,IonFooter:g,IonHeader:m,ViewPort:h,HisKeyboard:p,IonTitle:d},data:()=>({inputA:"",inputB:"",isSubmitting:!1,inputFocus:"inputA",inputASearchResults:[],inputBSearchResults:[],activeInputACard:{},keyboard:[o,[["","Hide"],["Space","Delete"],["inputA","inputB"],["Search","Clear"]]]}),computed:{canMerge(){return!I.isEmpty(this.activeInputACard)&&!I.isEmpty(this.inputBSearchResults.filter((t=>t.isChecked)))}},methods:{async onMerge(){if(await S("Are you sure you want to merge selected Persons?")){try{this.isSubmitting=!0;const t=await _.mergePatients({primary:{patient_id:this.activeInputACard.id,doc_id:this.activeInputACard.docID},secondary:this.inputBSearchResults.filter((t=>t.isChecked)).map((t=>({patient_id:t.id,doc_id:t.docID})))});await B(t.patient_id),this.inputBSearchResults=this.inputBSearchResults.filter((t=>!t.isChecked));const e=await P.getNextTaskParams(t.patient_id);this.$router.push(e.name?e:`/patient/dashboard/${t.patient_id}`)}catch(t){F(`${t}`)}this.isSubmitting=!1}},onPrimaryPatient(t){this.inputBSearchResults.forEach((e=>{e.id===t.id&&(this.inputBSearchResults[e.index].isChecked=!1)})),this.activeInputACard=t},onSecondaryPatient(t){if(t.isChecked)return this.inputBSearchResults[t.index].isChecked=!1;I.isEmpty(this.activeInputACard)||t.id==this.activeInputACard.id||(this.inputBSearchResults[t.index].isChecked=!0)},async searchPatient(t){const[e,i]=t.split(" ");return(await _.search({given_name:e,family_name:i})).map(((t,e)=>{const i=new _(t);return{index:e,id:i.getID(),name:i.getFullName(),docID:i.getDocID(),birthdate:i.getBirthdate(),arvNum:i.getArvNumber(),npid:i.getNationalID(),gender:i.getGender(),homeDistrict:i.getHomeDistrict(),homeVillage:i.getHomeVillage(),currentDistrict:i.getCurrentDistrict(),currentVillage:i.getCurrentVillage(),isChecked:!1}}))},async keypress(t){if(!this.inputFocus)return;let e=A(t,this[this.inputFocus]);e.match(/hide/i)?this.inputFocus="":e.match(/search/i)?(e=e.replace("Search",""),"inputA"===this.inputFocus?(this.inputASearchResults=await this.searchPatient(e),this.activeInputACard={}):this.inputBSearchResults=await this.searchPatient(e),this.inputFocus=""):e.match(/inputA/i)?this.inputFocus="inputA":e.match(/inputB/i)?this.inputFocus="inputB":e.match(/clear/i)?(this[this.inputFocus]="","inputA"===this.inputFocus?this.inputASearchResults=[]:this.inputBSearchResults=[]):this[this.inputFocus]=e}}}),$={class:"result-section"},j={class:"result-section"};t("default",n(M,[["render",function(t,e,i,n,r,o){const d=D("ion-title"),p=D("ion-toolbar"),h=D("ion-header"),m=D("ion-input"),g=D("ion-col"),f=D("ion-row"),C=D("patient-card"),b=D("view-port"),y=D("his-keyboard"),v=D("ion-content"),k=D("ion-button"),A=D("ion-footer"),_=D("ion-page");return u(),R(_,null,{default:w((()=>[V(h,null,{default:w((()=>[V(p,null,{default:w((()=>[V(d,{class:"his-lg-text"},{default:w((()=>[...e[4]||(e[4]=[s("Merge Clients",-1)])])),_:1})])),_:1})])),_:1}),V(v,null,{default:w((()=>[V(b,null,{default:w((()=>[V(f,null,{default:w((()=>[V(g,null,{default:w((()=>[V(m,{onClick:e[0]||(e[0]=e=>t.inputFocus="inputA"),placeholder:"Primary patient",class:c(["input_display",{"input-focused":"inputA"===t.inputFocus}]),modelValue:t.inputA,"onUpdate:modelValue":e[1]||(e[1]=e=>t.inputA=e)},null,8,["modelValue","class"])])),_:1}),V(g,null,{default:w((()=>[V(m,{onClick:e[2]||(e[2]=e=>t.inputFocus="inputB"),class:c(["input_display",{"input-focused":"inputB"===t.inputFocus}]),placeholder:"Secondary patient",modelValue:t.inputB,"onUpdate:modelValue":e[3]||(e[3]=e=>t.inputB=e)},null,8,["modelValue","class"])])),_:1})])),_:1}),V(f,null,{default:w((()=>[V(g,null,{default:w((()=>[l("div",$,[(u(!0),a(N,null,H(t.inputASearchResults,((e,i)=>(u(),R(C,{onClick:i=>t.onPrimaryPatient(e),key:i,patient:e,isActive:t.activeInputACard.index===i},null,8,["onClick","patient","isActive"])))),128))])])),_:1}),V(g,null,{default:w((()=>[l("div",j,[(u(!0),a(N,null,H(t.inputBSearchResults,((e,i)=>(u(),R(C,{onClick:i=>t.onSecondaryPatient(e),key:i,patient:e,isActive:e.isChecked},null,8,["onClick","patient","isActive"])))),128))])])),_:1})])),_:1})])),_:1}),t.inputFocus?(u(),R(y,{key:0,kbConfig:t.keyboard,onKeyPress:t.keypress},null,8,["kbConfig","onKeyPress"])):x("",!0)])),_:1}),V(A,null,{default:w((()=>[V(p,{color:"dark"},{default:w((()=>[V(k,{color:"danger",size:"large","router-link":"/"},{default:w((()=>[...e[5]||(e[5]=[s(" Cancel ",-1)])])),_:1}),t.canMerge?(u(),R(k,{key:0,disabled:t.isSubmitting,color:"success",size:"large",slot:"end",onClick:t.onMerge},{default:w((()=>[...e[6]||(e[6]=[s(" Merge ",-1)])])),_:1},8,["disabled","onClick"])):x("",!0)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-c94412aa"]]))}}}));
