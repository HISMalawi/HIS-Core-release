System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-kOBZLM0d.js","./tx_report_service-legacy-VvWCOfcN.js","./TableReportTemplate-legacy-CKj3FIGR.js","./index-legacy-Dg5P6bX-.js","./moh_cohort_service-legacy-BspmECQ3.js","./_setToArray-legacy-jEwcQpqP.js","./_Set-legacy-BL8ow4HL.js","./MultiFieldDateHelper-legacy-DBQBHUfA.js","./dynamic-import-helper-legacy-arUa2LZV.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./BasicReportTemplate-legacy-Q043r8R3.js","./Export-legacy-3ZHnhIid.js","./SIngleTouchField-legacy-SRHCPnWv.js","./Pagination-legacy-DMKxolpC.js","./HisStandardForm-legacy-BXV61qjj.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./ReportErrors-legacy-BDEmzxBv.js"],(function(t,e){"use strict";var s,r,o,a,n,i,l,h,c,u,d,g,f,p,m,v,w,M,y;return{setters:[t=>{s=t._},t=>{r=t.T},t=>{o=t.R},t=>{a=t.bv,n=t.d,i=t.L,l=t.cz,h=t._,c=t.r,u=t.o,d=t.c,g=t.w,f=t.b},t=>{p=t.M},t=>{m=t._,v=t.a,w=t.b,M=t.c},t=>{y=t._},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var e=m,A=function(t){return t!=t},T=function(t,e,s){for(var r=s-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1},F=function(t,s,r){return s==s?T(t,s,r):e(t,A,r)},R=function(t,e){return!(null==t||!t.length)&&F(t,e,0)>-1},_=function(t,e,s){for(var r=-1,o=null==t?0:t.length;++r<o;)if(s(e,t[r]))return!0;return!1},b=y,j=function(){},S=b&&1/v(new b([,-0]))[1]==1/0?function(t){return new b(t)}:j,P=w,x=R,C=_,D=M,I=S,$=v,V=function(t,e,s){var r=-1,o=x,a=t.length,n=!0,i=[],l=i;if(s)n=!1,o=C;else if(a>=200){var h=e?null:I(t);if(h)return $(h);n=!1,o=D,l=new P}else l=e?[]:i;t:for(;++r<a;){var c=t[r],u=e?e(c):c;if(c=s||0!==c?c:0,n&&u==u){for(var d=l.length;d--;)if(l[d]===u)continue t;e&&l.push(u),i.push(c)}else o(l,u,s)||(l!==i&&l.push(u),i.push(c))}return i};const L=a((function(t){return t&&t.length?V(t):[]})),E=n({mixins:[s],components:{ReportTemplate:o},data:()=>({title:"TX Curr MMD Report",cohort:{},rows:[],totals:new Set,errors:[],showStatus:!1,aggregate:{Male:{},Female:{}},columns:[[i.thTxt("Age group"),i.thTxt("Gender"),i.thNum("# of clients on <3 months of ARVs"),i.thNum("# of clients on 3 - 5 months of ARVs"),i.thNum("# of clients on >= 6 months of ARVs")]],headerInfoList:[],mohCohort:{},canValidate:!1}),watch:{async canValidate(t){t&&await this.validateReport()}},created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.canValidate=!1,this.totals.clear(),this.errors=[],this.showStatus=!1,this.rows=[],this.report=new r,this.mohCohort=new p,this.mohCohort.setOccupation(e.occupation),this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.report.initArvRefillPeriod(!0),await this.setMaleFemaleRows(),this.setTotalMalesRows(),await this.setTotalFemaleRows(),this.canValidate=!0,this.showStatus=!0,this.setHeaderInfoList()},buildRow(t,e,s){const r={underThreeMonths:{check:t=>t<90,data:[]},betweenThreeAndFiveMonths:{check:t=>t>=90&&t<=150,data:[]},overSixMonths:{check:t=>t>150,data:[]}},o=t[s]||{};for(const a in o){const t=parseInt(a);this.totals.add(t),Object.keys(r).forEach((e=>{this.aggregate[s][e]||(this.aggregate[s][e]=[]),r[e].check(o[a].prescribed_days)&&(r[e].data.push(t),this.aggregate[s][e].push(t))}))}return[i.td(e),i.td(s),this.drill(r.underThreeMonths.data,`${e} (${s}s) < 3 months of Arvs`),this.drill(r.betweenThreeAndFiveMonths.data,`${e} (${s}s) 3-5 months of Arvs`),this.drill(r.overSixMonths.data,`${e} (${s}s) > 6 months months of Arvs`)]},async setMaleFemaleRows(){const t=[],e=[];for(const s of l){const[r,o]=this.parseAgeGroup(s),a=await this.report.getTxCurrMMDReport(r,o);this.report.initArvRefillPeriod(!1),e.push(this.buildRow(a,s,"Female")),t.push(this.buildRow(a,s,"Male")),this.rows=[...e,...t]}},setTotalMalesRows(){this.rows.push([i.td("All"),i.td("Male"),this.drill(this.aggregate.Male.underThreeMonths,"All (Males) < 3 months of Arvs"),this.drill(this.aggregate.Male.betweenThreeAndFiveMonths,"All (Males) 3-5 months of Arvs"),this.drill(this.aggregate.Male.overSixMonths,"All (Males) > 6 months months of Arvs")])},async setTotalFemaleRows(){const t=L(Object.values(this.aggregate.Female).flat(1)),e=await this.report.getMaternalStatus(t),s=e.FBf.concat(e.FP),r=(t,r,o)=>{const a=t.filter((t=>{const o=parseInt(t.toString());return"FNP"===r?!s.includes(o):e[r].includes(o)}));return this.drill(a,o)},o=(t,e)=>{this.rows.push([i.td("All"),i.td(t),r(this.aggregate.Female.underThreeMonths,e,`All (${t}s) < 3 months of Arvs`),r(this.aggregate.Female.betweenThreeAndFiveMonths,e,`All (${t}s) 3-5 months of Arvs`),r(this.aggregate.Female.overSixMonths,e,`All (${t}s) > 6 months of Arvs`)])};o("FP","FP"),o("FNP","FNP"),o("FBF","FBf")},setHeaderInfoList(){this.headerInfoList=[{label:"Total clients",value:this.totals.size,other:{onclick:()=>this.runTableDrill(Array.from(this.totals),"Total Clients")}}]},validateReport(){const t={total_alive_and_on_art:{param:this.totals.size,check:(t,e)=>e>t,error:(t,e)=>`\n                        MoH cohort Alive and on ART clients <b>(${t})</b> is not\n                        matching with total TX MMD clients <b>(${e})</b>.\n                    `}};-1===this.mohCohort.validateIndicators(t,(t=>this.errors=t))&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}});t("default",h(E,[["render",function(t,e,s,r,o,a){const n=c("report-template"),i=c("ion-page");return u(),d(i,null,{default:g((()=>[f(n,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,reportPrefix:"PEPFAR",config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerInfoList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])])),_:1})}]]))}}}));
