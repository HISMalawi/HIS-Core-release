System.register(["./index-legacy-rS9CNTaA.js"],(function(e,t){"use strict";var a,l,n,r,o,s,i,d,u,c,m,f,_,h,b,g,p,y,v,x,k,I,T,C,w,N,M,B,D,H,R,$,A,F,P;return{setters:[e=>{a=e.al,l=e.d,n=e.am,r=e.a5,o=e.S,s=e.Q,i=e.O,d=e.a4,u=e.R,c=e.$,m=e.U,f=e.a0,_=e.a3,h=e.an,b=e.ao,g=e.ap,p=e.r,y=e.aq,v=e.ar,x=e.t,k=e.aj,I=e.ai,T=e.af,C=e.a8,w=e.v,N=e.w,M=e.ad,B=e.u,D=e.x,H=e.z,R=e.Y,$=e.a1,A=e.B,F=e.C,P=e.E}],execute:function(){var t=document.createElement("style");t.textContent=".his-card[data-v-f5608659]{margin:auto!important;padding:.6em}\n",document.head.appendChild(t);class z extends a{static getMergeHistory(e){return this.getJson("/rollback/merge_history",{identifier:e})}static rollback(e){return this.postJson("/rollback/rollback_patient",{patient_id:e,program_id:this.getProgramID()})}}const G=l({components:{IonText:n,IonPage:r,IonContent:o,IonToolbar:s,IonHeader:i,IonFooter:d,IonTitle:u,IonList:c,IonItem:m,IonLabel:f,IonButton:_,ReportTable:h},setup(){const e=b(),t=g(),a=p(-1),l=p([]),n=p([]),r=`${e.params.id}`.toUpperCase(),o=p("N/A"),s=p([{label:"Birthdate",value:"N/A"},{label:"Gender",value:"N/A"}]),i=[[y.thTxt("Merge type"),y.thTxt("Merge date"),y.thTxt("First Name"),y.thTxt("Last name"),y.thTxt("Birthdate"),y.thTxt("Gender")]],d=v((()=>n.value.length>0));return x((async()=>{if(r){try{n.value=await z.getMergeHistory(r)||[]}catch(e){k(`Merge history not found for ${r}`)}l.value=n.value.map((e=>(-1===a.value&&(a.value=e.secondary_id,o.value=`${e.secondary_first_name} ${e.secondary_surname}`,s.value=[{label:"Birthdate",value:I.toStandardHisDisplayFormat(e.secondary_birthdate)},{label:"Gender",value:e.secondary_gender}]),[y.td(e.merge_type),y.tdDate(e.merge_date),y.td(e.primary_first_name),y.td(e.primary_surname),y.tdDate(e.primary_birthdate),y.td(e.primary_gender)])))}else t.back()})),{cancel:function(){t.back()},holderName:o,isReversible:d,patientInfo:s,rollback:async function(){await T("Are you sure you want to merge transactions")&&(await z.rollback(a.value)?t.back():k("Failed to rollback"))},columns:i,rows:l,npid:r}}});e("default",C(G,[["render",function(e,t,a,l,n,r){const o=M("ion-text"),s=M("ion-title"),i=M("ion-toolbar"),d=M("ion-header"),u=M("ion-label"),c=M("ion-item"),m=M("ion-list"),f=M("report-table"),_=M("ion-content"),h=M("ion-button"),b=M("ion-footer"),g=M("ion-page");return B(),w(g,null,{default:N((()=>[D(d,null,{default:N((()=>[D(i,null,{default:N((()=>[D(s,{class:"his-lg-text"},{default:N((()=>[D(o,{color:"danger"},{default:N((()=>[H(R(e.npid),1)])),_:1}),H(" Merge history ")])),_:1})])),_:1})])),_:1}),D(_,null,{default:N((()=>[D(s,{class:"his-md-text his-card"},{default:N((()=>[H("NPID Holder: ")])),_:1}),D(m,null,{default:N((()=>[D(c,{lines:"none",class:"his-md-text"},{default:N((()=>[D(u,null,{default:N((()=>[H(" Person name ")])),_:1}),$("b",null,R(e.holderName),1)])),_:1}),(B(!0),A(P,null,F(e.patientInfo,((e,t)=>(B(),w(c,{lines:"none",class:"his-md-text",key:t},{default:N((()=>[D(u,null,{default:N((()=>[H(R(e.label)+": ",1)])),_:2},1024),$("b",null,R(e.value),1)])),_:2},1024)))),128))])),_:1}),D(s,{class:"his-md-text his-card"},{default:N((()=>[H("Transactions:")])),_:1}),D(f,{config:{tableCssTheme:"art-report-theme"},columns:e.columns,rows:e.rows},null,8,["columns","rows"])])),_:1}),D(b,null,{default:N((()=>[D(i,{color:"dark"},{default:N((()=>[D(h,{onClick:e.cancel,color:"danger",size:"large",slot:"start"},{default:N((()=>[H(" Cancel ")])),_:1},8,["onClick"]),D(h,{onClick:e.rollback,disabled:!e.isReversible,color:"success",size:"large",slot:"end"},{default:N((()=>[H(" Reverse ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-f5608659"]]))}}}));
