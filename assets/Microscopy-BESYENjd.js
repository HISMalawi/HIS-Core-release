import{d as R,r as P,bQ as I,bV as b,ar as L,ad as n,d$ as t,ae as i,a as h,c as $,w as U,b as B,u as v,I as F}from"./index-CMZASHAR.js";import{H as M}from"./HisStandardForm-BCjM4-bc.js";import{u as N}from"./useEncounter-CsCeua2V.js";import{r as D}from"./commons-Bp7XBfaW.js";import"./isEmpty-DjKeGqZh.js";import"./encounter_guidelines-CJXpBOk4.js";import"./GuidelineEngine-D6V1_Znr.js";const H=R({__name:"Microscopy",setup(V){const u=P([]),o=new I(-1,b.LAB_RESULTS),O=L(),{goToNextTask:T,patientDashboardUrl:m}=N((d,l)=>{o.patientID=l,o.providerID=d;const r=a=>({id:"sample".concat(a,"PhysicalAppearance"),helpText:"Sample ".concat(a," Physical Appearance:"),type:n.TT_SELECT,computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_PHYSICAL_APPEARANCE")),value_coded:t("".concat(e.value)),obs_datetime:o.date}),validation:e=>i.required(e),options:()=>[{value:"MUCO_PURULENT",label:"Muco-purulent"},{value:"BLOOD_STAINED",label:"Blood-stained"},{value:"SALIVA",label:"Saliva"},{value:"OTHER",label:"Other"}]}),s=a=>({id:"sample".concat(a,"Procedure"),helpText:"Sample ".concat(a," Procedure:"),type:n.TT_SELECT,computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_PROCEDURE")),value_coded:t("".concat(e.value)),obs_datetime:o.date}),validation:e=>i.required(e),options:()=>[{value:"ZIEHL_NEELSEN",label:"Ziehl-Neelsen"},{value:"FLUORESCENCE",label:"Fluorescence"}]}),c=a=>({id:"sample".concat(a,"Result"),helpText:"Sample ".concat(a," Result:"),type:n.TT_SELECT,computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_RESULT")),value_coded:t("".concat(e.value)),obs_datetime:o.date}),validation:e=>i.required(e),options:()=>[{value:"AFB_POSITIVE",label:"AFB Positive"},{value:"AFB_NEGATIVE",label:"AFB Negative"}]}),_=a=>({id:"sample".concat(a,"Grading"),helpText:"Sample ".concat(a," Grading:"),type:n.TT_SELECT,validation:e=>i.required(e),condition:e=>e["sample".concat(a,"Result")].value==="AFB_POSITIVE",computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_GRADING")),value_text:e.value,obs_datetime:o.date}),options:()=>[{value:"1+",label:"1+"},{value:"2+",label:"2+"},{value:"3+",label:"3+"},{value:"OTHER",label:"Other"}]}),p=a=>({id:"sample".concat(a,"OtherGrading"),helpText:"Sample ".concat(a," Other Grading:"),type:n.TT_TEXT,computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_GRADING")),value_text:e.value,obs_datetime:o.date}),validation:e=>i.required(e),condition:e=>e["sample".concat(a,"Grading")].value==="OTHER"}),E=a=>({id:"sample".concat(a,"BaciliSeen"),type:n.TT_NUMBER,helpText:"Sample ".concat(a," no. Of Bacilli Seen:"),computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_NUMBER_OF_BACILI_SEEN")),value_numeric:e.value,obs_datetime:o.date}),validation:e=>i.required(e),condition:e=>e["sample".concat(a,"Grading")].value==="OTHER"}),S=a=>({id:"sample".concat(a,"ResultDate"),helpText:"Sample ".concat(a," Result Date:"),type:n.TT_FULL_DATE,computedValue:e=>({concept_id:t("SAMPLE_".concat(a.toUpperCase(),"_MICROSCOPY_RESULT_DATE")),value_datetime:e.value,obs_datetime:o.date}),validation:e=>i.validateSeries([()=>i.required(e),()=>i.dateRangeOf(e,"".concat(O.query.date),o.date)])});u.value=[r("One"),s("One"),c("One"),_("One"),p("One"),E("One"),S("One"),r("Two"),s("Two"),c("Two"),_("Two"),p("Two"),E("Two"),S("Two")]});function A(d){const l=[];return d.sampleOneResult.value==="AFB_POSITIVE"||d.sampleTwoResult.value==="AFB_POSITIVE"?(l.push({concept_id:t("TB_TYPE"),value_coded:t("PULMONARY_TB"),obs_datetime:o.date}),l.push({concept_id:t("TB_STATUS"),value_coded:t("POSITIVE"),obs_datetime:o.date}),l.push({concept_id:t("TUBERCULOSIS_CLASS"),value_coded:t("All Other"),obs_datetime:o.date})):l.push({concept_id:t("TB_STATUS"),value_coded:t("NEGATIVE"),obs_datetime:o.date}),l.push({concept_id:t("BACTERIOLOGICALLY_DIAGNOSED"),value_coded:t("YES_ANSWER"),obs_datetime:o.date}),l.push({concept_id:t("PROCEDURE_TYPE"),value_coded:t("MICROSCOPY"),obs_datetime:o.date}),l}async function C(d,l){await o.createEncounter(),await o.saveObservationList([...A(d),...await D(l)]),T()}return(d,l)=>(h(),$(v(F),null,{default:U(()=>[B(M,{cancelDestinationPath:v(m),onFinishAction:C,fields:u.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])]),_:1}))}});export{H as default};
