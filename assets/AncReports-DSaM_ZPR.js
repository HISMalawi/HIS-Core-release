import{C as _,c as r,as as A,b0 as m,ao as b,an as s,a_ as B,H as f,S as E,z as d,aA as l,av as v}from"./index-DrAzzURJ.js";import{D as I}from"./BasicReportTemplate-vaBCj5CD.js";function $(w="Report"){const n=_({title:w,rows:[],columns:[],fields:[],period:"",drill:[],service:{},other:{}}),D=r(()=>n.rows),y=r(()=>n.period),g=r(()=>n.fields),T=r(()=>n.columns),x=r(()=>n.title),c=A();function S(e){c.push("/patient/dashboard/".concat(e))}function F(e){return f.toStandardHisDisplayFormat(e)}function P(e){const t=open("","","width:1024px, height:768px"),a=document.getElementById(e.containerID);a&&t&&(t.document.write('\n                <html>\n                <head>\n                    <title>Print Cohort</title>\n                    <link rel="stylesheet" media="print"  href="'.concat(e.cssFile,'"/>\n                </head>\n                <body>\n                    ').concat(a.innerHTML,"\n                </body>\n                </html>\n            ")),setTimeout(()=>{t.print(),t.close()},3500))}async function h(e,t){(await d.create({component:I,cssClass:"large-modal",componentProps:{title:e||"Drilldown",columns:[[l.thTxt("National ID"),l.thTxt("First name"),l.thTxt("Last name"),l.thTxt("Birthdate"),l.thTxt("Action")]],rows:t,rowParser:async a=>{const u=[];for(const o of a){if(n.drill[o]){u.push(n.drill[o]);continue}try{const i=new v(await v.findByID(o));n.drill[o]=[l.td(i.getNationalID()),l.td(i.getGivenName()),l.td(i.getFamilyName()),l.tdDate("".concat(i.getBirthdate())),l.tdBtn("Show",()=>{c.push({path:"/patient/dashboard/".concat(o)}),d.dismiss({})})],u.push(n.drill[o])}catch(i){console.error(i)}}return u},showFilters:!0,footerColor:"light",showReportStamp:!1,paginated:!0,rowsPerPage:20,onFinish:()=>d.dismiss()}})).present()}function N(e,t){return t.length?l.tdLink(t.length,()=>h(e,t)):l.td(0)}function p(e={}){return[...m({id:"start_date",helpText:"Start",required:!0,minDate:()=>(e==null?void 0:e.minDate)||null,maxDate:()=>(e==null?void 0:e.maxDate)||null,estimation:{allowUnknown:!1},computeValue:t=>t}),...m({id:"end_date",helpText:"End",required:!0,minDate:(t,a)=>a.start_date,maxDate:()=>(e==null?void 0:e.maxDate)||null,estimation:{allowUnknown:!1},computeValue:t=>t})]}n.fields=p();function C(){return[{id:"year",helpText:"Select Year",type:b.TT_NUMBER,computedValue:e=>e.value,validation:e=>{const t=B.isPlainObject(e)?e.value:-1;return s.validateSeries([()=>s.required(e),()=>isNaN(parseInt("".concat(t)))?["Invalid year"]:null,()=>s.rangeOf(e,2e3,f.getYear(E.getSessionDate()))])}},{id:"month",helpText:"Select Month",type:b.TT_SELECT,validation:e=>s.required(e),computedValue:e=>e.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}]}return{fd:F,drill:N,presentDrillDown:h,getMonthlyReportFields:C,showPrintWindow:P,buildTimeIntervalFields:p,gotoPatientDashboard:S,reportData:n,rows:D,period:y,fields:g,columns:T,title:x}}export{$ as A};
