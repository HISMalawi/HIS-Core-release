import{d as w,r as m,t as A,u as D,v as C,w as O,x as N,y as T,c_ as R,a5 as x,aK as M,aN as y}from"./index-CyYd6aWW.js";import{v as S}from"./TableView-KUf7rG9H.js";import{C as B}from"./clinic_report_service-BN5e79WK.js";import{s as j,w as z}from"./v2utils-Ce6mchJu.js";const I=w({__name:"ClinicTpTOutcomes",setup(H){const v=M("reports.png"),o=m([]),u=m(""),i=new B,t=n=>({...n,toValue:e=>e.length,tdClick:e=>{j({title:"".concat(e.data.age_group," ").concat(e.column.label),subtitle:u.value,patientIdentifiers:e.refData.map(s=>s.patient_id)})}}),P=[[{label:"Age group",ref:"age_group"},{label:"TPT Type",ref:"tpt_type"},t({label:"Started TPT (New on ART)",ref:"started_tpt_new"}),t({label:"Started TPT (Previous on ART)",ref:"started_tpt_prev"}),t({label:"Completed TPT (New on ART)",ref:"completed_tpt_new"}),t({label:"Completed TPT (Previous on ART)",ref:"completed_tpt_prev"}),t({label:"Not completed TPT",ref:"not_completed_tpt"}),t({label:"Died",ref:"died"}),t({label:"Defaulted",ref:"defaulted"}),t({label:"Stopped ART",ref:"stopped"}),t({label:"TO",ref:"transfer_out"}),t({label:"Confirmed TB ",ref:"confirmed_tb"}),t({label:"Pregnant",ref:"pregnant"}),t({label:"Breastfeeding",ref:"breast_feeding"}),t({label:"Skin rash",ref:"skin_rash"}),t({label:"Peripheral neuropathy",ref:"peripheral_neuropathy"}),t({label:"Yellow eyes",ref:"yellow_eyes"}),t({label:"Nausea",ref:"nausea"}),t({label:"Dizziness",ref:"dizziness"})]],f=()=>z(async()=>{o.value=[];const n=(await i.getTtpOutcomes()).reduce((l,a)=>({...l,[a.tpt_type]:[...l[a.tpt_type],a]}),{"3HP":[],"6H":[]});o.value=[...n["3HP"],...n["6H"]];const e=o.value.reduce((l,a)=>(Object.keys(a).forEach(r=>{if(Array.isArray(a[r])){const _=c=>{var g,b;return{...l[c],[r]:[...(b=(g=l==null?void 0:l[c])==null?void 0:g[r])!=null?b:[],...a[r].filter(h=>h.gender===c)]}};l={M:_("M"),F:_("F")}}}),l),{M:{},F:{}}),s=y.uniq(e.F.pregnant),p=y.uniq(e.F.breast_feeding),F=s.concat(p);o.value=[...o.value,{age_group:"All",tpt_type:"Male",...e.M},{age_group:"All",tpt_type:"FP",...Object.keys(e.F).reduce((l,a)=>({...l,[a]:e.F[a].filter(r=>s.includes(r))}),{})},{age_group:"All",tpt_type:"FNP",...Object.keys(e.F).reduce((l,a)=>({...l,[a]:e.F[a].filter(r=>!F.includes(r))}),{})},{age_group:"All",tpt_type:"FBF",...Object.keys(e.F).reduce((l,a)=>({...l,[a]:e.F[a].filter(r=>p.includes(r))}),{})}]}),d=()=>R({onFinish:(n,e,s,p)=>{p&&i.setOccupation(p),u.value="".concat(s),i.startDate=n,i.endDate=e,f()}});return A(()=>!o.value.length&&d()),(n,e)=>(D(),C(T(x),null,{default:O(()=>[N(S,{"icon-url":T(v),subtitle:u.value,title:"TPT Outcome","report-prefix":"Clinic",columns:P,onConfigure:d,columnData:o.value,rowsPerPage:100,onRefresh:f},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{I as default};
