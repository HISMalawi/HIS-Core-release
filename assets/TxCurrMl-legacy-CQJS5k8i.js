System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-C85CDn6B.js","./tx_report_service-legacy-D4gnwsTc.js","./TableReportTemplate-legacy-CpYI8faP.js","./index-legacy-Ck8hVlzC.js","./HisStandardForm-legacy-OroqgFde.js","./ReportErrors-legacy-D5GAXSdV.js"],(function(t,e){"use strict";var o,r,s,i,a,d,n,l,h,p,u,c,T,m;return{setters:[t=>{o=t._},t=>{r=t.T},t=>{s=t.R},t=>{i=t.d,a=t.I,d=t.L,n=t.ah,l=t.cW,h=t._,p=t.r,u=t.o,c=t.c,T=t.w,m=t.b},null,null],execute:function(){const e=i({mixins:[o],components:{ReportTemplate:s,IonPage:a},data:()=>({title:"PEPFAR Tx ML Report",rows:[],drillData:{},columns:[[d.thTxt("Age group"),d.thTxt("Gender"),d.thTxt("Died"),d.thTxt("IIT <3 mo"),d.thTxt("IIT 3-5 mo"),d.thTxt("IIT 6+ mo"),d.thTxt("Transferred out"),d.thTxt("Refused (Stopped)")]],indexLabel:["Died","IIT <3 mo","IIT 3-5 mo","IIT 6+ mo","Tranferred out","Refused (Stopped)"],cohort:{}}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.rows=[],this.report=new r,this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTxMlReport(),this.setRows("F"),this.setRows("M"),this.setTotalMaleRow(),this.setMaternalRows()},drilldown(t,e){const o=[[d.thTxt("ARV#"),d.thTxt("DOB"),d.thTxt("Dispensed"),d.thTxt("ARVs")]],r=async()=>{if(e in this.drillData)return this.drillData[e];const o=await this.report.getTxMMDClientLevelData(t);if(!o)return[];const r=this.report.remapTxClientLevelData(o).map((t=>{const e=t.drugs.map((t=>({tableView:`\n                                <table style='width: 100%;'> \n                                    <td style='width: 65%;'>${t.name}</td>\n                                    <td style='width: 30%;'>(${t.quantity}, ${t.dose} a day)</td>\n                                </table>`,dataView:`${t.name} (Quantity: ${t.quantity} Dose: ${t.dose})`})));return[d.td(t.id||"N/A"),d.tdDate(t.dob),d.tdDate(t.dispenseDate),d.td(e.map((t=>t.tableView)).join("<p/>"),{value:e.map((t=>t.dataView)).join("|")})]}));return this.drillData[e]=r,r};return t.length<=0?d.td(0):d.tdLink(t.length,(()=>this.drilldownAsyncRows(e,o,r)))},aggregate(t,e){return Object.values(this.cohort).reduce(((o,r)=>r[t]?[...r[t][this.indexLabel.indexOf(e)],...o]:o),[])},setTotalMaleRow(){const t=t=>this.drilldown(this.aggregate("M",t),t);this.rows.push([d.td("All"),d.td("Male"),t("Died"),t("IIT <3 mo"),t("IIT 3-5 mo"),t("IIT 6+ mo"),t("Tranferred out"),t("Refused (Stopped)")])},async setMaternalRows(){const t=this.indexLabel.reduce(((t,e)=>[...t,{indicator:e,data:this.aggregate("F",e)}]),[]),e=await this.report.getMaternalStatus(n.uniq(t.reduce(((t,e)=>[...t,...e.data]),[]).map((t=>t)))),o=e=>t.reduce(((t,o)=>o.indicator===e?[...t,...o.data]:t),[]),r=(t,r)=>this.drilldown(o(r).filter((o=>e[t].includes(o))),`All ${r} Female Pregnant`),s=e.FBf.concat(e.FP),i=t=>this.drilldown(o(t).filter((t=>!s.includes(t))),`All ${t} Female not pregnant`);this.rows.push([d.td("All"),d.td("FP"),r("FP","Died"),r("FP","IIT <3 mo"),r("FP","IIT 3-5 mo"),r("FP","IIT 6+ mo"),r("FP","Tranferred out"),r("FP","Refused (Stopped)")]),this.rows.push([d.td("All"),d.td("FNP"),i("Died"),i("IIT <3 mo"),i("IIT 3-5 mo"),i("IIT 6+ mo"),i("Tranferred out"),i("Refused (Stopped)")]),this.rows.push([d.td("All"),d.td("FBF"),r("FBf","Died"),r("FBf","IIT <3 mo"),r("FBf","IIT 3-5 mo"),r("FBf","IIT 6+ mo"),r("FBf","Tranferred out"),r("FBf","Refused (Stopped)")])},setRows(t){for(const o in l){const r=l[o],s=this.formatGender(t);try{const e=this.cohort[r][t],o=`${s}s ${r}`,i=e.map(((t,e)=>this.drilldown(t,`${o} ${this.indexLabel[e]}`)));this.rows.push([d.td(r),d.td(s),...i])}catch(e){this.rows.push([d.td(r),d.td(s),d.td(0),d.td(0),d.td(0),d.td(0),d.td(0),d.td(0)])}}}}});t("default",h(e,[["render",function(t,e,o,r,s,i){const a=p("report-template"),d=p("ion-page");return u(),c(d,null,{default:T((()=>[m(a,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},reportPrefix:"PEPFAR",onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
