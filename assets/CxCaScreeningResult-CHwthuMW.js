import{bS as C,d as y,r as c,ad as n,ae as r,a as E,c as x,u as O,W as p,R as P}from"./index-CpJHxj6i.js";import{H as A}from"./HisStandardForm-BxDywvJp.js";import{u as L}from"./useEncounter-BQDfhQ2z.js";import{y as v,m as a,r as N}from"./commons-Cn5Zyrna.js";import"./isEmpty-BpcJNAo-.js";import"./encounter_guidelines-B_HUUYYh.js";import"./GuidelineEngine-D6V1_Znr.js";class T extends C{constructor(t,i){super(t,186,i)}}const G=y({__name:"CxCaScreeningResult",setup(f){let t;const i=c([]),s=c(""),{patientDashboardUrl:m,goToNextTask:_,goToPatientDashboard:b}=L(async(e,o)=>{t=new T(o,e),s.value=await t.getFirstValueCoded("CxCa screening method"),i.value=h()});async function V(e,o){var u,d;if(!await t.createEncounter())return p("Unable to create encounter");const l=await N(o);if(((u=e.treatment_option)==null?void 0:u.value)==="Referral"){const S=(d=T.getLocationName())!=null?d:"";l.push(t.buildValueText("Referral location",S))}await t.saveObservationList(l),P("Observations and encounter created!"),_()}function g(e){return e||(p("No screening methods have been selected"),b()),/via/i.test(e)?["VIA Negative","VIA Positive","Suspect Cancer"]:/smear/i.test(e)?["PAP Smear Normal","PAP Smear Abnormal"]:/HPV DNA/i.test(e)?["HPV positive","HPV negative"]:/Speculum/i.test(e)?["Visible Lesion","No visible Lesion","Suspect Cancer","Other Gynae"]:[]}function h(){return[{id:"results_available",helpText:"Screening result available",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>v(),computedValue:e=>({obs:t.buildValueCoded("Screening results available",e.value)})},{id:"screening_result",helpText:"Screening Result",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(g(s.value)),condition(e){return e.results_available.value==="Yes"},computedValue:e=>({obs:t.buildValueCoded("Screening results",e.value)})},{id:"gynae_options",helpText:"Other Gynae treatment",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["STI","Cervicitis"]),condition(e){return e.screening_result.value==="Other Gynae"},computedValue:e=>({obs:t.buildValueCoded("Screening results",e.value)})},{id:"offer_via",helpText:"Offer VIA",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>v(),condition(e){return e.screening_result.value==="HPV positive"},computedValue:e=>({obs:t.buildValueCoded("Patient went for VIA?",e.value)})},{id:"via_screening_results",helpText:"VIA screening results",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["VIA negative","VIA positive","Suspect cancer"]),condition(e){return e.offer_via.value==="Yes"},computedValue:e=>({obs:t.buildValueCoded("VIA Results",e.value)})},{id:"reason_for_not_offering_via",helpText:"Reason for NOT offering VIA",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["Client NOT ready","Treatment not available","Other conditions"]),condition(e){return e.offer_via.value==="No"},computedValue:e=>({obs:t.buildValueCoded("Other reason for not seeking services",e.value)})},{id:"further_details_via",helpText:"Further details",type:n.TT_TEXT,validation:e=>r.required(e),computedValue:e=>({obs:t.buildValueText("Other reason for not seeking services",e.label)}),condition:e=>e.reason_for_not_offering_via.value==="Other conditions"||e.reason_for_not_offering_via.value==="Treatment not available"},{id:"treatment_option",helpText:"Enter treatment option",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["Same day treatment","Postponed treatment","Referral"]),condition(e){return!["VIA Negative","No visible Lesion","PAP Smear Normal","HPV negative"].includes(e.screening_result.value)},computedValue:e=>({obs:t.buildValueCoded("Directly observed treatment option",e.value)})},{id:"postponed_reason",helpText:"Select reason for postponing treatment",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["Client not ready","Treatment not available","Other conditions"]),condition(e){return e.treatment_option.value==="Postponed treatment"},computedValue:e=>({obs:t.buildValueCoded("Postponed reason",e.value)})},{id:"referral_rreason",helpText:"Referral reason",type:n.TT_SELECT,validation:e=>r.required(e),options:()=>a(["Further Investigation and Management","Large Lesion (Greater than 75 percent)","Unable to treat client","Suspect Cancer","Treatment not available","Other conditions"]),condition(e){return e.treatment_option.value==="Referral"},computedValue:e=>({obs:t.buildValueCoded("Referral reason",e.value)})},{id:"further_details_referral",helpText:"Further details",type:n.TT_TEXT,validation:e=>r.required(e),computedValue:e=>({obs:t.buildValueText("Referral reason",e.label)}),condition:e=>e.referral_rreason.value==="Other conditions"||e.referral_rreason.value==="Unable to treat client"}]}return(e,o)=>(E(),x(A,{fields:i.value,onFinishAction:V,skipSummary:!1,cancelDestinationPath:O(m)},null,8,["fields","cancelDestinationPath"]))}});export{G as default};
