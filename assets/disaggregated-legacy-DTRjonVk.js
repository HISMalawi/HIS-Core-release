System.register(["./index-legacy-CZA-oEdM.js","./disaggregated_service-legacy-DbE11_rf.js","./TableView-legacy-B074XVYw.js","./v2utils-legacy-BX0xyZSt.js","./regimen_report_service-legacy-RRtJNKE5.js","./Export-legacy-DJeT-aNB.js","./index-legacy-D7SSAUEF.js"],(function(e,a){"use strict";var t,n,r,o,l,i,s,u,c,g,d,p,f,v,m,b,D,h,y,F,P,x,A,R;return{setters:[e=>{t=e.d,n=e.a5,r=e.cm,o=e.r,l=e.t,i=e.aH,s=e.ad,u=e.O,c=e.cc,g=e.c$,d=e.ah,p=e.d1,f=e.cP,v=e.aq,m=e.a6,b=e.v,D=e.w,h=e.ab,y=e.u,F=e.x},e=>{P=e.D},e=>{x=e.v},e=>{A=e.A},e=>{R=e.R},null,null],execute:function(){const a=t({components:{IonPage:n,IonLoading:r,v2Datatable:x},setup(){const e=o([]),a=o(""),t=o(""),n=o(!1),r=new P,m=o([]),b=async e=>{(await v.create({component:A,backdropDismiss:!1,cssClass:"large-modal",componentProps:{...e,subtitle:a.value,onFinish:()=>v.getTop().then((e=>e&&v.dismiss()))}})).present()},D=(e,a)=>({ref:a,label:e,defaultValue:"0",toValue:e=>e.length,tdClick:async e=>{e.refData.length&&b({patientIdentifiers:e.refData,title:`${e.data.age_group} ${e.data.gender} ${e.column.label}`})}}),h=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},D("TX curr (receiving ART)","tx_curr"),...R.map((e=>D(e,e))),D("Unknown","N/A"),D("Total (regimen)","total")]],y=async(a=!1)=>{if(!r.startDate||!r.endDate)return u("Start date and end date required!");n.value=!0;try{m.value=[],e.value=[];const t=(await r.getDisaggReport(a,"pepfar")).reduce(((e,a)=>{if(/unknown/i.test(a.age_group))return e;const t=`${a.gender}`.toUpperCase();return e[t]&&e[t].push({...a,gender:c(a.gender)}),["M","F"].includes(t)&&!/all/i.test(a.age_group)&&(e.totalAlive=[...e.totalAlive,...a.tx_curr]),e}),{M:[],F:[],FP:[],FBF:[],FNP:[],totalAlive:[]});e.value=[...t.F,...t.M,...t.FP,...t.FNP,...t.FBF].map(((e,a)=>({index:a+1,...e}))),m.value=[{text:`Total alive and on ART: <b>${t.totalAlive.length}</b>`,icon:g,color:"primary",action:()=>b({patientIdentifiers:t.totalAlive,title:`Total alive and on ART: ${t.totalAlive.length}`})}]}catch(o){const e="Unable to generate report!";d(e),m.value=[{text:e,color:"danger",icon:p,action:function(){m.value=[{text:`Exception occured: <b>${o}</b>`,color:"danger",icon:p}]}}]}n.value=!1,t.value=""},F=(e=!1)=>f({onFinish:(t,n,o,l)=>{a.value=o,r.startDate=t,r.endDate=n,l&&r.setOccupation(l),r.setQuarter("pepfar"),y(e)}});return l((()=>F(!1))),{Img:i,onRegenerate:async()=>y(await s("Do you want to rebuild report?")),headerBadge:m,reportData:e,isLoading:n,configure:F,generate:y,columns:h,period:a}}});e("default",m(a,[["render",function(e,a,t,n,r,o){const l=h("ion-loading"),i=h("v2Datatable"),s=h("ion-page");return y(),b(s,null,{default:D((()=>[F(l,{"is-open":e.isLoading,message:"Please wait.."},null,8,["is-open"]),F(i,{"icon-url":e.Img("login-logos/PEPFAR.png"),title:"PEPFAR Disaggregated Report","report-prefix":"Pepfar",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,onConfigure:e.configure,onRefresh:e.onRegenerate,headerBadge:e.headerBadge},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh","headerBadge"])])),_:1})}]]))}}}));
