import{d as J,R as K,W,aX as X,a1 as Z,S as x,Q as ee,a3 as te,a4 as ne,U as se,cK as oe,an as ae,r as Y,ap as S,aG as le,cQ as re,cR as ce,cS as ue,cT as ie,cU as de,dM as he,b4 as me,aj as R,bu as pe,aJ as T,a6 as fe,ab as b,u as r,B as u,x as m,w as d,z as F,Z as f,H as $,G as c,v as O,E as y,C as k,a_ as V}from"./index-uMA-i4im.js";import{b as ye,t as _e}from"./Export-CcDNIGhh.js";const be=J({components:{IonToolbar:K,IonItem:W,IonIcon:X,IonLabel:Z,IonTitle:x,IonHeader:ee,IonButton:te,IonFooter:ne,IonContent:se,IonButtons:oe},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(t){const p=ae(),M=Y([]),U=Y(""),A=Y("desc"),G=S(()=>t.columns.slice(0,2)),z=S(()=>{var e;const n=[];return(e=t.columnData[0])==null||e.forEach(s=>{const o=t.columns[1].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),I=S(()=>{var e;const n=[];return(e=t.columnData[1])==null||e.forEach(s=>{const o=t.columns[2].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),w=S(()=>{var e;const n=[];return(e=t.columnData[2])==null||e.forEach(s=>{const o=t.columns[3].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),j=S(()=>{var e;const n=[];return(e=t.columnData[3])==null||e.forEach((s,o)=>{const a=t.columns[8+o].map(l=>{let i="";try{T.isEmpty(s)?i="...":typeof l.value=="function"?i=l.value(s):i=s[l.ref]||""}catch(_){i="_ERROR_",console.error(_)}return{column:l,data:s,value:i,[l.ref||"nada"]:i}});n.push({row:a,data:s,searchIndex:[...a,a.map(l=>l.value).join(" ")]})}),n}),H=n=>{U.value=n,A.value=A.value==="asc"?"desc":"asc"},B=()=>{typeof t.onFinish=="function"?t.onFinish():p.push("/")},N=n=>{var e,s;try{typeof((e=n.column)==null?void 0:e.tdClick)=="function"&&((s=n.column)==null||s.tdClick(n));return}catch(o){console.error(o)}},L=()=>t.columns.reduce((n,e)=>n.concat(e),[]).filter(n=>n.value||n.ref),P=()=>{var e;const n=(e=window==null?void 0:window.document)==null?void 0:e.getElementById("report-content");ye("\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ".concat(n.innerHTML,"    \n                </body>\n                </html>\n            "))},Q=()=>{const n=_=>_.map(v=>v.map(C=>t.order.map(D=>{const g=C[D];return Array.isArray(g)?g.length:g}).filter(D=>D!==void 0)).filter(C=>C.length>0)).filter(v=>v.length>0),e=_=>_.map(E=>{const[v]=Object.keys(E),C=E[v],D=Array.isArray(C)?C.length:0,g=[v,D];for(let q=0;q<5;q++)g.push("");return g}),s=n(t.columnData),o=e(t.columnData[3]),a=s.flat();o.forEach(_=>{a.push(_)});const l="".concat(R.getLocationName()||"Unknown site","-").concat(t.title,"-").concat(t.subtitle,"-").concat(R.getSessionDate()),i=()=>{const _=[...a],E=[0,9,18,27],v=t.csvSubHeader.length;return E.forEach((C,D)=>{const g=t.csvSubHeader[D%v];_.splice(C,0,[...g])}),_};_e([t.headers],[...i(),["Date Created: ".concat(pe().format("DD/MMM/YYYY HH:MM:ss"))],["Quarter: ".concat(t.csvQuarter||t.subtitle)],["HIS-Core Version: ".concat(R.getCoreVersion())],["API Version: ".concat(R.getApiVersion())],["Site UUID: ".concat(R.getSiteUUID())],["Generated by: ".concat(R.getUserName())]],l)},h=n=>{n.forEach(e=>{const s=L().map(o=>{let a="";try{T.isEmpty(e)?a="...":typeof o.value=="function"?a=o.value(e):a=e[o.ref]||""}catch(l){a="_ERROR_",console.error(l)}return{column:o,data:e,value:a,[o.ref||"nada"]:a}});M.value.push({row:s,data:e,searchIndex:[...s,s.map(o=>o.value).join(" ")]})})};return le(()=>t.columnData,n=>{M.value=[],Array.isArray(n)&&h(n)},{immediate:!0,deep:!0}),{sortColumn:H,onClickTablecell:N,toPDF:P,toCSV:Q,finish:B,columnsMinusOne:G,sync:re,search:ce,close:ue,arrowUp:ie,arrowDown:de,document:he,calendar:me,sortOrder:A,sectionOne:z,sectionTwo:I,sectionThree:w,sectionTotals:j,columnSorted:U}}}),ke={key:0},ve={class:"his-sm-text"},Ce={id:"report-content"},ge={class:"art-report-theme"},we={class:"stick-report-header"},De=["colspan","rowspan","onClick"],Re={colspan:7},Ie={class:"his-sm-text"},Ee=["onClick"],Se={class:"his-sm-text"},Te={colspan:7},$e={class:"his-sm-text"},Ae=["onClick"],He={class:"his-sm-text"},Fe={colspan:7},Oe={class:"his-sm-text"},Ve=["onClick"],Me={class:"his-sm-text"},Ue={colspan:7},ze={class:"his-sm-text"},je={colspan:"2"},Be={class:"his-sm-text"},Ne={colspan:"6"},Le=["onClick"];function Pe(t,p,M,U,A,G){const z=b("ion-title"),I=b("ion-icon"),w=b("ion-button"),j=b("ion-buttons"),H=b("ion-toolbar"),B=b("ion-header"),N=b("ion-label"),L=b("ion-item"),P=b("ion-content"),Q=b("ion-footer");return r(),u(y,null,[m(B,null,{default:d(()=>[m(H,null,{default:d(()=>[m(z,{class:"his-md-text"},{default:d(()=>[F(f(t.title)+" ",1),t.subtitle?(r(),u("br",ke)):$("",!0),c("span",ve,f(t.subtitle),1)]),_:1}),m(j,{slot:"end"},{default:d(()=>[typeof t.onConfigure=="function"?(r(),O(w,{key:0,onClick:t.onConfigure},{default:d(()=>[m(I,{size:"large",icon:t.calendar},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0),typeof t.onRefresh=="function"?(r(),O(w,{key:1,onClick:t.onRefresh,color:"success",size:"large"},{default:d(()=>[m(I,{size:"large",icon:t.sync},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0)]),_:1})]),_:1})]),_:1}),m(P,{"scroll-y":"","scroll-x":""},{default:d(()=>[c("div",Ce,[c("table",ge,[c("thead",we,[(r(!0),u(y,null,k(t.columnsMinusOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(y,null,k(h,(e,s)=>{var o,a;return r(),u("th",{key:s,colspan:((o=e==null?void 0:e.span)==null?void 0:o.thColspan)||1,rowspan:((a=e==null?void 0:e.span)==null?void 0:a.thRowspan)||1,onClick:l=>t.sortColumn(e.ref)},[m(L,{lines:"none"},{default:d(()=>[t.columnSorted&&t.columnSorted===e.ref?(r(),O(I,{key:0,icon:t.sortOrder==="asc"?t.arrowUp:t.arrowDown},null,8,["icon"])):$("",!0),n<t.columns.length-1?(r(),O(N,{key:1,class:"ion-text-center"},{default:d(()=>[c("b",null,f(e.label),1)]),_:2},1024)):$("",!0)]),_:2},1024)],8,De)}),128))]))),128))]),c("tbody",null,[c("tr",null,[c("td",Re,[c("span",Ie,f(t.columns[4][0].label),1)])]),(r(!0),u(y,null,k(t.sectionOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(y,null,k(h.row||[],(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("b",Se,f(e.value),1)],10,Ee)}),128))]))),128)),c("tr",null,[c("td",Te,[c("span",$e,f(t.columns[5][0].label),1)])]),(r(!0),u(y,null,k(t.sectionTwo,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(y,null,k(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",He,f(e.value),1)],10,Ae)}),128))]))),128)),c("tr",null,[c("td",Fe,[c("span",Oe,f(t.columns[6][0].label),1)])]),(r(!0),u(y,null,k(t.sectionThree,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(y,null,k(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",Me,f(e.value),1)],10,Ve)}),128))]))),128)),c("tr",null,[c("td",Ue,[c("span",ze,f(t.columns[7][0].label),1)])]),(r(!0),u(y,null,k(t.sectionTotals,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(y,null,k(h.row,(e,s)=>{var o;return r(),u(y,{key:s},[c("td",je,[c("span",Be,f(e.column.label),1)]),c("td",Ne,[c("span",{class:V(["his-sm-text",{"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick}]),onClick:()=>t.onClickTablecell(e)},f(e.value),11,Le)])],64)}),128))]))),128))])])])]),_:1}),m(Q,null,{default:d(()=>[m(H,{color:"dark"},{default:d(()=>[m(w,{onClick:p[0]||(p[0]=h=>t.toCSV()),size:"large"},{default:d(()=>p[2]||(p[2]=[F(" CSV ")])),_:1}),m(w,{onClick:p[1]||(p[1]=h=>t.toPDF()),size:"large"},{default:d(()=>p[3]||(p[3]=[F(" PDF ")])),_:1}),m(w,{onClick:t.finish,color:"success",size:"large",slot:"end"},{default:d(()=>p[4]||(p[4]=[F(" Finish ")])),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const Ge=fe(be,[["render",Pe],["__scopeId","data-v-663672d2"]]);export{Ge as v};
