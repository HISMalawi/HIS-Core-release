import{_ as B}from"./FieldMixin.vue_vue_type_script_lang-x6nXcbrX.js";import{d as H,k as O,bq as q,cO as x,cS as P,aq as z,as as G,ar as W,br as j,cy as J,cz as K,t as Q,O as X,cT as Y,ah as Z,_ as I,r as o,o as i,c as _,w as l,b as n,x as f,B as k,y as v,z as V,u as ee,v as w,A as L,a8 as ae,a9 as le}from"./index-C6EjxQ0a.js";const te=H({name:"HisSelect",mixins:[B],components:{IonTitle:O,IonInput:q,IonRadioGroup:x,IonRadio:P,IonGrid:z,IonCol:G,IonRow:W,ViewPort:j},setup(){return{arrowUp:J,arrowDown:K}},data:()=>({selected:"",listData:[]}),mounted(){this.init()},activated(){this.init()},methods:{async init(){this.$emit("onFieldActivated",this),this.listData=await this.options(this.fdata),this.listData.length&&(this.selected=this.listData[0].label)},warn(e){Q(e)},async launchModal(e,d){(await X.create({component:Y,backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:e,onFinish:d}})).present()},async editField(e,d){const h=a=>{var r,u,c;e.value=a,typeof((r=e==null?void 0:e.field)==null?void 0:r.computedValue)=="function"&&(e.computedValue=(u=e==null?void 0:e.field)==null?void 0:u.computedValue(a)),typeof((c=e==null?void 0:e.field)==null?void 0:c.onValueUpdate)=="function"&&e.field.onValueUpdate(a,d)};this.launchModal(e.field,a=>{var r,u;if(!Array.isArray(a)&&a.label.match(/unknown/i)&&typeof((u=(r=e.field)==null?void 0:r.config)==null?void 0:u.onUnknownEstimateField)=="function")return this.launchModal(e.field.config.onUnknownEstimateField(),c=>h(c));h(a)})}},watch:{listData:{handler(e){const d=[],h=e.map(a=>a.other.data).reduce((a,r)=>[...a,...r.reduce((u,c)=>[...u,...c],[])],[]).filter(a=>a.required&&a.value===""?(d.push(a.label),!1):!!a.required).map(a=>({label:a.label,value:a.value,other:{obs:a.computedValue}}));if(!Z.isEmpty(d)){this.$emit("onValue",[{label:"_INCOMPLETE_RECORD_ERROR_",value:d.length,other:{incompleteLabels:d}}]);return}this.$emit("onValue",h)},deep:!0}}}),se=e=>(ae("data-v-ba9690fd"),e=e(),le(),e),ne={key:0},ie=se(()=>L("p",null,null,-1));function de(e,d,h,a,r,u){const c=o("ion-radio"),g=o("ion-label"),C=o("ion-item"),A=o("ion-radio-group"),N=o("ion-list"),m=o("ion-col"),R=o("ion-title"),D=o("ion-row"),F=o("ion-input"),$=o("ion-grid"),S=o("view-port");return i(),_(S,null,{default:l(()=>[n($,{class:"view-port-content"},{default:l(()=>[n(D,null,{default:l(()=>[n(m,{size:"4"},{default:l(()=>[n(N,null,{default:l(()=>[n(A,{modelValue:e.selected,"onUpdate:modelValue":d[0]||(d[0]=t=>e.selected=t)},{default:l(()=>[(i(!0),f(k,null,v(e.listData,(t,p)=>(i(),_(C,{detail:"",lines:"none",class:"his-md-text his-card ion-padding",key:p},{default:l(()=>[n(c,{slot:"start",value:t.label},null,8,["value"]),n(g,{innerHTML:t.label},null,8,["innerHTML"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(m,null,{default:l(()=>[(i(!0),f(k,null,v(e.listData,(t,p)=>(i(),f("div",{key:p},[e.selected===t.label?(i(),f("div",ne,[(i(!0),f(k,null,v(t.other.data,(U,T)=>(i(),_($,{style:{"margin-bottom":"10px"},class:"his-card",key:T},{default:l(()=>{var E;return[(E=t==null?void 0:t.other)!=null&&E.rowTitles?(i(),_(D,{key:0,style:{background:"#F8F8F8"}},{default:l(()=>[n(m,{class:"ion-text-center"},{default:l(()=>{var s,b;return[n(R,{class:"his-md-text",innerHTML:(s=t==null?void 0:t.other)!=null&&s.rowTitles&&((b=t==null?void 0:t.other)==null?void 0:b.rowTitles[T])||""},null,8,["innerHTML"])]}),_:2},1024)]),_:2},1024)):V("",!0),ie,(i(!0),f(k,null,v(U,(s,b)=>(i(),_(D,{key:b},{default:l(()=>[n(m,null,{default:l(()=>[s.disabled?(i(),_(C,{key:0,onClick:y=>e.warn("Cannot edit ".concat(s.label)),class:"his-sm-text"},{default:l(()=>[n(g,null,{default:l(()=>[ee(w(s.label),1)]),_:2},1024),n(F,{placeholder:"N/A",slot:"end"})]),_:2},1032,["onClick"])):V("",!0),s.disabled?V("",!0):(i(),_(C,{key:1,class:"his-sm-text",onClick:y=>e.editField(s,e.listData[p].other.data[T])},{default:l(()=>{var y,M;return[n(g,{color:(y=s==null?void 0:s.value)!=null&&y.label?"":"danger"},{default:l(()=>[L("b",null,w(s.label),1)]),_:2},1032,["color"]),n(F,{class:"his-md-text",slot:"end",readonly:!0,value:(M=s==null?void 0:s.value)==null?void 0:M.label,placeholder:"Click to edit"},null,8,["value"])]}),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024))),128))]}),_:2},1024))),128))])):V("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const ue=I(te,[["render",de],["__scopeId","data-v-ba9690fd"]]);export{ue as default};
