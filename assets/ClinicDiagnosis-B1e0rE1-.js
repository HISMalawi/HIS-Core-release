import{R as f}from"./BaseTableReport-D1n0dEos.js";import{d as y,I as b,L as t,cU as x,q as v,P as d,bC as w,ab as l,_ as g,r as c,o as T,c as F,w as C,b as D}from"./index-CZt4BSQf.js";import{_ as $}from"./ReportMixin.vue_vue_type_script_lang-KTz0lrel.js";import"./Export-BOa-_uep.js";import"./HisStandardForm-B93s5uaV.js";import"./TouchScreenForm-JVgeEWDh.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./ToolbarMediumCard-CyRn44E2.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DiinNO5i.js";import"./BasicReportTemplate-B2bgDnCL.js";import"./SIngleTouchField-CGdD-Bed.js";import"./Pagination-CNLqe0_D.js";import"./MultiFieldDateHelper-BeQr4Gt4.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";const M=y({components:{ReportTemplate:f,IonPage:b},mixins:[$],data:()=>({title:"Clinic Diagnosis Report",rows:[],reportService:{},customInfo:{label:"Total Visits",value:0},columns:[[t.thTxt("Age Groups",{sortable:!1,exportable:!1}),t.thTxt("<6 months",{colspan:2,sortable:!1,exportable:!1}),t.thTxt("6 months < 5 yrs",{colspan:2,sortable:!1,exportable:!1}),t.thTxt("5 yrs < 14 yrs",{colspan:2,sortable:!1,exportable:!1}),t.thTxt("> 14 yrs",{colspan:2,sortable:!1,exportable:!1}),t.thTxt("",{sortable:!1,exportable:!1})],[t.thTxt("Diagnosis"),t.thTxt("Female",{value:"Females <6 months"}),t.thTxt("Male",{value:"Males <6 months"}),t.thTxt("Female",{value:"Females 6 months < 5 yrs"}),t.thTxt("Male",{value:"Males 6 months < 5 yrs"}),t.thTxt("Female",{value:"Females 5 yrs < 14 yrs"}),t.thTxt("Male",{value:"Males 5 yrs < 14 yrs"}),t.thTxt("Female",{value:"Females > 14 yrs"}),t.thTxt("Male",{value:"Males > 14 yrs"}),t.thTxt("Total")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async init(r,s){this.reportService=new x,this.reportService.startDate=s.start_date,this.reportService.endDate=s.end_date,this.period=this.reportService.getReportPeriod();try{this.rows=this.buildRows(await this.reportService.getDiagnosisReport());const e=await this.reportService.getAttendance();this.customInfo.value=e.length,this.customInfo.other={click:()=>this.drill(e,"Total Patients Visits")}}catch(e){v("".concat(e))}},totalDiagnosis(r){return Object.values(r).reduce((s,e)=>s+e,0)},getDrillDownColumns(){return[[t.thTxt("First Name"),t.thTxt("Last Name"),t.thTxt("Gender"),t.thTxt("Phone Number"),t.thTxt("Address")]]},drill(r,s){return this.drilldownData(s,this.getDrillDownColumns(),r,async e=>await Promise.all(e.map(async a=>{const n=await d.findByID(a),o=new d(n);return[t.td(o.getGivenName()),t.td(o.getFamilyName()),t.td(w(o.getGender())),t.td(o.getPhoneNumber()),t.td("".concat(o.getCurrentDistrict(),", ").concat(o.getCurrentVillage(),", ").concat(o.getClosestLandmark()))]})))},buildColumn(r,s="Drilldown Data"){return l.isEmpty(r)?t.td(0):t.tdLink(r.length,()=>this.drill(r,s))},buildRows(r){if(l.isEmpty(r))return[];const s=[];return Object.keys(r).forEach(e=>{const a=l.get(r[e],"F.0-5 months",[]),n=l.get(r[e],"M.0-5 months",[]),o=l.get(r[e],"F.6 mth < 5 yrs",[]),i=l.get(r[e],"M.6 mth < 5 yrs",[]),m=l.get(r[e],"F.5-14 yrs",[]),u=l.get(r[e],"M.5-14 yrs",[]),h=l.get(r[e],"F.>= 14 years",[]),p=l.get(r[e],"M.>= 14 years",[]);s.push([t.td(e,{style:{textAlign:"left"}}),this.buildColumn(a,"under 6 months females diagnosed with ".concat(e)),this.buildColumn(n,"under 6 months males diagnosed with ".concat(e)),this.buildColumn(o,"under 5 years females diagnosed with ".concat(e)),this.buildColumn(i,"under 5 years males diagnosed with ".concat(e)),this.buildColumn(m,"under 14 years females diagnosed with ".concat(e)),this.buildColumn(u,"under 14 years males diagnosed with ".concat(e)),this.buildColumn(h,"over 14 years females diagnosed with ".concat(e)),this.buildColumn(p,"over 14 years males diagnosed with ".concat(e)),this.buildColumn([...o,...i,...a,...n,...m,...u,...h,...p],"Total diagnosed with ".concat(e))])}),s.sort((e,a)=>e[0].td<a[0].td?-1:e[0].td>a[0].td?1:0)}}});function _(r,s,e,a,n,o){const i=c("report-template"),m=c("ion-page");return T(),F(m,null,{default:C(()=>[D(i,{title:r.title,rows:r.rows,fields:r.fields,columns:r.columns,period:r.period,reportPrefix:"Clinic",customInfo:r.customInfo,onReportConfiguration:r.init},null,8,["title","rows","fields","columns","period","customInfo","onReportConfiguration"])]),_:1})}const z=g(M,[["render",_]]);export{z as default};
