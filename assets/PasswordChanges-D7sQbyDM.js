import{d as D,r as s,o as b,a as h,c as v,w,b as p,u as l,m as i,g as C,t as P,e as _,D as x,I as V,i as k,f as y}from"./index-DUHy09-D.js";import{v as f}from"./TableView-Cubz3H_T.js";import{D as M}from"./data_verification_service-0Is-IiF9.js";import"./Export-Mg5mHyUQ.js";import"./index-h-mcwuuY.js";const H=D({__name:"PasswordChanges",setup(Y){const c=s([]),d=s(""),n=s(!1),r=new M,g=[[{label:"#",ref:"index"},{label:"User",ref:"provider"},{label:"Count",ref:"count"},{label:"View",ref:"drilldown",toValue:()=>"View",tdClick:async e=>{e.refData.length&&(await i.create({component:f,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e.data.provider,columns:[[{label:"#",ref:"index"},{label:"Date changed",ref:"date",toValue:a=>C(a).format("DD/MMM/YYYY HH:mm:ss")}]],rowsPerPage:100,columnData:e.refData.reduce((a,t,o)=>[...a,{...t,index:o+1}],[]),onFinish:()=>i.getTop().then(a=>a&&i.dismiss())}})).present()}}]],u=async()=>{if(!(r.startDate&&r.endDate))return P("Start date and end date required!");n.value=!0;try{const e=await r.getPasswordChanges();c.value=Object.keys(e).reduce((a,t,o)=>[...a,{index:o+1,provider:t,count:e[t].length,drilldown:e[t]}],[])}catch(e){console.error(e),_("Unable to generate report!")}n.value=!1},m=()=>x({onFinish:(e,a,t)=>{d.value=t,r.startDate=e,r.endDate=a,u()}});return b(()=>m()),(e,a)=>(h(),v(l(y),null,{default:w(()=>[p(l(V),{"is-open":n.value,message:"Please wait.."},null,8,["is-open"]),p(f,{"icon-url":l(k)("reports.png"),title:"Password changes","report-prefix":"Clinic",subtitle:d.value,columns:g,columnData:c.value,rowsPerPage:100,onConfigure:m,onRefresh:u},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{H as default};
