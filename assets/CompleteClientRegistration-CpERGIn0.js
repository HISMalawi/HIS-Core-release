import{d as p,a5 as _,r as C,ei as g,O as v,bD as n,aO as b,bn as s,a6 as F,v as D,w as y,ab as f,u as H,x as P}from"./index-CyYd6aWW.js";import{H as $}from"./HisStandardForm-CuX9K_Ib.js";const k=p({components:{IonPage:_,HisStandardForm:$},setup(){const i=C([]),{htsClient:a}=g(),{visitData:u,visitID:o,nextTask:c,patientDashboardUrl:d}=g({onInitVisit:async()=>{if("".concat(a.givenName," ").concat(a.familyName).toLowerCase()!="unknown unknown")return v("Client already registered");i.value=[n.getGivenNameField(),n.getFamilyNameField(),...b(n.getDobConfig()),n.getHomeRegionField(),n.getHomeDistrictField(),n.getHomeTaField(),n.getHomeVillageField(),{...n.getCurrentRegionField(),summaryMapValue:(t,m,r)=>{if(/use home/i.test("".concat(t.value))){const e=r.person;return[{label:"Current region",value:e==null?void 0:e.current_region},{label:"Current District/Country",value:e==null?void 0:e.current_district},{label:"Current Traditional Authority",value:e==null?void 0:e.current_traditional_authority},{label:"Current village",value:e==null?void 0:e.current_village}]}return{label:"Current Region",value:t.label}}},{...n.getCurrentDistrictField(),condition:t=>!t.current_region.label.match(/foreign|use home/i)},{...n.getCurrentTAfield(),condition:t=>!t.current_region.label.match(/foreign|use home/i)},{...n.getCurrentVillageField(),condition:t=>!t.current_region.label.match(/foreign|use home/i)},...n.getLandmarkFields(),n.getCellNumberField()]}});async function l(t,m){var r,e;s().saveOffline({id:o.value,label:"HTS Full Client Registration",personParams:{npid:a.npid,person:{...((e=(r=u.value)==null?void 0:r.personParams)==null?void 0:e.person)||{},...n.resolvePerson(m)}}}),c(),s().synchronizeRecord(o.value).then(h=>s().saveOffline(h))}return{patientDashboardUrl:d,onFinish:l,fields:i}}});function N(i,a,u,o,c,d){const l=f("his-standard-form"),t=f("ion-page");return H(),D(t,null,{default:y(()=>[P(l,{formLabel:"Additional client information",cancelDestinationPath:i.patientDashboardUrl(),"on-finish-action":i.onFinish,fields:i.fields},null,8,["cancelDestinationPath","on-finish-action","fields"])]),_:1})}const O=F(k,[["render",N]]);export{O as default};
