System.register(["./index-legacy--hxN_V8z.js","./Export-legacy-BAJiCfrv.js","./cxca_report_service-legacy-BbqwPPfY.js","./DrillPatientIds-legacy-DqNc4-wY.js","./PopupKeyboard-legacy-Cmizlmo9.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./TableView-legacy-Bw3PienI.js","./fuse-legacy-CQoBB3MK.js","./HisKeyboard-legacy-C2eWFoVg.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./KbLayouts-legacy-BKvPSxzZ.js","./BaseKeyboard-legacy-B0v61IaY.js","./KbHandler-legacy-De8o5nTq.js","./SIngleTouchField-legacy-X9PnjTsk.js","./TouchScreenForm-legacy-DxIQwsU4.js","./ToolbarMediumCard-legacy-CzmL2SiF.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-TUlObaz7.js","./HisKeypad-legacy-BtDv5qCA.js","./overlays-04a9a43f-legacy-CQAadd9M.js"],(function(e,a){"use strict";var t,n,l,r,o,s,c,i,d,u,g,f,y,p,v,b,m,h,_,I,C,w,k,T,O,S,D,j,x,N,H,A,$,E,R,M,V,F,L,P,z,Y,K,U,Q,q,B,J,W,G,X,Z,ee,ae,te;return{setters:[e=>{t=e.d,n=e.i,l=e.h,r=e.ao,o=e.C,s=e.k,c=e.j,i=e.f,d=e.m,u=e.l,g=e.bd,f=e.J,y=e.K,p=e.M,v=e.a8,b=e.cb,m=e.cc,h=e.cd,_=e.ce,I=e.cf,C=e.cO,w=e.ax,k=e.S,T=e.aZ,O=e.ab,S=e._,D=e.r,j=e.o,x=e.x,N=e.b,H=e.w,A=e.u,$=e.v,E=e.z,R=e.A,M=e.c,V=e.F,F=e.y,L=e.ar,P=e.a2,z=e.I,Y=e.c2,K=e.N,U=e.t,Q=e.q,q=e.c9,B=e.O,J=e.V,W=e.H},e=>{G=e.b,X=e.t},e=>{Z=e.C},e=>{ee=e.D},e=>{ae=e.M},e=>{te=e.F},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var a=C.createElement("style");a.textContent="th[data-v-26464ae3],td[data-v-26464ae3]{width:4%;border-collapse:collapse;text-align:left}td[data-v-26464ae3]{border-bottom:1px solid rgb(165,165,165);padding:.6em;font-weight:500;font-size:.8em}.stick-report-header[data-v-26464ae3]{background:#fff;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:1000}tr[data-v-26464ae3]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-26464ae3]{color:#0645ad;font-weight:600;font-size:1em}\n",C.head.appendChild(a);const ne=t({components:{IonToolbar:n,IonItem:l,IonIcon:r,IonLabel:o,IonTitle:s,IonHeader:c,IonButton:i,IonFooter:d,IonContent:u,IonButtons:g},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]},csvData:{type:Array,default:()=>[]}},setup(e){const a=f(),t=y([]),n=y(""),l=y("desc"),r=p((()=>e.columns.slice(0,1))),o=p((()=>{const a=[];return e.columnData?.forEach((t=>{const n=e.columns[1].map((e=>{let a="",n={},l=1;try{a=O.isEmpty(t)?"...":"function"==typeof e.value?e.value(t):t[e.ref]||""}catch(r){a="_ERROR_",console.error(r)}return"function"==typeof e.dataStyle&&(n=e.dataStyle(t)),"function"==typeof e.colSpan&&(l=e.colSpan(t)),{column:e,data:t,value:a,styling:n,colSpan:l,[e.ref||"nada"]:a}}));a.push({row:n,data:t,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})})),a})),s=a=>{a.forEach((a=>{const n=e.columns.reduce(((e,a)=>e.concat(a)),[]).filter((e=>e.value||e.ref)).map((e=>{let t="",n={},l=1;try{t=O.isEmpty(a)?"...":"function"==typeof e.value?e.value(a):a[e.ref]||""}catch(r){t="_ERROR_",console.error(r)}return"function"==typeof e.dataStyle&&(n=e.dataStyle(a)),"function"==typeof e.colSpan&&(l=e.colSpan(a)),{column:e,data:a,value:t,styling:n,colSpan:l,[e.ref||"nada"]:t}}));t.value.push({row:n,data:a,searchIndex:[...n,n.map((e=>e.value)).join(" ")]})}))};return v((()=>e.columnData),(e=>{t.value=[],Array.isArray(e)&&s(e)}),{immediate:!0,deep:!0}),{sortColumn:e=>{n.value=e,l.value="asc"===l.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(a){console.error(a)}},toPDF:()=>{const e=window?.document?.getElementById("report-content");G(`\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: left;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ${e.innerHTML}    \n                </body>\n                </html>\n            `)},toCSV:()=>{const a=`${k.getLocationName()||"Unknown site"}-${e.title}-${e.subtitle}-${k.getSessionDate()}`;X([e.headers],[...e.csvData,[`Date Created: ${T().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${k.getCoreVersion()}`],[`API Version: ${k.getApiVersion()}`],[`Site UUID: ${k.getSiteUUID()}`],[`Generated by: ${k.getUserName()}`]],a)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():a.push("/")},headerRow:r,sync:b,search:m,close:h,arrowUp:_,arrowDown:I,document:C,calendar:w,sortOrder:l,sectionOne:o,columnSorted:n}}}),le={key:0},re={class:"his-sm-text"},oe={id:"report-content"},se={class:"art-report-theme"},ce={class:"stick-report-header"},ie=["colspan","rowspan","onClick"],de=["onClick","colspan"],ue=S(ne,[["render",function(e,a,t,n,l,r){const o=D("ion-title"),s=D("ion-icon"),c=D("ion-button"),i=D("ion-buttons"),d=D("ion-toolbar"),u=D("ion-header"),g=D("ion-label"),f=D("ion-item"),y=D("ion-content"),p=D("ion-footer");return j(),x(V,null,[N(u,null,{default:H((()=>[N(d,null,{default:H((()=>[N(o,{class:"his-md-text"},{default:H((()=>[A($(e.title)+" ",1),e.subtitle?(j(),x("br",le)):E("",!0),R("span",re,$(e.subtitle),1)])),_:1}),N(i,{slot:"end"},{default:H((()=>["function"==typeof e.onConfigure?(j(),M(c,{key:0,onClick:e.onConfigure},{default:H((()=>[N(s,{size:"large",icon:e.calendar},null,8,["icon"])])),_:1},8,["onClick"])):E("",!0),"function"==typeof e.onRefresh?(j(),M(c,{key:1,onClick:e.onRefresh,color:"success",size:"large"},{default:H((()=>[N(s,{size:"large",icon:e.sync},null,8,["icon"])])),_:1},8,["onClick"])):E("",!0)])),_:1})])),_:1})])),_:1}),N(y,{"scroll-y":"","scroll-x":""},{default:H((()=>[R("div",oe,[R("table",se,[R("thead",ce,[(j(!0),x(V,null,F(e.headerRow,((a,t)=>(j(),x("tr",{key:t},[(j(!0),x(V,null,F(a,((a,n)=>(j(),x("th",{key:n,colspan:a?.span?.thColspan||1,rowspan:a?.span?.thRowspan||1,onClick:t=>e.sortColumn(a.ref)},[N(f,{lines:"none"},{default:H((()=>[e.columnSorted&&e.columnSorted===a.ref?(j(),M(s,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):E("",!0),t<e.columns.length-1?(j(),M(g,{key:1,class:"ion-text-center"},{default:H((()=>[R("b",null,$(a.label),1)])),_:2},1024)):E("",!0)])),_:2},1024)],8,ie)))),128))])))),128))]),R("tbody",null,[(j(!0),x(V,null,F(e.sectionOne,((a,t)=>(j(),x("tr",{key:t},[(j(!0),x(V,null,F(a.row||[],((a,t)=>(j(),x(V,{key:t},["TH"!=a.value?(j(),x("td",{key:0,onClick:()=>e.onClickTablecell(a),class:L({"clickable-cell":a?.column?.tdClick}),colspan:a.colSpan},[R("b",{style:P(a.styling),class:"his-sm-text"},$(a.value),5)],10,de)):E("",!0)],64)))),128))])))),128))])])])])),_:1}),N(p,null,{default:H((()=>[N(d,{color:"dark"},{default:H((()=>[N(c,{onClick:a[0]||(a[0]=a=>e.toCSV()),size:"large"},{default:H((()=>[A(" CSV ")])),_:1}),N(c,{onClick:a[1]||(a[1]=a=>e.toPDF()),size:"large"},{default:H((()=>[A(" PDF ")])),_:1}),N(c,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:H((()=>[A(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-26464ae3"]]),ge=y([]),fe=y(""),ye=y(""),pe=y(""),ve=y(!1),be=y(""),me=y([]),he=t({components:{IonPage:z,IonLoading:Y,v2Datatable:ue},setup(){const e=["screened_disaggregated_by_age","screened_disaggregated_by_hiv_status","screened_disaggregated_by_reason_for_visit","screened_disaggregated_by_screening_method","screening_results_hiv_positive","screening_results_hiv_negative","suspects_disaggregated_by_age","total_treated","total_treated_disaggregated_by_tx_option","referral_reasons","referral_feedback","family_planning"],a=async(e,a)=>{a.length<=0||(await B.create({component:ee,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:pe,patientIdentifiers:a,onFinish:()=>B.getTop().then((e=>e&&B.dismiss()))}})).present()},t=[["family_planning","Offered family planning services"],["referral_feedback","Number of clients with referral feedback"],["referral_reasons","Number of clients referred disaggregated by referral reasons"],["screened_disaggregated_by_age","Number of clients screened for cervical cancer disaggregated by age"],["screened_disaggregated_by_hiv_status","Number of clients screened for cervical cancer disaggregated by HIV status"],["screened_disaggregated_by_reason_for_visit","Number of clients screened for cervical cancer disaggregated by reason for visit"],["screened_disaggregated_by_screening_method","Number of clients screened disaggregated by screening method"],["screening_results_hiv_negative","Cervical cancer screening results (HIV- / unknown)"],["screening_results_hiv_positive","Cervical cancer screening results (HIV+)"],["suspects_disaggregated_by_age","Cervical Cancer suspects disaggregated by age"],["total_treated","Total number of clients treated"],["total_treated_disaggregated_by_tx_option","Number of clients treated disaggregated by treatment option"]],n=[[{label:"indicator #",ref:""},{label:"Name of indicator",ref:""},{label:"value",ref:""},{label:"indicator #",ref:""},{label:"Name of indicator",ref:""},{label:"value",ref:""}],[{label:"Indicator #",ref:"data.indicatorOne",secondaryLabel:"Indicator #",value:e=>e.indicatorOne},{label:"Name of Indicator",ref:"data.nameOfIndicatorOne",secondaryLabel:"Name of Indicator",value:e=>e.nameOfIndicatorOne,dataStyle:e=>"TH"===e.valueOne?{fontWeight:"bold"}:{fontWeight:"normal"},colSpan:e=>"TH"===e.valueOne?2:1},{label:"value",ref:"data.valueOne",secondaryLabel:"Value",value:e=>Array.isArray(e.valueOne)?e.valueOne.length:e.valueOne,tdClick:({data:e})=>a(`${e.indicatorOne} ${e.nameOfIndicatorOne}`,e.valueOne)},{label:"Indicator #",ref:"data.indicatorTwo",secondaryLabel:"Indicator #",value:e=>e.indicatorTwo},{label:"Name of Indicator",ref:"data.nameOfIndicatorTwo",secondaryLabel:"Name of Indicator",value:e=>e.nameOfIndicatorTwo,dataStyle:e=>"TH"===e.valueTwo?{fontWeight:"bold"}:{fontWeight:"normal"},colSpan:e=>"TH"===e.valueTwo?2:1},{label:"value",ref:"data.valueTwo",secondaryLabel:"Value",value:e=>Array.isArray(e.valueTwo)?e.valueTwo.length:e.valueTwo,tdClick:({data:e})=>a(`${e.indicatorTwo} ${e.nameOfIndicatorTwo}`,e.valueTwo)}]],l=async()=>{if(!fe.value||!ye.value)return U("Start date and end date required!");ve.value=!0,ge.value=[];const a=new Z;a.startDate=fe.value,a.endDate=ye.value;try{const r=(a=>{const t={};return e.forEach((e=>{a[e]&&(t[e]=a[e])})),t})(await a.getClinicReport("SCREENED FOR CXCA")),o=(e=>{const a=[],n=[],l=Object.keys(e);let r,o=0,s=0,c="";return l.forEach((l=>{Object.entries(e[l]).forEach((([e,i])=>{r!=l&&(o+=1,s=0,t.forEach((e=>{e[0]==l&&(l=e[1])})),a.push([o,l,"TH"]),n.push([o,l,""])),Array.isArray(i)?(s+=1,c=o+"."+s,a.push([c,e,i]),n.push([c,e,i])):(a.push([c,e,[]]),n.push([c,e,[]])),r=l}))})),me.value=n,a})(r),s=(l=o,Math.floor(l.length/2)),c=((e,a)=>{const t=[];for(let n=0;n<e.length;n++)t.push(e[n].concat(a[n]));return t})(((e,a)=>e.slice(0,a))(o,s),((e,a)=>e.slice(a))(o,s)),i=O.cloneDeep(c);me.value=((n=i).forEach((e=>{e[2]="TH"===e[2]?" ":e[2],Array.isArray(e[5])&&(e[5]=""+e[5].length),Array.isArray(e[2])&&(e[2]=""+e[2].length,e[5]="TH"===e[5]?" ":e[5])})),n);const d=c.map((e=>({indicatorOne:e[0],nameOfIndicatorOne:e[1],valueOne:e[2],indicatorTwo:e[3],nameOfIndicatorTwo:e[4],valueTwo:e[5]})));ge.value=d}catch(r){Q("Unable to generate report!"),console.error(r)}var n,l;ve.value=!1},r=()=>ae([{id:"year",helpText:"Select Year",type:te.TT_NUMBER,computedValue:e=>e.value,validation:e=>{const a=O.isPlainObject(e)?e.value:-1;return J.validateSeries([()=>J.required(e),()=>isNaN(parseInt(`${a}`))?["Invalid year"]:null,()=>J.rangeOf(e,2e3,W.getYear(k.getSessionDate()))])}},{id:"month",helpText:"Select Month",type:te.TT_SELECT,validation:e=>J.required(e),computedValue:e=>e.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}],(e=>{fe.value=`${e.year.value}-${e.month.value}-01`,ye.value=T(new Date(fe.value).toISOString()).endOf("month").format("YYYY-MM-DD"),pe.value=`Period (${q(fe.value)} to ${q(ye.value)})`,B.dismiss(),be.value=`${q(fe.value)} to ${q(ye.value)}`,l()}));return K((()=>!ge.value.length&&r())),{columns:n,isLoading:ve,reportData:ge,period:pe,csvQuarter:be,generate:l,configure:r,order:["age_group","cryotherapy","thermocoagulation","leep","via_deffered","via_reffered","suspected_reffered"],csvheaders:["Indicator #","Name of Indicator","Value","Indicator #","Name of Indicator","Value"],spacing:5,csvData:me}}});e("default",S(he,[["render",function(e,a,t,n,l,r){const o=D("ion-loading"),s=D("v2Datatable"),c=D("ion-page");return j(),M(c,null,{default:H((()=>[N(o,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),N(s,{title:"MONTHLY MOH Report",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:25,onConfigure:e.configure,csvQuarter:e.csvQuarter,onRefresh:()=>e.generate(),order:e.order,headers:e.csvheaders,"csv-spacing":e.spacing,"csv-data":e.csvData},null,8,["subtitle","columns","columnData","onConfigure","csvQuarter","onRefresh","order","headers","csv-spacing","csv-data"])])),_:1})}]]))}}}));
