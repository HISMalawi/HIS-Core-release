System.register(["./index-legacy-DCqMHtVA.js","./ReportDateSelectionPrompt-legacy-C164IJ-9.js","./disaggregated_service-legacy-DzkSD6WS.js","./TableView-legacy-7Qk78yFq.js","./ArtDrilldown-legacy-BN1APzo5.js","./regimen_report_service-legacy-C9aISAC7.js","./fuse-legacy-CQoBB3MK.js","./Export-legacy-DXJPpqRT.js","./HisKeyboard-legacy-D5WWwS7Y.js"],(function(e,t){"use strict";var a,n,r,o,l,i,s,c,g,u,d,p,f,v,m,b,D,y,h,P,A,F,R,w;return{setters:[e=>{a=e.d,n=e.I,r=e.ch,o=e.K,l=e.N,i=e.ac,s=e.n,c=e.t,g=e.bK,u=e.cu,d=e.q,p=e.cw,f=e.O,v=e._,m=e.r,b=e.o,D=e.c,y=e.w,h=e.b},e=>{P=e.D},e=>{A=e.D},e=>{F=e.v},e=>{R=e.A},e=>{w=e.R},null,null,null],execute:function(){const t=a({components:{IonPage:n,IonLoading:r,v2Datatable:F},setup(){const e=o([]),t=o(""),a=o(""),n=o(!1),r=new A,v=o([]),m=async e=>{(await f.create({component:R,backdropDismiss:!1,cssClass:"large-modal",componentProps:{...e,subtitle:t.value,onFinish:()=>f.getTop().then((e=>e&&f.dismiss()))}})).present()},b=(e,t)=>({ref:t,label:e,defaultValue:"0",toValue:e=>e.length,tdClick:async e=>{e.refData.length&&m({patientIdentifiers:e.refData,title:`${e.data.age_group} ${e.data.gender} ${e.column.label}`})}}),D=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},b("TX curr (receiving ART)","tx_curr"),...w.map((e=>b(e,e))),b("Unknown","N/A"),b("Total (regimen)","regimen_total")]],y=async(t=!1)=>{if(!r.startDate||!r.endDate)return c("Start date and end date required!");n.value=!0;try{v.value=[],e.value=[];const a=(await r.getDisaggReport(t,"pepfar")).reduce(((e,t)=>{if(/unknown/i.test(t.age_group))return e;const a=`${t.gender}`.toUpperCase();return e[a]&&e[a].push({...t,gender:g(t.gender)}),["M","F"].includes(a)&&!/all/i.test(t.age_group)&&(e.totalAlive=[...e.totalAlive,...t.tx_curr]),e}),{M:[],F:[],FP:[],FBF:[],FNP:[],totalAlive:[]});e.value=[...a.F,...a.M,...a.FP,...a.FNP,...a.FBF].map(((e,t)=>({index:t+1,...e}))),v.value=[{text:`Total alive and on ART: <b>${a.totalAlive.length}</b>`,icon:u,color:"primary",action:()=>m({patientIdentifiers:a.totalAlive,title:`Total alive and on ART: ${a.totalAlive.length}`})}]}catch(o){const e="Unable to generate report!";d(e),v.value=[{text:e,color:"danger",icon:p,action:function(){v.value=[{text:`Exception occured: <b>${o}</b>`,color:"danger",icon:p}]}}]}n.value=!1,a.value=""},h=(e=!1)=>P({onFinish:(a,n,o,l)=>{t.value=o,r.startDate=a,r.endDate=n,l&&r.setOccupation(l),r.setQuarter("pepfar"),y(e)}});return l((()=>h(!0))),{Img:i,onRegenerate:async()=>y(await s("Do you want to rebuild report?")),headerBadge:v,reportData:e,isLoading:n,configure:h,generate:y,columns:D,period:t}}});e("default",v(t,[["render",function(e,t,a,n,r,o){const l=m("ion-loading"),i=m("v2Datatable"),s=m("ion-page");return b(),D(s,null,{default:y((()=>[h(l,{"is-open":e.isLoading,message:"Please wait.."},null,8,["is-open"]),h(i,{"icon-url":e.Img("login-logos/PEPFAR.png"),title:"PEPFAR Disaggregated Report","report-prefix":"Pepfar",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,onConfigure:e.configure,onRefresh:e.onRegenerate,headerBadge:e.headerBadge},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh","headerBadge"])])),_:1})}]]))}}}));
