System.register(["./tb_report_service-legacy-DlIToC3b.js","./ReportMixin.vue_vue_type_script_lang-legacy-BzyImNXI.js","./TableReportTemplate-legacy-VaR5EkPy.js","./index-legacy-BN_YNxvw.js","./BasicReportTemplate-legacy-CFsGDo-r.js","./Export-legacy-BlZw841R.js","./index-legacy-B7ObpNWg.js","./Pagination-legacy-Bypdo5rg.js","./HisStandardForm-legacy-SfmqjxzI.js","./ReportErrors-legacy-DWaXZU5m.js"],(function(t,e){"use strict";var o,a,s,n,l,r,i,u,d,T,m,c,h,p,_,R;return{setters:[t=>{o=t.T},t=>{a=t._},t=>{s=t.R},t=>{n=t.d,l=t.I,r=t.as,i=t.aV,u=t.aN,d=t.ao,T=t.H,m=t.aa,c=t.c,h=t.w,p=t.af,_=t.a,R=t.b},null,null,null,null,null,null],execute:function(){var e=(t=>(t.WITHOUT_PROGRAM="WITHOUT PROGRAM",t.WITHOUT_TB_NUMBER="WITHOUT TB NUMBER",t.BAD_TB_NUMBER="BAD TB NUMBER",t.IN_TREATMENT_BUT_COMPLETED="IN TREATMENT BUT COMPLETED",t.WITH_DISPENSATION_ANOMALIES="WITH DISPENSATION ANOMALIES",t.WITH_UNKNOWN_OUTCOME="WITH UNKNOWN OUTCOME",t.WITH_DUPLICATE_TB_NUMBER="WITH DUPLICATE TB NUMBER",t))(e||{});class N extends o{constructor(){super()}getDataToolReport(t){return o.getJson("tb_data_cleaning_tools",this.buildRequestParams({context:t}))}}const w=n({mixins:[a],components:{ReportTemplate:s,IonPage:l},data:()=>({title:"Data cleaning report",rows:[],columns:[[r.thTxt("National ID"),r.thTxt("TB Number"),r.thTxt("Name"),r.thTxt("Gender"),r.thTxt("Birthdate"),r.thTxt("Residence"),r.thTxt("State")]],defaultIndicator:{}}),created(){this.fields=[...i({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}}),...i({id:"end_date",helpText:"End",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}})],this.defaultIndicator=u.find(this.getIndicatorOptions(),{label:this.$route.query.case})||null},methods:{async onPeriod(t,e){const o=t=>T.toStandardHisDisplayFormat(t);this.rows=[];const a=this.defaultIndicator;this.title=a.label,this.columns=a.other.columns,this.report=new N,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=`${o(e.start_date)} - ${o(e.end_date)}`;const s=await this.report.getDataToolReport(a.value);console.log(a,s),u.isNull(s)||(this.rows=await Promise.all(s.map((t=>a.other.formatRow(t)))))},mapRow(t){return[r.td(t.identifier||"N/A"),r.td(t.tb_number||"N/A"),r.tdLink(t.name,(()=>this.$router.push({path:`/patient/dashboard/${t.patient_id}`}))),r.td(t.gender||"N/A"),r.td(t.birthdate||"N/A"),r.td(t.residence||"N/A"),r.td(t.state||"N/A")]},getIndicatorOptions(){return[{label:"without program",value:e.WITHOUT_PROGRAM,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with duplicate tb number",value:e.WITH_DUPLICATE_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with unknown outcome",value:e.WITH_UNKNOWN_OUTCOME,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with dispensation anomalies",value:e.WITH_DISPENSATION_ANOMALIES,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"in treatment but completed",value:e.IN_TREATMENT_BUT_COMPLETED,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"bad tb number",value:e.BAD_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"without tb number",value:e.WITHOUT_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}}]}}});t("default",m(w,[["render",function(t,e,o,a,s,n){const l=p("report-template"),r=p("ion-page");return _(),c(r,null,{default:h((()=>[R(l,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
