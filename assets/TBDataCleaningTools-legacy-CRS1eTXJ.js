System.register(["./tb_report_service-legacy-VppZarxj.js","./ReportMixin.vue_vue_type_script_lang-legacy-fpsEGsH7.js","./TableReportTemplate-legacy-D4h3Tg8D.js","./index-legacy-BikDJqIc.js","./BasicReportTemplate-legacy-uMYSX7Vt.js","./Export-legacy-B8mC1pNa.js","./index-legacy-CAEFaOWs.js","./Pagination-legacy-CMVcM5rJ.js","./HisStandardForm-legacy-C2hYSmp0.js","./ReportErrors-legacy-Cua_1lvt.js"],(function(t,e){"use strict";var o,a,s,n,r,l,i,u,d,T,m,c,h,p,_,R;return{setters:[t=>{o=t.T},t=>{a=t._},t=>{s=t.R},t=>{n=t.d,r=t.ay,l=t.n,i=t.H,u=t.aZ,d=t.a$,T=t.S,m=t.ak,c=t.ap,h=t.a,p=t.b,_=t.w,R=t.e},null,null,null,null,null,null],execute:function(){var e=(t=>(t.WITHOUT_PROGRAM="WITHOUT PROGRAM",t.WITHOUT_TB_NUMBER="WITHOUT TB NUMBER",t.BAD_TB_NUMBER="BAD TB NUMBER",t.IN_TREATMENT_BUT_COMPLETED="IN TREATMENT BUT COMPLETED",t.WITH_DISPENSATION_ANOMALIES="WITH DISPENSATION ANOMALIES",t.WITH_UNKNOWN_OUTCOME="WITH UNKNOWN OUTCOME",t.WITH_DUPLICATE_TB_NUMBER="WITH DUPLICATE TB NUMBER",t))(e||{});class N extends o{constructor(){super()}getDataToolReport(t){return o.getJson("tb_data_cleaning_tools",this.buildRequestParams({context:t}))}}const E=n({mixins:[a],components:{ReportTemplate:s,IonPage:l},data:()=>({title:"Data cleaning report",rows:[],columns:[[r.thTxt("National ID"),r.thTxt("TB Number"),r.thTxt("Name"),r.thTxt("Gender"),r.thTxt("Birthdate"),r.thTxt("Residence"),r.thTxt("State")]],defaultIndicator:{}}),created(){this.fields=[...d({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>T.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}}),...d({id:"end_date",helpText:"End",required:!0,minDate:()=>"2000-01-01",maxDate:()=>T.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}})],this.defaultIndicator=u.find(this.getIndicatorOptions(),{label:this.$route.query.case})||null},methods:{async onPeriod(t,e){const o=t=>i.toStandardHisDisplayFormat(t);this.rows=[];const a=this.defaultIndicator;this.title=a.label,this.columns=a.other.columns,this.report=new N,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=`${o(e.start_date)} - ${o(e.end_date)}`;const s=await this.report.getDataToolReport(a.value);console.log(a,s),u.isNull(s)||(this.rows=await Promise.all(s.map((t=>a.other.formatRow(t)))))},mapRow(t){return[r.td(t.identifier||"N/A"),r.td(t.tb_number||"N/A"),r.tdLink(t.name,(()=>this.$router.push({path:`/patient/dashboard/${t.patient_id}`}))),r.td(t.gender||"N/A"),r.td(t.birthdate||"N/A"),r.td(t.residence||"N/A"),r.td(t.state||"N/A")]},getIndicatorOptions(){return[{label:"without program",value:e.WITHOUT_PROGRAM,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with duplicate tb number",value:e.WITH_DUPLICATE_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with unknown outcome",value:e.WITH_UNKNOWN_OUTCOME,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with dispensation anomalies",value:e.WITH_DISPENSATION_ANOMALIES,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"in treatment but completed",value:e.IN_TREATMENT_BUT_COMPLETED,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"bad tb number",value:e.BAD_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"without tb number",value:e.WITHOUT_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}}]}}});t("default",m(E,[["render",function(t,e,o,a,s,n){const r=c("report-template"),l=c("ion-page");return p(),h(l,null,{default:_((()=>[R(r,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
