import{_ as S}from"./FieldMixin.vue_vue_type_script_lang-CcBr82Cv.js";import{V as x}from"./ViewPort-DbAo6hHM.js";import{d as B,k as O,bb as P,ct as q,cw as z,ai as G,ak as j,aj as W,cc as J,cd as K,t as Q,O as X,ab as Y,_ as Z,r,o as i,c as _,w as l,b as n,x as f,F as k,y as v,z as V,u as I,v as M,A as L,a3 as ee,a4 as ae}from"./index-DTBWhHAq.js";import{T as le}from"./SIngleTouchField-0q-gpRlN.js";import"./dynamic-import-helper-Bsjrd6Ro.js";const te=B({name:"HisSelect",mixins:[S],components:{IonTitle:O,IonInput:P,IonRadioGroup:q,IonRadio:z,IonGrid:G,IonCol:j,IonRow:W,ViewPort:x},setup(){return{arrowUp:J,arrowDown:K}},data:()=>({selected:"",listData:[]}),mounted(){this.init()},activated(){this.init()},methods:{async init(){this.$emit("onFieldActivated",this),this.listData=await this.options(this.fdata),this.listData.length&&(this.selected=this.listData[0].label)},warn(e){Q(e)},async launchModal(e,o){(await X.create({component:le,backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:e,onFinish:o}})).present()},async editField(e,o){const m=a=>{var d,u,c;e.value=a,typeof((d=e==null?void 0:e.field)==null?void 0:d.computedValue)=="function"&&(e.computedValue=(u=e==null?void 0:e.field)==null?void 0:u.computedValue(a)),typeof((c=e==null?void 0:e.field)==null?void 0:c.onValueUpdate)=="function"&&e.field.onValueUpdate(a,o)};this.launchModal(e.field,a=>{var d,u;if(!Array.isArray(a)&&a.label.match(/unknown/i)&&typeof((u=(d=e.field)==null?void 0:d.config)==null?void 0:u.onUnknownEstimateField)=="function")return this.launchModal(e.field.config.onUnknownEstimateField(),c=>m(c));m(a)})}},watch:{listData:{handler(e){const o=[],m=e.map(a=>a.other.data).reduce((a,d)=>[...a,...d.reduce((u,c)=>[...u,...c],[])],[]).filter(a=>a.required&&a.value===""?(o.push(a.label),!1):!!a.required).map(a=>({label:a.label,value:a.value,other:{obs:a.computedValue}}));if(!Y.isEmpty(o)){this.$emit("onValue",[{label:"_INCOMPLETE_RECORD_ERROR_",value:o.length,other:{incompleteLabels:o}}]);return}this.$emit("onValue",m)},deep:!0}}}),se=e=>(ee("data-v-a4497403"),e=e(),ae(),e),ne={key:0},ie=se(()=>L("p",null,null,-1));function oe(e,o,m,a,d,u){const c=r("ion-radio"),g=r("ion-label"),C=r("ion-item"),A=r("ion-radio-group"),N=r("ion-list"),h=r("ion-col"),R=r("ion-title"),D=r("ion-row"),F=r("ion-input"),$=r("ion-grid"),U=r("view-port");return i(),_(U,null,{default:l(()=>[n($,{class:"view-port-content"},{default:l(()=>[n(D,null,{default:l(()=>[n(h,{size:"4"},{default:l(()=>[n(N,null,{default:l(()=>[n(A,{modelValue:e.selected,"onUpdate:modelValue":o[0]||(o[0]=t=>e.selected=t)},{default:l(()=>[(i(!0),f(k,null,v(e.listData,(t,p)=>(i(),_(C,{detail:"",lines:"none",class:"his-md-text his-card ion-padding",key:p},{default:l(()=>[n(c,{slot:"start",value:t.label},null,8,["value"]),n(g,{innerHTML:t.label},null,8,["innerHTML"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(h,null,{default:l(()=>[(i(!0),f(k,null,v(e.listData,(t,p)=>(i(),f("div",{key:p},[e.selected===t.label?(i(),f("div",ne,[(i(!0),f(k,null,v(t.other.data,(H,T)=>(i(),_($,{style:{"margin-bottom":"10px"},class:"his-card",key:T},{default:l(()=>{var E;return[(E=t==null?void 0:t.other)!=null&&E.rowTitles?(i(),_(D,{key:0,style:{background:"#F8F8F8"}},{default:l(()=>[n(h,{class:"ion-text-center"},{default:l(()=>{var s,b;return[n(R,{class:"his-md-text",innerHTML:(s=t==null?void 0:t.other)!=null&&s.rowTitles&&((b=t==null?void 0:t.other)==null?void 0:b.rowTitles[T])||""},null,8,["innerHTML"])]}),_:2},1024)]),_:2},1024)):V("",!0),ie,(i(!0),f(k,null,v(H,(s,b)=>(i(),_(D,{key:b},{default:l(()=>[n(h,null,{default:l(()=>[s.disabled?(i(),_(C,{key:0,onClick:y=>e.warn("Cannot edit ".concat(s.label)),class:"his-sm-text"},{default:l(()=>[n(g,null,{default:l(()=>[I(M(s.label),1)]),_:2},1024),n(F,{placeholder:"N/A",slot:"end"})]),_:2},1032,["onClick"])):V("",!0),s.disabled?V("",!0):(i(),_(C,{key:1,class:"his-sm-text",onClick:y=>e.editField(s,e.listData[p].other.data[T])},{default:l(()=>{var y,w;return[n(g,{color:(y=s==null?void 0:s.value)!=null&&y.label?"":"danger"},{default:l(()=>[L("b",null,M(s.label),1)]),_:2},1032,["color"]),n(F,{class:"his-md-text",slot:"end",readonly:!0,value:(w=s==null?void 0:s.value)==null?void 0:w.label,placeholder:"Click to edit"},null,8,["value"])]}),_:2},1032,["onClick"]))]),_:2},1024)]),_:2},1024))),128))]}),_:2},1024))),128))])):V("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const fe=Z(te,[["render",oe],["__scopeId","data-v-a4497403"]]);export{fe as default};
