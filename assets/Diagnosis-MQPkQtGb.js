import{O as f}from"./opd_report_service-nys8W8Wf.js";import{R as y}from"./BaseTableReport-wH5Xu9YJ.js";import{d as b,I as x,L as e,ab as l,P as d,_ as v,r as c,o as w,c as g,w as T,b as F}from"./index-iM2cGz0p.js";import{_ as D}from"./ReportMixin.vue_vue_type_script_lang-r1arG92A.js";import"./Export-VO9zGhWb.js";import"./HisStandardForm-tiWNF5wA.js";import"./TouchScreenForm-hvB0I83y.js";import"./dynamic-import-helper-9HnG3Mif.js";import"./ToolbarMediumCard-ny9gUih7.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-4mhPlN2U.js";import"./BasicReportTemplate-Cy-G-sIO.js";import"./SIngleTouchField-TVlhbHrr.js";import"./Pagination-nCJl9BUM.js";import"./MultiFieldDateHelper-BIZNjBD7.js";import"./KbLayouts-9dqmDWmG.js";import"./HisKbConfigurations-a7K7dizM.js";const C=b({components:{ReportTemplate:y,IonPage:x},mixins:[D],data:()=>({title:"OPD Diagnosis",rows:[],reportService:{},customInfo:{label:"Total OPD Visits",value:0},columns:[[e.thTxt("Age Groups",{sortable:!1,exportable:!1}),e.thTxt("<6 months",{colspan:2,sortable:!1,exportable:!1}),e.thTxt("6 months < 5 yrs",{colspan:2,sortable:!1,exportable:!1}),e.thTxt("5 yrs < 14 yrs",{colspan:2,sortable:!1,exportable:!1}),e.thTxt("> 14 yrs",{colspan:2,sortable:!1,exportable:!1}),e.thTxt("",{sortable:!1,exportable:!1})],[e.thTxt("Diagnosis"),e.thTxt("F",{value:"Females <6 months"}),e.thTxt("M",{value:"Males <6 months"}),e.thTxt("F",{value:"Females 6 months < 5 yrs"}),e.thTxt("M",{value:"Males 6 months < 5 yrs"}),e.thTxt("F",{value:"Females 5 yrs < 14 yrs"}),e.thTxt("M",{value:"Males 5 yrs < 14 yrs"}),e.thTxt("F",{value:"Females > 14 yrs"}),e.thTxt("M",{value:"Males > 14 yrs"}),e.thTxt("Total")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async init(r,o){this.reportService=new f,this.reportService.setStartDate(o.start_date),this.reportService.setEndDate(o.end_date),this.period=this.reportService.getDateIntervalPeriod(),this.rows=this.buildRows(await this.reportService.getDiagnosis());const t=await this.reportService.getAttendance();this.customInfo.value=t.length},totalDiagnosis(r){return Object.values(r).reduce((o,t)=>o+t,0)},getDrillDownColumns(){return[[e.thTxt("Patient ID"),e.thTxt("First Name"),e.thTxt("Last Name"),e.thTxt("Gender"),e.thTxt("Phone Number"),e.thTxt("Address")]]},buildColumn(r,o="Drilldown Data"){return l.isEmpty(r)?e.td(0):e.tdLink(r.length,async()=>this.drilldownData(o,this.getDrillDownColumns(),r,async t=>await Promise.all(t.map(async n=>{const a=await d.findByID(n),s=new d(a);return[e.td(n),e.td(s.getGivenName()),e.td(s.getFamilyName()),e.td(s.getGender()),e.td(s.getPhoneNumber()),e.td("".concat(s.getCurrentDistrict(),", ").concat(s.getCurrentVillage(),", ").concat(s.getClosestLandmark()))]}))))},buildRows(r){if(l.isEmpty(r))return[];const o=[];return Object.keys(r).forEach(t=>{const n=l.get(r[t],"F.0-5 months",[]),a=l.get(r[t],"M.0-5 months",[]),s=l.get(r[t],"F.6 mth < 5 yrs",[]),i=l.get(r[t],"M.6 mth < 5 yrs",[]),m=l.get(r[t],"F.5-14 yrs",[]),u=l.get(r[t],"M.5-14 yrs",[]),h=l.get(r[t],"F.>= 14 years",[]),p=l.get(r[t],"M.>= 14 years",[]);o.push([e.td(t,{style:{textAlign:"left"}}),this.buildColumn(n,"under 6 months females diagnosed with ".concat(t)),this.buildColumn(a,"under 6 months males diagnosed with ".concat(t)),this.buildColumn(s,"under 5 years females diagnosed with ".concat(t)),this.buildColumn(i,"under 5 years males diagnosed with ".concat(t)),this.buildColumn(m,"under 14 years females diagnosed with ".concat(t)),this.buildColumn(u,"under 14 years males diagnosed with ".concat(t)),this.buildColumn(h,"over 14 years females diagnosed with ".concat(t)),this.buildColumn(p,"over 14 years males diagnosed with ".concat(t)),this.buildColumn([...s,...i,...n,...a,...m,...u,...h,...p],"Total diagnosed with ".concat(t))])}),o.sort((t,n)=>t[0].td<n[0].td?-1:t[0].td>n[0].td?1:0)}}});function $(r,o,t,n,a,s){const i=c("report-template"),m=c("ion-page");return w(),g(m,null,{default:T(()=>[F(i,{title:r.title,rows:r.rows,fields:r.fields,columns:r.columns,period:r.period,reportPrefix:"Clinic",customInfo:r.customInfo,onReportConfiguration:r.init},null,8,["title","rows","fields","columns","period","customInfo","onReportConfiguration"])]),_:1})}const z=v(C,[["render",$]]);export{z as default};
