System.register(["./index-legacy-DJWxguzi.js","./tx_report_service-legacy-Bsezw1bt.js","./TableView-legacy-DDnFdj55.js","./v2utils-legacy-CD0I0fTY.js","./Export-legacy-Cu5cssuM.js","./index-legacy-CmSc6LiL.js"],(function(e,a){"use strict";var t,n,r,o,l,s,g,i,c,u,d,p,_,m,f,b,h,D,v,w,y,F,x,P;return{setters:[e=>{t=e.d,n=e.I,r=e.cL,o=e.r,l=e.o,s=e.i,g=e.W,i=e.ak,c=e.aN,u=e.da,d=e.au,p=e.ai,_=e.db,m=e.dc,f=e.D,b=e.aa,h=e.c,D=e.w,v=e.af,w=e.a,y=e.b},e=>{F=e.T},e=>{x=e.v},e=>{P=e.A},null,null],execute:function(){const a=t({components:{IonPage:n,IonLoading:r,v2Datatable:x},setup(){const e=o([]),a=o(""),t=o(!1),n=o([]),r=new F;function b(e,a){return{ref:a,label:e,toValue:e=>e.length,tdClick:async e=>{e.refData.length&&(await d.create({component:P,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:`${e.data.age_group} ${e.data.gender} ${e.column.label}`,patientIdentifiers:e.refData,onFinish:()=>d.getTop().then((e=>e&&d.dismiss()))}})).present()}}}const h=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},b("CD4 <200","cd4_less_than_200"),b("CD4 >=200","cd4_greater_than_or_equal_to_200"),b("Unknown CD4","unknown_cd4_count"),b("Not Eligible for CD4","not_eligible_for_cd4"),b("Returned <3 mo","returned_less_than_3_months"),b("Returned 3-5 mo","returned_greater_than_3_months_and_less_than_6_months"),b("Returned 6+ mo","returned_greater_than_or_equal_to_6_months")]],D=async(o=!1)=>{r.startDate&&r.endDate||g("Start date and end date required!");const l=o&&await i("Do you want to rebuild report?");t.value=!0;try{const t=await r.getTxRttReport(l),o={F:"Female",M:"Male"},s=t.reduce(((e,a)=>("Unknown"!=a.age_group&&(e[a.gender].rows.push({...a,gender:o[a.gender]}),e[a.gender].aggregate=Object.keys(a).reduce(((e,t)=>Array.isArray(a[t])?{...e,[t]:[...e[t]||[],...a[t]]}:e),e[a.gender].aggregate)),e)),{M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}});e.value=[...s.F.rows,...s.M.rows,{age_group:"All",gender:"Male",...s.M.aggregate}];const g=Object.values(s.F.aggregate).flat(1),i=await r.getMaternalStatus(c.uniq(g)),p=i.FBf.concat(i.FP);["FP","FNP","FBf"].forEach((a=>{e.value.push(Object.keys(s.F.aggregate).reduce(((e,t)=>({...e,[t]:s.F.aggregate[t].filter((e=>"FNP"===a?!p.includes(e):i[a].includes(e)))})),{age_group:"All",gender:a}))})),e.value=e.value.map(((e,a)=>({index:a+1,...e})));const _=Object.values(s.M.aggregate).flat(1),m=c.uniq([...g,..._]);n.value=[{id:"stats",text:`Total <b>${m.length}</b>`,icon:u,color:"primary",action:async()=>{(await d.create({component:P,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:"Total Clients",subtitle:a.value,patientIdentifiers:m,onFinish:()=>d.getTop().then((e=>e&&d.dismiss()))}})).present()}}]}catch(s){console.error(s),p("Unable to generate report!"),n.value=[{text:"Unable to generate report!",color:"danger",icon:_,action:function(){n.value=[{text:`Exception occured: <b>${s}</b>`,color:"danger",icon:m}]}}]}t.value=!1},v=()=>f({onFinish:(e,t,n,o)=>{a.value=n,r.startDate=e,r.endDate=t,o&&r.setOccupation(o),D()}});return l((()=>v())),{headerBadge:n,reportData:e,isLoading:t,Img:s,configure:v,generate:D,columns:h,period:a}}});e("default",b(a,[["render",function(e,a,t,n,r,o){const l=v("ion-loading"),s=v("v2Datatable"),g=v("ion-page");return w(),h(g,null,{default:D((()=>[y(l,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),y(s,{title:"TX RTT Report","report-prefix":"Pepfar","icon-url":e.Img("login-logos/PEPFAR.png"),subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,headerBadge:e.headerBadge,onConfigure:e.configure,onRefresh:()=>e.generate(!0)},null,8,["icon-url","subtitle","columns","columnData","headerBadge","onConfigure","onRefresh"])])),_:1})}]]))}}}));
