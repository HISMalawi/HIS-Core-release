System.register(["./index-legacy-uRreDP0D.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./HisStandardForm-legacy-U_iL4SQp.js","./TouchScreenForm-legacy-ogo2k9RR.js","./ToolbarMediumCard-legacy-ppaO_MMI.js","./Transformers-legacy-PbfCTy2a.js","./ViewPort-legacy-ItUHAnm-.js"],(function(e,t){"use strict";var i,r,a,s,l,o,n,u,c,d,p,_,v,y,m;return{setters:[e=>{i=e.d,r=e.I,a=e.R,s=e.Y,l=e.q,o=e.V,n=e.aJ,u=e._,c=e.r,d=e.o,p=e.c,_=e.w,v=e.b},e=>{y=e.F},e=>{m=e.H},null,null,null,null],execute:function(){const t=i({components:{HisStandardForm:m,IonPage:r},data:()=>({fields:[]}),created(){this.fields=[this.selectUser(),this.selectUserActivity(),this.limitUserSelection()]},methods:{onFinish(e,t){a.invalidate("CAN_EDIT_ACTIVITIES"),a.invalidate("ART_USER_SELECTED_ACTIVITIES");const i=Object.values(t).map((e=>s.postJson("user_properties",e)));Promise.all(i).then((()=>this.$router.back())).catch((()=>l("Unable to update user activities")))},selectUser(){let e=[];return{id:"user_id",helpText:"Select Username",type:y.TT_SELECT,validation:e=>o.required(e),init:async()=>(e=await s.getAllUsers(),!0),options:()=>e.map((e=>({label:e.username,value:e.user_id,other:e}))),config:{showKeyboard:!0}}},selectUserActivity(){const e={},t=n?.getActiveApp()?.primaryPatientActivites||[];return{id:"activities",helpText:"Preset user activities",type:y.TT_MULTIPLE_SELECT,computedValue:(e,t)=>({user_id:t.user_id.value,property:"activities",property_value:e.map((e=>e.value)).join(",")}),validation:e=>o.required(e),options:async i=>{if(!e[i.user_id.value])try{e[i.user_id.value]=(await s.getJson("user_properties",{user_id:i.user_id.value,property:"activities"})).property_value}catch(r){console.warn(r)}return t.map((t=>{const r=t.workflowID||t.name;return{value:r,label:`${t.name}`.toUpperCase(),isChecked:`${e[i.user_id.value]}`.split(",").some((e=>e.toLowerCase()===r.toLowerCase())),disabled:"boolean"==typeof t.availableOnActivitySelection&&!t.availableOnActivitySelection}}))}}},limitUserSelection:()=>({id:"lock_user_to_art_activities",helpText:"Can user modify activities?",type:y.TT_SELECT,computedValue:(e,t)=>({user_id:t.user_id.value,property:"lock_user_to_art_activities",property_value:e.value}),defaultValue:async e=>{try{return(await s.getJson("user_properties",{user_id:e.user_id.value,property:"lock_user_to_art_activities"})).property_value}catch(t){console.log(t)}},validation:e=>o.required(e),options:()=>[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]})}});e("default",u(t,[["render",function(e,t,i,r,a,s){const l=c("his-standard-form"),o=c("ion-page");return d(),p(o,null,{default:_((()=>[v(l,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0},null,8,["fields","onFinishAction"])])),_:1})}]]))}}}));
