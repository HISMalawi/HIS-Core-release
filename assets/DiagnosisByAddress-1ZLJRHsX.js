import{O as d}from"./opd_report_service-sSYP80o_.js";import{R as c}from"./BaseTableReport-ctgX6onn.js";import{d as m,a5 as u,ao as s,aq as n,aN as h,a6 as f,ab as a,u as g,v as _,w,x as D}from"./index-CyYd6aWW.js";import{_ as v}from"./ReportMixin.vue_vue_type_script_lang-bNARcyGN.js";import{D as C}from"./DrillPatientIds-CPcjFCer.js";import"./HisStandardForm-CuX9K_Ib.js";import"./TableView-KUf7rG9H.js";const b=m({components:{ReportTemplate:c,IonPage:u},mixins:[v],data:()=>({title:"OPD diagnosis by address report",rows:[],reportService:{},columns:[[s.thTxt("Address"),s.thTxt("Diagnosis"),s.thTxt("Count")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async init(e,t){this.reportService=new d,this.reportService.setStartDate(t.start_date),this.reportService.setEndDate(t.end_date),this.period=this.reportService.getDateIntervalPeriod(),this.rows=this.buildRows(await this.reportService.getDiagnosisByAddress())},async drill(e,t){!e||!e.length||(await n.create({component:C,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:t,patientIdentifiers:e,subtitle:this.period,onFinish:()=>n.getTop().then(o=>o&&n.dismiss())}})).present()},totalDiagnosis(e){return Object.values(e).reduce((t,o)=>t+o,0)},buildRows(e){const t=[];if(h.isEmpty(e))return t;for(const o in e)for(const r in e[o]){const i=e[o][r];t.push([s.td(r),s.td(o),s.tdLink(i.length,()=>this.drill(i,r))])}return t}}});function S(e,t,o,r,i,R){const p=a("report-template"),l=a("ion-page");return g(),_(l,null,{default:w(()=>[D(p,{title:e.title,rows:e.rows,fields:e.fields,columns:e.columns,period:e.period,reportPrefix:"Clinic",onReportConfiguration:e.init},null,8,["title","rows","fields","columns","period","onReportConfiguration"])]),_:1})}const O=f(b,[["render",S]]);export{O as default};
