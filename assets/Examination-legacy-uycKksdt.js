System.register(["./EncounterMixin.vue_vue_type_script_lang-legacy-BmCg9KlZ.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./index-legacy-X--GYU37.js","./anc_current_pregnancy-legacy-BVHlCF9N.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./encounter_guidelines-legacy-wNYbMa3T.js","./GuidelineEngine-legacy-KsvQuFdF.js","./HisStandardForm-legacy-DMJkhfrq.js","./TouchScreenForm-legacy-C_f8Ho2H.js","./ToolbarMediumCard-legacy-CdhT4OJW.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-1het9QhE.js","./KbLayouts-legacy-BKvPSxzZ.js"],(function(e,t){"use strict";var i,n,o,a,s,r,l,u,c,d,p,h,v,m,g,T,b;return{setters:[e=>{i=e._},e=>{n=e.F},e=>{o=e.b4,a=e.d,s=e.I,r=e.aS,l=e.V,u=e.ab,c=e.n,d=e._,p=e.r,h=e.o,v=e.c,m=e.w,g=e.b},e=>{T=e.A},e=>{b=e.b},null,null,null,null,null,null,null,null],execute:function(){const t={12:13,13:14,14:16,15:17,16:18,17:19,18:20,19:21,20:22,21:24,22:25,23:25,24:27,25:28,26:29,27:30,28:32,29:33,30:34,31:35,32:36,33:37,34:38,35:39,36:40,37:42};class f extends o{gestationWeeks;constructor(e,t){super(e,98,t),this.gestationWeeks=0}expectedFundalHeightForGestationWeeks(){return this.getEquivalentFundalHeight(this.gestationWeeks)}async loadPregnancyStatus(){const e=await o.getJson(`programs/${this.programID}/patients/${this.patientID}`);if(e&&e.date_of_lnmp){const t=new T(this.patientID,this.providerID);this.gestationWeeks=t.calculateWeekOfFirstVisit(e.date_of_lnmp)}}getEquivalentFundalWeeks(e){return e<12?t[12]:e>37?t[37]:t[e]}getEquivalentFundalHeight(e){for(const i in t)if(e<=t[i])return parseInt(i);return e>42?37:e<13?12:0}}const y=a({components:{IonPage:s},mixins:[i],data:()=>({service:{},statusService:{},deliveryObs:void 0}),watch:{ready:{async handler(e){e&&(this.service=new f(this.patientID,this.providerID),await this.service.loadPregnancyStatus(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,t){await this.service.createEncounter(),await this.service.saveObservationList(await this.resolveObs(t)),this.deliveryObs?.length&&(await this.statusService.createEncounter(),await this.statusService.saveObservationList(await Promise.all(this.deliveryObs))),this.nextTask()},diagnosisOptions(e){return[...r.getConceptsByCategory("anc_diagnosis"),{name:"None"}].map((t=>e({...this.toOption(t.name),isChecked:!1})))},getFields(){return[{id:"ultrasound",helpText:"Ultrasound scan results available",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueCoded("Ultrasound",e.value),options:()=>this.yesNoOptions()},{id:"multiple_gestation",helpText:"Number of fetuses",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueText("Multiple gestation",e.value),condition:e=>"Yes"===e.ultrasound.value,options:()=>[{label:"One",value:1},{label:"Two",value:2},{label:"Three",value:3},{label:"Four",value:4},{label:"Unknown",value:"Unknown"}]},{id:"liquor",helpText:"Liquor",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueText("LIQUOR",e.value),condition:e=>"Yes"===e.ultrasound.value,options:()=>this.mapStrToOptions(["Adequate","Not adequate","Unknown"])},{id:"lie",helpText:"Lie",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueText("Lie",e.value),condition:e=>"Yes"===e.ultrasound.value,options:()=>this.mapStrToOptions(["Longitudinal","Transverse","Unknown"])},{id:"fetal_heart_movement_seen",helpText:"Fetal heart movement seen",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueCoded("Fetal heart movement seen",e.value),condition:e=>"Yes"===e.ultrasound.value,options:()=>this.yesNoOptions()},{id:"presentation",helpText:"Presentation",type:n.TT_GROUP_SELECTOR,validation:e=>this.validateSeries([()=>l.required(e),()=>e&&!e.value?["Presentation cannot be Empty!"]:null,()=>e&&e?.other?.subGroupOptions&&u.isEmpty(e?.other?.subGroupOptionValue)?[`${e?.other?.subgroupTitle||"Subgroup"} has no value selected`]:null,()=>!e||u.isEmpty(e?.other?.subGroupOptionValue)||u.isEmpty(e?.other?.subGroupOptionValue?.other?.options)||e?.other?.subGroupOptionValue?.value?null:[`${e?.other?.subGroupOptionValue?.label}'s value isnt selected`]]),computedValue:e=>{const t=[this.service.buildValueText("Presentation",e.label)];return e?.other?.subGroupOptionValue?.value&&t.push(this.service.buildValueText("Position",e?.other?.subGroupOptionValue?.value)),t},options:e=>{const t=(e,t="",i={})=>({label:e,value:t,other:i}),i=[t("Vertex","",{options:this.mapStrToOptions(["Left Occipito Anterior","Left Occipito Transverse","Left Occipito Posterior","Right Occipito Anterior","Right Occipito Transverse","Right Occipito Posterior","Unknown"])}),this.toOption("Oblique"),this.toOption("Transverse"),this.toOption("Breech",{options:this.mapStrToOptions(["Left Sacro Anterior","Left Sacro Transverse","Left Sacro Posterior","Right Sacro Anterior","Right Sacro Transverse","Right Sacro Posterior","Unknown"])}),t("Face","",{concept:"Position",options:this.mapStrToOptions(["Left Mento Anterior","Left Mento Transverse","Left Mento Posterior","Right Mento Anterior","Right Mento Transverse","Right Mento Posterior","Unknown"])}),t("Shoulder","",{options:this.mapStrToOptions(["Left Acromion Dorsal Anterior","Left Acromion Dorsal Transverse","Left Acromion Dorsal Posterior","Right Acromion Dorsal Anterior","Right Acromion Dorsal Transverse","Right Acromion Dorsal Posterior","Unknown"])})];return e.presentation?e.presentation:[t("Cephalic","",{subGroupOptions:i,subgroupTitle:"Cephalic Position",options:this.mapStrToOptions(["Right Occipito Anterior","Left Occipito Anterior","Unknown"])}),t("Breech","",{subGroupOptions:i,subgroupTitle:"Breech Position",options:this.mapStrToOptions(["Right Sacro Anterior","Left Sacro Anterior","Unknown"])}),this.toOption("Ball"),this.toOption("Nil palpable")]}},{id:"enter_fundal_height",helpText:"Fundal height (cm)",type:n.TT_NUMBER,dynamicHelpText:()=>{const e="Fundal height (cm)";return this.service.gestationWeeks?`${e} (${this.service.gestationWeeks}wks/${this.service.getEquivalentFundalHeight(this.service.gestationWeeks)} cm)`:e},beforeNext:async(e,t)=>{if(e&&`${e.value}`.match(/unknown/i)&&!["Nil palpable","Ball"].includes(t.presentation.value))return!!(await c("Do you want to proceed with Unknown Fundal height?"));const i=this.service.expectedFundalHeightForGestationWeeks(),n=parseInt(e.value);if(this.service.gestationWeeks&&(n<i||n>i)){if(!(await c(`\n                        Fundal height is not equal to expected ${i} cm from gestation weeks of ${this.service.gestationWeeks}.\n                        Are you sure about this value?`)))return!1;this.statusService=new T(this.patientID,this.providerID);const e=this.service.getEquivalentFundalWeeks(n),t=this.statusService.estimateLnmpDate(e);this.deliveryObs=this.statusService.buildDelieveryDateObs(t)}return!0},validation:e=>this.validateSeries([()=>l.required(e),()=>e&&!`${e.value}`.match(/unknown/i)?l.rangeOf(e,10,45):null]),computedValue:e=>"Unknown"!=e.value?this.service.buildValueNumber("Fundus",e.value):this.service.buildObs("Fundus",{value_coded:e.value,value_numeric:0}),config:{keypad:b}},{id:"fetal_heart_beat",helpText:"Fetal heart beat",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueText("Fetal Heart Beat",e.value),options:()=>this.mapStrToOptions(["Heard","Not heard"])},{id:"fetal_heart_rate",helpText:"Fetal heart rate",type:n.TT_NUMBER,validation:e=>l.required(e),beforeNext:async e=>{const t=e?parseInt(e.value):-1;return!e||"number"!=typeof t||!(t<120||t>140)||!!(await c("\n                            The value is out of Range of 120 - 140.\n                            Are you sure about this value?"))},condition:e=>"Heard"===e.fetal_heart_beat.value,computedValue:e=>"Unknown"!=e.value?this.service.buildValueNumber("Fetal heart movement seen",e.value):this.service.buildObs("Fetal heart movement seen",{value_numeric:0,value_coded:e.value}),config:{keypad:b}},{id:"enter_fetal_movement",helpText:"Fetal movement heard",type:n.TT_SELECT,validation:e=>l.required(e),computedValue:e=>this.service.buildValueCoded("Fetal movement heard",`${e.value}`),options:()=>this.yesNoOptions()},{id:"fetal_movement_felt",helpText:"Fetal movement felt",type:n.TT_SELECT,validation:e=>l.required(e),condition:e=>!["Ball","Nil palpable"].includes(e.presentation.label),computedValue:e=>this.service.buildValueCoded("Fetal movement felt",`${e.value}`),options:()=>this.yesNoOptions()},{id:"last_fmf",helpText:"Last fetal movement felt (in Weeks)",type:n.TT_NUMBER,validation:e=>l.validateSeries([()=>l.required(e),()=>l.rangeOf(e,0,42)]),condition:e=>"Unknown"!=e.fetal_movement_felt.value,computedValue:e=>"Unknown"!=e.value?this.service.buildValueNumber("Last Fetal movement felt",e.value):this.service.buildObs("Last Fetal movement felt",{value_numeric:0,value_coded:e.value}),options:()=>this.yesNoUnknownOptions()},{id:"diagnosis",helpText:"Diagnosis",type:n.TT_MULTIPLE_SELECT,validation:e=>l.required(e),computedValue:e=>e&&e.map((e=>e.value)).includes("None")?[]:e.map((e=>this.service.buildValueCoded(e.label,"Yes"))),onValueUpdate:(e,t)=>e.map((e=>("None"===t.value&&"None"!=e.value&&(e.isChecked=!1),"None"!=t.value&&t.isChecked&&"None"===e.value&&(e.isChecked=!1),e))),options:()=>this.diagnosisOptions((e=>e)),config:{footerBtns:[{name:"None",slot:"end",onClickComponentEvents:{refreshOptions:()=>this.diagnosisOptions((e=>(e.isChecked="None"===e.label,e)))},onClick:()=>"None"}]}}]}}});e("default",d(y,[["render",function(e,t,i,n,o,a){const s=p("his-standard-form"),r=p("ion-page");return h(),v(r,null,{default:m((()=>[g(s,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])])),_:1})}]]))}}}));
