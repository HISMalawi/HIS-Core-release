System.register(["./MultiFieldDateHelper-legacy-DRQ-Cbl7.js","./index-legacy-JGk_dRVc.js","./BasicReportTemplate-legacy-ufNdf0U0.js","./opd_report_service-legacy-Bi4XzEGk.js","./MOHReportHeader-legacy-zVgVrxG8.js","./dynamic-import-helper-legacy-DYK5bIOV.js"],(function(t,e){"use strict";var a,r,n,o,i,s,l,d,c,p,h,m,u,D;return{setters:[t=>{a=t.g},t=>{r=t.d,n=t.H,o=t.ab,i=t.L,s=t.O,l=t.V,d=t.a$,c=t.S,p=t.P},t=>{h=t.D},t=>{m=t.O},t=>{u=t.a},t=>{D=t.F}],execute:function(){t("_",r({data:()=>({fields:[],report:{},reportReady:!1,period:"",startDate:"",endDate:"",customFileName:"",drillDownCache:{}}),methods:{toDate:t=>n.toStandardHisDisplayFormat(t),confirmPatient(t){return this.$router.push(`/patients/confirm?person_id=${t}`)},async exportToCustomPDF(t){const e=open("","","width:1024px, height:768px"),a=document.getElementById("report-content");a&&e&&(e.document.write(`\n                    <html>\n                    <head>\n                        <title>${t}</title>\n                        <link rel="stylesheet" media="print" href="/assets/css/cohort.css" />\n                    </head>\n                    <body>\n                        ${a.innerHTML}\n                    </body>\n                    </html>\n                `),setTimeout((()=>{e.print(),e.close()}),3500))},async onDrillDown(t,e){if(o.isEmpty(e))return;const a=[[i.thTxt("First name"),i.thTxt("Last name"),i.thTxt("Gender"),i.thTxt("Age"),i.thTxt("Phone"),i.thTxt("Address"),i.thTxt("Action")]];return this.drilldownData(t,a,e,(async t=>await Promise.all(t.map((async t=>{const e=await p.findByID(t),a=new p(e);return[i.td(a.getGivenName()),i.td(a.getFamilyName()),i.td(a.getGender()),i.td(a.getAge()),i.td(a.getPhoneNumber()),i.td(`${a.getCurrentDistrict()}, ${a.getCurrentVillage()}, ${a.getClosestLandmark()}`),i.tdBtn("Select",(async()=>{await s.dismiss({}),this.$router.push({path:`/patient/dashboard/${t}`})}))]})))))},async drilldownAsyncRows(t,e,a){(await s.create({component:h,cssClass:"large-modal",componentProps:{title:t,columns:e,asyncRows:a,showFilters:!0,rowsPerPage:50,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>s.dismiss()}})).present()},async drilldownData(t,e,a,r){(await s.create({component:h,cssClass:"large-modal",componentProps:{title:t,columns:e,rows:a,rowParser:r,rowsPerPage:50,showFilters:!0,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>s.dismiss()}})).present()},getDefaultDrillDownTable(){return{rowParser:t=>t.map((async t=>{const[e,a]=t;if(a in this.drillDownCache)return[e];const r=await p.findByID(a),n=new p(r),o=[e,i.td(n.getArvNumber()),i.td(n.getGender()),i.tdDate(n.getBirthdate().toString()),i.tdBtn("Show",(async()=>{await s.dismiss({}),this.$router.push({path:`/patient/dashboard/${a}`})}))];return this.drillDownCache[a]=o,o})),columns:[[i.thTxt("ARV number"),i.thTxt("Gender"),i.thTxt("Birth Date"),i.thTxt("Actions")]]}},runTableDrill(t,e="Drilldown patients"){const{columns:a,rowParser:r}=this.getDefaultDrillDownTable();this.drilldownData(e,a,t,r)},drill(t,e="Drill table"){return t&&t.length>0?i.tdLink(t.length,(()=>this.runTableDrill(t,e))):i.td(0)},getEpiweeksFields:()=>[{id:"epiweek",helpText:"Select EPI week",type:D.TT_SELECT,validation:t=>l.required(t),options:async()=>(await u.getReportEpiWeeks()).map((t=>({label:t.name+" - ("+d(t.start).format("DD/MMM/YYYY")+" - "+d(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getMonthlyFields:()=>[{id:"idsrmonth",helpText:"Select Month",type:D.TT_SELECT,validation:t=>l.required(t),options:async()=>(await u.getReportMonths()).map((t=>({label:t.name+" - ("+d(t.start).format("DD/MMM/YYYY")+" - "+d(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getDateDurationFields(t=!1,e=!1,r=5){const n=c.getSessionDate();return[{id:"quarter",helpText:"Select Quarter",type:D.TT_SELECT,condition:()=>t,validation:t=>l.required(t),options:()=>{let t=m.getReportQuarters(r).map((t=>({label:t.name,value:t.start,other:t})));return e&&(t=[{label:"Set custom period",value:"custom_period",other:{}},...t]),t}},...a({id:"start_date",helpText:"Start",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,minDate:()=>"2001-01-01",maxDate:()=>n,estimation:{allowUnknown:!1},computeValue:t=>t}),...a({id:"end_date",helpText:"End",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,unload:(t,e,a,r)=>{"next"===e&&(this.endDate=r.end_date)},minDate:(t,e)=>e.start_date,maxDate:()=>n,estimation:{allowUnknown:!1},computeValue:t=>t})]}}}))}}}));
