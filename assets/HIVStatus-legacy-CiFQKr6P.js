System.register(["./HisStandardForm-legacy-a-GAw9o3.js","./index-legacy-Dab_9-0G.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./LocationFieldOptions-legacy-abwQi0sr.js","./MultiFieldDateHelper-legacy-CrZfaPmm.js","./useEncounter-legacy-DQW2iI_w.js","./commons-legacy-C5gNdqvi.js","./TouchScreenForm-legacy-BrA5VXvB.js","./ToolbarMediumCard-legacy-tyMOM4tZ.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-kf7cSfpw.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./isEmpty-legacy-Bqp3Y1rY.js","./_Set-legacy-DrJUtltY.js","./_setToArray-legacy-xtZY3SgF.js","./encounter_guidelines-legacy-ktYKRZJj.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,i,l,n,o,s,u,d,r,c,T,v,p,_,y,m,b,g,V,h;return{setters:[e=>{a=e.H},e=>{i=e.b5,l=e.d,n=e.K,o=e.V,s=e.o,u=e.c,d=e.w,r=e.b,c=e.cl,T=e.I,v=e.t},e=>{p=e.F},e=>{_=e.g},e=>{y=e.g,m=e.E},e=>{b=e.u},e=>{g=e.y,V=e.m,h=e.r},null,null,null,null,null,null,null,null,null,null,null],execute:function(){class t extends i{constructor(e,t){super(e,39,t)}}e("default",l({__name:"HIVStatus",setup(e){let i;const l=n([]),{patientDashboardUrl:D,goToNextTask:E}=b(((e,a,n)=>{i=new t(a,e),l.value=[{id:"hiv_status",helpText:"HIV status",type:p.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({obs:i.buildValueText("HIV status",e.label)}),options:()=>V(["Reactive","Non-reactive","Unknown"])},...A(n),{id:"test_location",helpText:"HIV test location",type:p.TT_SELECT,validation:e=>o.required(e),defaultValue:()=>t.getLocationName(),computedValue:({label:e})=>({obs:i.buildValueText("HIV test location",e)}),condition:e=>"Unknown"!==e.hiv_status.value,options:(e,t="")=>_(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"cpt_started",helpText:"CPT Started",type:p.TT_SELECT,options:g,condition:e=>"Reactive"===e.hiv_status.value,computedValue:e=>({obs:i.buildValueCoded("CPT Started",e.value)})},{id:"received_arvs",helpText:"Started ART?",type:p.TT_SELECT,computedValue:({value:e})=>({obs:i.buildValueCoded("ART Started",e)}),validation:e=>o.required(e),options:()=>V(["Yes","No","Defaulter","Unknown"]),condition:e=>"Reactive"===e.hiv_status.value},...S(n),...x(n),{id:"art_clinic_location",helpText:"ART clinic location",type:p.TT_SELECT,computedValue:e=>({obs:i.buildValueText("ART clinic location",e.label)}),validation:e=>o.required(e),condition:e=>/Yes|Defaulter/i.test(e.received_arvs.value),options:(e,t="")=>_(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"advised_to_visit_art",helpText:"Advised to visit ART",type:p.TT_SELECT,options:g,condition:e=>"Yes"!==e.received_arvs.value,computedValue:e=>({obs:i.buildValueCoded("Advised to visit ART",e.value)})}]}));async function f(e,t){if(!(await i.createEncounter()))return v("Unable to create encounter");const a=await h({...t});if(!(await i.saveObservationList(a)))return v("Unable to save observations");E()}function S(e){return y({id:"date_started_art",helpText:"Started ART",required:!0,condition:e=>"Yes"===e.received_arvs.value,minDate:()=>`${e?.getBirthdate()??""}`,maxDate:()=>i.getDate(),estimation:{allowUnknown:!0,estimationFieldType:m.MONTH_ESTIMATE_FIELD},computeValue:(e,t)=>i.buildDateObs("Date ART started",e,t)})}function x(e){return y({id:"date_defualted_art",helpText:"ART Default",required:!0,condition:e=>"Defaulter"===e.received_arvs.value,minDate:()=>`${e?.getBirthdate()??""}`,maxDate:()=>i.getDate(),estimation:{allowUnknown:!0,estimationFieldType:m.MONTH_ESTIMATE_FIELD},computeValue:(e,t)=>i.buildDateObs("ART default date",e,t)})}function A(e){return y({id:"hiv_test_date",helpText:"HIV Test",required:!0,minDate:()=>`${e?.getBirthdate()??""}`,maxDate:()=>t.getSessionDate(),condition:e=>"Unknown"!==e.hiv_status.value,summaryLabel:"HIV test date",estimation:{allowUnknown:!0,estimationFieldType:m.MONTH_ESTIMATE_FIELD},computeValue:(e,t)=>i.buildDateObs("HIV test date",e,t)})}return(e,t)=>(s(),u(c(T),null,{default:d((()=>[r(a,{cancelDestinationPath:c(D),fields:l.value,onFinishAction:f,skipSummary:""},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
