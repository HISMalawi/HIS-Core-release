import{d as x,r as u,o as _,a as h,c as C,w as k,b as v,u as d,m as p,t as j,e as y,D as E,I as O,i as V,f as F}from"./index-DUHy09-D.js";import{v as D}from"./TableView-Cubz3H_T.js";import{D as I}from"./data_verification_service-0Is-IiF9.js";import"./Export-Mg5mHyUQ.js";import"./index-h-mcwuuY.js";const M=x({__name:"EncountersPerProvider",setup(S){const f=u([]),m=u(""),l=u(!1),r=new I,P=[[{label:"#",ref:"index"},{label:"User",ref:"provider"},{label:"Count",ref:"count"},{label:"Percentage",ref:"percentage"},{label:"View",ref:"drilldown",toValue:()=>"View",tdClick:async e=>{e.refData.length&&(await p.create({component:D,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e.data.provider,columns:[[{label:"#",ref:"index"},{label:"Encounter name",ref:"name"},{label:"Total done",ref:"total"}]],rowsPerPage:100,columnData:e.refData,onFinish:()=>p.getTop().then(t=>t&&p.dismiss())}})).present()}}]],g=async()=>{if(!(r.startDate&&r.endDate))return j("Start date and end date required!");l.value=!0;try{const e=await r.getEncounterPerProvider(),t=Object.values(e).reduce((n,a)=>n+Object.values(a).reduce((i,o)=>i+o,0),0);f.value=Object.keys(e).reduce((n,a,i)=>{const o=Object.values(e[a]).reduce((c,s)=>c+s,0);return[...n,{index:i+1,provider:a,count:o,percentage:(o/t*100).toFixed(2)+"%",drilldown:Object.keys(e[a]).reduce((c,s,w)=>[...c,{index:w+1,name:s,total:e[a][s]}],[])}]},[])}catch(e){console.error(e),y("Unable to generate report!")}l.value=!1},b=()=>E({onFinish:(e,t,n)=>{m.value=n,r.startDate=e,r.endDate=t,g()}});return _(()=>b()),(e,t)=>(h(),C(d(F),null,{default:k(()=>[v(d(O),{"is-open":l.value,message:"Please wait.."},null,8,["is-open"]),v(D,{"icon-url":d(V)("reports.png"),title:"Encounters per Provider","report-prefix":"Clinic",subtitle:m.value,columns:P,columnData:f.value,rowsPerPage:100,onConfigure:b,onRefresh:g},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{M as default};
