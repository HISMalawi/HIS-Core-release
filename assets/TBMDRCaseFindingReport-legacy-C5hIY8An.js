System.register(["./TableReportTemplate-legacy-CB8GOx4t.js","./index-legacy-CA6M7ipO.js","./tb_report_service-legacy-Zm3SniYu.js","./ReportMixin.vue_vue_type_script_lang-legacy-BI1_Se6D.js","./TBDrilldown-legacy-CFeHzZaG.js","./Export-legacy-SGgsNE3Q.js","./index-legacy-DZOKxSjk.js","./HisStandardForm-legacy-a9YJRGaH.js","./ReportErrors-legacy-DajcGv3V.js","./BasicReportTemplate-legacy-VHTBSvfP.js","./Pagination-legacy-BXR2lmLV.js","./TableView-legacy-2WevvWny.js"],(function(e,t){"use strict";var a,l,i,r,o,n,s,d,u,c,p,h,m,_,g,f,v,b;return{setters:[e=>{a=e.R},e=>{l=e.d,i=e.I,r=e.r,o=e.ad,n=e.ae,s=e.au,d=e.W,u=e.as,c=e.aa,p=e.c,h=e.w,m=e.af,_=e.a,g=e.b},e=>{f=e.T},e=>{v=e._},e=>{b=e.T},null,null,null,null,null,null,null],execute:function(){const t=l({mixins:[v],components:{IonPage:i,ReportTemplate:a},data:()=>({rows:[],columns:r([[]]),subtitle:r("-"),data:r([]),yearValue:r(""),quarterValue:r(1),indicatorsValue:r([]),footerText:r("Select All"),reportIndicators:[{label:"Patients aged fourteen and below",value:"patients_aged_fourteen_and_below"},{label:"Patients aged fourteen and above",value:"patients_aged_fourteen_and_above"},{label:"New DR cases",value:"new_dr_cases"},{label:"Previously treated with firstline drugs",value:"previously_treated_with_firstline_drugs"},{label:"Previously treated for TB Drug Resistance",value:"previously_treated_for_tb_drug_resistance"},{label:"Patients on Individualised regimen",value:"patients_on_individualised_regimen"},{label:"Patients on Short regimen",value:"patients_on_short_regimen"},{label:"Patients on Standardised regimen",value:"patients_on_standardised_regimen"},{label:"DR Male patients",value:"dr_male_patients"},{label:"DR Female patients",value:"dr_female_patients"},{label:"DR HIV Positive patients",value:"dr_hiv_positive_patients"},{label:"DR HIV Negative patients",value:"dr_hiv_negative_patients"},{label:"DR patients on ART",value:"dr_patients_on_art"},{label:"DR patients not on ART",value:"dr_patients_not_on_art"}],reportConfig:[],age_groups:["0-4","5-14","15-24","25-34","35-44","45-54","55-64","65+"]}),mounted(){this.init()},methods:{init(){this.reportConfig=[{id:"year",helpText:"Year",type:o.TT_NUMBER,validation:e=>n.required(e),computedValue:e=>e.value},{id:"quater",helpText:"Quater",type:o.TT_SELECT,requireNext:!1,options:()=>[{label:"First",value:1},{label:"Second",value:2},{label:"Third",value:3},{label:"Fourth",value:4}],validation:e=>n.required(e),computedValue:e=>e.value},{id:"indicators",helpText:"Indicators",type:o.TT_MULTIPLE_SELECT,options:()=>this.reportIndicators,validation:e=>n.required(e),computedValue:e=>e.map((e=>e.value)),config:{footerBtns:[{name:this.footerText,slot:"end",onClickComponentEvents:{refreshOptions:()=>"Select All"===this.footerText?this.selectAll():this.deSelectAll()},onClick:()=>"None"}]}}],this.columns=this.buildColumns()},async generate(e){try{this.rows=[],this.indicatorsValue=e.indicators.map((e=>e.value)),this.yearValue=e.year.value,this.quarterValue=e.quater.value;const t=new f;this.data=await t.getMDRTBCaseFindingReport(this.yearValue,this.quarterValue,this.indicatorsValue),this.populateData(),s.getTop().then((e=>e&&s.dismiss()))}catch(t){console.error(t),d("Unable to generate report")}},populateData(){this.data.forEach((e=>{const t=[u.td(this.reportIndicators.find((t=>t.value==this.indicatorsValue.find((t=>t===e.indicator))))?.label),this.toDrillColumn(e.indicator,e.data.clinical.male),this.toDrillColumn(e.indicator,e.data.clinical.female),this.toDrillColumn(e.indicator,e.data.mdr_confirmed.male),this.toDrillColumn(e.indicator,e.data.mdr_confirmed.female),this.toDrillColumn(e.indicator,e.data.rif_confirmed.male),this.toDrillColumn(e.indicator,e.data.rif_confirmed.female),this.toDrillColumn(e.indicator,e.data.total.male),this.toDrillColumn(e.indicator,e.data.total.female)];this.rows.push(t)}))},toDrillColumn(e,t){return u.tdLink(t.length,(()=>{this.drilldown({indicator:e,ids:t})}))},async drilldown(e){(await s.create({component:b,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e.indicator,patientIdentifiers:e.ids,subtitle:`Period: ${this.period} Q${this.quarterValue}`,onFinish:()=>s.getTop().then((e=>e&&s.dismiss()))}})).present()},buildColumns(){const e=["Clinical","Confirmed","Confirmed RR","Totals"],t=[[u.thTxt("",{sortable:!1,exportable:!1}),u.thTxt("DR RR/TB Cases detected and enrolled",{sortable:!1,exportable:!1})]];return e.forEach((e=>{t[0].push(u.thTxt(e,{colspan:2,sortable:!1,exportable:!1}))})),t[1]=[],t[1].push(u.thTxt("",{sortable:!1,exportable:!1})),e.forEach((()=>{t[1].push(u.thTxt("Male",{sortable:!1,exportable:!1}),u.thTxt("Female",{sortable:!1,exportable:!1}))})),t},deSelectAll(){const e=this.reportIndicators;return this.footerText="Select All",e.map((e=>({...e,isChecked:!1})))},selectAll(){const e=this.reportIndicators;return this.footerText="Deselect All",e.map((e=>({...e,isChecked:!0})))}}});e("default",c(t,[["render",function(e,t,a,l,i,r){const o=m("report-template"),n=m("ion-page");return _(),p(n,null,{default:h((()=>[g(o,{title:"TB MDR Case Finding Report",period:"Period",rows:e.rows,fields:e.reportConfig,columns:e.columns,reportPrefix:"NTP",config:{showIndex:!0},onReportConfiguration:e.generate},null,8,["rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
