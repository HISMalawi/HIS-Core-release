import{d as c,I as u,V as _,ab as T,cI as f,L as t,cJ as i,S as l,H as x,_ as w,r as m,o as I,c as D,w as v,b as S}from"./index-CEHwIYqs.js";import{_ as g}from"./ReportMixin.vue_vue_type_script_lang-BUZJnrGJ.js";import{R as N}from"./TableReportTemplate-Dfnljex-.js";import{F as E}from"./dynamic-import-helper-Bsjrd6Ro.js";import{g as d}from"./MultiFieldDateHelper-3uh31nyF.js";import"./BasicReportTemplate-C1LCpIKe.js";import"./Export-BQ97ckzh.js";import"./SIngleTouchField-l8pjEMFV.js";import"./Pagination-BZcHKApi.js";import"./HisStandardForm-CG-mBCAJ.js";import"./TouchScreenForm-CoH4BwNu.js";import"./ToolbarMediumCard-C9Oru3Lp.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-CUJZqAQw.js";import"./ReportErrors-uaWLdTQ5.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";const C=c({mixins:[g],components:{ReportTemplate:N,IonPage:u},data:()=>({title:"Data cleaning report",rows:[],columns:[],defaultIndicator:{}}),created(){this.fields=[{id:"indicator",helpText:"Select indicator",type:E.TT_SELECT,requireNext:!1,condition:()=>!this.defaultIndicator,defaultOutput:()=>this.defaultIndicator,validation:e=>_.required(e),options:()=>this.getIndicatorOptions()},...d({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>l.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e}),...d({id:"end_date",helpText:"End",required:!0,minDate:(e,a)=>a.start_date,maxDate:()=>l.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e})],this.defaultIndicator=T.find(this.getIndicatorOptions(),{value:this.$route.query.cleaning_tool})||null},methods:{async onPeriod(e,a){const r=o=>x.toStandardHisDisplayFormat(o);this.rows=[],this.title=e.indicator.label;const n=e.indicator;this.columns=n.other.columns,this.report=new f,this.report.setStartDate(a.start_date),this.report.setEndDate(a.end_date),this.period="".concat(r(a.start_date)," - ").concat(r(a.end_date));const s=await this.report.getDataToolReport(n.value);s&&(this.rows=await Promise.all(s.map(o=>n.other.formatRow(o))))},showPatientBtn(e){return t.tdBtn("View",()=>this.$router.push("/patient/dashboard/"+e))},getIndicatorOptions(){return[{label:"Males with ANC Encounters",value:i.MALES_WITH_ANC_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Total Encounters"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Encounters after death",value:i.ENCOUNTERS_AFTER_DEATH,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Date of death"),t.thTxt("Recent encounter date"),t.thTxt("Count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.tdDate(e.patient_died_date),t.tdDate(e.minimum_encounter_datetime),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Incomplete visits",value:i.INCOMPLETE_VISITS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Name"),t.thTxt("Visit date"),t.thTxt("Incomplete count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.n_id),t.td(e.name),t.td(e.visit_date),t.td(e.visit_no),this.showPatientBtn(e.patient_id)]}},{label:"Duplicate encounters",value:i.DUPLICATE_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Name"),t.thTxt("Total"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.name),t.td(e.total),this.showPatientBtn(e.patient_id)]}},{label:"Missing HIV Status",value:i.MISSING_HIV_STATUS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}},{label:"Missing Last Menstrual Period (LMP)",value:i.MISSING_LMP,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}}]}}});function R(e,a,r,n,s,o){const h=m("report-template"),p=m("ion-page");return I(),D(p,null,{default:v(()=>[S(h,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,showFilters:!0,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const W=w(C,[["render",R]]);export{W as default};
