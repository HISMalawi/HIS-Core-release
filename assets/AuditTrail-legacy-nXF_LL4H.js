System.register(["./stock_report_service-legacy-BbSx3uRo.js","./ReportMixin.vue_vue_type_script_lang-legacy-DdW6gwYJ.js","./index-legacy-DfH-8HCh.js","./TableReportTemplate-legacy-DP7PjZkq.js","./BasicReportTemplate-legacy-Cga0OSrA.js","./Export-legacy-M2ItoaBg.js","./index-legacy-BcR0ABWj.js","./Pagination-legacy-QZybLwTJ.js","./HisStandardForm-legacy-Y3Pj6QSa.js","./ReportErrors-legacy-DSUJR3VK.js"],(function(t,e){"use strict";var a,r,i,n,o,s,d,l,c,u,p,h,_,g,m,T;return{setters:[t=>{a=t.S},t=>{r=t._},t=>{i=t.d,n=t.aq,o=t.ab,s=t.ac,d=t.d4,l=t.ai,c=t.aj,u=t.a8,p=t.ad,h=t.u,_=t.v,g=t.w,m=t.x},t=>{T=t.R},null,null,null,null,null,null],execute:function(){const e={textAlign:"right",paddingRight:".5rem"},y=i({mixins:[r],components:{ReportTemplate:T},data:()=>({title:"Audit Trail",rows:[],columns:[[n.thTxt("Medication"),n.thTxt("Transaction type"),n.thTxt("Transaction date"),n.thTxt("Net Quantity",{style:e})]],fields:[{id:"start_date",helpText:"Start Date",type:o.TT_FULL_DATE,validation:t=>s.required(t),computedValue:t=>t.value},{id:"end_date",helpText:"End Date",type:o.TT_FULL_DATE,validation:t=>s.required(t),computedValue:t=>t.value}]}),methods:{async onPeriod(t,r){this.rows=[],this.report=new a,this.report.setStartDate(r.start_date),this.report.setEndDate(r.end_date),this.period=this.report.getDateIntervalPeriod(),this.report.loadTrail().then((t=>{t.forEach((t=>{this.rows.push([n.td(t.drug_name),n.td(t.transaction_type),n.tdDate(t.transaction_date),n.tdLink(d(Math.trunc(Math.abs(t.cum_per_day_stock_commited))),(async()=>{const a=await this.report.getTrailDetails(t.transaction_date,t.drug_id,t.transaction_type);this.drilldownData(`${t.drug_name} ${t.transaction_type.toLowerCase()} on ${l.toStandardHisDisplayFormat(t.transaction_date)}`,[[n.thTxt("Product Code"),n.thTxt("Batch Number"),n.thTxt("Medication"),n.thTxt("Amount Per Unit"),n.thTxt("Total Tins/Pallets",{style:e})]],a.map((t=>[n.td(t.product_code),n.td(t.batch_number),n.td(t.drug_name),n.td(t.pack_size),n.tdNum(Math.abs(Math.trunc(t.amount_committed_to_stock/t.pack_size||1)))])),!1)}),{style:{textAlign:"right",paddingRight:".5rem"}})])}))})).catch((t=>{c(t)}))}}});t("default",u(y,[["render",function(t,e,a,r,i,n){const o=p("report-template"),s=p("ion-page");return h(),_(s,null,{default:g((()=>[m(o,{title:t.title,rows:t.rows,paginated:!0,period:t.period,fields:t.fields,columns:t.columns,onReportConfiguration:t.onPeriod},null,8,["title","rows","period","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
