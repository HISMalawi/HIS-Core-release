import{d as C,a5 as _,cv as I,r,t as $,aK as R,O as B,ah as A,db as b,c_ as O,aq as u,a6 as P,ab as p,u as S,v as k,w,x as v}from"./index-CyYd6aWW.js";import{O as y,D as V}from"./opd_report_service-sSYP80o_.js";import{v as x}from"./TableView-KUf7rG9H.js";import{A as G}from"./v2utils-Ce6mchJu.js";const L=C({components:{IonPage:_,IonLoading:I,v2Datatable:x},setup(){const e=r([]),s=r(""),m=r(""),l=r(!1),o=new y,i=r([]);let c=0;const d=async a=>{(await u.create({component:G,backdropDismiss:!1,cssClass:"large-modal",componentProps:{...a,subtitle:s.value,onFinish:()=>u.getTop().then(t=>t&&u.dismiss())}})).present()},g=(a,t)=>({ref:t,label:a,defaultValue:"0",toValue:n=>n.length,tdClick:async n=>{n.refData.length&&d({patientIdentifiers:n.refData,title:"".concat(n.data.age_group," ").concat(n.data.gender," ").concat(n.column.label)})}}),h=[[{label:"#",ref:"index",toValue:()=>++c},{label:"Age group",ref:"ageGroup"},{label:"Gender",ref:"gender"},...Object.entries(V).map(([a,t])=>g(t,a))]],f=async()=>{if(!(o.startDate&&o.endDate))return B("Start date and end date required!");l.value=!0;try{e.value=await o.getDisaggReport()}catch(a){console.error(a);const t="Unable to generate report!";A(t),i.value=[{text:t,color:"danger",icon:b,action:function(){i.value=[{text:"Exception occured: <b>".concat(a,"</b>"),color:"danger",icon:b}]}}]}l.value=!1,m.value=""},D=()=>O({onFinish:(a,t,n)=>{s.value=n,o.startDate=a,o.endDate=t,f()}});return $(()=>D()),{Img:R,headerBadge:i,reportData:e,isLoading:l,configure:D,generate:f,columns:h,period:s}}});function q(e,s,m,l,o,i){const c=p("ion-loading"),d=p("v2Datatable"),g=p("ion-page");return S(),k(g,null,{default:w(()=>[v(c,{"is-open":e.isLoading,message:"Please wait.."},null,8,["is-open"]),v(d,{"icon-url":e.Img("reports.png"),title:"Clinic Disaggregated Report","report-prefix":"clinic",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,onConfigure:e.configure,onRefresh:e.generate,headerBadge:e.headerBadge},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh","headerBadge"])]),_:1})}const j=P(L,[["render",q]]);export{j as default};
