System.register(["./TableReportTemplate-legacy-BGf2T7cz.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./index-legacy-X--GYU37.js","./identifier_service-legacy-cwmTozQR.js","./DrillTableModal-legacy-Dvk63UIn.js","./VoidReason-legacy-C3ZoWXLa.js","./Export-legacy-DuqLSep7.js","./HisStandardForm-legacy-DMJkhfrq.js","./TouchScreenForm-legacy-C_f8Ho2H.js","./ToolbarMediumCard-legacy-CdhT4OJW.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-1het9QhE.js","./ReportErrors-legacy-DSAcU8Yd.js"],(function(e,t){"use strict";var i,s,n,r,a,l,o,d,c,p,u,m,y,f,g;return{setters:[e=>{i=e.R},e=>{s=e.F},e=>{n=e.d,r=e.L,a=e.V,l=e.H,o=e.O,d=e.q,c=e._,p=e.r,u=e.o,m=e.c},e=>{y=e.I},e=>{f=e.D},e=>{g=e.p},null,null,null,null,null,null,null],execute:function(){const t=n({components:{ReportTemplate:i},data:()=>({service:{},dde:{},title:"Multiple Identifiers",fields:[],rows:[],columns:[[r.thTxt("First Name"),r.thTxt("Last Name"),r.thTxt("Gender"),r.thTxt("Number of identifiers"),r.thTxt("View")]]}),async created(){this.fields=this.getFormFields()},methods:{async onPeriod({identifier:e}){const t=parseInt(e.value.toString());this.title=e.label+" Multiple Identifiers",this.service=new y,this.service.setIdentifierType(t),this.rows=await this.getRows()},getFormFields:()=>[{id:"identifier",helpText:"Select Identifier type",type:s.TT_SELECT,validation:e=>a.required(e),options:async()=>(await y.getIdentifierTypes()).map((e=>({label:e.name,value:e.patient_identifier_type_id})))}],toDate:e=>l.toStandardHisDisplayFormat(e),async drillDuplicates(e,t){(await o.create({component:f,cssClass:"custom-modal",componentProps:{title:"Identifiers belonging to client",columns:["identifier","date created","void"],onRows:async()=>e.map(((i,s)=>{try{return[i.identifier,this.toDate(i.date_created),{type:"button",name:"Void",color:"danger",action:async()=>{await this.voidActiveItem(i.patient_identifier_id,e,s,t)},disabled:!(e.length>1)}]}catch(n){return d("Unable to load patient details"),["N/A","N/A","N/A","N/A","N/A"]}}))}})).present()},voidActiveItem(e,t,i,s){g((async n=>{try{o.dismiss().then((async()=>{await this.service.voidMultipleIdentifiers([e],n,t[0].identifier_type);const r=t.splice(i,1);r.length>1?await this.drillDuplicates(r,s):this.rows.splice(s,1)}))}catch(r){d(`${r}`)}}),"void-modal custom-modal-backdrop")},async getRows(){return(await this.service.getMultipleIdentifiers()).map(((e,t)=>[r.td(e.given_name),r.td(e.family_name),r.td(e.gender),r.td(e.identifiers.length),r.tdBtn("Select",(()=>this.drillDuplicates(e.identifiers,t)))]))}}});e("default",c(t,[["render",function(e,t,i,s,n,r){const a=p("report-template");return u(),m(a,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,canExportCsv:!1,canExportPDf:!1,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])}]]))}}}));
