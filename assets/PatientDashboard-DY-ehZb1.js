const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MinimalToolbar-XmwOXj42.js","assets/index-Cpa1Vu_O.js","assets/index-BJIxebzH.css"])))=>i.map(i=>d[i]);
import{d as S,aV as re,Z as j,_ as F,a4 as U,Q as z,a3 as W,O as G,R as ce,aL as $,a9 as Ce,aJ as de,as as J,M as K,af as ye,a8 as O,ad as s,u as l,B as f,x as n,w as i,z as p,Y as _,E as T,C as A,v as h,aW as ue,$ as x,S as ee,U as te,aj as Q,a1 as m,G as y,aX as ke,a0 as Ie,aY as pe,aZ as ne,a_ as De,a$ as me,b0 as X,r as he,t as $e,b1 as we,b2 as Ee,b3 as Te,a5 as Pe,b4 as Le,aI as Ae,b5 as Ve,b6 as Se,b7 as Oe,b8 as Ne,b9 as Be,ba as Me,bb as ze,bc as He,bd as Re,be as qe,bf as je,bg as Fe,bh as B,bi as H,bj as Y,bk as R,au as M,bl as Ue,ai as q,bm as Z,ah as We,bn as Ge,ag as Je,bo as Ye,bp as Ze,bq as Ke,J as Qe,br as Xe,bs as xe,bt as et,bu as tt,bv as nt,H as ae,a6 as it,a7 as ot}from"./index-Cpa1Vu_O.js";import{D as st}from"./drug_order_service-C7yYoFKE.js";import{T as at}from"./TaskCard-DKduTpYJ.js";import{p as lt}from"./VoidReason-Cwg3BCTg.js";import rt from"./DashboardAppIcon-UqHbCF9M.js";const ct=S({components:{IonGrid:re,IonRow:j,IonCol:F,TaskCard:at,IonFooter:U,IonToolbar:z,IonButton:W,IonHeader:G,IonTitle:ce},props:{title:{type:String,default:"Select Activity"},items:{type:Object,required:!0},taskParams:{type:Object,required:!1}},data:()=>({filteredItems:[]}),watch:{items:{async handler(e){if(!(!e||$.isEmpty(e)))for(const t in e){const o=e[t];o.globalProperty&&!await Ce.isProp(o.globalProperty)||o.condition&&!await o.condition(this.taskParams)||this.filteredItems.push(o)}},deep:!0,immediate:!0}},methods:{img(e){return de(e)},isDisabled(e){return typeof e=="function"?e(this.taskParams):!1},closeModal(){J.dismiss({})},async doTask(e){var t;if(this.isDisabled(e.disabled))return K("This task is disabled");typeof e.taskCompleted=="boolean"&&(e!=null&&e.taskCompleted)&&!await ye("This task was already completed. Do you want to continue?")||(e.action?e.action(this.taskParams,this.$router):e.url?this.$router.push({path:e.url}):this.$router.push({name:e.id,params:{patient_id:(t=this.taskParams)==null?void 0:t.patient.patient_id}}),this.closeModal())}}});function dt(e,t,o,a,k,w){const b=s("ion-title"),r=s("ion-toolbar"),c=s("ion-header"),C=s("task-card"),E=s("ion-col"),v=s("ion-row"),d=s("ion-grid"),I=s("ion-button"),D=s("ion-footer");return l(),f(T,null,[n(c,null,{default:i(()=>[n(r,null,{default:i(()=>[n(b,null,{default:i(()=>[p(_(e.title),1)]),_:1})]),_:1})]),_:1}),n(d,{class:"selector"},{default:i(()=>[n(v,null,{default:i(()=>[(l(!0),f(T,null,A(e.filteredItems,(g,P)=>(l(),h(E,{"size-lg":"4","size-sm":"6",key:P},{default:i(()=>[n(C,{onClick:L=>e.doTask(g),title:g.name.toUpperCase(),description:g.description,taskCompleted:g.taskCompleted,taskDisabled:e.isDisabled(g.disabled),icon:e.img(g.icon)},null,8,["onClick","title","description","taskCompleted","taskDisabled","icon"])]),_:2},1024))),128))]),_:1})]),_:1}),n(D,null,{default:i(()=>[n(r,null,{default:i(()=>[n(I,{class:"close-btn",color:"danger",size:"large",onClick:e.closeModal,slot:"end"},{default:i(()=>[p(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const le=O(ct,[["render",dt],["__scopeId","data-v-701ae879"]]),ut=S({components:{HisBasicTable:ue,IonButton:W,IonToolbar:z,IonList:x,IonFooter:U,IonContent:ee,IonRow:j,IonCol:F,IonTitle:ce,IonHeader:G,IonItem:te},data:()=>({active:{id:-1,name:"",provider:"",rows:[],columns:[]},encounters:[]}),computed:{canVoid(){return!$.isEmpty(this.active)}},watch:{items:{handler(e){$.isEmpty(e)||(this.encounters=e,this.showDetails(this.encounters[0]))},immediate:!0,deep:!0}},props:{title:{type:String,required:!0},items:{type:Object,required:!0}},methods:{closeModal(){J.dismiss({})},removeEncounter(e){this.encounters=this.encounters.filter(t=>t.other.id!=e)},voidActiveItem(){lt(async e=>{try{await this.active.onVoid(e),this.removeEncounter(this.active.id),this.active={},$.isEmpty(this.encounters)||this.showDetails(this.encounters[0])}catch(t){Q("".concat(t))}},"void-modal custom-modal-backdrop")},async showDetails(e){var t;this.active.id=e.other.id,this.active.name=e.label,this.active.columns=e.other.columns,this.active.onVoid=e.other.onVoid,this.active.rows=await e.other.getRows(),this.active.provider=await e.other.provider,this.active.isBDE=(t=e.other.isBDE)!=null?t:!1}}}),pt={class:"his-md-text",style:{display:"flex","justify-content":"space-between",width:"100%"}},mt={class:"ion-margin-start"},ht={class:"ion-margin-end"},ft={class:"tb"};function _t(e,t,o,a,k,w){const b=s("ion-text"),r=s("ion-toolbar"),c=s("ion-header"),C=s("ion-item"),E=s("ion-list"),v=s("ion-col"),d=s("his-basic-table"),I=s("ion-row"),D=s("ion-content"),g=s("ion-button"),P=s("ion-footer");return l(),f(T,null,[n(c,null,{default:i(()=>[n(r,null,{default:i(()=>[m("div",pt,[m("span",mt,_(e.title),1),e.active.isBDE?(l(),h(b,{key:0,color:"danger"},{default:i(()=>[p("BDE Record")]),_:1})):y("",!0),m("span",ht,"Provider: "+_(e.active.provider),1)])]),_:1})]),_:1}),n(D,null,{default:i(()=>[n(I,null,{default:i(()=>[n(v,{size:"4"},{default:i(()=>[n(E,null,{default:i(()=>[(l(!0),f(T,null,A(e.encounters,(L,N)=>(l(),h(C,{class:"his-sm-text",key:N,color:L.other.id===e.active.id?"primary":"",detail:!0,onClick:()=>e.showDetails(L)},{default:i(()=>[p(_(L.label),1)]),_:2},1032,["color","onClick"]))),128))]),_:1})]),_:1}),n(v,{size:"8"},{default:i(()=>[m("div",ft,[n(d,{columns:e.active.columns,rows:e.active.rows},null,8,["columns","rows"])])]),_:1})]),_:1})]),_:1}),n(P,null,{default:i(()=>[n(r,null,{default:i(()=>[n(g,{color:"danger",onClick:e.voidActiveItem,disabled:!e.canVoid,size:"large"},{default:i(()=>[p(" Void encounter")]),_:1},8,["onClick","disabled"]),n(g,{onClick:e.closeModal,size:"large",slot:"end"},{default:i(()=>[p(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const gt=O(ut,[["render",_t],["__scopeId","data-v-1d3f0719"]]),bt=S({components:{HisBasicTable:ue,IonHeader:G,IonToolbar:z,IonContent:ee,IonFooter:U,IonButton:W},props:{title:{type:String,required:!0},columns:{type:Array,required:!0},rows:{type:Array,default:()=>[]}},methods:{async closeModal(){await J.dismiss({})}}});function vt(e,t,o,a,k,w){const b=s("ion-title"),r=s("ion-toolbar"),c=s("ion-header"),C=s("his-basic-table"),E=s("ion-content"),v=s("ion-button"),d=s("ion-footer");return l(),f(T,null,[n(c,null,{default:i(()=>[n(r,null,{default:i(()=>[n(b,{class:"his-md-text"},{default:i(()=>[p(_(e.title),1)]),_:1})]),_:1})]),_:1}),n(E,null,{default:i(()=>[n(C,{columns:e.columns,rows:e.rows},null,8,["columns","rows"])]),_:1}),n(d,null,{default:i(()=>[n(r,null,{default:i(()=>[n(v,{size:"large",onClick:e.closeModal,slot:"end"},{default:i(()=>[p(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const Ct=O(bt,[["render",vt]]),yt=S({components:{TextSkeleton:ke,IonLabel:Ie,IonList:x,IonItem:te,IonChip:pe,IonIcon:ne,IonBadge:De},data:()=>({time:me}),props:{isEnabled:{type:Boolean,default:()=>!0},counter:{type:Number,required:!1},isLoading:{type:Boolean},icon:{type:String},title:{type:String,required:!0},items:{type:Object},titleColor:{type:String,required:!1,default:()=>"#337ab7"}}});function kt(e,t,o,a,k,w){const b=s("ion-badge"),r=s("ion-label"),c=s("ion-item"),C=s("text-skeleton"),E=s("ion-icon"),v=s("ion-chip"),d=s("ion-list");return l(),f("div",{class:X(["card",{inactive:!e.isEnabled,clickable:e.isEnabled}])},[n(c,{color:e.titleColor,lines:"none",class:"his-md-text title-card"},{default:i(()=>[n(b,{slot:"start",class:"his-sm-text",color:"light"},{default:i(()=>[m("b",null,_(e.counter),1)]),_:1}),n(r,null,{default:i(()=>[p(_(e.title),1)]),_:1})]),_:1},8,["color"]),e.isLoading?(l(),h(C,{key:0,itemCount:5})):y("",!0),e.isLoading?y("",!0):(l(),h(d,{key:1},{default:i(()=>[(l(!0),f(T,null,A(e.items,(I,D)=>(l(),h(c,{key:D},{default:i(()=>{var g,P;return[n(r,{class:X((g=I==null?void 0:I.other)!=null&&g.wrapTxt?"ion-text-wrap":""),innerHTML:I.label},null,8,["class","innerHTML"]),I.value?(l(),h(v,{key:0,class:"his-sm-text ion-no-margin",slot:"end"},{default:i(()=>[n(E,{icon:e.icon},null,8,["icon"]),n(r,null,{default:i(()=>[p(_(I.value),1)]),_:2},1024)]),_:2},1024)):y("",!0),(P=I.other)!=null&&P.isBDE?(l(),h(v,{key:1,class:"his-sm-text ion-no-margin",slot:"end",color:"danger",style:{"margin-left":".2rem"}},{default:i(()=>[n(r,null,{default:i(()=>[p("BDE")]),_:1})]),_:1})):y("",!0)]}),_:2},1024))),128))]),_:1}))],2)}const It=O(yt,[["render",kt],["__scopeId","data-v-5f54c099"]]),Dt=S({components:{IonList:x,IonItem:te},props:{title:{type:String,default:()=>"Visits"},items:{type:Object,required:!0}},data:()=>({active:{},activeListItems:[],paginatedListItems:[],index:-1,perPage:6,btnSize:45}),computed:{listAlignmentClass(){return this.activeListItems&&this.activeListItems.length===this.perPage?"vertically-align":""},upbuttonImg(){return"/assets/images/drop-up-arrow.svg"},downbuttonImg(){return"/assets/images/drop-down-arrow.svg"},showNextButton(){return this.index+1<this.paginatedListItems.length},showPrevButton(){return this.index>=1}},watch:{items:{handler(e){if(!$.isEmpty(e)){this.index=0,this.paginatedListItems=$.chunk(e,this.perPage),this.activeListItems=this.paginatedListItems[0],this.active=this.activeListItems[0];for(const t in this.paginatedListItems){const o=$.findIndex(this.paginatedListItems[t],a=>a.other.isActive===!0,0);if(o!=-1){this.index=parseInt(t),this.activeListItems=this.paginatedListItems[t],this.active=this.activeListItems[o];break}}}},deep:!0,immediate:!0},index:{handler(e){this.activeListItems=this.paginatedListItems[e]},immediate:!0},active(e){this.$emit("onselect",e)}},methods:{onselect(e){this.active=e},isActive(e){return e.label===this.active.label},goNext(){const e=this.index+1;e<=this.paginatedListItems.length&&(this.index=e)},goPrev(){this.paginatedListItems.length>=1&&(this.index-=1)}}}),$t={class:"card his-card"},wt={class:"his-md-text header-section"},Et=["disabled"],Tt=["src","width"],Pt={class:"bottom-section"},Lt=["disabled"],At=["src","width"];function Vt(e,t,o,a,k,w){const b=s("ion-item"),r=s("ion-list");return l(),f("div",$t,[m("div",wt,_(e.title),1),m("button",{class:"nav-btn nav-btn-top clickable",disabled:!e.showPrevButton,onClick:t[0]||(t[0]=(...c)=>e.goPrev&&e.goPrev(...c))},[m("img",{src:e.upbuttonImg,width:e.btnSize},null,8,Tt)],8,Et),m("div",{class:X(e.listAlignmentClass)},[n(r,null,{default:i(()=>[(l(!0),f(T,null,A(e.activeListItems,(c,C)=>(l(),h(b,{class:"his-md-text",key:C,onClick:E=>e.onselect(c),detail:!0,color:e.isActive(c)?"primary":""},{default:i(()=>[p(_(c.label),1)]),_:2},1032,["onClick","color"]))),128))]),_:1})],2),m("div",Pt,[m("button",{class:"nav-btn nav-btn-bottom clickable",disabled:!e.showNextButton,onClick:t[1]||(t[1]=(...c)=>e.goNext&&e.goNext(...c))},[m("img",{src:e.downbuttonImg,width:e.btnSize},null,8,At)],8,Lt)])])}const St=O(Dt,[["render",Vt],["__scopeId","data-v-751691ca"]]);function Ot(){const e=he({width:window.innerWidth,height:window.innerHeight});function t(o){e.value={height:o.currentTarget.innerHeight,width:o.currentTarget.innerWidth}}return $e(()=>{addEventListener("resize",t)}),we(()=>{removeEventListener("resize",t)}),{resolution:e}}const Nt=S({name:"HisResultCard",components:{IonIcon:ne},props:{icon:{required:!1},items:{type:Object,required:!0}},methods:{hasIcon(e){return"other"in e&&"icon"in e.other}}}),Bt={class:"tool-bar-medium-card"};function Mt(e,t,o,a,k,w){const b=s("ion-icon");return l(),f("div",Bt,[(l(!0),f(T,null,A(e.items,(r,c)=>(l(),f("div",{key:c},[e.hasIcon(r)?(l(),h(b,{key:0,icon:r.other.icon},null,8,["icon"])):y("",!0),p(" "+_(r.label)+": ",1),m("b",null,_(r.value),1)]))),128))])}const zt=O(Nt,[["render",Mt],["__scopeId","data-v-f304e49e"]]),Ht=S({name:"PatientToolbar",components:{IonHeader:G,IonToolbar:z,IonCol:F,IonRow:j,InfoCard:zt,IconCard:rt},props:{app:{type:Object},appVersion:{type:String},patientCardInfo:{type:Array,required:!0},programCardInfo:{type:Array,required:!0},appIcon:{type:String,required:!0}},computed:{logo(){return de(this.appIcon)}}});function Rt(e,t,o,a,k,w){const b=s("info-card"),r=s("ion-col"),c=s("icon-card"),C=s("ion-row"),E=s("ion-toolbar"),v=s("ion-header");return l(),h(v,{translucent:!0},{default:i(()=>[n(E,null,{default:i(()=>[n(C,null,{default:i(()=>[n(r,{size:"5"},{default:i(()=>[n(b,{items:e.patientCardInfo},null,8,["items"])]),_:1}),n(r,{size:"5"},{default:i(()=>[n(b,{items:e.programCardInfo},null,8,["items"])]),_:1}),n(r,{size:"2"},{default:i(()=>[n(c,{app:e.app,version:e.appVersion,icon:e.logo},null,8,["app","version","icon"])]),_:1})]),_:1})]),_:1})]),_:1})}const qt=O(Ht,[["render",Rt]]),jt=S({components:{IonSegment:Ee,IonSegmentButton:Te,IonChip:pe,IonPage:Pe,IonIcon:ne,IonFooter:U,IonContent:ee,IonButton:W,IonToolbar:z,IonGrid:re,IonRow:j,IonCol:F,FullToolbar:qt,PrimaryCard:It,VisitDatesCard:St,MinimalToolbar:Le(()=>nt(()=>import("./MinimalToolbar-XmwOXj42.js"),__vite__mapDeps([0,1,2])))},setup(){const e=he("lg"),{resolution:t}=Ot();return Ae(()=>t.value,o=>{o&&o.width<=900?e.value="sm":e.value="lg"},{immediate:!0,deep:!0}),{time:me,person:Ve,calendar:Se,medical:Oe,clipboard:Ne,apps:Be,folder:Me,logOut:ze,clipboardOutline:He,appsOutline:Re,folderOutline:qe,logOutOutline:je,alertCircle:Fe,screenBreakPoint:e}},data:()=>({activeTab:1,app:{},dashboardComponent:{},isBDE:!1,currentDate:"",sessionDate:"",nextTask:{},programId:0,patientId:0,patient:{},patientProgram:{},patientCardInfo:[],programCardInfo:[],visitDates:[],activeVisitDate:"",patientCards:[],appVersion:B.getFullVersion(),sessionEncounterMap:{},savedEncounters:[]}),computed:{patientIsset(){return!$.isEmpty(this.patient)},patientName(){return $.isEmpty(this.patient)?"N/A":this.patient.getFullName()},appHasCustomContent(){return!$.isEmpty(this.app.customPatientDashboardContentComponent)},customDashboardContent(){return this.app.customPatientDashboardContentComponent},visitDatesTitle(){return"".concat(this.visitDates.length," Visits")}},watch:{activeVisitDate(e){this.appHasCustomContent||this.updateCardVisitData(e)}},created(){this.app=H.getActiveApp(),this.patientCards=[{items:[],cache:{},label:"Activities",color:"primary",isLoading:!1,icon:Y,isEnabled:this.isCardEnabled("activitiesEnabled"),onVisitDate:(e,t)=>{e.isLoading=!0,R.getEncounters(this.patientId,{date:t}).then(o=>{e.items=this.getActivitiesCardInfo(o),e.cache[t]=e.items,e.isLoading=!1,this.sessionEncounterMap={},t===B.getSessionDate()&&!$.isEmpty(o)&&(this.sessionEncounterMap=o.reduce((a,k)=>(a[k.type.name.toLowerCase()]=k.observations.reduce((w,b)=>w.concat(b.concept.concept_names),[]).map(w=>w.name.toLowerCase()),a),{}))}).catch(()=>{e.items=[],e.cache[t]=e.items,e.isLoading=!1})},onClick:e=>{e.isEnabled&&(e.isLoading?K("Please wait..."):this.openModal(e.items,"Select Activities",gt))}},{items:[],cache:{},color:"success",isLoading:!1,label:"Lab Orders",icon:Y,isEnabled:this.isCardEnabled("labEnabled"),onVisitDate:(e,t,o,a)=>{o&&a==="LAB ORDERS"&&M.invalidate("PATIENT_LAB_ORDERS"),e.isLoading=!0,this.getLabOrderCardInfo(t).then(k=>{e.items=k,e.cache[t]=e.items,e.isLoading=!1}).catch(()=>{e.items=[],e.cache[t]=e.items,e.isLoading=!1})},onClick:e=>{var t;return e.isEnabled&&this.$router.push((t=this.app)!=null&&t.getPatientDashboardLabCardRoute?"".concat(this.app.getPatientDashboardLabCardRoute,"/").concat(this.patient.getID(),"?date=").concat(this.activeVisitDate):"/art/encounters/lab/".concat(this.patient.getID()))}},{items:[],label:"Alerts and Clinic Notes",color:"danger",icon:Ue,isLoading:!1,isInit:!1,isEnabled:this.isCardEnabled("alertsEnabled"),onVisitDate:e=>{if(e.isInit)return;const t=this.getPatientAlertCardInfo();typeof t=="object"&&typeof t.then=="function"&&(e.isLoading=!0,this.getPatientAlertCardInfo().then(o=>{o&&(e.items=o),e.isInit=!0,e.isLoading=!1}).catch(()=>{e.items=[],e.isInit=!0,e.isLoading=!1})),t&&(e.items=t)},onClick:()=>{}},{items:[],cache:{},label:"Medications",color:"warning",icon:Y,isLoading:!1,isEnabled:this.isCardEnabled("medicationsEnabled"),onVisitDate:(e,t)=>{e.isLoading=!0,st.getOrderByPatient(this.patientId,{start_date:t}).then(o=>{e.items=this.getMedicationCardInfo(o),e.cache[t]=e.items,e.isLoading=!1}).catch(()=>{e.data,e.items=[],e.cache[t]=e.items,e.isLoading=!1})},onClick:e=>{if(!e.isEnabled)return;if(e.isLoading)return K("Please wait..");const t=["Medication","Start date","End date","Amount given"],o=e.items.map(a=>["".concat(a.other.drug.name).concat(a.other.regimen?" (".concat(a.other.regimen,")"):"").trim(),this.toDate(a.other.order.start_date),this.toDate(a.other.order.auto_expire_date),a.other.quantity]);this.openTableModal(t,o,"Medication History")}}]},mounted(){this.patientId=parseInt("".concat(this.$route.params.id)),this.patientId&&H.doAppManagementTasks().then(()=>{this.app=H.getActiveApp(),this.programId=this.app.programID,this.appHasCustomContent&&(this.patientCards=[]),this.initData()})},methods:{initData(){var e,t;this.programCardInfo=typeof((e=this.app)==null?void 0:e.patientProgramInfoData)=="function"?(t=this.app)==null?void 0:t.patientProgramInfoData(this.patientId):[],this.currentDate=q.currentDisplayDate(),this.sessionDate=this.toDate(B.getSessionDate()),this.isBDE=B.isBDE()||!1,M.get("ACTIVE_PATIENT",{patientID:this.patientId}).then(async o=>{this.patient=o,this.patientCardInfo=this.getPatientCardInfo(o),this.getNextTask().then(a=>this.nextTask=a),this.getPatientVisitDates(this.patientId).then(a=>{this.visitDates=a,this.loadSavedEncounters()}).catch(a=>{console.error(a)});for(const a of this.programCardInfo)typeof a.init=="function"&&await a.init(),typeof a.asyncValue=="function"?a.asyncValue().then(k=>a.value=k):typeof a.staticValue=="function"&&(a.value=a.staticValue())}).catch(o=>Q("".concat(o)))},isCardEnabled(e){var o;const t=(o=this.app)==null?void 0:o.configDefaultPatientDashboardCards;return t&&e in t?t[e]||!1:!0},async showLoader(){(await Z.create({message:"Please wait....",backdropDismiss:!1})).present()},clearLoader(){Z.getTop().then(e=>e?Z.dismiss():null)},toDate(e){return q.toStandardHisDisplayFormat(e)},toTime(e){return q.toStandardHisTimeFormat(e)},loadSavedEncounters(){R.getSavedEncounters(this.patientId).then(e=>{this.savedEncounters=e})},updateCardVisitData(e,t=!1,o=""){this.patientCards.forEach(a=>{if(a.isEnabled&&typeof a.onVisitDate=="function"){if(typeof a.cache=="object"&&a.cache[e]&&!t){a.items=a.cache[e];return}a.onVisitDate(a,e,t,o)}})},async getPatientVisitDates(e){return(await We.getPatientVisits(e,!1)).map(t=>({label:this.toDate(t),value:t,other:{isActive:t===B.getSessionDate()}}))},getNextTask(){return Ge.getNextTaskParams(this.patientId)},goToNextTask(){Je(this.patientId,this.$router)},onActiveVisitDate(e){this.activeVisitDate=e.value},getPatientCardInfo(e){const t=e.getBirthdate(),o=e.getGender()==="M"?Ye:Ze;return[{label:"Name",value:e.getFullName(),other:{icon:o}},{label:"Birthdate",value:"\n                    ".concat(this.toDate(t),"\n                    (").concat(e.getAge(),") \n                    (").concat(e.getNationalID(),")")},{label:"Current Village",value:e.getCurrentVillage()},{label:"Phone#",value:e.getPhoneNumber()}]},getActivitiesCardInfo(e){return e.map(t=>({label:t.type.name,value:this.toTime(t.encounter_datetime),other:{provider:Ke.getPersonFullName(t.provider_id),isBDE:R.isEncounterInBDE(t),id:t.encounter_id,columns:["Observation","Value","Time"],onVoid:async o=>{await this.showLoader(),R.voidEncounter(t.encounter_id,o).then(()=>{this.clearLoader(),this.loadSavedEncounters(),this.updateCardVisitData(this.activeVisitDate,!0,t.type.name),this.getNextTask().then(a=>this.nextTask=a),Qe("Encounter has been voided!",2e3)}).catch(a=>{this.clearLoader(),Q("".concat(a),32e3)})},getRows:async()=>{var k,w,b,r,c,C;const o=[],{observations:a}=t;for(const E in a){let v="<UNKNOWN CONCEPT>";const d=a[E];try{if((k=d==null?void 0:d.concept)!=null&&k.concept_names){const g=(C=(c=(b=(w=d==null?void 0:d.drug)==null?void 0:w.drug_cms)==null?void 0:b.short_name)!=null?c:(r=d==null?void 0:d.drug)==null?void 0:r.name)!=null?C:"",P=g?"(".concat(g,")"):"";v="".concat(d.concept.concept_names[0].name," ").concat(P).trim()}else v=await Xe.getConceptName(d.concept_id)}catch(g){console.error(d,g)}const I=await xe.resolvePrimaryValue(d),D=q.toStandardHisTimeFormat(d.date_created);o.push([v,I,D])}return o}}}))},getMedicationCardInfo(e){return e.map(t=>({label:"".concat(t.drug.name).concat(t.regimen?" (".concat(t.regimen,")"):""),value:this.toTime(t.order.start_date),other:t}))},async getLabOrderCardInfo(e){return typeof this.app.getPatientDashboardLabOrderCardItems=="function"?this.app.getPatientDashboardLabOrderCardItems(this.patientId,e):(await et.getOrders(this.patientId,{date:e})).map(o=>({label:o.specimen.name,value:this.toTime(o.order_date)}))},async getPatientAlertCardInfo(){if("getPatientDashboardAlertsAndNotes"in this.app)return this.app.getPatientDashboardAlertsAndNotes(this.patient)},async changeApp(){const e=await H.selectApplication("PatientDashboard",!0);e&&(e.programID!=this.programId?(this.programId=e.programID,this.$router.push("/patients/confirm?patient_barcode=".concat(this.patient.getNationalID()))):this.initData())},async showTasks(){if("primaryPatientActivites"in this.app){const e=[...this.app.primaryPatientActivites].map(t=>{const o=(t.encounterTypeName||t.name).toLowerCase();return typeof t.taskCompletionChecklist=="object"&&!$.isEmpty(this.sessionEncounterMap)?t.taskCompleted=t.taskCompletionChecklist.every(a=>$.isArray(this.sessionEncounterMap[o])&&this.sessionEncounterMap[o].includes(a.toLowerCase())):t.taskCompleted=!$.isEmpty(this.sessionEncounterMap[o]),t});this.openModal(e,"Tasks for",le,this.sessionDate)}},showOptions(){if("secondaryPatientActivites"in this.app){const e=this.app.secondaryPatientActivites;this.openModal(e,"Select Activity",le)}},async startModal(e,t){(await J.create({component:e,backdropDismiss:!1,cssClass:"large-modal",componentProps:t})).present()},async openModal(e,t,o,a=""){$.isEmpty(this.patientProgram)&&(this.patientProgram=await new tt(this.patientId).getProgram()),this.startModal(o,{items:e,title:"".concat(t,": ").concat(a||this.toDate(this.activeVisitDate.toString())),taskParams:{patient:this.patient.getObj(),program:this.patientProgram,visitDate:this.activeVisitDate,patientID:this.patientId,savedEncounters:this.savedEncounters}})},openTableModal(e,t,o){this.startModal(Ct,{columns:e,rows:t,title:"".concat(o,": ").concat(this.toDate(this.activeVisitDate.toString()))})},onCancel(){M.invalidate("ACTIVE_PATIENT"),M.invalidate("PATIENT_PROGRAM"),M.invalidate("PATIENT_LAB_ORDERS"),this.$router.push({path:"/"})}}}),fe=e=>(it("data-v-ac0d1e98"),e=e(),ot(),e),Ft={key:0},Ut=fe(()=>m("p",null,null,-1)),Wt={class:"his-card info-card-item"},Gt={class:"his-card info-card-item"},Jt={class:"his-card info-card-item"},Yt={class:"his-sm-text his-card"},Zt={key:0},Kt={key:1},Qt=fe(()=>m("b",null,"NONE",-1)),Xt={key:0},xt={key:1},en={key:1};function tn(e,t,o,a,k,w){const b=s("minimal-toolbar"),r=s("ion-icon"),c=s("ion-label"),C=s("ion-segment-button"),E=s("ion-segment"),v=s("ion-toolbar"),d=s("ion-button"),I=s("primary-card"),D=s("ion-col"),g=s("ion-row"),P=s("ion-grid"),L=s("ion-item"),N=s("ion-list"),ie=s("ion-content"),_e=s("ion-footer"),oe=s("ion-page"),ge=s("full-toolbar"),be=s("visit-dates-card"),se=s("ion-chip");return l(),f(T,null,[e.screenBreakPoint==="sm"?(l(),h(oe,{key:0},{default:i(()=>[n(b,{title:e.patientName,menuTitle:e.visitDatesTitle,menuItems:e.visitDates,appIcon:e.app.applicationIcon,onOnClickMenuItem:e.onActiveVisitDate},null,8,["title","menuTitle","menuItems","appIcon","onOnClickMenuItem"]),e.screenBreakPoint==="sm"?(l(),h(v,{key:0},{default:i(()=>[n(E,{value:e.activeTab,class:"ion-justify-content-center"},{default:i(()=>[n(C,{value:"1",onClick:t[0]||(t[0]=u=>e.activeTab=1)},{default:i(()=>[n(r,{icon:e.calendar},null,8,["icon"]),n(c,null,{default:i(()=>[p("Visits")]),_:1})]),_:1}),n(C,{value:"2",onClick:t[1]||(t[1]=u=>e.activeTab=2)},{default:i(()=>[n(r,{icon:e.person},null,8,["icon"]),n(c,null,{default:i(()=>[p("Patient")]),_:1})]),_:1}),n(C,{value:"3",onClick:t[2]||(t[2]=u=>e.activeTab=3)},{default:i(()=>[n(r,{icon:e.medical},null,8,["icon"]),n(c,null,{default:i(()=>[p("Program")]),_:1})]),_:1}),n(C,{value:"4",onClick:t[3]||(t[3]=u=>e.activeTab=4)},{default:i(()=>[n(r,{icon:e.time},null,8,["icon"]),n(c,null,{default:i(()=>[p("Dates")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1})):y("",!0),e.nextTask.name&&e.screenBreakPoint==="sm"?(l(),h(v,{key:1},{default:i(()=>[n(d,{style:{width:"100%"},color:"success",onClick:e.goToNextTask},{default:i(()=>[n(c,null,{default:i(()=>[m("b",null,"Next Task: "+_(e.nextTask.name.toUpperCase()),1)]),_:1}),n(r,{icon:e.alertCircle},null,8,["icon"])]),_:1},8,["onClick"])]),_:1})):y("",!0),n(ie,{id:"main-content"},{default:i(()=>[e.screenBreakPoint==="sm"?(l(),f("div",Ft,[e.appHasCustomContent&&e.activeTab===1&&e.patientIsset?(l(),h(ae(e.customDashboardContent),{key:0,patient:e.patient,visitDate:e.activeVisitDate},null,8,["patient","visitDate"])):y("",!0),!e.appHasCustomContent&&e.activeTab===1?(l(),h(P,{key:1},{default:i(()=>[n(g,null,{default:i(()=>[(l(!0),f(T,null,A(e.patientCards,(u,V)=>(l(),h(D,{size:"12",key:V},{default:i(()=>[(l(),h(I,{key:"mcard".concat(V),isEnabled:u.isEnabled,counter:u.items.length,icon:u.icon,title:u.label,titleColor:u.color,items:u.items,isLoading:u.isLoading,onClick:ve=>u.onClick(u)},null,8,["isEnabled","counter","icon","title","titleColor","items","isLoading","onClick"]))]),_:2},1024))),128))]),_:1})]),_:1})):y("",!0),e.activeTab===2?(l(),h(N,{key:2},{default:i(()=>[(l(!0),f(T,null,A(e.patientCardInfo,(u,V)=>(l(),f("div",{class:"his-card info-card-item",key:V},[n(L,{lines:"none"},{default:i(()=>[n(c,null,{default:i(()=>[p(_(u.label),1)]),_:2},1024),n(c,{slot:"end"},{default:i(()=>[m("b",null,_(u.value),1)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):y("",!0),e.activeTab===3?(l(),h(N,{key:3},{default:i(()=>[(l(!0),f(T,null,A(e.programCardInfo,(u,V)=>(l(),f("div",{class:"his-card info-card-item",key:V},[n(L,{lines:"none"},{default:i(()=>[n(c,null,{default:i(()=>[p(_(u.label),1)]),_:2},1024),n(c,{slot:"end"},{default:i(()=>[m("b",null,_(u.value),1)]),_:2},1024)]),_:2},1024),Ut]))),128))]),_:1})):y("",!0),e.activeTab===4?(l(),h(N,{key:4},{default:i(()=>[m("div",Wt,[n(L,{lines:"none"},{default:i(()=>[n(c,null,{default:i(()=>[p(" Today ")]),_:1}),n(c,{slot:"end"},{default:i(()=>[m("b",null,_(e.currentDate),1)]),_:1})]),_:1})]),m("div",Gt,[n(L,{lines:"none"},{default:i(()=>[n(c,null,{default:i(()=>[p(" Session ")]),_:1}),n(c,{slot:"end"},{default:i(()=>[m("b",null,_(e.sessionDate),1)]),_:1})]),_:1})]),m("div",Jt,[n(L,{lines:"none"},{default:i(()=>[n(c,null,{default:i(()=>[p(" Current visit date ")]),_:1}),n(c,{slot:"end"},{default:i(()=>[m("b",null,_(e.activeVisitDate),1)]),_:1})]),_:1})])]),_:1})):y("",!0)])):y("",!0)]),_:1}),n(_e,null,{default:i(()=>[e.screenBreakPoint==="sm"?(l(),h(v,{key:0,color:"dark"},{default:i(()=>[n(d,{color:"primary",size:"medium",slot:"end",onClick:e.showTasks},{default:i(()=>[n(r,{icon:e.clipboard},null,8,["icon"])]),_:1},8,["onClick"]),n(d,{color:"primary",size:"medium",slot:"end",onClick:e.showOptions},{default:i(()=>[n(r,{icon:e.folder},null,8,["icon"])]),_:1},8,["onClick"]),n(d,{color:"primary",size:"medium",slot:"end",onClick:e.changeApp},{default:i(()=>[n(r,{icon:e.apps},null,8,["icon"])]),_:1},8,["onClick"]),n(d,{color:"success",size:"medium",slot:"end",onClick:e.onCancel},{default:i(()=>[n(r,{icon:e.logOut},null,8,["icon"])]),_:1},8,["onClick"])]),_:1})):y("",!0)]),_:1})]),_:1})):y("",!0),e.screenBreakPoint==="lg"?(l(),h(oe,{key:1},{default:i(()=>[n(ge,{app:e.app,appVersion:e.appVersion,appIcon:e.app.applicationIcon,patientCardInfo:e.patientCardInfo,programCardInfo:e.programCardInfo},null,8,["app","appVersion","appIcon","patientCardInfo","programCardInfo"]),n(ie,{id:"main-content"},{default:i(()=>[n(P,{class:"grid-custom vertically-align"},{default:i(()=>[n(g,null,{default:i(()=>[n(D,{size:"2.4"},{default:i(()=>[n(be,{title:e.visitDatesTitle,items:e.visitDates,onOnselect:e.onActiveVisitDate},null,8,["title","items","onOnselect"])]),_:1}),n(D,{size:"9.6"},{default:i(()=>[m("div",Yt,[n(g,null,{default:i(()=>[n(D,{"size-md":"4","size-sm":"6"},{default:i(()=>[p(" Today's Date: "),m("b",null,_(e.currentDate),1)]),_:1}),n(D,{"size-md":"4","size-sm":"6"},{default:i(()=>[e.nextTask.name?(l(),f("span",Zt,[n(se,{class:"next-task",color:"success",onClick:e.goToNextTask},{default:i(()=>[p("Next Task: "+_(e.nextTask.name.toUpperCase()),1)]),_:1},8,["onClick"])])):(l(),f("span",Kt,[p(" Next Task: "),Qt]))]),_:1}),n(D,{"size-md":"4","size-sm":"12"},{default:i(()=>[e.isBDE?(l(),f("span",Xt,[n(se,{style:{marginTop:"-8px"},color:"danger",onClick:t[4]||(t[4]=u=>e.$router.push({name:"Session Date"}))},{default:i(()=>[m("b",null," BDE: "+_(e.sessionDate.toUpperCase()),1)]),_:1})])):(l(),f("span",xt,[p(" Set Date: "),m("b",null,_(e.sessionDate),1)]))]),_:1})]),_:1}),e.appHasCustomContent&&e.patientIsset?(l(),h(ae(e.customDashboardContent),{key:0,patient:e.patient,visitDate:e.activeVisitDate},null,8,["patient","visitDate"])):y("",!0),e.appHasCustomContent?y("",!0):(l(),f("div",en,[n(g,null,{default:i(()=>[(l(!0),f(T,null,A(e.patientCards,(u,V)=>(l(),h(D,{size:"6",key:V},{default:i(()=>[(l(),h(I,{key:u.label,isEnabled:u.isEnabled,counter:u.items.length,icon:u.icon,title:u.label,titleColor:u.color,items:u.items,isLoading:u.isLoading,onClick:ve=>u.onClick(u)},null,8,["isEnabled","counter","icon","title","titleColor","items","isLoading","onClick"]))]),_:2},1024))),128))]),_:1})]))])]),_:1})]),_:1})]),_:1})]),_:1}),n(v,{color:"dark"},{default:i(()=>[n(d,{color:"primary",size:"large",slot:"end",onClick:e.showTasks},{default:i(()=>[n(r,{icon:e.clipboardOutline},null,8,["icon"]),p(" Tasks ")]),_:1},8,["onClick"]),n(d,{color:"primary",size:"large",slot:"end",onClick:e.showOptions},{default:i(()=>[n(r,{icon:e.folderOutline},null,8,["icon"]),p(" Printouts/Other ")]),_:1},8,["onClick"]),n(d,{color:"primary",size:"large",slot:"end",onClick:e.changeApp},{default:i(()=>[n(r,{icon:e.appsOutline},null,8,["icon"]),p(" Applications ")]),_:1},8,["onClick"]),n(d,{onClick:e.onCancel,color:"success",size:"large",slot:"end"},{default:i(()=>[n(r,{icon:e.logOutOutline},null,8,["icon"]),p(" Finish ")]),_:1},8,["onClick"])]),_:1})]),_:1})):y("",!0)],64)}const rn=O(jt,[["render",tn],["__scopeId","data-v-ac0d1e98"]]);export{rn as default};
