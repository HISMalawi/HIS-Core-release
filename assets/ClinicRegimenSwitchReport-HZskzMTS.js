import{d as f,r as c,o as g,a as _,c as b,w as v,b as R,u as d,cj as h,ci as o,D,I as w,i as C,W as V,dA as S}from"./index-CMZASHAR.js";import{a as x}from"./regimen_report_service-6t8QxExr.js";import{v as A}from"./TableView-DhTjQT8r.js";import{b as P,w as j}from"./v2utils-DPaBC-nQ.js";import"./Export-CpyT9Gk1.js";import"./index-_zuoFVCp.js";const q=f({__name:"ClinicRegimenSwitchReport",setup(B){const m=C("reports.png"),r=c([]),i=c(""),a=new x,p=[[P(),{label:"Gender",ref:"gender",toValue:e=>h(e)},{label:"DOB",ref:"birthdate",toValue:e=>o(e)},{label:"ART start date",ref:"art_start_date",toValue:e=>o(e)},{label:"Weight",ref:"current_weight"},{label:"Prev.Reg",ref:"previous_regimen"},{label:"Curr.Reg",ref:"current_regimen"},{label:"ARVs",ref:"medication",toValue:e=>e.map(t=>"".concat(t.medication," (").concat(t.quantity,")")).join(", ")},{label:"Curr.reg dispensed",ref:"last_dispensation_date",toValue:e=>o(e)}]],s=()=>j(async()=>{if(!(a.startDate&&a.endDate))return V("Start date and end date required!");r.value=[];const e=await a.getRegimenSwitchReport(!1);r.value=Object.values(e).map(t=>({...t,last_dispensation_date:t.medication.reduce((u,n)=>n.start_date,"")})),r.value.length<=0&&S("Report complete but no data!",3e3)}),l=()=>D({onFinish:(e,t,u,n)=>{n&&a.setOccupation(n),i.value="".concat(u),a.startDate=e,a.endDate=t,s()}});return g(()=>!r.value.length&&l()),(e,t)=>(_(),b(d(w),null,{default:v(()=>[R(A,{"default-sort-order":"asc","default-sorted-column":"arv_number","icon-url":d(m),title:"Clinic Regimen Switch Report","report-prefix":"Clinic",subtitle:i.value,columns:p,columnData:r.value,rowsPerPage:50,onConfigure:l,onRefresh:s},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{q as default};
