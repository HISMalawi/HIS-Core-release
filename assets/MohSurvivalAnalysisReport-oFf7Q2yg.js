var f=Object.defineProperty;var v=(t,o,r)=>o in t?f(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r;var p=(t,o,r)=>(v(t,typeof o!="symbol"?o+"":o,r),r);import{bB as T,d as R,I as b,L as e,V as w,ab as m,_ as y,r as c,o as x,c as S,w as _,b as C}from"./index-hoLU9YgK.js";import{_ as I}from"./ReportMixin.vue_vue_type_script_lang-VKPiCK7V.js";import{R as A}from"./TableReportTemplate-w1n0QulW.js";import{F as E}from"./dynamic-import-helper-9HnG3Mif.js";import"./MultiFieldDateHelper-PDSV6pPV.js";import"./KbLayouts-9dqmDWmG.js";import"./HisKbConfigurations-a7K7dizM.js";import"./BasicReportTemplate-7WBogXGX.js";import"./Export-g1vHKjsV.js";import"./SIngleTouchField-iKsJUYy8.js";import"./Pagination-Ex8Q9IMR.js";import"./HisStandardForm-rzQ2tZDj.js";import"./TouchScreenForm-3AdFBAzj.js";import"./ToolbarMediumCard-8sJVQ55x.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-kkmofE00.js";import"./ReportErrors-9sOxwrH3.js";var u=(t=>(t.GENERAL="General",t.CHILDREN="Children",t.WOMEN="Women",t))(u||{});class G extends T{constructor(){super();p(this,"ageGroup");p(this,"quarter");p(this,"regenerate");this.quarter="",this.regenerate=!1,this.ageGroup="General"}setRegenerate(r){this.regenerate=r}getAgeGroup(){return this.ageGroup}setQuarter(r){this.quarter=r}setAgeGroup(r){this.ageGroup=r}getSurvivalAnalysis(){return this.getReport("cohort_survival_analysis",{quarter:this.quarter,regenerate:this.regenerate,date:this.date,age_group:this.ageGroup,program_id:this.programID})}}const g={style:{borderRight:"5px solid black !important"}},D=R({mixins:[I],components:{ReportTemplate:A,IonPage:b},data:()=>({title:"Survival analysis report",totalClients:[],rows:[],columns:[[e.thTxt("Reg cohort"),e.thTxt("Interval (months)"),e.thTxt("Sub group"),e.thTxt("Total Reg (database)"),e.thTxt("Total Reg (Confirmed)",g),e.thTxt("Alive"),e.thTxt("Died"),e.thTxt("Defaulted"),e.thTxt("Stopped"),e.thTxt("TO"),e.thTxt("Unknown")]]}),created(){this.fields=[...this.getDateDurationFields(!0,!1,17),{id:"group",helpText:"Select sub-group",type:E.TT_SELECT,validation:t=>w.required(t),options:()=>[{label:"General",value:u.GENERAL},{label:"Children",value:u.CHILDREN},{label:"Option B+",value:u.WOMEN}]}]},methods:{async onPeriod({quarter:t,group:o},r,a=!1){this.rows=[],this.period=t.label,this.report=new G,this.report.setOccupation(r.occupation),this.report.setRegenerate(a),this.report.setQuarter(t.label),this.report.setAgeGroup(o.value);const i=await this.report.getSurvivalAnalysis();this.title="Survival analysis report ".concat(o.label),this.rows=this.getRows(i)},getRows(t){return Object.keys(t).filter(o=>!m.isEmpty(t[o])).sort((o,r)=>{const a=o.split(" ")[1],i=r.split(" ")[1];return parseInt(a)-parseInt(i)}).map(o=>{const r=t[o];let a=0,i=0;const s={"On antiretrovirals":0,Defaulted:0,"Patient died":0,"Treatment stopped":0,"Patient transferred out":0,unknown:0};if(!m.isEmpty(r)){for(const n in r){const l=r[n];for(const h in l){const d=l[h];a=parseInt(h),n in s?s[n]=d:s.unknown=d,i+=d}}return[e.td(o),e.td(a),e.td(this.report.getAgeGroup()),e.td(i),e.td("",g),e.td(s["On antiretrovirals"]),e.td(s["Patient died"]),e.td(s.Defaulted),e.td(s["Treatment stopped"]),e.td(s["Patient transferred out"]),e.td(s.unknown)]}})}}});function k(t,o,r,a,i,s){const n=c("report-template"),l=c("ion-page");return x(),S(l,null,{default:_(()=>[C(n,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!1},reportPrefix:"MoH",hasServerSideCaching:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const Y=y(D,[["render",k]]);export{Y as default};
