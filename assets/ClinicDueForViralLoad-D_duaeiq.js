import{d as n,I as l,cH as p,L as t,cJ as d,aW as c,S as m,_ as h,r as o,o as u,c as _,w as f,b as x}from"./index-BFVcutZq.js";import{_ as T}from"./ReportMixin.vue_vue_type_script_lang-DYy2lpd9.js";import{R as w}from"./TableReportTemplate-BDV868op.js";import"./HisStandardForm-DO3sZVdL.js";import"./ReportErrors-B0y1wUIE.js";const D=n({mixins:[T],components:{ReportTemplate:w,IonPage:l},data:()=>({title:"Clinic Clients due for VL <small>(clients with appointments in specified period)</small>",rows:[],columns:[]}),async created(){const s=await p.filingNumbersEnabled();this.columns.push([t.thTxt(s?"Filing #":"ARV#"),t.thTxt("First name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Last name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Gender"),t.thTxt("Age"),t.thTxt("App."),t.thTxt("ART started"),t.thTxt("Months on ART"),t.thTxt("Milestone"),t.thTxt("Ordered"),t.thTxt("Result"),t.thTxt("Released")]),this.fields=this.getDateDurationFields(!1,!1,5,null)},methods:{async onPeriod(s,e){this.rows=[],this.report=new d,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.report.setOccupation(e.occupation),this.period=this.report.getDateIntervalPeriod();const a=await this.report.getClientsDueForVl();this.setRows(a)},async setRows(s){s.forEach(e=>{this.rows.push([t.tdLink(e.arv_number,()=>this.confirmPatient(e.patient_id)),t.td(e.given_name),t.td(e.family_name),t.td(this.formatGender(e.gender)),t.td(e.birthdate?c(m.getSessionDate()).diff(e.birthdate,"years"):"N/A"),t.tdDate(e.appointment_date),t.tdDate(e.start_date),t.td(e.months_on_art),t.tdDate(e.mile_stone),t.tdDate(e.last_result_order_date),t.td(e.last_result),t.tdDate(e.last_result_date)])})}}});function R(s,e,a,g,b,C){const r=o("report-template"),i=o("ion-page");return u(),_(i,null,{default:f(()=>[x(r,{title:s.title,period:s.period,rows:s.rows,fields:s.fields,columns:s.columns,showtitleOnly:!0,canExportPDf:!0,encryptPDF:!0,onReportConfiguration:s.onPeriod,"report-prefix":"Clinic"},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const F=h(D,[["render",R]]);export{F as default};
