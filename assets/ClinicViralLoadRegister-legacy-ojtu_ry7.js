System.register(["./index-legacy-CA6M7ipO.js","./TableView-legacy-2WevvWny.js","./v2utils-legacy-Bs3stsn1.js","./Export-legacy-SGgsNE3Q.js","./index-legacy-DZOKxSjk.js"],(function(e,t){"use strict";var l,a,r,s,d,o,u,n,i,c,v,_,b,g,f,T,m,y,p,D,h,w;return{setters:[e=>{l=e.d,a=e.r,r=e.cy,s=e.at,d=e.o,o=e.a,u=e.c,n=e.w,i=e.b,c=e.u,v=e.ci,_=e.H,b=e.D,g=e.I,f=e.i,T=e.df,m=e.dg,y=e.aM},e=>{p=e.v},e=>{D=e.b,h=e.w,w=e.s},null,null],execute:function(){e("default",l({__name:"ClinicViralLoadRegister",setup(e){const t=f("reports.png"),l=a(""),O=a([]),R=a("All"),j=a([]),C=new r,A=[[D(),{label:"Accession #",ref:"accession_number"},{label:"Status",ref:"order_status"},{label:"Order Date",ref:"date_ordered",toValue:e=>`${v(e)}`},{label:"Result",ref:"result",toValue:e=>e?e.replace(/</g,"&lt;"):""},{label:"Date received",ref:"date_received",toValue:e=>`${v(e)??""}`},{label:"Mode of Delivery",ref:"result_delivery_mode",toValue:e=>"test_results_delivered_to_site_electronically"==e?"Electronic":"test_results_delivered_to_site_manually"==e?"Manual":""},{label:"Test reason",ref:"test_reason"},{label:"TAT(Days)",ref:"tat",value:e=>e.date_received&&e.date_ordered?_.dateDiffInDays(e.date_received,e.date_ordered):""}]],S={All:()=>!0,"No results":e=>!e.result,"With Results":e=>e.result,Rejected:e=>"test-rejected"===e.order_status,Drawn:e=>"drawn"===e.order_status,Pending:e=>"pending"===e.order_status,Started:e=>"started"===e.order_status,Failed:e=>"failed"===e.order_status,"Not-done":e=>"not-done"===e.order_status,Completed:e=>"completed"===e.order_status,"Targeted orders":e=>/target/i.test(`${e.test_reason}`),"Targeted orders with results":e=>/target/i.test(`${e.test_reason}`)&&e.result},x=e=>S[e]?O.value.filter((t=>S[e](t))):[],P=s((()=>x(R.value))),V=()=>{j.value=[{text:"<b>High level view</b>",icon:T,color:"primary",action:()=>(async()=>{const e=e=>x(e).length||"0",t=[{label:"Total Orders",value:e("All")},{label:"Total Orders With Results",value:e("With Results")},{label:"Total Orders No Results",value:e("No results")},{label:"Total Orders Rejected",value:e("Rejected")},{label:"Total Targeted Orders",value:e("Targeted orders")},{label:"Total Targeted Orders With Results",value:e("Targeted orders with results")},{label:"Total Orders Drawn",value:e("Drawn")},{label:"Total Orders Pending",value:e("Pending")},{label:"Total Orders Started",value:e("Started")},{label:"Total Orders Failed",value:e("Failed")},{label:"Total Orders Not-done",value:e("Not-done")},{label:"Total Orders Completed",value:e("Completed")},{label:"Average TAT (days)",value:(()=>{let e=0;const t=O.value.reduce(((t,l)=>l.date_received&&l.date_ordered?(++e,t+parseInt(`${_.dateDiffInDays(l.date_received,l.date_ordered)}`)):t),0);return Math.floor(t/e)})()}];w({title:"Register Summary",columns:[[{label:"Indicator",ref:"label"},{label:"Count",ref:"value"}]],columnData:t,subtitle:l.value,rowsPerPage:50})})()},{text:`<b>Report filter: <i>${R.value}</i></b>`,icon:m,color:"primary",action:async()=>{const e=await y("Select report filter","",Object.keys(S),[{name:"Cancel",slot:"start"},{name:"Select",slot:"end",role:"action"}]);R.value=e?.selection||R.value,V()}}]},$=()=>h((async()=>{O.value=[],j.value=[],O.value=await C.getClinicElectronicAlerts(),V()})),N=()=>b({onFinish:(e,t,a,r)=>{r&&C.setOccupation(r),l.value=`${a}`,C.startDate=e,C.endDate=t,$()}});return d((()=>!O.value.length&&N())),(e,a)=>(o(),u(c(g),null,{default:n((()=>[i(p,{"default-sort-order":"asc","default-sorted-column":"arv_number","icon-url":c(t),subtitle:l.value,title:"Viral Load Register","report-prefix":"Clinic",columns:A,onConfigure:N,headerBadge:j.value,columnData:P.value,rowsPerPage:50,onRefresh:$},null,8,["icon-url","subtitle","headerBadge","columnData"])])),_:1}))}}))}}}));
