System.register(["./index-legacy-HpoRL6sM.js","./ReportDateSelectionPrompt-legacy-XzooytAM.js","./tx_report_service-legacy-DKKxLExg.js","./TableView-legacy-D9y_CPZX.js","./ArtDrilldown-legacy-B-BNT-Ch.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./MultiFieldDateHelper-legacy-Ca_7culp.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./PopupKeyboard-legacy-CMLSx4kz.js","./SIngleTouchField-legacy-58JVf1y9.js","./TouchScreenForm-legacy-D3QVjNom.js","./ToolbarMediumCard-legacy-BjHrpWWd.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-u0ytW13O.js","./HisKeypad-legacy-BC3UajGc.js","./BaseKeyboard-legacy-Dk1FAYaj.js","./KbHandler-legacy-De8o5nTq.js","./fuse-legacy-CQoBB3MK.js","./Export-legacy-t2OOVOE7.js","./HisKeyboard-legacy-CViezLhc.js"],(function(e,a){"use strict";var t,n,r,l,o,s,g,c,u,i,d,p,_,m,y,b,f,h,j,D,F,w,v;return{setters:[e=>{t=e.d,n=e.I,r=e.c4,l=e.K,o=e.N,s=e.a9,g=e.t,c=e.ab,u=e.c5,i=e.O,d=e.q,p=e.c6,_=e.c7,m=e._,y=e.r,b=e.o,f=e.c,h=e.w,j=e.b},e=>{D=e.D},e=>{F=e.T},e=>{w=e.v},e=>{v=e.A},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const a=t({components:{IonPage:n,IonLoading:r,v2Datatable:w},setup(){const e=l([]),a=l(""),t=l(!1),n=l([]),r=new F;function m(e,a){return{ref:a,label:e,toValue:e=>e.length,tdClick:async e=>{e.refData.length&&(await i.create({component:v,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:`${e.data.age_group} ${e.data.gender} ${e.column.label}`,patientIdentifiers:e.refData,onFinish:()=>i.getTop().then((e=>e&&i.dismiss()))}})).present()}}}const y=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},m("CD4 <200","cd4_less_than_200"),m("CD4 >=200","cd4_greater_than_or_equal_to_200"),m("Unknown CD4","unknown_cd4_count"),m("Not Eligible for CD4","not_eligible_for_cd4"),m("Returned <3 mo","returned_less_than_3_months"),m("Returned 3-5 mo","returned_greater_than_3_months_and_less_than_6_months"),m("Returned 6+ mo","returned_greater_than_or_equal_to_6_months")]],b=async()=>{r.startDate&&r.endDate||g("Start date and end date required!"),t.value=!0;try{const t=await r.getTxRttReport(),l={F:"Female",M:"Male"},o=t.reduce(((e,a)=>("Unknown"!=a.age_group&&(e[a.gender].rows.push({...a,gender:l[a.gender]}),e[a.gender].aggregate=Object.keys(a).reduce(((e,t)=>Array.isArray(a[t])?{...e,[t]:[...e[t]||[],...a[t]]}:e),e[a.gender].aggregate)),e)),{M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}});e.value=[...o.F.rows,...o.M.rows,{age_group:"All",gender:"Male",...o.M.aggregate}];const s=Object.values(o.F.aggregate).flat(1),g=await r.getMaternalStatus(c.uniq(s)),d=g.FBf.concat(g.FP);["FP","FNP","FBf"].forEach((a=>{e.value.push(Object.keys(o.F.aggregate).reduce(((e,t)=>({...e,[t]:o.F.aggregate[t].filter((e=>"FNP"===a?!d.includes(e):g[a].includes(e)))})),{age_group:"All",gender:a}))})),e.value=e.value.map(((e,a)=>({index:a+1,...e})));const p=Object.values(o.M.aggregate).flat(1),_=c.uniq([...s,...p]);n.value=[{id:"stats",text:`Total <b>${_.length}</b>`,icon:u,color:"primary",action:async()=>{(await i.create({component:v,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:"Total Clients",subtitle:a.value,patientIdentifiers:_,onFinish:()=>i.getTop().then((e=>e&&i.dismiss()))}})).present()}}]}catch(l){console.error(l),d("Unable to generate report!"),n.value=[{text:"Unable to generate report!",color:"danger",icon:p,action:function(){n.value=[{text:`Exception occured: <b>${l}</b>`,color:"danger",icon:_}]}}]}t.value=!1},f=()=>D({onFinish:(e,t,n,l)=>{a.value=n,r.startDate=e,r.endDate=t,l&&r.setOccupation(l),b()}});return o((()=>f())),{headerBadge:n,reportData:e,isLoading:t,Img:s,configure:f,generate:b,columns:y,period:a}}});e("default",m(a,[["render",function(e,a,t,n,r,l){const o=y("ion-loading"),s=y("v2Datatable"),g=y("ion-page");return b(),f(g,null,{default:h((()=>[j(o,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),j(s,{title:"TX RTT Report","report-prefix":"Pepfar","icon-url":e.Img("login-logos/PEPFAR.png"),subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,headerBadge:e.headerBadge,onConfigure:e.configure,onRefresh:()=>e.generate()},null,8,["icon-url","subtitle","columns","columnData","headerBadge","onConfigure","onRefresh"])])),_:1})}]]))}}}));
