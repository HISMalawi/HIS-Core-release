System.register(["./index-legacy-BiNmSRfH.js","./BasicReportTemplate-legacy-D3ZA3AVF.js","./opd_report_service-legacy-BWk_6vbe.js","./MOHReportHeader-legacy-D5DRrF5-.js"],(function(t,e){"use strict";var a,r,n,o,i,s,l,d,c,h,m,p,u,D;return{setters:[t=>{a=t.d,r=t.S,n=t.al,o=t.am,i=t.a$,s=t.B,l=t.ay,d=t.z,c=t.aZ,h=t.H,m=t.at},t=>{p=t.D},t=>{u=t.O},t=>{D=t.I}],execute:function(){t("_",a({data:()=>({fields:[],report:{},reportReady:!1,period:"",startDate:"",endDate:"",customFileName:"",drillDownCache:{}}),methods:{toDate:t=>h.toStandardHisDisplayFormat(t),confirmPatient(t){return this.$router.push(`/patients/confirm?person_id=${t}`)},async exportToCustomPDF(t){const e=open("","","width:1024px, height:768px"),a=document.getElementById("report-content");a&&e&&(e.document.write(`\n                    <html>\n                    <head>\n                        <title>${t}</title>\n                        <link rel="stylesheet" media="print" href="/assets/css/cohort.css" />\n                    </head>\n                    <body>\n                        ${a.innerHTML}\n                    </body>\n                    </html>\n                `),setTimeout((()=>{e.print(),e.close()}),3500))},async onDrillDown(t,e){if(c.isEmpty(e))return;const a=[[l.thTxt("First name"),l.thTxt("Last name"),l.thTxt("Gender"),l.thTxt("Age"),l.thTxt("Phone"),l.thTxt("Address"),l.thTxt("Action")]];return this.drilldownData(t,a,e,(async t=>await Promise.all(t.map((async t=>{const e=await m.findByID(t),a=new m(e);return[l.td(a.getGivenName()),l.td(a.getFamilyName()),l.td(a.getGender()),l.td(a.getAge()),l.td(a.getPhoneNumber()),l.td(`${a.getCurrentDistrict()}, ${a.getCurrentVillage()}, ${a.getClosestLandmark()}`),l.tdBtn("Select",(async()=>{await d.dismiss({}),this.$router.push({path:`/patient/dashboard/${t}`})}))]})))))},async drilldownAsyncRows(t,e,a){(await d.create({component:p,cssClass:"large-modal",componentProps:{title:t,columns:e,asyncRows:a,showFilters:!0,rowsPerPage:50,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>d.dismiss()}})).present()},async drilldownData(t,e,a,r){(await d.create({component:p,cssClass:"large-modal",componentProps:{title:t,columns:e,rows:a,rowParser:r,rowsPerPage:50,showFilters:!0,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>d.dismiss()}})).present()},getDefaultDrillDownTable(){return{rowParser:t=>t.map((async t=>{const[e,a]=t;if(a in this.drillDownCache)return[e];const r=await m.findByID(a),n=new m(r),o=[e,l.td(n.getArvNumber()),l.td(n.getGender()),l.tdDate(n.getBirthdate().toString()),l.tdBtn("Show",(async()=>{await d.dismiss({}),this.$router.push({path:`/patient/dashboard/${a}`})}))];return this.drillDownCache[a]=o,o})),columns:[[l.thTxt("ARV number"),l.thTxt("Gender"),l.thTxt("Birth Date"),l.thTxt("Actions")]]}},runTableDrill(t,e="Drilldown patients"){const{columns:a,rowParser:r}=this.getDefaultDrillDownTable();this.drilldownData(e,a,t,r)},drill(t,e="Drill table"){return t&&t.length>0?l.tdLink(t.length,(()=>this.runTableDrill(t,e))):l.td(0)},getEpiweeksFields:()=>[{id:"epiweek",helpText:"Select EPI week",type:o.TT_SELECT,validation:t=>n.required(t),options:async()=>(await D.getReportEpiWeeks()).map((t=>({label:t.name+" - ("+s(t.start).format("DD/MMM/YYYY")+" - "+s(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getMonthlyFields:()=>[{id:"idsrmonth",helpText:"Select Month",type:o.TT_SELECT,validation:t=>n.required(t),options:async()=>(await D.getReportMonths()).map((t=>({label:t.name+" - ("+s(t.start).format("DD/MMM/YYYY")+" - "+s(t.end).format("DD/MMM/YYYY")+")",value:t.start,other:t})))}],getDateDurationFields(t=!1,e=!1,a=5){const s=r.getSessionDate();return[{id:"quarter",helpText:"Select Quarter",type:o.TT_SELECT,condition:()=>t,validation:t=>n.required(t),options:()=>{let t=u.getReportQuarters(a).map((t=>({label:t.name,value:t.start,other:t})));return e&&(t=[{label:"Set custom period",value:"custom_period",other:{}},...t]),t}},...i({id:"start_date",helpText:"Start",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,minDate:()=>"2001-01-01",maxDate:()=>s,estimation:{allowUnknown:!1},computeValue:t=>t}),...i({id:"end_date",helpText:"End",required:!0,condition:e=>e.quarter&&"custom_period"===e.quarter.value||!t,unload:(t,e,a,r)=>{"next"===e&&(this.endDate=r.end_date)},minDate:(t,e)=>e.start_date,maxDate:()=>s,estimation:{allowUnknown:!1},computeValue:t=>t})]}}}))}}}));
