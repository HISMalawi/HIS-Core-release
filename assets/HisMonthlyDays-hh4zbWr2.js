import d from"./BaseTextInput-CYKc9m-x.js";import{H as c}from"./HisKeyboard-DxmrJWpu.js";import{k as p}from"./KbHandler-BuQ4TFU6.js";import{M as y}from"./HisKbConfigurations-GhFQZvlg.js";import{V as b}from"./ViewPort-DixuDTZA.js";import{M as k}from"./KbLayouts-VRA-vjeH.js";import{_ as V}from"./FieldMixin.vue_vue_type_script_lang-qMf9z2fm.js";import{d as _,_ as v,r as o,o as l,x as u,b as n,w as g,v as w,z as D,F as $}from"./index-BPESSmpp.js";import"./BaseKeyboard-DxmkwR6c.js";const K=_({components:{BaseInput:d,HisKeyboard:c,ViewPort:b},mixins:[V],data:()=>({value:"",errors:"",minDays:1,maxDays:30,keyboard:[]}),mounted(){this.init()},activated(){this.init()},methods:{async init(){this.$emit("onFieldActivated",this);let e=k;this.config?(this.config.year&&this.config.month&&(e=this.generateKeypad(this.config.year(this.fdata),this.config.month(this.fdata))),this.config.keyboardActions?this.keyboard=[e,this.config.keyboardActions]:this.keyboard=[e,[["Unknown"]]]):this.keyboard=y,await this.setDefaultValue()},onKbValue(e){this.value=e,this.emitValue()},keypress(e){this.value=p(e,""),this.emitValue()},emitValue(){this.errors="";let e=this.value;if(!e){this.$emit("onValue",null);return}if(e.toString().match(/unknown/i)){this.$emit("onValue",{label:"Unknown",value:"Unknown"});return}if(isNaN(e)){this.errors="Invalid number",this.$emit("onValue",null);return}e=parseInt(e),e<this.minDays||e>this.maxDays?(this.errors="Value number is out of range",this.$emit("onValue",null)):this.$emit("onValue",{label:e,value:e})},generateKeypad(e,r){const t=[[]];this.maxDays=new Date(e,r,0).getDate();let a=0,s=0;for(let i=0;i<this.maxDays;++i)s>7&&(++a,t[a]=[],s=0),t[a].push("".concat(i+1)),++s;return t},async setDefaultValue(){if(this.defaultValue&&!this.value){const e=await this.defaultValue(this.fdata,this.cdata);e&&(this.value=e,this.emitValue())}}},watch:{clear(){this.value=""}}}),C={key:0,style:{color:"red","font-weight":"bold"}};function H(e,r,t,a,s,i){const h=o("base-input"),m=o("view-port"),f=o("his-keyboard");return l(),u($,null,[n(m,null,{default:g(()=>[n(h,{value:e.value,onOnValue:e.onKbValue},null,8,["value","onOnValue"]),e.errors?(l(),u("span",C," **"+w(e.errors)+"** ",1)):D("",!0)]),_:1}),n(f,{kbConfig:e.keyboard,onKeyPress:e.keypress,disabled:!1},null,8,["kbConfig","onKeyPress"])],64)}const I=v(K,[["render",H]]);export{I as default};
