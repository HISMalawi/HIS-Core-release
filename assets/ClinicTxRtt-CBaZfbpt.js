import{d as $,r as A,ce as C,t as I,u as N,v as V,w as q,x as K,y as O,cW as U,a5 as W,aK as X,du as z,aM as H}from"./index-BoUMTIjB.js";import{T as J}from"./tx_report_service-Cr99DgZV.js";import{v as L}from"./TableView-Bt3Sm_T2.js";import{s as Q,w as Y}from"./v2utils-B7MuYY86.js";import"./Export-UGDCL4eA.js";import"./index-Wy4X0smJ.js";const se=$({__name:"ClinicTxRtt",setup(Z){const T=X("reports.png"),s=A([]),f=A(""),l=new J,p=e=>({...e,toValue:r=>r.length,tdClick:async r=>{Q({subtitle:f.value,patientIdentifiers:r.refData,title:"".concat(r.data.age_group," ").concat(C(r.data.gender)," ").concat(r.column.label)})}}),j=[[{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender",toValue:e=>C(e)},p({label:"Returned <3 mo",ref:"less_than_three_months"}),p({label:"Returned 3-5 mo",ref:"three_to_five_months"}),p({label:"Returned 6+ mo",ref:"more_than_six_months"})]],k=e=>e<3?"less_than_three_months":e>=3&&e<=5?"three_to_five_months":e>=6?"more_than_six_months":"unknown",i=()=>({less_than_three_months:[],three_to_five_months:[],more_than_six_months:[]}),d=()=>Y(async()=>{var g,F,v;s.value=[];const e={M:i(),F:i()},r=await l.getClinicTxRtt(),u=z.reduce((a,t)=>r[t]?(["M","F"].forEach(n=>{r[t][n].forEach(h=>{var b,x,D,M,R,w,P,y;const _=k(h.months);a[n]={...(b=a[n])!=null?b:{},[t]:{...(D=(x=a[n])==null?void 0:x[t])!=null?D:i(),[_]:[...(w=(R=(M=a[n])==null?void 0:M[t])==null?void 0:R[_])!=null?w:[],h.patient_id]}},e[n]={...e[n],[_]:[...(y=(P=e[n])==null?void 0:P[_])!=null?y:[],h.patient_id]}})}),a):{M:{...a.M,[t]:i()},F:{...a.F,[t]:i()}},{}),c=a=>Object.keys(u[a]).map(t=>({...u[a][t],age_group:t,gender:a}));s.value=[...c("F"),...c("M"),{age_group:"All",gender:"Male",...e.M}];const G=Object.values(e.F).flat(1),o=await l.getMaternalStatus(H.uniq(G)),B=(g=o==null?void 0:o.FP)!=null?g:[],E=(F=o==null?void 0:o.FBf)!=null?F:[],S=(v=o==null?void 0:o.FNP)!=null?v:[];s.value=[...s.value,{age_group:"All",gender:"FP",...Object.keys(e.F).reduce((a,t)=>({...a,[t]:e.F[t].filter(n=>B.includes(n))}),{})},{age_group:"All",gender:"FNP",...Object.keys(e.F).reduce((a,t)=>({...a,[t]:e.F[t].filter(n=>S.includes(n))}),{})},{age_group:"All",gender:"FBF",...Object.keys(e.F).reduce((a,t)=>({...a,[t]:e.F[t].filter(n=>E.includes(n))}),{})}]}),m=()=>U({onFinish:(e,r,u,c)=>{c&&l.setOccupation(c),f.value="".concat(u),l.startDate=e,l.endDate=r,d()}});return I(()=>!s.value.length&&m()),(e,r)=>(N(),V(O(W),null,{default:q(()=>[K(L,{"icon-url":O(T),subtitle:f.value,title:"TX RTT Report","report-prefix":"Clinic",columns:j,onConfigure:m,columnData:s.value,rowsPerPage:100,onRefresh:d},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{se as default};
