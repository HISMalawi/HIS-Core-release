import{d as l,an as c,bC as i,W as p,aR as f,bB as r,B as o,a_ as m,ak as u,b as h,ap as _,a as b}from"./index-CJleCCtM.js";import{H as g}from"./HisStandardForm-BPNPJCrM.js";import{_ as y}from"./EncounterMixin.vue_vue_type_script_lang-Cy2p88dG.js";import"./encounter_guidelines-CfQXyRxl.js";import"./GuidelineEngine-D6V1_Znr.js";const O=l({mixins:[y],components:{HisStandardForm:g},data:()=>({fields:[],fieldContext:{}}),watch:{ready:{handler(e){e&&(this.fields=this.getFields())}}},methods:{onFinish(){this.nextTask()},getFields(){return[{id:"patient_lab_orders",helpText:"Lab orders",type:c.TT_LAB_ORDERS,onload:e=>{this.fieldContext=e},options:async()=>{const e=await i.getOrdersIncludingGivenResultStatus(this.patientID);return[{label:"Lab orders",value:"order trail",other:{values:i.formatLabs(e)}}]},config:{printOrder:e=>p(e),hiddenFooterBtns:["Clear"],footerBtns:[{name:"Order",size:"large",slot:"end",color:"primary",visible:!0,onClick:async()=>{if(!f.isEmpty(this.fieldContext)){if(i.getProgramName()!="ART")return this.fieldContext.launchOrderSelection();if(await(async()=>{const a=parseInt("".concat(this.$route.params.patient_id)),t=await r.getFirstObs(a,"Patient present");if(!t)return!1;const s=o(t.obs_datetime),n=o(r.getSessionDate());return s.isSame(n,"day")&&t.value_coded==="No"})())return m("Guardian visit warning","Doing lab orders on a guardian only visit is strictly forbidden.","Please arrange for a patient visit and update the HIV Reception encounter to proceed...",[{name:"Close",slot:"start",color:"primary"}],"his-danger-color");await this.fieldContext.launchOrderSelection()}}}]}}]}}});function v(e,a,t,s,n,C){const d=_("his-standard-form");return b(),h(d,{fields:e.fields,onOnFinish:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onOnFinish","cancelDestinationPath"])}const B=u(O,[["render",v]]);export{B as default};
