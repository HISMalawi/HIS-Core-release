import{d as K,k as Q,i as W,ah as A,aE as X,a7 as Y,l as Z,r as E,c as $,aR as G,cf as x,cg as ee,ck as te,cn as ae,a_ as H,am as oe,ar as j,h as v,b as i,g as L,e as f,a9 as B,aa as z,w as c,a as D,a6 as S,t as R,bc as le,j as b,ak as ne,al as se,d9 as re,C as ue,f as _,bg as U,b9 as q,bh as ie,bN as ce,cw as de}from"./index-qFt4YszW.js";const fe=K({components:{IonToolbar:Z,IonItem:Y,IonIcon:X,IonLabel:A,IonButton:W,IonFooter:Q},props:{columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},rowsPerPage:{type:Number,default:10},defaultSortedColumn:{type:String},defaultSortOrder:{type:Object}},setup(e){const V=E([]),p=E(0),C=E(""),y=E("desc"),g=$(()=>{let s=V.value;return y.value&&C.value&&(s=ae(V.value)[y.value](u=>u.sortData[C.value])),s}),l=$(()=>H.chunk(g.value,e.rowsPerPage).length),O=$(()=>p.value+2<=l.value),w=$(()=>p.value>0),t=$(()=>H.chunk(g.value,e.rowsPerPage)[p.value]),o=s=>{C.value=s,y.value=y.value==="asc"?"desc":"asc"},a=()=>te(s=>{const u=parseInt(s);parseInt(s)<=l.value&&(p.value=u)},{title:"Select page"}),r=()=>p.value=0,h=()=>p.value=l.value-1||0,n=()=>p.value+=1,m=()=>p.value-=1,k=s=>{var u,N;try{typeof((u=s.column)==null?void 0:u.tdClick)=="function"&&((N=s.column)==null||N.tdClick(s));return}catch(T){console.error(T)}},I=()=>e.columns.reduce((s,u)=>s.concat(u),[]).filter(s=>s.value||s.ref),M=s=>{s.forEach(u=>{const N={...u},T=I().map(d=>{let P="";const F=u[d.ref];try{H.isEmpty(u)?P="":typeof d.toValue=="function"?P="".concat(d.toValue(F)):typeof d.value=="function"?P=d.value(u):P=u[d.ref]||""}catch(J){P=(d==null?void 0:d.defaultValue)||"_ERROR_",console.error(J)}return N[d.ref]=P,typeof d.sortValue=="function"&&(N[d.ref]=d.sortValue(F)),{column:d,refData:F,value:P,data:u}});V.value.push({row:T,data:u,sortData:N,searchIndex:[...T,T.map(d=>d.value).join(" ")]})})};return G(()=>e.columnData,s=>{var u;if(V.value=[],!Array.isArray(s)||!s.length){p.value=0,C.value=(u=e.defaultSortedColumn)!=null?u:"",y.value=e.defaultSortOrder||"desc",M(Array.from({length:0}).map(()=>({})));return}M(s)},{immediate:!0,deep:!0}),{first:r,last:h,next:n,prev:m,selectPage:a,sortColumn:o,onClickTablecell:k,close,arrowUp:ee,arrowDown:x,page:t,canNext:O,totalPages:l,sortOrder:y,canPrev:w,currentPage:p,columnSorted:C}}}),pe=e=>(ne("data-v-6173022f"),e=e(),se(),e),ge={style:{width:"100%"}},ve={class:"stick-report-header"},he=["colspan","rowspan","onClick"],me=["onClick"],ke=["innerHTML"],_e=pe(()=>L("p",null,null,-1));function be(e,V,p,C,y,g){const l=j("ion-icon"),O=j("ion-label"),w=j("ion-item"),t=j("ion-button"),o=j("ion-toolbar"),a=j("ion-footer");return i(),v(B,null,[L("div",null,[L("table",ge,[L("thead",ve,[(i(!0),v(B,null,z(e.columns,(r,h)=>(i(),v("tr",{key:h},[(i(!0),v(B,null,z(r,(n,m)=>{var k,I;return i(),v("th",{key:m,colspan:((k=n==null?void 0:n.span)==null?void 0:k.thColspan)||1,rowspan:((I=n==null?void 0:n.span)==null?void 0:I.thRowspan)||1,onClick:M=>e.sortColumn(n.ref)},[f(w,{lines:"none"},{default:c(()=>[e.columnSorted&&e.columnSorted===n.ref?(i(),D(l,{key:0,icon:e.sortOrder==="asc"?e.arrowUp:e.arrowDown},null,8,["icon"])):S("",!0),f(O,null,{default:c(()=>[L("b",null,R(n.label),1)]),_:2},1024)]),_:2},1024)],8,he)}),128))]))),128))]),L("tbody",null,[(i(!0),v(B,null,z(e.page,(r,h)=>(i(),v("tr",{key:h},[(i(!0),v(B,null,z(r.row,(n,m)=>{var k;return i(),v("td",{key:m,onClick:()=>e.onClickTablecell(n),class:le({"clickable-cell":(k=n==null?void 0:n.column)==null?void 0:k.tdClick})},[L("span",{innerHTML:n.value,class:"his-sm-text"},null,8,ke)],10,me)}),128))]))),128))])])]),_e,f(a,null,{default:c(()=>[f(o,{color:"light"},{default:c(()=>[e.totalPages>1?(i(),D(t,{key:0,onClick:e.first,disabled:e.currentPage===0||e.totalPages<=2,size:"large",slot:"end"},{default:c(()=>[b(" First ")]),_:1},8,["onClick","disabled"])):S("",!0),e.totalPages>1?(i(),D(t,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:c(()=>[b(" Prev ")]),_:1},8,["onClick","disabled"])):S("",!0),e.totalPages>1?(i(),D(t,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:c(()=>[b(R(e.currentPage)+" / "+R(e.totalPages-1),1)]),_:1},8,["onClick"])):S("",!0),e.totalPages>1?(i(),D(t,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:c(()=>[b(" Next ")]),_:1},8,["onClick","disabled"])):S("",!0),e.totalPages>1?(i(),D(t,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:c(()=>[b(" Last ")]),_:1},8,["onClick","disabled"])):S("",!0)]),_:1})]),_:1})],64)}const ye=oe(fe,[["render",be],["__scopeId","data-v-6173022f"]]),Ve={key:0},Ce=L("p",null,null,-1),we={key:1,class:"his-card ion-text-center his-lg-text"},Pe=K({__name:"HomeNotifications",setup(e){const{notificationData:V,hasNotifications:p,clearNotification:C,openNotification:y}=re(),g=E("highVL"),l=ue({highVL:[],rejectedVL:[],normalVL:[],initiatedData:{},stats:{}}),O=$(()=>[[{ref:"arv",label:"ARV #"},{ref:"accession",label:"Accession #"},{ref:"order_date",label:"Order Date",toValue:t=>"".concat(de(t))},...g.value==="rejectedVL"?[{ref:"rejection_reason",label:"Rejection Reason"}]:[],{ref:"id",label:"View",toValue:()=>"View",tdClick:t=>y(t.data)},{ref:"id",label:"Clear",toValue:()=>"Clear",tdClick:t=>C(t.refData,o=>{l[g.value]=l[g.value].filter(a=>a.id!=o)})}]]);async function w(t,o=V.value){var h,n,m;if(o.length&&l.initiatedData[t])return;let a=6e3;const r=H.chunk((m=(n=(h=o==null?void 0:o[0])==null?void 0:h.vlMessageObs)==null?void 0:n[t])!=null?m:{},7);l.initiatedData[t]=o.length>0,l[t]=[];for(const k of r)l[t]=[...l[t],...k],await ce(a),a=30;l[t]=[...l[t]].sort((k,I)=>new Date(k.order_date)>new Date(I.order_date)?-1:1)}return G(V,async t=>{w(g.value,t),setTimeout(()=>{var a,r,h,n,m;const o=(r=(a=t==null?void 0:t[0])==null?void 0:a.vlMessageObs)!=null?r:{};l.stats.highVL=((h=o.highVL)!=null?h:[]).length,l.stats.normalVL=((n=o.normalVL)!=null?n:[]).length,l.stats.rejectedVL=((m=o.rejectedVL)!=null?m:[]).length},50)},{immediate:!0,deep:!0}),(t,o)=>(i(),v("div",null,[_(p)?(i(),v("div",Ve,[f(_(ie),{mode:"ios",modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=a=>g.value=a),class:"ion-justify-content-center"},{default:c(()=>[f(_(U),{onClick:o[0]||(o[0]=a=>w("highVL")),value:"highVL"},{default:c(()=>[f(_(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:c(()=>[b("High Vl")]),_:1}),f(_(q),{color:"danger"},{default:c(()=>{var a,r;return[b(R((r=(a=l.stats)==null?void 0:a.highVL)!=null?r:"-"),1)]}),_:1})]),_:1}),f(_(U),{onClick:o[1]||(o[1]=a=>w("rejectedVL")),value:"rejectedVL"},{default:c(()=>[f(_(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:c(()=>[b("Rejected")]),_:1}),f(_(q),{color:"warning"},{default:c(()=>{var a,r;return[b(R((r=(a=l.stats)==null?void 0:a.rejectedVL)!=null?r:"-"),1)]}),_:1})]),_:1}),f(_(U),{onClick:o[2]||(o[2]=a=>w("normalVL")),value:"normalVL"},{default:c(()=>[f(_(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:c(()=>[b("Normal Results")]),_:1}),f(_(q),{color:"success"},{default:c(()=>{var a,r;return[b(R((r=(a=l.stats)==null?void 0:a.normalVL)!=null?r:"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),Ce,(i(),D(ye,{key:g.value,columns:O.value,"column-data":l[g.value],"rows-per-page":7},null,8,["columns","column-data"]))])):(i(),v("div",we," No notifications "))]))}});export{Pe as default};
