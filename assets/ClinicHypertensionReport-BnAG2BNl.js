import{d as h,I as D,J as A,bA as w,_ as v,r as d,o as P,c as C,w as $,b as _,c2 as E,K as g,N as M,a9 as R,O as f,t as F,q as S}from"./index-ChqjXh1q.js";import{v as y}from"./TableView-D5d-HKAd.js";import{D as G}from"./ReportDateSelectionPrompt-Ct3nveNn.js";import{C as H}from"./clinic_report_service-Bm15tG5P.js";import"./PopupKeyboard-h_Nt-BNV.js";import"./SIngleTouchField-BdybEVDH.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./TouchScreenForm-Bp625zJI.js";import"./ToolbarMediumCard-NV07rtjo.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DBgU2Ffk.js";import"./HisKeypad-WzzlrmYQ.js";import"./BaseKeyboard-pj9TNcmG.js";import"./KbLayouts-VRA-vjeH.js";import"./KbHandler-BuQ4TFU6.js";import"./fuse-YdZE3OCN.js";import"./Export-C9Hhxwb2.js";import"./HisKeyboard-BFJHNqBd.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./MultiFieldDateHelper-BeB1wkpH.js";const I=h({components:{v2Datatable:y,IonPage:D},props:{title:String,patients:Array,onFinish:Function},setup(){const i=A();return{ITEMS_PER_PAGE:20,columns:[[{label:"ARV Number",ref:"arv_number"},{label:"Gender",ref:"gender",value:t=>w(t.gender)},{label:"Systolic/Diastolic",ref:"diastolic",value:t=>"".concat(t.systolic,"/").concat(t.diastolic)},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:t})=>i.push({path:"/patient/dashboard/".concat(t.patient_id)}),value:()=>"View client"}]]}}});function N(o,i,s,t,l,e){const c=d("v2Datatable"),m=d("ion-page");return P(),C(m,null,{default:$(()=>[_(c,{title:o.title,columnData:o.patients,columns:o.columns,"on-finish":o.onFinish,"icon-url":"/assets/images/folder.png",rowsPerPage:o.ITEMS_PER_PAGE},null,8,["title","columnData","columns","on-finish","rowsPerPage"])]),_:1})}const T=v(I,[["render",N]]),V=h({components:{IonPage:D,IonLoading:E,v2Datatable:y},setup(){const o=R("reports.png"),i=g([]),s=g(""),t=g(!1),l=new H,e=(r,a)=>({label:r,ref:a,toValue:n=>n.length,tdClick:n=>m("".concat(n.column.label),n.refData)}),c=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},e("Due for BP screening","due_for_screening"),e("Screened for HP","screened"),e("Normal <140/<90","normal_reading"),e("Mild 140-159/90-99","mild_reading"),e("Moderate 160-180/100-110","moderate_reading"),e("Severe >180/>110","severe_reading"),e("Hydrochlorothiazide 25mg","hydrochlorothiazide_25mg"),e("Amlodipine 5mg","amlodipine_5mg"),e("Amlodipine 10 mg","amlodipine_10mg"),e("Captopril","captopril"),e("Enalapril 5 mg","enalapril_5mg"),e("Enalapril 10mg","enalapril_10mg"),e("Atenolol 50mg","atenolol_50mg"),e("Atenolol 100mg","atenolol_100mg"),e("Nifedipine","nifedipine"),e("Total (regimen)","total_regimen")]],m=async(r,a)=>{a.length&&(await f.create({component:T,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:r,subtitle:s,patients:a,onFinish:()=>f.getTop().then(n=>n&&f.dismiss())}})).present()},u=async()=>{if(!(l.startDate&&l.endDate))return F("Start date and end date required!");t.value=!0,i.value=[];try{const r=await l.getHypertensionReport(),a=Object.keys(r).reduce((n,p)=>(n.M.push({age_group:p,gender:"Male",...r[p].M}),n.F.push({age_group:p,gender:"Female",...r[p].F}),n),{F:[],M:[]});i.value=a.F.concat(a.M).map((n,p)=>({index:p+1,...n}))}catch(r){S("Unable to generate report!"),console.error(r)}t.value=!1},b=()=>G({onFinish:(r,a,n)=>{s.value="Period (".concat(n,")"),l.startDate=r,l.endDate=a,u()}});return M(()=>b()),{logo:o,reportData:i,isLoading:t,configure:b,generate:u,columns:c,period:s}}});function k(o,i,s,t,l,e){const c=d("ion-loading"),m=d("v2Datatable"),u=d("ion-page");return P(),C(u,null,{default:$(()=>[_(c,{"is-open":o.isLoading,message:"Please wait..."},null,8,["is-open"]),_(m,{title:"Hypertension Report","icon-url":o.logo,subtitle:o.period,columns:o.columns,columnData:o.reportData,rowsPerPage:30,onConfigure:o.configure,onRefresh:()=>o.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const ae=v(V,[["render",k]]);export{ae as default};
