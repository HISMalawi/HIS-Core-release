System.register(["./index-legacy-BsbMrqEO.js","./HisStandardForm-legacy-BbU4Bs9R.js"],(function(t,e){"use strict";var a,s,i,n,o,r,d,c,D,u,h,l,m,y;return{setters:[t=>{a=t.d,s=t.al,i=t.aM,n=t.ai,o=t.aN,r=t.au,d=t.M,c=t.Q,D=t.ag,u=t.a8,h=t.ad,l=t.u,m=t.v},t=>{y=t.H}],execute:function(){const e=a({components:{HisStandardForm:y},data:()=>({apiDate:"",fields:[]}),async created(){this.apiDate=await s.getApiDate(),this.fields=i({id:"session_date",helpText:"Session Date",required:!0,minDate:()=>"2000-01-01",maxDate:()=>this.apiDate,estimation:{allowUnknown:!1},computeValue:t=>t,config:{footerBtns:[{name:"Reset",slot:"end",color:"success",state:{visible:{default:()=>s.isBDE()}},onClick:async()=>{await this.resetSessionDate()}}]}})},async mounted(){await this.showBdeNotice()},methods:{async showBdeNotice(){if(!s.isBDE())return;const t=n.toStandardHisDisplayFormat(s.getCachedApiDate()||""),e=n.toStandardHisDisplayFormat(s.getSessionDate()),a=await o("BDE Notice",`The system is currently in Back Data Entry Mode(BDE).                 Do you wish to reset the date to ${t}?`,`BDE Date: ${e}`,[{name:"Reset Date",slot:"start",color:"success"},{name:"Keep BDE Date",slot:"end",color:"danger"},{name:"New date",slot:"end"}]);if("Reset Date"===a)return await this.resetSessionDate();"Keep BDE Date"===a&&this.redirect()},async resetSessionDate(){try{await s.resetSessionDate(),r.invalidate("PROVIDERS"),d(`Session date has been reset to ${this.formatDate(this.apiDate)}`),this.redirect()}catch(t){c(`${t}`)}},redirect(){const t=this.$route.query.patient_dashboard_redirection_id;t?this.$router.push(`/patient/dashboard/${t}`):this.$router.back()},async onSubmit(t,e){const a=e.session_date;try{await s.setSessionDate(a),d(`Successfully Back dated to ${this.formatDate(a)}`);const t=this.$route?.query?.patient_id;t?D(t,this.$router):this.redirect()}catch(i){c(`${i}`)}},formatDate:t=>n.toStandardHisDisplayFormat(t)}});t("default",u(e,[["render",function(t,e,a,s,i,n){const o=h("his-standard-form");return l(),m(o,{skipSummary:!0,fields:t.fields,onOnFinish:t.onSubmit},null,8,["fields","onOnFinish"])}]]))}}}));
