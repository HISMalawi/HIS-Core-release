import{L as v}from"./Layout-CVFcxuWh.js";import{cs as k,M as g,N as D,ah as M,a0 as _,dE as C,aW as S,S as h,t as T,dJ as w,cX as x,bN as $,dK as A,d as B,_ as E,r as P,o,c as z,w as F,A as y,x as n,B as H,y as L,z as d,v as c,a7 as G}from"./index-BFVcutZq.js";import{D as N}from"./PatientDrilldown-CmEDgbnp.js";const s=k({model:[],indicators:{},dateGenerated:"",startDate:"",endDate:"",title:"",period:""}),p=g(()=>s.model.map(e=>{if(typeof e.value=="function"){const l=e.value(s.indicators);Array.isArray(l)?(e._value="".concat(l.length),e._drill=l):e._value=l}return e})),b=g(()=>{const[e,...l]=p.value.map(r=>[r.index||"",r.label,r.index?r._value||0:""]);return{rows:l,columns:[["#",p.value[0].label,"#"]]}});function R(e){e.title!=s.title&&(s.indicators={}),s.title=e.title,s.model=e.indicators;const l=async(a="",t="")=>{(await _.create({message:"Please wait .."})).present();try{const i=new C(e.name);i.startDate=a||s.startDate,i.endDate=t||s.endDate,s.indicators=await i.requestReport({type:"moh"}),s.dateGenerated=S(h.getSessionDate()).format("DD/MMM/YYYY HH:mm:ss")}catch(i){T("Unable to generate report")}_.dismiss()},r=()=>w({title:s.title,onFinish:(a,t,i)=>{s.period=i,s.startDate=a,s.endDate=t,l()}}),u=a=>{Array.isArray(a._drill)&&N(a.label,a._drill)},m=()=>{const a=document.getElementById("report-content");a&&x('\n                <html>\n                <head>\n                    <link rel="stylesheet" media="print"  href="/assets/css/hts-report-style-print.css"/>\n                    <style> \n                        #moh_template { border: solid 1px #3333; width: 100%; } td { font-size: var(--his-sm-font-size); padding: 0.3em; } .main-title { background: #8EAADB; font-weight: bold; border: solid 3px black; } .table-value { padding: 1em; text-align: center; color: #337ab7; font-weight: bold; font-size: var(--his-md-font-size); border: solid 2px black; } .table-section { font-weight: bold; background: #D9E2F3; border: solid 3px black; }\n                    </style>\n                </head>\n                <body>\n                    '.concat(a.innerHTML,"\n                </body>\n                </html>\n            "),50)},f=()=>{const{rows:a,columns:t}=b.value;$(t,A(a,s),"MOH-".concat(s.title,"-").concat(h.getLocationName(),"-").concat(s.period))};return D(()=>M.isEmpty(s.indicators)&&r()),{drill:u,data:s,indicators:p,exportable:b,generate:l,exportPdf:m,exportCsv:f,configure:r}}const V=B({components:{Layout:v},props:{params:{type:Object,required:!0}},setup(e){return R(e.params)}}),Y={id:"report-content"},j={id:"moh_template"},q={key:0,class:"main-title"},I={key:1,class:"main-title"},O={key:2,class:"main-title"},W={key:3,class:"table-section"},J={key:4,colspan:2,class:"table-section"},K={key:5},U=["onClick"];function X(e,l,r,u,m,f){const a=P("layout");return o(),z(a,{logo:"login-logos/Malawi-Coat_of_arms_of_arms.png",title:e.data.title,toCSV:e.exportCsv,toPDF:e.exportPdf,period:e.data.period,dateGenerated:e.data.dateGenerated,refreshReport:e.generate,configure:e.configure},{default:F(()=>[y("div",Y,[y("table",j,[(o(!0),n(H,null,L(e.indicators,(t,i)=>(o(),n("tr",{key:i},[t.isMainTitle?(o(),n("td",q,"#")):d("",!0),t.isMainTitle?(o(),n("td",I,c(t.label),1)):d("",!0),t.isMainTitle?(o(),n("td",O,"#")):d("",!0),t.isSectionTitle?(o(),n("td",W)):d("",!0),t.isSectionTitle?(o(),n("td",J,c(t.label),1)):d("",!0),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",K,c(t.index),1)),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",{key:6,style:G(t.style||{}),class:"table-key"},c(t.label),5)),t.isMainTitle||t.isSectionTitle?d("",!0):(o(),n("td",{key:7,class:"table-value",onClick:Q=>e.drill(t)},c(t._value),9,U))]))),128))])])]),_:1},8,["title","toCSV","toPDF","period","dateGenerated","refreshReport","configure"])}const se=E(V,[["render",X],["__scopeId","data-v-43c9e0b5"]]);export{se as M};
