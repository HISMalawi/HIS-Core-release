import{d as x,r as u,o as _,a as h,b as C,w as k,e as b,i as d,z as p,l as y,v as j,D as E,x as O,y as V,q as F}from"./index-CJleCCtM.js";import{v as D}from"./TableView-CMbHc5dx.js";import{D as S}from"./data_verification_service-m3u_oa_8.js";import"./Export-CXTwynHo.js";import"./index-DC9jnrfb.js";const z=x({__name:"EncountersPerProvider",setup(q){const f=u([]),m=u(""),l=u(!1),r=new S,P=[[{label:"#",ref:"index"},{label:"User",ref:"provider"},{label:"Count",ref:"count"},{label:"Percentage",ref:"percentage"},{label:"View",ref:"drilldown",toValue:()=>"View",tdClick:async e=>{e.refData.length&&(await p.create({component:D,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e.data.provider,columns:[[{label:"#",ref:"index"},{label:"Encounter name",ref:"name"},{label:"Total done",ref:"total"}]],rowsPerPage:100,columnData:e.refData,onFinish:()=>p.getTop().then(t=>t&&p.dismiss())}})).present()}}]],g=async()=>{if(!(r.startDate&&r.endDate))return y("Start date and end date required!");l.value=!0;try{const e=await r.getEncounterPerProvider(),t=Object.values(e).reduce((n,a)=>n+Object.values(a).reduce((i,o)=>i+o,0),0);f.value=Object.keys(e).reduce((n,a,i)=>{const o=Object.values(e[a]).reduce((c,s)=>c+s,0);return[...n,{index:i+1,provider:a,count:o,percentage:(o/t*100).toFixed(2)+"%",drilldown:Object.keys(e[a]).reduce((c,s,w)=>[...c,{index:w+1,name:s,total:e[a][s]}],[])}]},[])}catch(e){console.error(e),j("Unable to generate report!")}l.value=!1},v=()=>E({onFinish:(e,t,n)=>{m.value=n,r.startDate=e,r.endDate=t,g()}});return _(()=>v()),(e,t)=>(h(),C(d(F),null,{default:k(()=>[b(d(O),{"is-open":l.value,message:"Please wait.."},null,8,["is-open"]),b(D,{"icon-url":d(V)("reports.png"),title:"Encounters per Provider","report-prefix":"Clinic",subtitle:m.value,columns:P,columnData:f.value,rowsPerPage:100,onConfigure:v,onRefresh:g},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{z as default};
