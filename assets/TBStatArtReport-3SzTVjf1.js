import{d as w,r as d,o as v,D as T,a as D,w as R,e as b,f as g,x as A,n as P,b as h,z as u,s as F}from"./index-3BeNlo1y.js";import{w as x}from"./v2utils-DNjYY_Cy.js";import{T as m}from"./tb_report_service-Cg-NpdY6.js";import{v as y}from"./TableView-C7p0Xx0H.js";import{T as B}from"./TBDrilldown-7pQBfsN_.js";import"./Export-CbOZpD_i.js";import"./index-DgFByFCT.js";const I=w({__name:"TBStatArtReport",setup(C){const f=A("login-logos/PEPFAR.png"),i=d([]),l=d(""),s=new m,o=(e,a)=>({label:e,ref:a,toValue:t=>t.length,tdClick:async t=>(await u.create({component:B,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:t.column.label,patientIdentifiers:t.refData,subtitle:"Period: ".concat(l.value),onFinish:()=>u.getTop().then(n=>n&&u.dismiss())}})).present()}),_=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},o("Known positive","known_positive"),o("Newly Tested Positives","newly_tested_positive"),o("New Negatives","new_negative"),o("Recent negative","recent_negative"),o("Not Done","not_done"),o("New on ART","new_on_art"),o("Already on ART","already_on_art")]],c=()=>x(async()=>{if(!(s.startDate&&s.endDate))return F("Start date and end date required!");i.value=[];const e=await m.getJson("programs/2/reports/TB_ART_STAT",s.buildRequestParams({})),a=Object.keys(e).reduce((n,r)=>(/unknown|all/i.test(r)||(n.M.push({age_group:r,gender:"Male",...e[r].M}),n.F.push({age_group:r,gender:"Female",...e[r].F})),n),{F:[],M:[]}),t=[...a.F,...a.M];i.value=t.map((n,r)=>({index:r+1,...n}))}),p=()=>T({onFinish:(e,a,t)=>{l.value="".concat(t),s.startDate=e,s.endDate=a,c()}});return v(()=>p()),(e,a)=>(h(),D(g(P),null,{default:R(()=>[b(y,{title:"TB STAT ART Report","report-prefix":"PEPFAR","icon-url":g(f),subtitle:l.value,columns:_,columnData:i.value,rowsPerPage:50,onConfigure:p,onRefresh:()=>c()},null,8,["icon-url","subtitle","columnData","onRefresh"])]),_:1}))}});export{I as default};
