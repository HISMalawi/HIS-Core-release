System.register(["./index-legacy-CemUMpht.js","./HisStandardForm-legacy-Qa7lmv6m.js","./useEncounter-legacy-BAphd6_G.js","./util-legacy-CjANJSja.js","./commons-legacy-B01frEgm.js","./isEmpty-legacy-Bhi1Rhjd.js","./encounter_guidelines-legacy-D-aBTNIq.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,l,n,s,u,o,i,d,c,r,f,v,_,p,g,h,m,E,I,y,S,O,N,b,A,C,R,T,D,k,j,P,L,x,H,U,w,Y,F,V,G,$,M,W;return{setters:[e=>{a=e.d,l=e.K,n=e.M,s=e.N,u=e.o,o=e.x,i=e.b,d=e.w,c=e.cu,r=e.u,f=e.B,v=e.y,_=e.c,p=e.v,g=e.A,h=e.z,m=e.O,E=e.i,I=e.k,y=e.j,S=e.ap,O=e.aq,N=e.ar,b=e.g,A=e.cK,C=e.h,R=e.cO,T=e.D,D=e.e,k=e.l,j=e.f,P=e.m,L=e._,x=e.bg,H=e.dj,U=e.F,w=e.ct,Y=e.ae,F=e.V,V=e.I},e=>{G=e.H},e=>{$=e.u},e=>{M=e.g},e=>{W=e.r},null,null,null],execute:function(){var t=document.createElement("style");t.textContent="ion-col[data-v-feb7a6c4]{border-right:solid 1px #ccc}.side-title[data-v-feb7a6c4]{width:100%;padding:.5em;text-align:center;background:#e9e8e8;font-size:1.2em}p[data-v-feb7a6c4]{font-weight:700}\n",document.head.appendChild(t);const B={key:0,class:"side-title"},z=L(a({__name:"SideEffects",props:{prevSideEffectState:{type:Object},sideEffects:{type:Object,required:!0},drugs:{type:Array,default:()=>[]}},setup(e){const t=l(""),a=l({}),L=e,x=n((()=>Object.keys(a.value).every((e=>{const t=a.value[e];return Object.keys(t.drugReason).some((e=>t.drugReason[e].isChecked))||`${t.otherReason}`.length>0}))));function H(){m.dismiss()}function U(){const e=[];Object.keys(a.value).forEach((t=>{Object.keys(a.value[t].drugReason).forEach((l=>{a.value[t].drugReason[l].isChecked&&e.push({concept:a.value[t].concept,drug:a.value[t].drugReason[l].detail})})),a.value[t].otherReason&&e.push({concept:a.value[t].concept,other:a.value[t].otherReason})})),m.dismiss({values:e,state:a.value})}function w(e){e.detail.checked&&(a.value[t.value].otherReason="")}function Y(){Object.keys(a.value[t.value].drugReason).forEach((e=>{a.value[t.value].drugReason[e].isChecked=!1}))}return s((()=>{L.prevSideEffectState?a.value=L.prevSideEffectState:L.sideEffects.forEach((e=>{t.value||(t.value=e.label),a.value[e.label]={concept:e.other.concept,drugReason:L.drugs.reduce(((e,t)=>(e[t.drug.name]={isChecked:!1,detail:t},e)),{}),otherReason:""}}))})),(e,l)=>(u(),o(f,null,[i(c(y),null,{default:d((()=>[i(c(E),null,{default:d((()=>[i(c(I),{class:"his-lg-text"},{default:d((()=>[r("Suspected causes")])),_:1})])),_:1})])),_:1}),i(c(k),{style:{overflowY:"hidden",background:"grey"}},{default:d((()=>[i(c(S),null,{default:d((()=>[i(c(O),null,{default:d((()=>[i(c(N),null,{default:d((()=>[i(c(b),{style:{overflowY:"auto",height:"78vh"}},{default:d((()=>[i(c(A),{modelValue:t.value,"onUpdate:modelValue":l[0]||(l[0]=e=>t.value=e)},{default:d((()=>[(u(!0),o(f,null,v(a.value,((e,t)=>(u(),_(c(C),{class:"his-md-text",key:t},{default:d((()=>[i(c(R),{slot:"start",value:t},null,8,["value"]),i(c(T),null,{default:d((()=>[r(p(t),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),i(c(N),{style:{overflowY:"auto",height:"78vh"}},{default:d((()=>[t.value?(u(),o("div",B,[g("b",null,p(t.value),1),r(" causes ")])):h("",!0),t.value?(u(),_(c(b),{key:1},{default:d((()=>[i(c(C),{class:"his-lg-text"},{default:d((()=>[i(c(T),null,{default:d((()=>[r("Current Medication(s)")])),_:1})])),_:1}),(u(!0),o(f,null,v(a.value[t.value].drugReason,((e,t)=>(u(),_(c(C),{class:"his-md-text",key:t},{default:d((()=>[i(c(T),null,{default:d((()=>[r(p(t),1)])),_:2},1024),i(c(D),{onIonChange:w,slot:"start",modelValue:e.isChecked,"onUpdate:modelValue":t=>e.isChecked=t},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)))),128))])),_:1})):h("",!0),t.value?(u(),_(c(A),{key:2,onIonChange:Y,modelValue:a.value[t.value].otherReason,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value[t.value].otherReason=e)},{default:d((()=>[i(c(C),{class:"his-lg-text"},{default:d((()=>[i(c(T),null,{default:d((()=>[r("Previous Medication")])),_:1})])),_:1}),i(c(C),{class:"his-md-text"},{default:d((()=>[i(c(T),null,{default:d((()=>[r("Other, not drug related")])),_:1}),i(c(R),{slot:"start",value:"Other"})])),_:1}),i(c(C),{class:"his-md-text"},{default:d((()=>[i(c(T),null,{default:d((()=>[r("Drug side effect")])),_:1}),i(c(R),{slot:"start",value:"Drug side effect"})])),_:1})])),_:1},8,["modelValue"])):h("",!0)])),_:1})])),_:1})])),_:1})])),_:1}),i(c(P),null,{default:d((()=>[i(c(E),null,{default:d((()=>[i(c(j),{onClick:H,slot:"start",size:"large",color:"danger"},{default:d((()=>[r(" Close ")])),_:1}),i(c(j),{onClick:U,size:"large",slot:"end",disabled:!x.value},{default:d((()=>[r(" Save ")])),_:1},8,["disabled"])])),_:1})])),_:1})],64))}}),[["__scopeId","data-v-feb7a6c4"]]);e("default",a({__name:"Complications",setup(e){const t=l([]),a=new x(-1,H.COMPLICATIONS),n=l([]),s=l({}),o={pageOne:{"Abnominal pain":"ABNOMINAL_PAIN",Athralgia:"ATHRALGIA","Colour body fluids":"COLOUR_BODY_FLUIDS",Depression:"DEPRESSION",Fatigue:"FATIGUE",Gastrointestinal:"GASTROINTESTINAL",Headache:"HEADACHE","Hearing Difficulties":"HEARING_DIFFICULTIES",Hematological:"HEMATOLOGICAL",Hepatoxicity:"HEPATOXICITY",Hypothyroidism:"HYPOTHYROIDISM",Itching:"SKIN_ITCHING"},pageTwo:{Jaundice:"JAUNDICE","Lactic Acidosis":"LACTIC_ACIDOSIS",Numbness:"NUMBNESS_IN_HANDS_FEET_LEGS","Optic Neuritis":"OPTIC_NEURITIS",Pancreatitis:"PANCREATITIS","Periferal Neuropathy":"PERIFERAL_NEUROPATHY",Psychosis:"PSYCHOSIS","QT Prolongation":"QT_PROLONGATION","Renal failure":"RENAL_FAILURE","Skin Rash":"SKIN_RASH",Toxicity:"TOXICITY"}},{goToNextTask:r,patientDashboardUrl:f}=$(((e,l)=>{a.patientID=l,a.providerID=e,t.value=[function(){let e=[];return{id:"history",helpText:"Side effects / Contraindications history",type:U.TT_TABLE_VIEWER,init:async()=>{const t=await x.getJson(`programs/${a.programID}/patients/${l}/medication_side_effects`,{date:a.date});return Object.keys(t).forEach((a=>{e.push([w(a),Object.values(t[a]).flat(1).map((e=>`<b>${e.name}</b> ${e.drug_induced?"(Drug-induced)":""} : ${e.drug||"Unknown"} `)).join("<p/>")])})),!0},condition:()=>e.length,options:()=>[{label:"",value:"",other:{columns:["Date","Condition"],rows:e}}]}}(),...Object.keys(o).map(((e,t)=>({id:e,helpText:`Page ${t+1}: Contraindications / Side effects`,type:U.TT_MULTIPLE_YES_NO,init:async()=>(Y.isEmpty(n.value)&&(n.value=await x.getJson(`patients/${l}/last_drugs_received`,{program_id:a.programID})),!0),beforeNext:async t=>{const a=t.filter((e=>"YES_ANSWER"===e.value));if(a.length){const t=await m.create({component:z,backdropDismiss:!1,cssClass:"large-modal",componentProps:{sideEffects:a,drugs:n.value}});t.present();const{data:l}=await t.onDidDismiss();if(!l)return!1;s.value[e]=l.values}return!0},validation:e=>F.validateSeries([()=>F.required(e),()=>F.anyEmpty(e)]),computedValue:e=>e.map((e=>({concept_id:M("MALAWI_TB_SIDE_EFFECTS"),value_coded:M(`${e.other.concept}`),child:[{concept_id:M(`${e.other.concept}`),value_coded:M(`${e.value}`),obs_datetime:a.date}],obs_datetime:a.date}))),options:t=>Object.keys(o[e]).map((a=>({label:a,value:t[e]?.find((e=>e.label===a))?.value||"",other:{concept:o[e][a],values:[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}]}}))),config:{footerBtns:[{name:"None",slot:"end",onClickComponentEvents:{refreshOptions:()=>Object.keys(o[e]).map((t=>({label:t,value:"NO_ANSWER",other:{concept:o[e][t],values:[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}]}})))},onClick:()=>"None"}]}})))]}));async function v(e,t){await a.createEncounter(),await a.saveObservationList([...await W(t),...Object.values(s.value).flat(1).map((e=>e.other&&/drug/i.test(e.other)?{concept_id:M("DRUG_INDUCED"),value_coded:M(e.concept),value_text:"Past medication history"}:e.drug?{concept_id:M("DRUG_INDUCED"),value_coded:M(e.concept),value_drug:e.drug.drug.drug_id}:{concept_id:M("CONTRAINDICATIONS"),value_coded:M(e.concept)}))]),r()}return(e,a)=>(u(),_(c(V),null,{default:d((()=>[i(G,{cancelDestinationPath:c(f),onFinishAction:v,fields:t.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
