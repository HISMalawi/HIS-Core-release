System.register(["./index-legacy-Dg5P6bX-.js","./dynamic-import-helper-legacy-arUa2LZV.js","./HisStandardForm-legacy-BXV61qjj.js","./useEncounter-legacy-Bp6E5sCN.js","./PersonFieldHelper-legacy-BM6tNksH.js","./MultiFieldDateHelper-legacy-DBQBHUfA.js","./relations_service-legacy-C7fQRqV8.js","./VoidReason-legacy-DbJap4mP.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./isEmpty-legacy-rdjCNuhy.js","./_Set-legacy-BL8ow4HL.js","./_setToArray-legacy-jEwcQpqP.js","./encounter_guidelines-legacy-mRSBdMQj.js","./GuidelineEngine-legacy-KsvQuFdF.js","./LocationFieldOptions-legacy-dM5Ij6EC.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js"],(function(e,a){"use strict";var t,n,o,i,l,r,s,d,c,u,g,y,p,h,m,_,f,v,j,b,T;return{setters:[e=>{t=e.d,n=e.K,o=e.p,i=e.ag,l=e.V,r=e.o,s=e.c,d=e.w,c=e.b,u=e.cl,g=e.a$,y=e.aX,p=e.d0,h=e.I},e=>{m=e.F},e=>{_=e.H},e=>{f=e.u},e=>{v=e.P},e=>{j=e.g},e=>{b=e.R},e=>{T=e.p},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",t({__name:"Contacts",setup(e){const a=n([]),t=n();function F(e){const a=g(),t=g(e),n=a.diff(t,"year"),o=a.diff(t.add(n,"year"),"month"),i=a.diff(t.add(n,"year").add(o,"month"),"day");return n>0?`${n} year${n>1?"s":""} old`:o>0?`${o} month${o>1?"s":""} old`:`${i} day${i>1?"s":""} old`}const{patientDashboardUrl:w,patientId:C}=f(((e,n,r)=>{t.value=r,a.value=[(()=>{let e={},a=[];return{id:"contacts",helpText:"Contacts",type:m.TT_TABLE_VIEWER,onload:a=>e=a,init:async()=>(a=await r.getGuardian(),!0),options:()=>[{label:"",value:"",other:{columns:["Name","Gender","Age","Screen","Void"],rows:a.map((a=>[`${a.relation.names[0].given_name} ${a.relation.names[0].family_name}`,"M"===a.relation.gender?"Male":"Female",F(a.relation.birthdate),{name:"Screen",type:"button",action:()=>o(a.relation.person_id,i)},{id:a.relationship_id,name:"Void",type:"button",color:"danger",action:()=>T((async t=>{await b.voidRelation(n,a.relationship_id,t),e.rows=e.rows.filter((e=>e[e.length-1].id!=a.relationship_id))}))}]))}}],config:{overrideDefaultFooterBtns:{nextBtn:{name:"Add contact"}}}}})(),v.getGivenNameField(),v.getFamilyNameField(),v.getGenderField(),...j(v.getDobConfig()),v.getCellNumberField(),{id:"action",helpText:"Next step:",type:m.TT_SELECT,requireNext:!1,validation:e=>l.required(e),options:()=>[{label:"Add another contact",value:1,other:{action:()=>location.reload()}},{label:"Proceed to diagnosis",value:2,other:{action:e=>o(e,i)}},{label:"Go to dashboard",value:3,other:{action:()=>i.push(w.value)}}]}]}));function P(){const e=t.value.patient;return{home_district:e.person.addresses[0].address2,current_district:e.person.addresses[0].state_province,current_village:e.person.addresses[0].city_village,current_traditional_authority:e.person.addresses[0].township_division,home_village:e.person.addresses[0].neighborhood_cell,home_traditional_authority:e.person.addresses[0].county_district}}async function $(e,a){const t=new y,n={...P(),...v.resolvePerson(a)};await t.createPerson(n),await t.createPatient(),await b.createRelation(C.value,t.personId,p.TB_CONTACT),"function"==typeof e.action?.other?.action&&e.action.other.action(t.personId)}return(e,t)=>(r(),s(u(h),null,{default:d((()=>[c(_,{cancelDestinationPath:u(w),onFinishAction:$,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
