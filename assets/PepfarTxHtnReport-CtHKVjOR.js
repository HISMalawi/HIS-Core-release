import{d as D,a5 as h,r as m,t as C,aQ as b,d2 as F,aq as u,O as v,a6 as w,v as H,u as T,w as A,x as N,ab as _}from"./index-BMVUUxuO.js";import{v as P}from"./TableView-BoNb-DDa.js";import{C as M}from"./clinic_report_service-Dv4iJ86Q.js";import{H as R}from"./HypertensionDrilldown-DQJfcUhM.js";import{w as y}from"./v2utils-Cl9owyoc.js";import"./Export-BdZiLVD9.js";import"./index-tytmNkJf.js";const $=D({components:{IonPage:h,v2Datatable:P},setup(){const r=b("reports.png"),i=m([]),p=m(""),a=new M,s=(e,o)=>({label:e,ref:o,toValue:n=>n.length,tdClick:n=>d("".concat(n.column.label),n.refData)}),g=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},s("TX CURR","tx_curr"),s("Ever Diagnosed HTN","ever_diagnosed_htn"),s("Screened for HTN","screened_for_htn"),s("Newly diagnosed HTN","newly_diagnosed_htn"),s("Controlled HTN","controlled_htn")]],d=async(e,o)=>{o.length&&(await u.create({component:R,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:p,patients:o,onFinish:()=>u.getTop().then(n=>n&&u.dismiss())}})).present()},c=()=>y(async()=>{if(!(a.startDate&&a.endDate))return v("Start date and end date required!");i.value=[];const e=await a.getTxHtnReport(),o=Object.keys(e).reduce((t,l)=>(/unknown|all/i.test(l)||(t.M.push({age_group:l,gender:"Male",...e[l].M}),t.F.push({age_group:l,gender:"Female",...e[l].F})),t),{F:[],M:[]}),n=[...o.F,...o.M,{age_group:"All",gender:"Male",...e.All.Male},{age_group:"All",gender:"FP",...e.All.FP},{age_group:"All",gender:"FNP",...e.All.FNP},{age_group:"All",gender:"FBf",...e.All.FBf}];i.value=n.map((t,l)=>({index:l+1,...t}))}),f=()=>F({onFinish:(e,o,n,t)=>{t&&a.setOccupation(t),p.value="".concat(n),a.startDate=e,a.endDate=o,c()}});return C(()=>f()),{logo:r,reportData:i,configure:f,generate:c,columns:g,period:p}}});function x(r,i,p,a,s,g){const d=_("v2Datatable"),c=_("ion-page");return T(),H(c,null,{default:A(()=>[N(d,{title:"TX HIV HTN Report","icon-url":r.logo,subtitle:r.period,columns:r.columns,columnData:r.reportData,rowsPerPage:50,onConfigure:r.configure,onRefresh:()=>r.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const I=w($,[["render",x]]);export{I as default};
