import{F as d}from"./dynamic-import-helper-9HnG3Mif.js";import{H as b}from"./HisStandardForm-EQOKz9NX.js";import{b2 as g,d as w,t as p,aI as t,T as C,V as h,_ as S,r as D,o as T,c as O}from"./index-LcKkVeBi.js";import{_ as F}from"./EncounterMixin.vue_vue_type_script_lang-_QSYmoce.js";import"./TouchScreenForm-xHVNtrEx.js";import"./ToolbarMediumCard-8zGLRwn9.js";import"./Transformers-XlEF3tgP.js";import"./ViewPort-bfGE2-21.js";import"./encounter_guidelines-F30Cj7_H.js";import"./GuidelineEngine-syyQoOzo.js";class x extends g{constructor(o,a){super(o,184,a)}}const y=w({mixins:[F],components:{HisStandardForm:b},data:()=>({outcome:{}}),watch:{patient:{async handler(){this.outcome=new x(this.patientID,this.providerID),this.fields=this.getFields()},deep:!0}},methods:{async onFinish(e){if(!await this.outcome.createEncounter())return p("Unable to create encounter");const a=t.getProgramID(),c=await t.getProgramWorkflows(t.getProgramID()),i=e.select_referral_outcome.value,r={};c.forEach(s=>{s.states.forEach(m=>{const _=m.program_workflow_state_id,v=m.concept.concept_names[0].name;r[v]=_})});const n={location_id:t.getLocationName(),state:r[i],date:t.getSessionDate()};if(!await t.createState(this.patientID,a,n))return p("Unable to update state");const f=e.select_referral_outcome.value,l=e.select_cancer_treatment.value,u=[await this.outcome.buildValueCoded("Outcome",f)];if(l.match(/cancer/)){const s=await this.outcome.buildValueCoded("Cancer treatment",l);u.push(s)}await this.outcome.saveObservationList(u),C("Observations and encounter created!"),this.nextTask()},getFields(){return[{id:"select_referral_outcome",helpText:"Referral outcome",type:d.TT_SELECT,validation:e=>h.required(e),options:()=>[{label:"Cancer of cervix",value:"Cancer of cervix"},{label:"Continue follow-up",value:"Continue follow-up"},{label:"Discharged uninfected",value:"Discharged uninfected"},{label:"Treatment complete",value:"Treatment complete"}]},{id:"select_cancer_treatment",helpText:"Select cancer treatment",type:d.TT_SELECT,validation:e=>h.required(e),options:()=>[{label:"Surgery",value:"Surgery"},{label:"Palliative Care",value:"Palliative Care"},{label:"Discharged",value:"Discharged"},{label:"Other",value:"Other"}]}]}}});function E(e,o,a,c,i,r){const n=D("his-standard-form");return T(),O(n,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const W=S(y,[["render",E]]);export{W as default};
