import{ed as m,ee as u,ef as b}from"./index-ii3Qn3XY.js";class f extends m{async stopAndHideScanner(){console.log(window.OSBarcodeWebScanner),window.OSBarcodeWebScanner&&(await window.OSBarcodeWebScanner.stop(),window.OSBarcodeWebScanner=null),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="none"}buildScannerElement(){if(document.getElementById("cap-os-barcode-scanner-container")){document.getElementById("cap-os-barcode-scanner-container").className="scanner-container-display";return}const e=document.body.appendChild(document.createElement("div"));e.id="cap-os-barcode-scanner-container";const c=document.createElement("div");c.id="cap-os-barcode-scanner-container-dialog",c.className="scanner-dialog";const a=document.createElement("div");a.className="scanner-dialog-inner";const n=document.createElement("span");n.className="close-button",n.innerHTML="&times;",a.appendChild(n);const o=document.createElement("p");o.innerHTML="&nbsp;",a.appendChild(o);const r=document.createElement("div");r.className="scanner-container-full-width",r.id="cap-os-barcode-scanner-container-scanner",a.appendChild(r),c.appendChild(a),e.appendChild(c),n.onclick=this.stopAndHideScanner}async scanBarcode(e){return this.buildScannerElement(),document.getElementById("cap-os-barcode-scanner-container-dialog").style.display="block",new Promise((c,a)=>{var n,o;const r={facingMode:e.cameraDirection===1?"environment":"user",hasScannerButton:!1,scanButton:e.scanButton===void 0?!1:e.scanButton,showScanLine:!1,scanInstructions:e.scanInstructions?e.scanInstructions:"",orientation:e.scanOrientation?e.scanOrientation:u.PORTRAIT,showCameraSelection:!((n=e.web)===null||n===void 0)&&n.showCameraSelection?e.web.showCameraSelection:!1,typeHint:e.hint===17?void 0:e.hint,scannerFPS:!((o=e.web)===null||o===void 0)&&o.scannerFPS?e.web.scannerFPS:50},t=document.getElementById("cap-os-barcode-scanner-container-scanner");if(!t)throw new Error("Scanner Element is required for web");window.OSBarcodeWebScanner=new b(t.id);const i={fps:r.scannerFPS,qrbox:t.getBoundingClientRect().width*(9/16)-10,aspectRatio:16/9,videoConstraints:{focusMode:"continuous",height:{min:576,ideal:1920},deviceId:void 0,facingMode:void 0}},s=(d,p)=>{this.stopAndHideScanner(),c({ScanResult:d})},l=d=>{d.indexOf("NotFoundException")===-1&&d.indexOf("No barcode or QR code detected")===-1&&(this.stopAndHideScanner(),console.error("[Scanner Web Error] ".concat(d)),a(d))};window.OSBarcodeWebScanner.start({facingMode:r.facingMode},i,s,l)})}}export{f as CapacitorBarcodeScannerWeb};
