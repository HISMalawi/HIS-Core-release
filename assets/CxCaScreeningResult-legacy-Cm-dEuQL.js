System.register(["./dynamic-import-helper-legacy-DYK5bIOV.js","./HisStandardForm-legacy-DMJkhfrq.js","./index-legacy-X--GYU37.js","./EncounterMixin.vue_vue_type_script_lang-legacy-BmCg9KlZ.js","./LocationFieldOptions-legacy-tb_FnfFb.js","./TouchScreenForm-legacy-C_f8Ho2H.js","./ToolbarMediumCard-legacy-CdhT4OJW.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-1het9QhE.js","./encounter_guidelines-legacy-wNYbMa3T.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var i,n,s,a,o,r,l,u,d,c,p,h,v;return{setters:[e=>{i=e.F},e=>{n=e.H},e=>{s=e.b4,a=e.d,o=e.t,r=e.T,l=e.V,u=e._,d=e.r,c=e.o,p=e.c},e=>{h=e._},e=>{v=e.g},null,null,null,null,null,null],execute:function(){class t extends s{constructor(e,t){super(e,186,t)}}const g=a({mixins:[h],components:{HisStandardForm:n},data:()=>({screeningResult:{},obs:[],fieldContext:{},currentMethod:""}),watch:{patient:{async handler(){this.screeningResult=new t(this.patientID,this.providerID),this.currentMethod=await this.getTreatmentOptions(),this.fields=this.getFields()},deep:!0}},methods:{async onFinish(e,i){if(!(await this.screeningResult.createEncounter()))return o("Unable to create encounter");e.treatment_option&&"Referral"===e.treatment_option.value&&this.obs.push(this.screeningResult.buildValueText("Referral location",t.getLocationName()));const n=[];Object.keys(i).forEach((e=>{n.push(i[e].obs)}));const s=await Promise.all([...this.obs,...n]);await this.screeningResult.saveObservationList(s),r("Observations and encounter created!"),this.nextTask()},getFacilities:(e="")=>v(e),async getTreatmentOptions(){return await this.screeningResult.getFirstValueCoded("CxCa screening method")},getOptions(e){return e||(o("No screening methods have been selected"),this.gotoPatientDashboard()),e.match(/via/i)?["VIA Negative","VIA Positive","Suspect Cancer"]:e.match(/smear/i)?["PAP Smear Normal","PAP Smear Abnormal"]:e.match(/HPV DNA/i)?["HPV positive","HPV negative"]:e.match(/Speculum/i)?["Visible Lesion","No visible Lesion","Suspect Cancer","Other Gynae"]:[]},getFields(){return[{id:"results_available",helpText:"Screening result available",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.yesNoOptions(),computedValue:e=>({obs:this.screeningResult.buildValueCoded("Screening results available",e.value)})},{id:"screening_result",helpText:"Screening Result",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions([...this.getOptions(this.currentMethod)]),condition:e=>"Yes"===e.results_available.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Screening results",e.value)})},{id:"gynae_options",helpText:"Other Gynae treatment",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["STI","Cervicitis"]),condition:e=>"Other Gynae"===e.screening_result.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Screening results",e.value)})},{id:"offer_via",helpText:"Offer VIA",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.yesNoOptions(),condition:e=>"HPV positive"===e.screening_result.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Patient went for VIA?",e.value)})},{id:"via_screening_results",helpText:"VIA screening results",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["VIA negative","VIA positive","Suspect cancer"]),condition:e=>"Yes"===e.offer_via.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("VIA Results",e.value)})},{id:"reason_for_not_offering_via",helpText:"Reason for NOT offering VIA",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["Client NOT ready","Treatment not available","Other conditions"]),condition:e=>"No"===e.offer_via.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Other reason for not seeking services",e.value)})},{id:"further_details",helpText:"Further details",type:i.TT_TEXT,validation:e=>l.required(e),computedValue:e=>({obs:this.screeningResult.buildValueText("Other reason for not seeking services",e.label)}),condition:e=>"Other conditions"===e.possible_reasons_why.value||"Treatment not available"===e.possible_reasons_why.value},{id:"treatment_option",helpText:"Enter treatment option",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["Same day treatment","Postponed treatment","Referral"]),condition:e=>!["VIA Negative","No visible Lesion","PAP Smear Normal","HPV negative"].includes(e.screening_result.value),computedValue:e=>({obs:this.screeningResult.buildValueCoded("Directly observed treatment option",e.value)})},{id:"postponed_reason",helpText:"Select reason for postponing treatment",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["Client not ready","Treatment not available","Other conditions"]),condition:e=>"Postponed treatment"===e.treatment_option.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Postponed reason",e.value)})},{id:"referral_rreason",helpText:"Referral reason",type:i.TT_SELECT,validation:e=>l.required(e),options:()=>this.mapOptions(["Further Investigation and Management","Large Lesion (Greater than 75 percent)","Unable to treat client","Suspect Cancer","Treatment not available","Other conditions"]),condition:e=>"Referral"===e.treatment_option.value,computedValue:e=>({obs:this.screeningResult.buildValueCoded("Referral reason",e.value)})},{id:"further_details",helpText:"Further details",type:i.TT_TEXT,validation:e=>l.required(e),computedValue:e=>({obs:this.screeningResult.buildValueText("Referral reason",e.label)}),condition:e=>"Other conditions"===e.possible_reasons_why.value||"Unable to treat client"===e.possible_reasons_why.value}]}}});e("default",u(g,[["render",function(e,t,i,n,s,a){const o=d("his-standard-form");return c(),p(o,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!1,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}]]))}}}));
