import{d as b,I as _,cm as v,J as D,K as s,M as h,bR as C,ct as p,N as L,T as V,t as R,q as w,_ as I,r as u,o as N,c as $,w as B,b as f}from"./index-BFVcutZq.js";import{v as P}from"./TableView-CvEqt4DX.js";import{V as S}from"./viral_load_report-DbqWI4ge.js";import{D as A}from"./ReportDateSelectionPrompt-JDliGFTi.js";import"./fuse-YdZE3OCN.js";import"./HisKeyboard-kCuG2DTL.js";const E=b({components:{IonPage:_,IonLoading:v,v2Datatable:P},setup(){const a=D(),o=s([]),i=s(""),n=s(!1),t=new S,c=s(!1),d=h(()=>[[{label:c.value?"Filing#":"ARV#",ref:"identifier"},{label:"First name",ref:"given_name",exportable:!1},{label:"Last name",ref:"family_name",exportable:!1},{label:"Gender",ref:"gender",value:e=>C(e.gender)},{label:"DOB",ref:"birthdate",value:e=>p(e.birthdate)},{label:"Date of VL Order",ref:"order_date",value:e=>p(e.order_date)},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:e})=>a.push({path:"/patient/dashboard/".concat(e.patient_id)}),value:()=>"View client"}]]),r=async()=>{if(!(t.startDate&&t.endDate))return R("Start date and end date required!");n.value=!0,o.value=[];try{o.value=await t.getVlCollection()}catch(e){w("Unable to generate report!")}n.value=!1},l=()=>A({onFinish:(e,m,g)=>{i.value="Period (".concat(g,")"),t.startDate=e,t.endDate=m,r()}});return L(()=>{V.get("IS_ART_FILING_NUMBER_ENABLED").then(e=>c.value=e),!o.value.length&&l()}),{reportData:o,isLoading:n,configure:l,generate:r,columns:d,period:i}}});function F(a,o,i,n,t,c){const d=u("ion-loading"),r=u("v2Datatable"),l=u("ion-page");return N(),$(l,null,{default:B(()=>[f(d,{"is-open":a.isLoading,message:"Please wait..."},null,8,["is-open"]),f(r,{title:"VL Collection",subtitle:a.period,columns:a.columns,columnData:a.reportData,rowsPerPage:20,onConfigure:a.configure,onRefresh:()=>a.generate(),"report-prefix":"Clinic"},null,8,["subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const O=I(E,[["render",F]]);export{O as default};
