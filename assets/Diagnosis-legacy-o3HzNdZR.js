System.register(["./HisStandardForm-legacy-CGi-zolz.js","./index-legacy-pSEoxn3J.js","./useEncounter-legacy-D27v7I9F.js","./commons-legacy-B7dPhjdd.js","./isEmpty-legacy-De9HmsH6.js","./encounter_guidelines-legacy-mYSO8ZN5.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,n,s,i,o,l,c,u,r,d,g,y,p,m,w,b,T,_,v,f;return{setters:[e=>{a=e.H},e=>{n=e.bW,s=e.bn,i=e.d,o=e.r,l=e.bk,c=e.an,u=e.ao,r=e.a_,d=e.a,g=e.w,y=e.e,p=e.f,m=e.m,w=e.aw,b=e.b,T=e.S},e=>{_=e.u},e=>{v=e.c,f=e.r},null,null,null],execute:function(){class t extends n{constructor(e,t){super(e,41,t)}static async getDiagnosis(e="",t=1,a=10){const i=s.getConceptID("Qech outpatient diagnosis list");return n.getJson("diagnosis",{id:i,name:e,page:t,page_size:a})}}class D extends n{constructor(e,t){super(e,105,t)}}e("default",i({__name:"Diagnosis",setup(e){let n,s;const i=o("No"),E=o([]),{goToNextTask:h,patientDashboardUrl:L}=_(((e,a)=>{l.getLatestMalariaTestResult(a).then((e=>i.value=e)),n=new D(a,e),s=new t(a,e),E.value=[S("Primary"),S("Secondary"),{id:"clinical_notes",helpText:"Clinical notes",type:u.TT_TEXT,computedValue:e=>r.isEmpty(e)?null:{tag:"notes",obs:n.buildValueText("Clinical notes construct",e.value)}}]}));async function x(e,t){await s.createEncounter();const a=await f({...t,obs_datetime:T.getSessionDate()},"diagnosis");await s.saveObservationList(a);const i=await f({...t},"notes");r.isEmpty(i)||(await n.createEncounter(),await n.saveObservationList(i)),h()}function S(e){return{id:`${e.toLowerCase()}_diagnosis`,helpText:`${e} Diagnosis`,type:u.TT_INFINITE_SCROLL_MULTIPLE_SELECT,validation:t=>"Primary"===e?c.required(t):null,options:async(e,a="",n=1,s=10)=>{const i=await t.getDiagnosis(a,n,s);return v(i,"name","concept_id")},beforeNext:async e=>await async function(e){return!e.some((({label:e})=>/Malaria/i.test(e)))||"Positive"===i.value||await w(`Patient has ${i.value} malaria test result. Do you want to continue?`)}(e),computedValue:t=>({tag:"diagnosis",obs:t.map((({value:t})=>s.buildValueCoded(`${e} Diagnosis`,t)))}),config:{isFilterDataViaApi:!0,showKeyboard:!0}}}return(e,t)=>(b(),d(p(m),null,{default:g((()=>[y(a,{cancelDestinationPath:p(L),fields:E.value,onFinishAction:x},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
