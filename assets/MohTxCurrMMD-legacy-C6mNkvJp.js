System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-C9Ns8WHu.js","./tx_report_service-legacy-BQbAti7N.js","./TableReportTemplate-legacy-BuasS8uz.js","./index-legacy-C29Eb2Qm.js","./moh_cohort_service-legacy-DEsxLEi2.js","./MultiFieldDateHelper-legacy-DNe3hLpD.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./BasicReportTemplate-legacy-Dme8z_3V.js","./Export-legacy-DkNEJvfQ.js","./SIngleTouchField-legacy-BRNk_9sq.js","./Pagination-legacy-mp0eCPy0.js","./HisStandardForm-legacy-BpfFI5_j.js","./TouchScreenForm-legacy-BmEuIwWy.js","./ToolbarMediumCard-legacy-CF38wqjC.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-CDi_rmkw.js","./ReportErrors-legacy-BEWHM-PZ.js"],(function(t,e){"use strict";var s,o,a,r,i,l,n,h,c,d,u,g,p,m,f;return{setters:[t=>{s=t._},t=>{o=t.T},t=>{a=t.R},t=>{r=t.d,i=t.I,l=t.L,n=t.cz,h=t.ab,c=t._,d=t.r,u=t.o,g=t.c,p=t.w,m=t.b},t=>{f=t.M},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=r({mixins:[s],components:{ReportTemplate:a,IonPage:i},data:()=>({title:"Moh TX CURR MMD Report",cohort:{},rows:[],headerInfoList:[],totals:new Set,mohCohort:{},errors:[],showStatus:!1,aggregate:{Male:{},Female:{}},columns:[[l.thTxt("Age group"),l.thTxt("Gender"),l.thNum("# of clients on <3 months of ARVs"),l.thNum("# of clients on 3 - 5 months of ARVs"),l.thNum("# of clients on >= 6 months of ARVs")]],canValidate:!1}),created(){this.fields=this.getDateDurationFields()},watch:{async canValidate(t){t&&await this.validateReport()}},methods:{async onPeriod(t,e){this.canValidate=!1,this.rows=[],this.errors=[],this.showStatus=!1,this.report=new o,this.mohCohort=new f,this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.mohCohort.setOccupation(e.occupation),this.report.setOrg("moh"),this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),await this.setMaleFemaleRows(),this.setTotalMalesRows(),await this.setTotalFemaleRows(),this.setHeaderInfoList(),this.canValidate=!0,this.showStatus=!0},setHeaderInfoList(){this.headerInfoList=[{label:"Total clients",value:this.totals.size,other:{onclick:()=>this.runTableDrill(Array.from(this.totals),"Total Clients")}}]},buildRow(t,e,s){const o={underThreeMonths:{check:t=>t<90,data:[]},betweenThreeAndFiveMonths:{check:t=>t>=90&&t<=150,data:[]},overSixMonths:{check:t=>t>150,data:[]}},a=t[s]||{};for(const r in a){const t=parseInt(r);this.totals.add(t),Object.keys(o).forEach((e=>{this.aggregate[s][e]||(this.aggregate[s][e]=[]),o[e].check(a[r].prescribed_days)&&(o[e].data.push(t),this.aggregate[s][e].push(t))}))}return[l.td(e),l.td(s),this.drill(o.underThreeMonths.data,`${e} (${s}s) < 3 months of Arvs`),this.drill(o.betweenThreeAndFiveMonths.data,`${e} (${s}s) 3-5 months of Arvs`),this.drill(o.overSixMonths.data,`${e} (${s}s) > 6 months months of Arvs`)]},async setMaleFemaleRows(){const t=[],e=[];for(const s of n){const[o,a]=this.parseAgeGroup(s),r=await this.report.getTxCurrMMDReport(o,a);this.report.initArvRefillPeriod(!1),e.push(this.buildRow(r,s,"Female")),t.push(this.buildRow(r,s,"Male")),this.rows=[...e,...t]}},setTotalMalesRows(){this.rows.push([l.td("All"),l.td("Male"),this.drill(this.aggregate.Male.underThreeMonths,"All (Males) < 3 months of Arvs"),this.drill(this.aggregate.Male.betweenThreeAndFiveMonths,"All (Males) 3-5 months of Arvs"),this.drill(this.aggregate.Male.overSixMonths,"All (Males) > 6 months months of Arvs")])},async setTotalFemaleRows(){const t=h.uniq(Object.values(this.aggregate.Female).flat(1)),e=await this.report.getMaternalStatus(t),s=e.FBf.concat(e.FP),o=(t,o,a)=>{const r=t.filter((t=>{const a=parseInt(t.toString());return"FNP"===o?!s.includes(a):e[o].includes(a)}));return this.drill(r,a)},a=(t,e)=>{this.rows.push([l.td("All"),l.td(t),o(this.aggregate.Female.underThreeMonths,e,`All (${t}s) < 3 months of Arvs`),o(this.aggregate.Female.betweenThreeAndFiveMonths,e,`All (${t}s) 3-5 months of Arvs`),o(this.aggregate.Female.overSixMonths,e,`All (${t}s) > 6 months of Arvs`)])};a("FP","FP"),a("FNP","FNP"),a("FBF","FBf")},validateReport(){const t={total_alive_and_on_art:{param:this.totals.size,check:(t,e)=>t!=e,error:(t,e)=>`\n                        MoH cohort Alive and on ART clients <b>(${t})</b> is not\n                        matching with total TX MMD clients <b(${e}).</b>\n                    `}};-1===this.mohCohort.validateIndicators(t,(t=>this.errors=t))&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}});t("default",c(e,[["render",function(t,e,s,o,a,r){const i=d("report-template"),l=d("ion-page");return u(),g(l,null,{default:p((()=>[m(i,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,reportPrefix:"MoH",config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerInfoList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])])),_:1})}]]))}}}));
