System.register(["./index-legacy-CA6M7ipO.js"],(function(e,t){"use strict";var a,n,s,o,i,r;return{setters:[e=>{a=e.bQ,n=e.bx,s=e.ao,o=e.aN,i=e.S,r=e.H}],execute:function(){e("P",class extends a{constructor(e,t){super(e,121,t)}static async getRadiologyList(e,t=""){return n.getConceptSet(e,t)}async getRadiologyObs(e){try{const t="radiology/radiology_orders?patient_id="+e;return await s.getJson(t)}catch(t){return 0}}async showPreviousRadiolgy(e){return(await this.getRadiologyObs(e.getID())).length>0}async getPreviousRadiologyExaminations(e){const t=await s.getThirdpartyApps();let a="";for(const s of t)"pacs"==s.name&&(a=s.url);o.isEmpty(a)&&(a=`opd/encounters/radiology/${this.patientID}`);const n=await this.getRadiologyObs(e.getID());return n.length>0&&{data:n,url:a}}async submitToPacs(e,t){let a;for(const s of e)a=s.children[0].accession_number;const n=await Promise.all(e.map((async e=>({main_value_text:e.value_text,obs_id:e.obs_id,sub_value_text:e.children[0].value_text})))),o={patient_name:t.getFullName(),patientAge:t.getAge(),patientDOB:t.getBirthdate(),patientGender:t.getGender(),national_id:t.getNationalID(),person_id:t.getID(),encounter_id:this.getEncounterID(),date_created:this.getDate(),accession_number:a},i={username:s.getUserName(),userID:s.getUserID(),userRoles:s.getUserRoles()};return s.postJson("radiology/radiology_orders",{patient_details:o,physician_details:i,radiology_orders:n})}async getAccesionNumber(){return(await s.getJson("sequences/next_accession_number")).accession_number}async obsObj(e){const t=await this.getAccesionNumber(),a=[];for(const s of e)a.push({concept_id:s.concept_id,value_text:await n.getConceptName(s.child.concept_id),child:[{concept_id:s.child.concept_id,accession_number:t,value_text:await n.getConceptName(s.child.value_coded)}]});return a}async printOrders(e,t){const a=new i,n=t.getNationalID(),s=t.getFullName(),o=[];for(const i of e){const e=i.value_text+": "+i.children[0].value_text;o.push(`/radiology/barcode?accession_number=${i.children[0].accession_number}&patient_national_id=${n}&patient_name=${s}&radio_order=${e}&date_created=${r.toStandardHisDisplayFormat(i.obs_datetime)}`)}await a.batchPrintLbls(o,!0)}})}}}));
