System.register(["./index-legacy-CA6M7ipO.js","./drug_order_service-legacy-3VUXkHbj.js"],(function(e,t){"use strict";var a,r,n,i;return{setters:[e=>{a=e.bQ,r=e.aN,n=e.H},e=>{i=e.D}],execute:function(){const t=e("D",{"Once a day (OD)":1,"Twice a day (BD)":2,"Three a day (TDS)":3,"Four times a day (QID)":4,"Five times a day (5X/D)":5,"Six times a day (Q4HRS)":6,"In the morning (QAM)":1,"Once a week (QWK)":1,"Once a month":1,"Twice a month":2});e("A",class extends a{constructor(e,t){super(e,25,t)}vaccinationDrugObj(){return{drug_inventory_id:609,dose:.5,equivalent_daily_dose:.5,frequency:"Once a day (od)",start_date:this.date,auto_expire_date:this.date,instructions:"Once a day",units:"ml"}}async updateVaccinationOrder(){const e=await this.dispenseVaccinationDrug();if(!r.isEmpty(e)){const t=e[0].order_id;return i.updateDispensationOrders([{order_id:t,quantity:1}])}throw"Unable to dispense"}dispenseVaccinationDrug(){return this.createOrders([this.vaccinationDrugObj()])}createOrders(e){return i.create({drug_orders:e,encounter_id:this.getEncounterID()})}async submitTreatment(e){await this.createEncounter();const t=await this.createOrders(e.map((e=>this.buildDrugOrderObj(e)))),r=new a(this.patientID,54,this.providerID);await r.createEncounter(),e.forEach((e=>{t.forEach((t=>{t.drug_inventory_id===e.id&&(t.quantity=this.calculateAmountNeeded(e))}))})),await i.updateDispensationOrders(t)}calculateAmountNeeded(e){const t=this.calculateDosage(e),a=this.calculateDailyEquivalentDose(e,t);let r=e.duration*(a||1)-(e.quantity||0);return Math.max(0,Math.ceil(r))}calculateDosage(e){return parseFloat(e.dose||`${t[e.frequency]}`)}calculateDailyEquivalentDose(e,a){return a*t[e.frequency]}buildDrugOrderObj(e){const t=new Date(this.date),a=t.setDate(t.getDate()+parseInt(`${e.duration}`)),r=this.calculateDosage(e);return{drug_inventory_id:e.id,dose:r,frequency:e.frequency,start_date:this.date,auto_expire_date:n.toStandardHisFormat(new Date(a)),equivalent_daily_dose:this.calculateDailyEquivalentDose(e,r),instructions:e.drug_name+":"+e.dose+" "+e.units+" "+e.frequency,units:e.units}}})}}}));
