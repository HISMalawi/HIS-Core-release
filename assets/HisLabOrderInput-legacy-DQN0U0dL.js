System.register(["./index-legacy-B5_bWIZW.js","./FieldMixin.vue_vue_type_script_lang-legacy-C2sP4tcj.js"],(function(e,t){"use strict";var s,a,i,n,o,c,l,d,u,h,r,m,p,f,g,v,_,C,b,k,y,D,x,T,w,I,N,S;return{setters:[e=>{s=e.d,a=e.bm,i=e.ap,n=e.ar,o=e.aq,c=e.D,l=e.g,d=e.h,u=e.cP,h=e.e,r=e.cK,m=e.a$,p=e._,f=e.r,g=e.o,v=e.c,_=e.w,C=e.b,b=e.x,k=e.B,y=e.y,D=e.u,x=e.v,T=e.z,w=e.a6,I=e.a7,N=e.A},e=>{S=e._}],execute:function(){var t=document.createElement("style");t.textContent=".view-port-content[data-v-29f67c87]{background:#fff}.border-right[data-v-29f67c87]{border-left:solid 1px #ccc}.mx-height[data-v-29f67c87]{height:75vh;overflow-y:auto}.title[data-v-29f67c87]{width:100%;padding:.3em;text-align:center;background:#e9e8e8}\n",document.head.appendChild(t);const j=s({mixins:[S],components:{ViewPort:a,IonGrid:i,IonCol:n,IonRow:o,IonLabel:c,IonList:l,IonItem:d,IonRadio:u,IonCheckbox:h,IonRadioGroup:r},data:()=>({whitelist:[],testData:{},focusedTestName:""}),watch:{testData:{handler(e){const t=Object.keys(e).reduce(((e,t)=>{const s=this.testData[t];return s.isChecked&&this.isSelectionComplete(t)&&e.push({label:t,value:s.specimen.name,other:{reason:"Routine",accessionNumber:null,concept_id:s.testConcept,specimenConcept:s.specimen.concept_id}}),e}),[]);this.$emit("onValue",t.length?t:null)},deep:!0}},computed:{testTypeOptions(){const e=this.whitelist.map((e=>e.value)),t=Object.keys(this.testData);return e.length?t.filter((t=>e.includes(t))):t}},methods:{async init(){this.$emit("onFieldActivated",this),"function"==typeof this.options&&(this.whitelist=await this.options(this.fdata)),Object.keys(this.testData).length||m.getTestTypes().then((e=>{this.testData=e.reduce(((e,t)=>(e[t.name]={testConcept:t.concept_id,isChecked:!1,specimens:[],reason:"",specimen:""},e)),{})}))},isSelectionComplete(e){return!e||!this.testData[e].isChecked||this.testData[e].specimen},selectTest(e,t){this.testData[t].isChecked=e.detail.checked,e.detail.checked?(this.focusedTestName=t,this.testData[t]?.specimens.length||m.getSpecimens(t).then((e=>this.testData[t].specimens=e))):(this.testData[t]={...this.testData[t],isChecked:!1,specimen:""},this.focusedTestName="")}},mounted(){this.init()},activated(){this.init()}}),O={key:0},V=(e=>(w("data-v-29f67c87"),e=e(),I(),e))((()=>N("h3",{class:"title"},"Select specimen",-1)));e("default",p(j,[["render",function(e,t,s,a,i,n){const o=f("ion-checkbox"),c=f("ion-label"),l=f("ion-item"),d=f("ion-list"),u=f("ion-col"),h=f("ion-radio"),r=f("ion-radio-group"),m=f("ion-row"),p=f("ion-grid"),w=f("view-port");return g(),v(w,null,{default:_((()=>[C(p,{class:"view-port-content"},{default:_((()=>[C(m,null,{default:_((()=>[C(u,{class:"mx-height",size:"5"},{default:_((()=>[C(d,null,{default:_((()=>[(g(!0),b(k,null,y(e.testTypeOptions,((t,s)=>(g(),v(l,{key:s,class:"his-sm-text"},{default:_((()=>[C(o,{onIonChange:s=>e.selectTest(s,t),disabled:!e.isSelectionComplete(e.focusedTestName)&&e.focusedTestName!=t,color:e.isSelectionComplete(t)?"success":"danger",value:e.testData[t].isChecked,slot:"start"},null,8,["onIonChange","disabled","color","value"]),C(c,{color:e.isSelectionComplete(t)?"":"danger"},{default:_((()=>[D(x(t),1)])),_:2},1032,["color"])])),_:2},1024)))),128))])),_:1})])),_:1}),C(u,{class:"border-right mx-height",size:"7"},{default:_((()=>[e.focusedTestName?(g(),b("div",O,[V,C(d,null,{default:_((()=>[C(r,{modelValue:e.testData[e.focusedTestName].specimen,"onUpdate:modelValue":t[0]||(t[0]=t=>e.testData[e.focusedTestName].specimen=t)},{default:_((()=>[(g(!0),b(k,null,y(e.testData[e.focusedTestName].specimens,((e,t)=>(g(),v(l,{key:t,class:"his-sm-text"},{default:_((()=>[C(h,{value:e,slot:"start"},null,8,["value"]),C(c,null,{default:_((()=>[D(x(e.name),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["modelValue"])])),_:1})])):T("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-29f67c87"]]))}}}));
