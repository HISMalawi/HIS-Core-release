var g=Object.defineProperty;var l=(o,e,r)=>e in o?g(o,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[e]=r;var i=(o,e,r)=>(l(o,typeof e!="symbol"?e+"":e,r),r);import{ah as c}from"./index-BFVcutZq.js";const n="openmrs",S="offline_db",p=(o="IndexedDBStorage")=>{switch(o){case"IndexedDBStorage":return new f;case"LocalStorage":return new d;default:return new d}};class d{existsinStorage(e){return localStorage.getItem(e)?Promise.resolve(!0):Promise.resolve(!1)}getFromStorage(e){return new Promise((r,s)=>{const t=localStorage.getItem(e);if(t)return r(JSON.parse(t));r([])})}deleteFromStorage(e){return localStorage.removeItem(e),!0}saveToStorage(e,r){return localStorage.setItem(e,JSON.stringify(r)),!0}}class f{constructor(){i(this,"db");const e=indexedDB.open(S,1);e.onupgradeneeded=function(){e.result.createObjectStore(n)},e.onsuccess=()=>{this.db=e.result}}existsinStorage(e){return new Promise((r,s)=>{const t=this.db.transaction(n).objectStore(n).get(e);t.onsuccess=()=>{r(t.result)},t.onerror=()=>{s(t.error)}})}getFromStorage(e,r){return new Promise((s,t)=>{const u=this.db.transaction(n).objectStore(n).openCursor();u.onsuccess=()=>{const a=u.result;a?(a.key===e&&s(r?m(a,r):a.value.data),a.continue()):s([])},u.onerror=()=>{t("error")}})}saveToStorage(e,r){return this.db.transaction(n,"readwrite").objectStore(n).put(r,e),!0}deleteFromStorage(e){return this.db.transaction(n,"readwrite").objectStore(n).delete(e),!0}}function m(o,e){return c.filter(o.value,r=>Object.entries(e).every(([s,t])=>c.isInteger(r[s])?!t||r[s]===t:!t||c.toLower(r[s]).includes(c.toLower(t))))}export{p as s};
