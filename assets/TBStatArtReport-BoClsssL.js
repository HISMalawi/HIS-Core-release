import{d as w,r as d,o as v,a as T,b as D,w as R,e as b,i as g,D as A,q as P,y as h,z as u,l as F}from"./index-CJleCCtM.js";import{w as y}from"./v2utils-Czfb_0FR.js";import{T as m}from"./tb_report_service-CX4i-P_Y.js";import{v as B}from"./TableView-CMbHc5dx.js";import{T as C}from"./TBDrilldown-DMPk-_W4.js";import"./Export-CXTwynHo.js";import"./index-DC9jnrfb.js";const I=w({__name:"TBStatArtReport",setup(x){const f=h("login-logos/PEPFAR.png"),i=d([]),l=d(""),s=new m,o=(e,a)=>({label:e,ref:a,toValue:t=>t.length,tdClick:async t=>(await u.create({component:C,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:t.column.label,patientIdentifiers:t.refData,subtitle:"Period: ".concat(l.value),onFinish:()=>u.getTop().then(n=>n&&u.dismiss())}})).present()}),_=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},o("Known positive","known_positive"),o("Newly Tested Positives","newly_tested_positive"),o("New Negatives","new_negative"),o("Recent negative","recent_negative"),o("Not Done","not_done"),o("New on ART","new_on_art"),o("Already on ART","already_on_art")]],c=()=>y(async()=>{if(!(s.startDate&&s.endDate))return F("Start date and end date required!");i.value=[];const e=await m.getJson("programs/2/reports/TB_ART_STAT",s.buildRequestParams({})),a=Object.keys(e).reduce((n,r)=>(/unknown|all/i.test(r)||(n.M.push({age_group:r,gender:"Male",...e[r].M}),n.F.push({age_group:r,gender:"Female",...e[r].F})),n),{F:[],M:[]}),t=[...a.F,...a.M];i.value=t.map((n,r)=>({index:r+1,...n}))}),p=()=>A({onFinish:(e,a,t)=>{l.value="".concat(t),s.startDate=e,s.endDate=a,c()}});return v(()=>p()),(e,a)=>(T(),D(g(P),null,{default:R(()=>[b(B,{title:"TB STAT ART Report","report-prefix":"PEPFAR","icon-url":g(f),subtitle:l.value,columns:_,columnData:i.value,rowsPerPage:50,onConfigure:p,onRefresh:()=>c()},null,8,["icon-url","subtitle","columnData","onRefresh"])]),_:1}))}});export{I as default};
