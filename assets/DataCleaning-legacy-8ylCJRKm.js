System.register(["./data_cleaning_report_service-legacy-8n3nzIgX.js","./ReportMixin.vue_vue_type_script_lang-legacy-69_iz533.js","./TableReportTemplate-legacy-04efF0WH.js","./index-legacy-T5lWkeko.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./MultiFieldDateHelper-legacy-DiAe_Xzr.js","./BasicReportTemplate-legacy-HWBV8iVm.js","./Export-legacy-liiTgn5j.js","./SIngleTouchField-legacy-V9o49_9Z.js","./Pagination-legacy-G4-KSwso.js","./HisStandardForm-legacy-2zAvTkZI.js","./TouchScreenForm-legacy-oE84DcYP.js","./ToolbarMediumCard-legacy-uJ0c_iri.js","./Transformers-legacy-PbfCTy2a.js","./ViewPort-legacy-EDL_vLSV.js","./ReportErrors-legacy-ZJT4KY3y.js","./KbLayouts-legacy-NQmKRJpJ.js","./HisKbConfigurations-legacy-AV_G95Cg.js"],(function(t,e){"use strict";var a,s,i,n,r,o,l,d,h,c,u,m,p,D,g,f,_,w,T;return{setters:[t=>{a=t.D,s=t.C},t=>{i=t._},t=>{n=t.R},t=>{r=t.d,o=t.I,l=t.V,d=t.L,h=t.ab,c=t.cw,u=t.S,m=t._,p=t.r,D=t.o,g=t.c,f=t.w,_=t.b},t=>{w=t.F},t=>{T=t.g},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=r({mixins:[i],components:{ReportTemplate:n,IonPage:o},data:()=>({title:"Data cleaning report",rows:[],columns:[]}),created(){this.fields=[{id:"indicator",helpText:"Select indicator",type:w.TT_SELECT,requireNext:!1,validation:t=>l.required(t),options:()=>this.getIndicatorOptions()},...T({id:"start_date",helpText:"Start",required:!0,condition:t=>!t.indicator.other.skipDateSelection,minDate:()=>"2001-01-01",maxDate:()=>u.getSessionDate(),estimation:{allowUnknown:!1},computeValue:t=>t}),...T({id:"end_date",helpText:"End",required:!0,condition:t=>!t.indicator.other.skipDateSelection,minDate:(t,e)=>e.start_date,maxDate:()=>u.getSessionDate(),estimation:{allowUnknown:!1},computeValue:t=>t})]},methods:{async onPeriod(t,e){this.rows=[],this.title=t.indicator.label;const a=t.indicator;this.columns=a.other.columns,await a.other.setRows(t,e)},masterCardBtn(t){return d.tdBtn("View",(()=>this.$router.push(`/art/mastercard/${t}`)))},getDefaultIndicatorColumns:(t=[])=>[[d.thTxt("ARV Number"),d.thTxt("Patient Id"),d.thTxt("First Name"),d.thTxt("Last Name"),d.thTxt("Gender"),d.thTxt("Date of birth"),...t,d.thTxt("Action")]],async setDefaultIndicatorRows(t,e,s,i=null){this.report=new a,this.report.setStartDate(e),this.report.setEndDate(s),this.period=this.report.getDateIntervalPeriod();const n=this.sortByArvNumber(await this.report.getCleaningToolReport(t)||[],"arv_number");h.isEmpty(n)||n.forEach((t=>{const e="function"==typeof i?i(t):[];this.rows.push([d.td(t.arv_number),d.td(t.patient_id),d.td(t.given_name),d.td(t.family_name),d.td(this.formatGender(t.gender)),d.tdDate(t.birthdate),...e,this.masterCardBtn(t.patient_id)])}))},getIndicatorOptions(){return[{label:"DOB > Date enrolled",value:s.DobMoreThanEnrolledDate,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.DobMoreThanEnrolledDate,e.start_date,e.end_date)}},{label:"Date enrolled < Earliest start date",value:s.DateEnrolledLessThanEarliestStartDate,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns([d.thTxt("Earliest start date"),d.thTxt("Date enrolled")]),setRows:(t,e)=>this.setDefaultIndicatorRows(s.DateEnrolledLessThanEarliestStartDate,e.start_date,e.end_date,(t=>[d.tdDate(t.earliest_start_date),d.tdDate(t.date_enrolled)]))}},{label:"Encounters after Death",value:s.ClientsWithEncountersAfterDeath,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.ClientsWithEncountersAfterDeath,e.start_date,e.end_date)}},{label:"Incomplete visits",value:"Incomplete visits",other:{skipDateSelection:!1,columns:[[d.thTxt("ARV#"),d.thTxt("NHID"),d.thTxt("First name"),d.thTxt("Last name"),d.thTxt("Gender"),d.thTxt("Birthdate"),d.thTxt("Date(s)"),d.thTxt("Action")]],setRows:async(t,e)=>{this.report=new a,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod();const s=await this.report.getIncompleteVisits();for(const a in s){const t=s[a];this.rows.push([d.td(t.arv_number),d.td(t.national_id),d.td(t.given_name),d.td(t.family_name),d.td(this.formatGender(t.gender)),d.tdDate(t.birthdate),d.td(t.dates.map((t=>this.toDate(t))).join("<br/>")),this.masterCardBtn(parseInt(a.toString()))])}}}},{label:"Enrolled on ART before birth",value:"Enrolled on ART before birth",other:{skipDateSelection:!0,columns:[[d.thTxt("ARV number"),d.thTxt("Name"),d.thTxt("Earliest start date"),d.thTxt("Date enrolled"),d.thTxt("Gender"),d.thTxt("Birth Date"),d.thTxt("Action")]],setRows:async()=>{try{this.report=new a,(await this.report.getEnrolledOnArtBeforeBirth()).forEach((t=>{this.rows.push([d.td(t.identifier),d.td(t.name),d.tdDate(t.earliest_start_date),d.tdDate(t.date_enrolled),d.td(this.formatGender(t.gender)),d.tdDate(t.birthdate),this.masterCardBtn(t.patient_id)])}))}catch(t){if(!(t instanceof c))throw t}}}},{label:"Missing VL Results",value:"Missing VL Results",other:{columns:[[d.thTxt("ARV number"),d.thTxt("First name"),d.thTxt("Last name"),d.thTxt("Gender"),d.thTxt("Accession number"),d.thTxt("Order date"),d.thTxt("Action")]],setRows:async(t,e)=>{try{this.report=new a,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),(await this.report.getCleaningToolReport(s.MissingVlResults)).forEach((t=>{this.rows.push([d.td(t.arv_number),d.td(t.given_name),d.td(t.family_name),d.td(this.formatGender(t.gender)),d.td(t.accession_number),d.tdDate(t.order_date),this.masterCardBtn(t.patient_id)])}))}catch(i){if(!(i instanceof c))throw i}}}},{label:"Male patients with female observations",value:s.MalesWithFemaleObs,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns([d.thTxt("Visit date")]),setRows:(t,e)=>this.setDefaultIndicatorRows(s.MalesWithFemaleObs,e.start_date,e.end_date,(t=>[d.tdDate(t.visit_date)]))}},{label:"Missing important demographics elements",value:s.MissingDemographics,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.MissingDemographics,e.start_date,e.end_date)}},{label:"Missing start reason",value:s.MissingStartReasons,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.MissingStartReasons,e.start_date,e.end_date)}},{label:"Multiple start reasons",value:s.MultipleStartReasons,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.MultipleStartReasons,e.start_date,e.end_date)}},{label:"Patients with Pre-ART / Unknown outcome",value:s.PreArtOrUnknownOutcomes,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns(),setRows:(t,e)=>this.setDefaultIndicatorRows(s.PreArtOrUnknownOutcomes,e.start_date,e.end_date)}},{label:"Prescriptions without dispensations",value:s.PrescriptionWithoutDispensation,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns([d.thTxt("Visit Date")]),setRows:(t,e)=>this.setDefaultIndicatorRows(s.PrescriptionWithoutDispensation,e.start_date,e.end_date,(t=>[d.tdDate(t.visit_date)]))}},{label:"Different pregnancy value on same date",value:s.DifferentPregnancyValueOnSameDate,other:{skipDateSelection:!1,columns:this.getDefaultIndicatorColumns([d.thTxt("Visit Date")]),setRows:(t,e)=>this.setDefaultIndicatorRows(s.DifferentPregnancyValueOnSameDate,e.start_date,e.end_date,(t=>[d.tdDate(t.visit_date)]))}}]}}});t("default",m(e,[["render",function(t,e,a,s,i,n){const r=p("report-template"),o=p("ion-page");return D(),g(o,null,{default:f((()=>[_(r,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
