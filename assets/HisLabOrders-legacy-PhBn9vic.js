System.register(["./index-legacy-Dx_PXhkv.js","./LabOrderModal-legacy-Bd7UkYE6.js","./FieldMixin.vue_vue_type_script_lang-legacy-DmFd6D5K.js","./lab_order_service-legacy-BP7kQfAR.js","./HisKeyboard-legacy-BFoifhRH.js","./fuse-legacy-CQoBB3MK.js"],(function(e,t){"use strict";var r,s,n,d,a,i,o,l,c,u,h,m,p,y,g,_,f,v,b,w,O,D,x,S,k,j,C;return{setters:[e=>{r=e.d,s=e.bl,n=e.f,d=e.H,a=e.ct,i=e.S,o=e.t,l=e.n,c=e.O,u=e.ae,h=e._,m=e.r,p=e.o,y=e.c,g=e.w,_=e.A,f=e.x,v=e.B,b=e.y,w=e.b,O=e.u,D=e.v,x=e.a5,S=e.a6,k=e.a7},e=>{j=e.L},e=>{C=e._},null,null,null],execute:function(){var t=document.createElement("style");t.textContent="table[data-v-d2ac3687]{font-family:arial,sans-serif;border-collapse:collapse;width:100%}td[data-v-d2ac3687],th[data-v-d2ac3687]{border:1px solid #dddddd;text-align:left;padding:8px}tr[data-v-d2ac3687]:nth-child(2n){background-color:#ddd}\n",document.head.appendChild(t);const F=r({components:{ViewPort:s,IonButton:n},mixins:[C],data:()=>({HisDate:d,rows:[],fetchingOrders:!1,ordersToday:{}}),methods:{async init(){this.$emit("onFieldActivated",this),this.fetchingOrders=!0;let e=[];try{e=await this.options(this.fdata)}catch(r){console.error(`${r}`)}this.fetchingOrders=!1;const t=e[0].other.values;this.ordersToday=t.reduce(((e,t)=>(a(t.ordered)!==a(i.getSessionDate())||t.result.length||(e[t.test_name]=!0),e)),{}),this.rows=t.map((e=>(e.id=e.order_id,e.ordered&&(e.ordered=d.toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=d.toStandardHisDisplayFormat(e.released)),e)))},async printOrder(e){if(a(e.ordered)!=a(i.getSessionDate()))return o(`Printing order #${e.accession_number} is restricted to today. Consider using BDE mode/set session date to the order date`);"function"==typeof this.config?.printOrder&&await l(`Do you want to print order with accession number ${e.accession_number}?`)&&this.config.printOrder(e.id)},formatOrders:e=>e.map((e=>({id:e.order_id,encounter_id:e.encounter_id,result_given:e.result_given,accession_number:e.accession_number,test_name:e.tests[0].name,specimen:e.specimen.name,ordered:d.toStandardHisDisplayFormat(e.order_date),result:[],release:""}))),async launchOrderSelection(e=null){if(this.fetchingOrders)return o("Please wait....");const t=await c.create({component:j,backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:e,ordersToday:this.ordersToday,onOrderAdded:e=>this.ordersToday[e]=!0}});t.present();const{data:r}=await t.onDidDismiss();u.isEmpty(r)||(this.rows=[...this.formatOrders(r),...this.rows])}},mounted(){this.init()},activated(){this.init()}}),H=e=>(S("data-v-d2ac3687"),e=e(),k(),e),T={class:"view-port-content"},A={class:"his-sm-text"},P=H((()=>_("tr",null,[_("th",null,"Accession #"),_("th",null,"Test Name"),_("th",null,"Specimen"),_("th",null,"Ordered"),_("th",null,"Result"),_("th",null,"Released"),_("th",null,"Given")],-1))),$=H((()=>_("br",null,null,-1)));e("default",h(F,[["render",function(e,t,r,s,n,d){const a=m("ion-button"),i=m("view-port");return p(),y(i,null,{default:g((()=>[_("div",T,[_("table",A,[P,(p(!0),f(v,null,b(e.rows,((t,r)=>(p(),f("tr",{key:r},[_("td",null,[w(a,{color:"light",fill:"none",onClick:r=>e.printOrder(t)},{default:g((()=>[O(D(t.accession_number),1)])),_:2},1032,["onClick"])]),_("td",null,D(t.test_name),1),_("td",null,D(t.specimen),1),_("td",null,D(t.ordered),1),_("td",null,[(p(!0),f(v,null,b(t.result,((e,t)=>(p(),f("span",{key:t},[O(D(e)+" ",1),$])))),128))]),_("td",null,D(t.released),1),_("td",null,[_("span",{style:x("color: "+("Yes"===t.result_given?"green;":"black;"))},D(t.result_given),5)])])))),128))])])])),_:1})}],["__scopeId","data-v-d2ac3687"]]))}}}));
