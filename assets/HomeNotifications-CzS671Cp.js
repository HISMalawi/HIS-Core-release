import{d as K,Y,$ as Q,ay as W,a6 as A,a8 as X,a9 as Z,r as E,at as S,cg as x,aN as M,aL as q,cb as ee,cc as te,cf as ae,aa as oe,af as j,a as i,E as m,K as P,J as B,G as z,b as p,w as d,c as _,M as $,a2 as O,b7 as le,C,d6 as ne,e as se,ck as re,u as V,ba as U,b5 as G,b9 as ue,bG as ie}from"./index-BsVOoHAl.js";const de=K({components:{IonToolbar:Y,IonItem:Q,IonIcon:W,IonLabel:A,IonButton:X,IonFooter:Z},props:{columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},rowsPerPage:{type:Number,default:10},defaultSortedColumn:{type:String},defaultSortOrder:{type:Object}},setup(e){const c=E([]),g=E(0),w=E(""),h=E("desc"),v=S(()=>{let s=c.value;return h.value&&w.value&&(s=x(c.value)[h.value](u=>u.sortData[w.value])),s}),l=S(()=>M.chunk(v.value,e.rowsPerPage).length),R=S(()=>g.value+2<=l.value),L=S(()=>g.value>0),a=S(()=>M.chunk(v.value,e.rowsPerPage)[g.value]),t=s=>{w.value=s,h.value=h.value==="asc"?"desc":"asc"},o=()=>ae(s=>{const u=parseInt(s);parseInt(s)<=l.value&&(g.value=u)},{title:"Select page"}),r=()=>g.value=0,k=()=>g.value=l.value-1||0,n=()=>g.value+=1,b=()=>g.value-=1,y=s=>{var u,I;try{typeof((u=s.column)==null?void 0:u.tdClick)=="function"&&((I=s.column)==null||I.tdClick(s));return}catch(T){console.error(T)}},N=()=>e.columns.reduce((s,u)=>s.concat(u),[]).filter(s=>s.value||s.ref),H=s=>{s.forEach(u=>{const I={...u},T=N().map(f=>{let D="";const F=u[f.ref];try{M.isEmpty(u)?D="":typeof f.toValue=="function"?D="".concat(f.toValue(F)):typeof f.value=="function"?D=f.value(u):D=u[f.ref]||""}catch(J){D=(f==null?void 0:f.defaultValue)||"_ERROR_",console.error(J)}return I[f.ref]=D,typeof f.sortValue=="function"&&(I[f.ref]=f.sortValue(F)),{column:f,refData:F,value:D,data:u}});c.value.push({row:T,data:u,sortData:I,searchIndex:[...T,T.map(f=>f.value).join(" ")]})})};return q(()=>e.columnData,s=>{var u;if(c.value=[],!Array.isArray(s)||!s.length){g.value=0,w.value=(u=e.defaultSortedColumn)!=null?u:"",h.value=e.defaultSortOrder||"desc",H(Array.from({length:0}).map(()=>({})));return}H(s)},{immediate:!0,deep:!0}),{first:r,last:k,next:n,prev:b,selectPage:o,sortColumn:t,onClickTablecell:y,close,arrowUp:ee,arrowDown:te,page:a,canNext:R,totalPages:l,sortOrder:h,canPrev:L,currentPage:g,columnSorted:w}}}),ce={style:{width:"100%"}},fe={class:"stick-report-header"},pe=["colspan","rowspan","onClick"],ge=["onClick"],ve=["innerHTML"];function me(e,c,g,w,h,v){const l=j("ion-icon"),R=j("ion-label"),L=j("ion-item"),a=j("ion-button"),t=j("ion-toolbar"),o=j("ion-footer");return i(),m(B,null,[P("div",null,[P("table",ce,[P("thead",fe,[(i(!0),m(B,null,z(e.columns,(r,k)=>(i(),m("tr",{key:k},[(i(!0),m(B,null,z(r,(n,b)=>{var y,N;return i(),m("th",{key:b,colspan:((y=n==null?void 0:n.span)==null?void 0:y.thColspan)||1,rowspan:((N=n==null?void 0:n.span)==null?void 0:N.thRowspan)||1,onClick:H=>e.sortColumn(n.ref)},[p(L,{lines:"none"},{default:d(()=>[e.columnSorted&&e.columnSorted===n.ref?(i(),_(l,{key:0,icon:e.sortOrder==="asc"?e.arrowUp:e.arrowDown},null,8,["icon"])):$("",!0),p(R,null,{default:d(()=>[P("b",null,O(n.label),1)]),_:2},1024)]),_:2},1024)],8,pe)}),128))]))),128))]),P("tbody",null,[(i(!0),m(B,null,z(e.page,(r,k)=>(i(),m("tr",{key:k},[(i(!0),m(B,null,z(r.row,(n,b)=>{var y;return i(),m("td",{key:b,onClick:()=>e.onClickTablecell(n),class:le({"clickable-cell":(y=n==null?void 0:n.column)==null?void 0:y.tdClick})},[P("span",{innerHTML:n.value,class:"his-sm-text"},null,8,ve)],10,ge)}),128))]))),128))])])]),c[4]||(c[4]=P("p",null,null,-1)),p(o,null,{default:d(()=>[p(t,{color:"light"},{default:d(()=>[e.totalPages>1?(i(),_(a,{key:0,onClick:e.first,disabled:e.currentPage===0||e.totalPages<=2,size:"large",slot:"end"},{default:d(()=>c[0]||(c[0]=[C(" First ")])),_:1},8,["onClick","disabled"])):$("",!0),e.totalPages>1?(i(),_(a,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:d(()=>c[1]||(c[1]=[C(" Prev ")])),_:1},8,["onClick","disabled"])):$("",!0),e.totalPages>1?(i(),_(a,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:d(()=>[C(O(e.currentPage)+" / "+O(e.totalPages-1),1)]),_:1},8,["onClick"])):$("",!0),e.totalPages>1?(i(),_(a,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:d(()=>c[2]||(c[2]=[C(" Next ")])),_:1},8,["onClick","disabled"])):$("",!0),e.totalPages>1?(i(),_(a,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:d(()=>c[3]||(c[3]=[C(" Last ")])),_:1},8,["onClick","disabled"])):$("",!0)]),_:1})]),_:1})],64)}const ke=oe(de,[["render",me],["__scopeId","data-v-6173022f"]]),be={key:0},ye={key:1,class:"his-card ion-text-center his-lg-text"},Ce=K({__name:"HomeNotifications",setup(e){const{notificationData:c,hasNotifications:g,clearNotification:w,openNotification:h}=ne(),v=E("highVL"),l=se({highVL:[],rejectedVL:[],normalVL:[],initiatedData:{},stats:{}}),R=S(()=>[[{ref:"arv",label:"ARV #"},{ref:"accession",label:"Accession #"},{ref:"order_date",label:"Order Date",toValue:a=>"".concat(re(a))},...v.value==="rejectedVL"?[{ref:"rejection_reason",label:"Rejection Reason"}]:[],{ref:"id",label:"View",toValue:()=>"View",tdClick:a=>h(a.data)},{ref:"id",label:"Clear",toValue:()=>"Clear",tdClick:a=>w(a.refData,t=>{l[v.value]=l[v.value].filter(o=>o.id!=t)})}]]);async function L(a,t=c.value){var k,n,b;if(t.length&&l.initiatedData[a])return;let o=6e3;const r=M.chunk((b=(n=(k=t==null?void 0:t[0])==null?void 0:k.vlMessageObs)==null?void 0:n[a])!=null?b:{},7);l.initiatedData[a]=t.length>0,l[a]=[];for(const y of r)l[a]=[...l[a],...y],await ie(o),o=30;l[a]=[...l[a]].sort((y,N)=>new Date(y.order_date)>new Date(N.order_date)?-1:1)}return q(c,async a=>{L(v.value,a),setTimeout(()=>{var o,r,k,n,b;const t=(r=(o=a==null?void 0:a[0])==null?void 0:o.vlMessageObs)!=null?r:{};l.stats.highVL=((k=t.highVL)!=null?k:[]).length,l.stats.normalVL=((n=t.normalVL)!=null?n:[]).length,l.stats.rejectedVL=((b=t.rejectedVL)!=null?b:[]).length},50)},{immediate:!0,deep:!0}),(a,t)=>(i(),m("div",null,[V(g)?(i(),m("div",be,[p(V(ue),{mode:"ios",modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=o=>v.value=o),class:"ion-justify-content-center"},{default:d(()=>[p(V(U),{onClick:t[0]||(t[0]=o=>L("highVL")),value:"highVL"},{default:d(()=>[p(V(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[4]||(t[4]=[C("High Vl")])),_:1}),p(V(G),{color:"danger"},{default:d(()=>{var o,r;return[C(O((r=(o=l.stats)==null?void 0:o.highVL)!=null?r:"-"),1)]}),_:1})]),_:1}),p(V(U),{onClick:t[1]||(t[1]=o=>L("rejectedVL")),value:"rejectedVL"},{default:d(()=>[p(V(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[5]||(t[5]=[C("Rejected")])),_:1}),p(V(G),{color:"warning"},{default:d(()=>{var o,r;return[C(O((r=(o=l.stats)==null?void 0:o.rejectedVL)!=null?r:"-"),1)]}),_:1})]),_:1}),p(V(U),{onClick:t[2]||(t[2]=o=>L("normalVL")),value:"normalVL"},{default:d(()=>[p(V(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[6]||(t[6]=[C("Normal Results")])),_:1}),p(V(G),{color:"success"},{default:d(()=>{var o,r;return[C(O((r=(o=l.stats)==null?void 0:o.normalVL)!=null?r:"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),t[7]||(t[7]=P("p",null,null,-1)),(i(),_(ke,{key:v.value,columns:R.value,"column-data":l[v.value],"rows-per-page":7},null,8,["columns","column-data"]))])):(i(),m("div",ye," No notifications "))]))}});export{Ce as default};
