System.register(["./opd_report_service-legacy-CNjtFa_f.js","./BaseTableReport-legacy-CDhS2LWQ.js","./index-legacy-DzF0J2nr.js","./ReportMixin.vue_vue_type_script_lang-legacy-nksRd-YK.js","./Export-legacy-nGdXEsf9.js","./HisStandardForm-legacy-DHvPmsWP.js","./TouchScreenForm-legacy-CDzY5o9b.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./ToolbarMediumCard-legacy-BDSK2XWR.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-BcrZm7RF.js","./BasicReportTemplate-legacy-C0yGLBl6.js","./SIngleTouchField-legacy-C-DlUswk.js","./Pagination-legacy-B8DL8hGq.js","./MultiFieldDateHelper-legacy-BKSEfgg6.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js"],(function(t,e){"use strict";var i,l,a,s,r,n,o,u,d,c,g,p,y,h,m;return{setters:[t=>{i=t.O},t=>{l=t.R},t=>{a=t.d,s=t.I,r=t.L,n=t.H,o=t.S,u=t.cG,d=t._,c=t.r,g=t.o,p=t.c,y=t.w,h=t.b},t=>{m=t._},null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=a({components:{ReportTemplate:l,IonPage:s},mixins:[m],data:()=>({title:"Clinic Registration",rows:[],reportData:[],columns:[[r.thTxt("Reg"),r.thTxt("First Name"),r.thTxt("Last Name"),r.thTxt("Gender"),r.thTxt("DOB"),r.thTxt("Date reg.")]],customBtns:[]}),created(){this.fields=this.getDateDurationFields(),this.customBtns.push({name:"High level view",size:"large",slot:"start",color:"primary",visible:!0,onClick:async()=>this.showModal()})},methods:{async init(t,e){const l=new i;l.setStartDate(e.start_date),l.setEndDate(e.end_date),this.period=l.getDateIntervalPeriod();const a=await l.getClinicRegistrations();this.reportData=a.sort(((t,e)=>t.visit_type>e.visit_type?1:t.visit_type<e.visit_type?-1:0)),this.rows=this.buildRows(this.reportData)},buildRows:t=>t.length?t.map((t=>[r.td(t.visit_type),r.td(t.given_name),r.td(t.family_name),r.td(t.gender),r.td(n.toStandardHisDisplayFormat(t.birthdate)),r.td(n.toStandardHisDisplayFormat(t.visit_date))])):[],filterBy(t,e){return this.reportData.filter((i=>{const l=n.calculateAge(i.birthdate,o.getSessionDate());return i.visit_type===t&&("under5"===e?l<=5:l>6)}))},modalData(){const t=[...this.filterBy("New patient","under5")].length,e=[...this.filterBy("New patient","over5")].length,i=t+e,l=[...this.filterBy("Referral","under5")].length,a=[...this.filterBy("Referral","over5")].length,s=l+a,r=[...this.filterBy("Revisiting","under5")].length,n=[...this.filterBy("Revisiting","over5")].length;return[{label:"New patient",under5:t,over5:e,value:i},{label:"Referral",under5:l,over5:a,value:s},{label:"Revisiting",under5:r,over5:n,value:r+n}]},async showModal(){await u([...this.modalData()])}}});t("default",d(e,[["render",function(t,e,i,l,a,s){const r=c("report-template"),n=c("ion-page");return g(),p(n,null,{default:y((()=>[h(r,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,itemsPerPage:10,period:t.period,reportPrefix:"Clinic",onReportConfiguration:t.init,customBtns:t.customBtns,paginated:""},null,8,["title","rows","fields","columns","period","onReportConfiguration","customBtns"])])),_:1})}]]))}}}));
