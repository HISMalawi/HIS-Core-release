import{d as x,I as R,cJ as P,o as w,r as s,W as M,am as N,aE as A,bC as F,ci as d,au as u,ad as S,aN as I,ae as p,H as V,ao as Y,aa as E,af as f,a as O,c as H,w as J,b as D}from"./index-CMZASHAR.js";import{v as Q}from"./TableView-BqD_eTJw.js";import{C as j}from"./cxca_report_service-BLTGK-Am.js";import{D as q}from"./DrillPatientIds-CwQBWjf6.js";import"./Export-CpyT9Gk1.js";import"./index-_zuoFVCp.js";import"./TableView-DhTjQT8r.js";const g=s([]),o=s(""),n=s(""),b=s(""),y=s(!1),k=s(""),B=x({components:{IonPage:R,IonLoading:P,v2Datatable:Q},setup(){const l=(a,e)=>{const r=[c(a.first_time_screened),c(a.rescreened_after_prev_visit),c(a.post_treatment_followup)];return r.push(m(e)),r},c=a=>a.map(e=>{const{age_group:r,...i}=e;return{...i,age_group:r}}),m=a=>{const e=[];for(const r in a){const i={};i[r]=a[r],e.push(i)}return e},t=async(a,e)=>{e.length<=0||(await u.create({component:q,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:a,subtitle:b,patientIdentifiers:e,onFinish:()=>u.getTop().then(r=>r&&u.dismiss())}})).present()},h=["age_group","negative","positive","for_same_day_tx","suspected"],C=["Age Group","Negative","Positive","For same day Tx","Suspected Cancer"],v=[["","","1st time screened","",""],["","","Rescreened after previous negative","",""],["","","Post-treatment follow-up","",""],["","","Month Summary","",""]],_=[[{label:"Facility:",ref:""},{label:"Month/Year:",ref:"",span:{thColspan:1}},{label:"Report Officer:",ref:"",span:{thColspan:3}}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Negative",ref:"data.cryotherapy.length",secondaryLabel:"1st screened (negative)",value:a=>{var e;return(e=a.negative)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.negative)},{label:"Positive",ref:"data.positive.length",secondaryLabel:"1st screened (positive)",value:a=>{var e;return(e=a.positive)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.positive)},{label:"For same day Tx",ref:"data.for_same_day_tx.length",secondaryLabel:"1st screened (For same day Tx)",value:a=>{var e;return(e=a.for_same_day_tx)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.for_same_day_tx)},{label:"Suspected Cancer",ref:"data.suspected.length",secondaryLabel:"1st screened (Suspected Cancer)",value:a=>{var e;return(e=a.suspected)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected)}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Negative",ref:"data.cryotherapy.length",secondaryLabel:"Rescreened after previous negative (negative)",value:a=>{var e;return(e=a.negative)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.negative)},{label:"Positive",ref:"data.positive.length",secondaryLabel:"Rescreened after previous negative (positive)",value:a=>{var e;return(e=a.positive)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.positive)},{label:"For same day Tx",ref:"data.for_same_day_tx.length",secondaryLabel:"Rescreened after previous negative (For same day Tx)",value:a=>{var e;return(e=a.for_same_day_tx)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.for_same_day_tx)},{label:"Suspected Cancer",ref:"data.suspected.length",secondaryLabel:"Rescreened after previous negative (Suspected Cancer)",value:a=>{var e;return(e=a.suspected)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected)}],[{label:"Age Disaggregate:",ref:"data.age_group",value:a=>a.age_group},{label:"Negative",ref:"data.cryotherapy.length",secondaryLabel:"Post-treatment follow-up (negative)",value:a=>{var e;return(e=a.negative)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.negative)},{label:"Positive",ref:"data.positive.length",secondaryLabel:"Post-treatment follow-up positive)",value:a=>{var e;return(e=a.positive)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.positive)},{label:"For same day Tx",ref:"data.for_same_day_tx.length",secondaryLabel:"Post-treatment follow-up (For same day Tx)",value:a=>{var e;return(e=a.for_same_day_tx)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.for_same_day_tx)},{label:"Suspected Cancer",ref:"data.suspected.length",secondaryLabel:"Post-treatment follow-up (Suspected Cancer)",value:a=>{var e;return(e=a.suspected)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(e.age_group," ").concat(a.secondaryLabel),e.suspected)}],[{label:"1st time Screened",ref:"",exportable:!1,span:{thColspan:7}}],[{label:"Rescreened after previous negative",ref:"",exportable:!1,span:{thColspan:7}}],[{label:"Post-treatment follow-up",ref:"",span:{thColspan:7}}],[{label:"Month Summary",ref:"",span:{thColspan:7}}],[{label:"Total Screened",ref:"data.total_screened.length",secondaryLabel:"Total Screened",value:a=>{var e;return(e=a.total_screened)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_screened)}],[{label:"Total Negative",ref:"data.total_negative.length",secondaryLabel:"Total Negative",value:a=>{var e;return(e=a.total_negative)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_negative)}],[{label:"Total Via + eligible for same day Tx",ref:"data.total_via_plus_eligible_for_same_day_tx.length",secondaryLabel:"Total Via + eligible for same day Tx",value:a=>{var e;return(e=a.total_via_plus_eligible_for_same_day_tx)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_via_plus_eligible_for_same_day_tx)}],[{label:"Total Positive",ref:"data.total_positive.length",secondaryLabel:"Total Positive",value:a=>{var e;return(e=a.total_positive)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_positive)}],[{label:"Total Suspected Cancer",ref:"data.total_suspect_cancer.length",secondaryLabel:"Total Suspected Cancer",value:a=>{var e;return(e=a.total_suspect_cancer)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_suspect_cancer)}],[{label:"Total VIA+ Referred",ref:"data.total_via_reffered.length",secondaryLabel:"Total VIA+ Referred",value:a=>{var e;return(e=a.total_via_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_via_reffered)}],[{label:"Total CXCA Suspect Referred",ref:"data.suspects_reffered.length",secondaryLabel:"Total CXCA Suspect Referred",value:a=>{var e;return(e=a.suspects_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.suspects_reffered)}],[{label:"Total Referred",ref:"data.total_reffered.length",secondaryLabel:"Total Referred",value:a=>{var e;return(e=a.total_reffered)==null?void 0:e.length},tdClick:({column:a,data:e})=>t("".concat(a.secondaryLabel),e.total_reffered)}]],$=async()=>{if(!(o.value&&n.value))return M("Start date and end date required!");y.value=!0,g.value=[];const a=new j;a.startDate=o.value,a.endDate=n.value;try{const e=await a.getClinicReport("MONTHLY SCREEN");g.value=l(e.data,e.totals)}catch(e){N("Unable to generate report!"),console.error(e)}y.value=!1},T=()=>A([{id:"year",helpText:"Select Year",type:S.TT_NUMBER,computedValue:a=>a.value,validation:a=>{const e=I.isPlainObject(a)?a.value:-1;return p.validateSeries([()=>p.required(a),()=>isNaN(parseInt("".concat(e)))?["Invalid year"]:null,()=>p.rangeOf(a,2e3,V.getYear(Y.getSessionDate()))])}},{id:"month",helpText:"Select Month",type:S.TT_SELECT,validation:a=>p.required(a),computedValue:a=>a.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}],a=>{o.value="".concat(a.year.value,"-").concat(a.month.value,"-01"),n.value=F(new Date(o.value).toISOString()).endOf("month").format("YYYY-MM-DD"),b.value="Period (".concat(d(o.value)," to ").concat(d(n.value),")"),u.dismiss(),k.value="".concat(d(o.value)," to ").concat(d(n.value)),$()});return w(()=>!g.value.length&&T()),{columns:_,isLoading:y,reportData:g,period:b,csvQuarter:k,generate:$,configure:T,order:h,csvheaders:C,spacing:3,subHeaders:v}}});function G(l,c,m,t,h,C){const v=f("ion-loading"),L=f("v2Datatable"),_=f("ion-page");return O(),H(_,null,{default:J(()=>[D(v,{"is-open":l.isLoading,message:"Please wait..."},null,8,["is-open"]),D(L,{title:"Monthly Screen Report",subtitle:l.period,columns:l.columns,columnData:l.reportData,rowsPerPage:25,onConfigure:l.configure,csvQuarter:l.csvQuarter,onRefresh:()=>l.generate(),order:l.order,headers:l.csvheaders,"csv-spacing":l.spacing,"csv-sub-header":l.subHeaders},null,8,["subtitle","columns","columnData","onConfigure","csvQuarter","onRefresh","order","headers","csv-spacing","csv-sub-header"])]),_:1})}const ae=E(B,[["render",G]]);export{ae as default};
