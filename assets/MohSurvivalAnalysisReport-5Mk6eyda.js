var f=Object.defineProperty;var v=(t,o,r)=>o in t?f(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r;var p=(t,o,r)=>(v(t,typeof o!="symbol"?o+"":o,r),r);import{cb as T,d as R,a5 as w,aq as e,ab as x,ac as y,aK as c,a8 as b,ad as g,u as S,v as _,w as C,x as I}from"./index-LyP1z09P.js";import{_ as A}from"./ReportMixin.vue_vue_type_script_lang-XAcjLpwM.js";import{R as E}from"./TableReportTemplate-7x-Wf1XS.js";import"./BasicReportTemplate-sA2vucmk.js";import"./Export-8d5rspLX.js";import"./Pagination-hZp0slGq.js";import"./HisStandardForm-DTr2fl7A.js";import"./ReportErrors-GzsxNicS.js";var u=(t=>(t.GENERAL="General",t.CHILDREN="Children",t.WOMEN="Women",t))(u||{});class G extends T{constructor(){super();p(this,"ageGroup");p(this,"quarter");p(this,"regenerate");this.quarter="",this.regenerate=!1,this.ageGroup="General"}setRegenerate(r){this.regenerate=r}getAgeGroup(){return this.ageGroup}setQuarter(r){this.quarter=r}setAgeGroup(r){this.ageGroup=r}getSurvivalAnalysis(){return this.getReport("cohort_survival_analysis",{quarter:this.quarter,regenerate:this.regenerate,date:this.date,age_group:this.ageGroup,program_id:this.programID})}}const m={style:{borderRight:"5px solid black !important"}},D=R({mixins:[A],components:{ReportTemplate:E,IonPage:w},data:()=>({title:"Survival analysis report",totalClients:[],rows:[],columns:[[e.thTxt("Reg cohort"),e.thTxt("Interval (months)"),e.thTxt("Sub group"),e.thTxt("Total Reg (database)"),e.thTxt("Total Reg (Confirmed)",m),e.thTxt("Alive"),e.thTxt("Died"),e.thTxt("Defaulted"),e.thTxt("Stopped"),e.thTxt("TO"),e.thTxt("Unknown")]]}),created(){this.fields=[...this.getDateDurationFields(!0,!1,17),{id:"group",helpText:"Select sub-group",type:x.TT_SELECT,validation:t=>y.required(t),options:()=>[{label:"General",value:u.GENERAL},{label:"Children",value:u.CHILDREN},{label:"Option B+",value:u.WOMEN}]}]},methods:{async onPeriod({quarter:t,group:o},r,s=!1){this.rows=[],this.period=t.label,this.report=new G,this.report.setOccupation(r.occupation),this.report.setRegenerate(s),this.report.setQuarter(t.label),this.report.setAgeGroup(o.value);const n=await this.report.getSurvivalAnalysis();this.title="Survival analysis report ".concat(o.label),this.rows=this.getRows(n)},getRows(t){return Object.keys(t).filter(o=>!c.isEmpty(t[o])).sort((o,r)=>{const s=o.split(" ")[1],n=r.split(" ")[1];return parseInt(s)-parseInt(n)}).map(o=>{const r=t[o];let s=0,n=0;const a={"On antiretrovirals":0,Defaulted:0,"Patient died":0,"Treatment stopped":0,"Patient transferred out":0,unknown:0};if(!c.isEmpty(r)){for(const i in r){const l=r[i];for(const h in l){const d=l[h];s=parseInt(h),i in a?a[i]=d:a.unknown=d,n+=d}}return[e.td(o),e.td(s),e.td(this.report.getAgeGroup()),e.td(n),e.td("",m),e.td(a["On antiretrovirals"]),e.td(a["Patient died"]),e.td(a.Defaulted),e.td(a["Treatment stopped"]),e.td(a["Patient transferred out"]),e.td(a.unknown)]}})}}});function k(t,o,r,s,n,a){const i=g("report-template"),l=g("ion-page");return S(),_(l,null,{default:C(()=>[I(i,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!1},reportPrefix:"MoH",hasServerSideCaching:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const Q=b(D,[["render",k]]);export{Q as default};
