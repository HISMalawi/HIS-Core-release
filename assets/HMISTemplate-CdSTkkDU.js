var b=Object.defineProperty;var w=(o,t,e)=>t in o?b(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var u=(o,t,e)=>w(o,typeof t!="symbol"?t+"":t,e);import{O as R}from"./opd_report_service-5M9S1HMw.js";import{d as S,R as D,L as n,b3 as v,S as c,_ as C,r as _,o as I,x as $,b as y}from"./index-Bb5e7Gwm.js";class h extends R{constructor(){super();u(this,"regenerate");this.regenerate=!1}setRegenerate(e){this.regenerate=e}requestHMIS15(){return this.getReport("generate_hmis_15_report",{request:"true"})}requestHMIS17(){return this.getReport("generate_hmis_17_report",{request:"true"})}renderResults(e){const r=[];let s=1;for(const[i,d]of Object.entries(e)){const m=[],g=d,a={id:0,name:"",total:0,totalPatientIds:""};a.name=i;let p=0;a.id=s,s+=1;for(const[E,f]of Object.entries(g)){const l=f;l!=null&&(p+=l.length,a.total=p,l.length&&(m.push(...l),a.totalPatientIds=m))}r.push(a)}return r}getCSVString(e){let r="Diseases/Events/Conditions, #,\n";for(const s of e){const i="".concat(s.name,",").concat(s.total,",\n");r+=i}return{CSVString:r}}}const V=S({components:{ReportTable:D},data:function(){return{conditions:[],tableCssTheme:"opd-report-theme",total:" Total ",rows:[],columns:[[n.thTxt(""),n.thTxt("Diseases/Events/Conditions"),n.thTxt("UNVERIFIED"),n.thTxt("VERIFIED")]]}},props:["params","periodDates","quarter","onDrillDown","reportName"],methods:{renderResults(){const t=new h().renderResults(this.params);t.length&&(this.conditions=t,this.rows=this.buildRows(t))},onDownload(o=""){const t=new h;let{CSVString:e}=t.getCSVString(this.conditions);e+="\n          Date Created: ".concat(v().format("DD/MMM/YYYY HH:MM:ss"),"\n          His-Core Version: ").concat(c.getCoreVersion(),"\n          API Version: ").concat(c.getApiVersion(),"\n          Report Period: ").concat(this.periodDates,"\n          Site: ").concat(c.getLocationName(),"\n          Site UUID: ").concat(c.getSiteUUID());const r=new Blob([e],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(r,"exportFilename");else{const s=document.createElement("a");s.href=window.URL.createObjectURL(r),s.setAttribute("download","".concat(o,".csv")),document.body.appendChild(s),s.click(),document.body.removeChild(s)}},buildRows(o){const t=[];return o.forEach(e=>{t.push([n.td(e.id,{style:{textAlign:"left"}}),n.td(e.name,{style:{textAlign:"left"}}),this.buildRow(this.total+"("+e.name+")",e.total,e.totalPatientIds),n.td("")])}),t},buildRow(o,t,e){return t>0?n.tdLink(t,async()=>this.onDrillDown(o,e)):n.td(0)}},watch:{params:{immediate:!0,handler(){this.renderResults()}}}}),x={class:"my-table",style:{margin:"auto",width:"95%","margin-top":"3%","margin-bottom":"3%"}};function T(o,t,e,r,s,i){const d=_("report-table");return I(),$("div",x,[y(d,{columns:o.columns,rows:o.rows,config:{tableCssTheme:o.tableCssTheme}},null,8,["columns","rows","config"])])}const U=C(V,[["render",T]]);export{U as H,h as a};
