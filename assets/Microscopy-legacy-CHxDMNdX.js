System.register(["./index-legacy-zV5Jd_xD.js","./HisStandardForm-legacy-DUG6a-9J.js","./useEncounter-legacy-CjSSj0Ri.js","./commons-legacy-BHY0ulwn.js","./isEmpty-legacy-B03tgnL3.js","./encounter_guidelines-legacy-D0nfkYrS.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,a){"use strict";var t,l,i,d,o,u,n,_,s,p,c,r,T,E,S,v,O;return{setters:[e=>{t=e.d,l=e.r,i=e.bV,d=e.bX,o=e.al,u=e.e2,n=e.am,_=e.u,s=e.a,p=e.w,c=e.e,r=e.f,T=e.n,E=e.b},e=>{S=e.H},e=>{v=e.u},e=>{O=e.r},null,null,null],execute:function(){e("default",t({__name:"Microscopy",setup(e){const a=l([]),t=new i(-1,d.LAB_RESULTS),m=_(),{goToNextTask:A,patientDashboardUrl:C}=v(((e,l)=>{t.patientID=l,t.providerID=e;const i=e=>({id:`sample${e}PhysicalAppearance`,helpText:`Sample ${e} Physical Appearance:`,type:n.TT_SELECT,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_PHYSICAL_APPEARANCE`),value_coded:u(`${a.value}`),obs_datetime:t.date}),validation:e=>o.required(e),options:()=>[{value:"MUCO_PURULENT",label:"Muco-purulent"},{value:"BLOOD_STAINED",label:"Blood-stained"},{value:"SALIVA",label:"Saliva"},{value:"OTHER",label:"Other"}]}),d=e=>({id:`sample${e}Procedure`,helpText:`Sample ${e} Procedure:`,type:n.TT_SELECT,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_PROCEDURE`),value_coded:u(`${a.value}`),obs_datetime:t.date}),validation:e=>o.required(e),options:()=>[{value:"ZIEHL_NEELSEN",label:"Ziehl-Neelsen"},{value:"FLUORESCENCE",label:"Fluorescence"}]}),_=e=>({id:`sample${e}Result`,helpText:`Sample ${e} Result:`,type:n.TT_SELECT,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_RESULT`),value_coded:u(`${a.value}`),obs_datetime:t.date}),validation:e=>o.required(e),options:()=>[{value:"AFB_POSITIVE",label:"AFB Positive"},{value:"AFB_NEGATIVE",label:"AFB Negative"}]}),s=e=>({id:`sample${e}Grading`,helpText:`Sample ${e} Grading:`,type:n.TT_SELECT,validation:e=>o.required(e),condition:a=>"AFB_POSITIVE"===a[`sample${e}Result`].value,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_GRADING`),value_text:a.value,obs_datetime:t.date}),options:()=>[{value:"1+",label:"1+"},{value:"2+",label:"2+"},{value:"3+",label:"3+"},{value:"OTHER",label:"Other"}]}),p=e=>({id:`sample${e}OtherGrading`,helpText:`Sample ${e} Other Grading:`,type:n.TT_TEXT,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_GRADING`),value_text:a.value,obs_datetime:t.date}),validation:e=>o.required(e),condition:a=>"OTHER"===a[`sample${e}Grading`].value}),c=e=>({id:`sample${e}BaciliSeen`,type:n.TT_NUMBER,helpText:`Sample ${e} no. Of Bacilli Seen:`,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_NUMBER_OF_BACILI_SEEN`),value_numeric:a.value,obs_datetime:t.date}),validation:e=>o.required(e),condition:a=>"OTHER"===a[`sample${e}Grading`].value}),r=e=>({id:`sample${e}ResultDate`,helpText:`Sample ${e} Result Date:`,type:n.TT_FULL_DATE,computedValue:a=>({concept_id:u(`SAMPLE_${e.toUpperCase()}_MICROSCOPY_RESULT_DATE`),value_datetime:a.value,obs_datetime:t.date}),validation:e=>o.validateSeries([()=>o.required(e),()=>o.dateRangeOf(e,`${m.query.date}`,t.date)])});a.value=[i("One"),d("One"),_("One"),s("One"),p("One"),c("One"),r("One"),i("Two"),d("Two"),_("Two"),s("Two"),p("Two"),c("Two"),r("Two")]}));function R(e){const a=[];return"AFB_POSITIVE"===e.sampleOneResult.value||"AFB_POSITIVE"===e.sampleTwoResult.value?(a.push({concept_id:u("TB_TYPE"),value_coded:u("PULMONARY_TB"),obs_datetime:t.date}),a.push({concept_id:u("TB_STATUS"),value_coded:u("POSITIVE"),obs_datetime:t.date}),a.push({concept_id:u("TUBERCULOSIS_CLASS"),value_coded:u("All Other"),obs_datetime:t.date})):a.push({concept_id:u("TB_STATUS"),value_coded:u("NEGATIVE"),obs_datetime:t.date}),a.push({concept_id:u("BACTERIOLOGICALLY_DIAGNOSED"),value_coded:u("YES_ANSWER"),obs_datetime:t.date}),a.push({concept_id:u("PROCEDURE_TYPE"),value_coded:u("MICROSCOPY"),obs_datetime:t.date}),a}async function P(e,a){await t.createEncounter(),await t.saveObservationList([...R(e),...await O(a)]),A()}return(e,t)=>(E(),s(r(T),null,{default:p((()=>[c(S,{cancelDestinationPath:r(C),onFinishAction:P,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
