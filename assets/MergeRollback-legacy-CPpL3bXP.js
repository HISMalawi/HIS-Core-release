System.register(["./index-legacy-B837ziyX.js"],(function(e,t){"use strict";var a,l,n,r,o,s,i,d,u,c,m,h,_,f,b,g,p,y,v,k,x,I,T,w,C,N,H,M,$,D,A,B,F,P,R;return{setters:[e=>{a=e.S,l=e.d,n=e.aw,r=e.k,o=e.ah,s=e.a7,i=e.ag,d=e.a5,u=e.l,c=e.a4,m=e.m,h=e.I,_=e.n,f=e.ax,b=e.u,g=e.aq,p=e.r,y=e.ay,v=e.c,k=e.o,x=e.y,I=e.H,T=e.au,w=e.ak,C=e.ap,N=e.a,H=e.b,M=e.w,$=e.e,D=e.j,A=e.t,B=e.h,F=e.g,P=e.a9,R=e.aa}],execute:function(){var t=document.createElement("style");t.textContent=".his-card[data-v-f5608659]{margin:auto!important;padding:.6em}\n/*$vite$:1*/",document.head.appendChild(t);class G extends a{static getMergeHistory(e){return this.getJson("/rollback/merge_history",{identifier:e})}static rollback(e){return this.postJson("/rollback/rollback_patient",{patient_id:e,program_id:this.getProgramID()})}}const L=l({components:{IonText:f,IonPage:_,IonContent:h,IonToolbar:m,IonHeader:c,IonFooter:u,IonTitle:d,IonList:i,IonItem:s,IonLabel:o,IonButton:r,ReportTable:n},setup(){const e=b(),t=g(),a=p(-1),l=p([]),n=p([]),r=`${e.params.id}`.toUpperCase(),o=p("N/A"),s=p([{label:"Birthdate",value:"N/A"},{label:"Gender",value:"N/A"}]),i=[[y.thTxt("Merge type"),y.thTxt("Merge date"),y.thTxt("First Name"),y.thTxt("Last name"),y.thTxt("Birthdate"),y.thTxt("Gender")]],d=v((()=>n.value.length>0));return k((async()=>{if(r){try{n.value=await G.getMergeHistory(r)||[]}catch(e){x(`Merge history not found for ${r}`)}l.value=n.value.map((e=>(-1===a.value&&(a.value=e.secondary_id,o.value=`${e.secondary_first_name} ${e.secondary_surname}`,s.value=[{label:"Birthdate",value:I.toStandardHisDisplayFormat(e.secondary_birthdate)},{label:"Gender",value:e.secondary_gender}]),[y.td(e.merge_type),y.tdDate(e.merge_date),y.td(e.primary_first_name),y.td(e.primary_surname),y.tdDate(e.primary_birthdate),y.td(e.primary_gender)])))}else t.back()})),{cancel:function(){t.back()},holderName:o,isReversible:d,patientInfo:s,rollback:async function(){await T("Are you sure you want to merge transactions")&&(await G.rollback(a.value)?t.back():x("Failed to rollback"))},columns:i,rows:l,npid:r}}});e("default",w(L,[["render",function(e,t,a,l,n,r){const o=C("ion-text"),s=C("ion-title"),i=C("ion-toolbar"),d=C("ion-header"),u=C("ion-label"),c=C("ion-item"),m=C("ion-list"),h=C("report-table"),_=C("ion-content"),f=C("ion-button"),b=C("ion-footer"),g=C("ion-page");return H(),N(g,null,{default:M((()=>[$(d,null,{default:M((()=>[$(i,null,{default:M((()=>[$(s,{class:"his-lg-text"},{default:M((()=>[$(o,{color:"danger"},{default:M((()=>[D(A(e.npid),1)])),_:1}),t[0]||(t[0]=D(" Merge history ",-1))])),_:1})])),_:1})])),_:1}),$(_,null,{default:M((()=>[$(s,{class:"his-md-text his-card"},{default:M((()=>[...t[1]||(t[1]=[D("NPID Holder: ",-1)])])),_:1}),$(m,null,{default:M((()=>[$(c,{lines:"none",class:"his-md-text"},{default:M((()=>[$(u,null,{default:M((()=>[...t[2]||(t[2]=[D(" Person name ",-1)])])),_:1}),F("b",null,A(e.holderName),1)])),_:1}),(H(!0),B(P,null,R(e.patientInfo,((e,t)=>(H(),N(c,{lines:"none",class:"his-md-text",key:t},{default:M((()=>[$(u,null,{default:M((()=>[D(A(e.label)+": ",1)])),_:2},1024),F("b",null,A(e.value),1)])),_:2},1024)))),128))])),_:1}),$(s,{class:"his-md-text his-card"},{default:M((()=>[...t[3]||(t[3]=[D("Transactions:",-1)])])),_:1}),$(h,{config:{tableCssTheme:"art-report-theme"},columns:e.columns,rows:e.rows},null,8,["columns","rows"])])),_:1}),$(b,null,{default:M((()=>[$(i,{color:"dark"},{default:M((()=>[$(f,{onClick:e.cancel,color:"danger",size:"large",slot:"start"},{default:M((()=>[...t[4]||(t[4]=[D(" Cancel ",-1)])])),_:1},8,["onClick"]),$(f,{onClick:e.rollback,disabled:!e.isReversible,color:"success",size:"large",slot:"end"},{default:M((()=>[...t[5]||(t[5]=[D(" Reverse ",-1)])])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-f5608659"]]))}}}));
