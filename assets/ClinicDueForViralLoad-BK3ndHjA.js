import{d as n,I as l,cB as p,L as t,cE as d,b6 as m,S as c,_ as h,r,o as u,c as _,w as f,b as x}from"./index-BBbw6-oc.js";import{_ as T}from"./ReportMixin.vue_vue_type_script_lang-BwEqdtdY.js";import{R as w}from"./TableReportTemplate-D_OlOeCN.js";import"./BasicReportTemplate-DIfw5aau.js";import"./Export-DGgo6aCj.js";import"./Pagination-CACJEzfQ.js";import"./HisStandardForm-BhUAZgIK.js";import"./ReportErrors-DC1YgN-F.js";const D=n({mixins:[T],components:{ReportTemplate:w,IonPage:l},data:()=>({title:"Clinic Clients due for VL <small>(clients with appointments in specified period)</small>",rows:[],columns:[]}),async created(){const s=await p.filingNumbersEnabled();this.columns.push([t.thTxt(s?"Filing #":"ARV#"),t.thTxt("First name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Last name",{csvExportable:!1,pdfExportable:!0}),t.thTxt("Gender"),t.thTxt("Age"),t.thTxt("App."),t.thTxt("ART started"),t.thTxt("Months on ART"),t.thTxt("Milestone"),t.thTxt("Ordered"),t.thTxt("Result"),t.thTxt("Released")]),this.fields=this.getDateDurationFields(!1,!1,5,null)},methods:{async onPeriod(s,e){this.rows=[],this.report=new d,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.report.setOccupation(e.occupation),this.period=this.report.getDateIntervalPeriod();const o=await this.report.getClientsDueForVl();this.setRows(o)},async setRows(s){s.forEach(e=>{this.rows.push([t.tdLink(e.arv_number,()=>this.confirmPatient(e.patient_id)),t.td(e.given_name),t.td(e.family_name),t.td(this.formatGender(e.gender)),t.td(e.birthdate?m(c.getSessionDate()).diff(e.birthdate,"years"):"N/A"),t.tdDate(e.appointment_date),t.tdDate(e.start_date),t.td(e.months_on_art),t.tdDate(e.mile_stone),t.tdDate(e.last_result_order_date),t.td(e.last_result),t.tdDate(e.last_result_date)])})}}});function R(s,e,o,b,g,C){const a=r("report-template"),i=r("ion-page");return u(),_(i,null,{default:f(()=>[x(a,{title:s.title,period:s.period,rows:s.rows,fields:s.fields,columns:s.columns,showtitleOnly:!0,canExportPDf:!0,encryptPDF:!0,onReportConfiguration:s.onPeriod,"report-prefix":"Clinic"},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const S=h(D,[["render",R]]);export{S as default};
