import{_ as u}from"./EncounterMixin.vue_vue_type_script_lang-v2aYCq6R.js";import{d as c,I as p,b$ as h,ad as i,aj as m,ae as t,bY as v,aa as f,af as o,a as _,c as y,w as b,b as T}from"./index-CMZASHAR.js";import{A as r}from"./anc_current_pregnancy-C2a3KiMr.js";import"./encounter_guidelines-CJXpBOk4.js";import"./GuidelineEngine-D6V1_Znr.js";import"./HisStandardForm-BCjM4-bc.js";const g=c({components:{IonPage:p},mixins:[u],data:()=>({service:{},gestationWeeks:0,delieveryDate:"",lnmp:""}),watch:{ready:{async handler(e){e&&(this.service=new r(this.patientID,this.providerID),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,a){try{await this.service.enrollPatient()}catch(n){if(n instanceof h)console.warn("".concat(n));else throw n}const s=await this.resolveObs(a);await this.service.createEncounter(),await this.service.saveObservationList(s),this.nextTask()},buildLnmpObs(e=!1){return/Unknown/i.test(this.lnmp)?null:[e?this.service.buildValueDateEstimated("Last menstrual period",this.lnmp):this.service.buildValueDate("Last menstrual period",this.lnmp),this.service.buildValueNumber("Week of First Visit",this.gestationWeeks)]},getFields(){return[{id:"lnmp",helpText:"Last Normal Menstrual Period",type:i.TT_FULL_DATE,config:{allowUnknown:!0,addTodayBtn:!1},defaultValue:()=>this.service.date,computedValue:()=>this.buildLnmpObs(),beforeNext:async e=>(this.lnmp=e.value,this.gestationWeeks=this.service.calculateWeekOfFirstVisit(this.lnmp),this.gestationWeeks<=0||this.gestationWeeks>42?m("Gestation weeks out of range of 0-42. Are you sure you want to continue?"):!0),validation:e=>this.validateSeries([()=>t.required(e),()=>{if(e.value){const a=new Date(e.value),s=new Date(this.service.date);if(a>s)return["Last menstrual period cannot be in the future"]}return null}])},{id:"estimate_lmp",helpText:"Gestation (months)",type:i.TT_NUMBER,condition:e=>e.lnmp.value==="Unknown",computedValue:()=>this.buildLnmpObs(!0),validation:e=>this.validateSeries([()=>t.required(e),()=>t.rangeOf(e,1,10)]),beforeNext:e=>(this.lnmp=this.service.calculateGestationDateFromPeriod(e.value),this.gestationWeeks=this.service.calculateWeekOfFirstVisit(this.lnmp),!0)},{id:"expected_delivary_date",helpText:"Expected Date Of Delivery",type:i.TT_FULL_DATE,config:{addTodayBtn:()=>this.gestationWeeks>=30},dynamicHelpText:()=>"Expected Date Of Delivery (Gestation Weeks: ".concat(this.gestationWeeks,")"),defaultValue:()=>this.service.estimateDelieveryDate(this.lnmp),computedValue:e=>this.service.buildValueDate("Estimated date of delivery",e.value),validation:e=>t.required(e)},{id:"planned_delivery_place",helpText:"Planned delivery place",type:i.TT_SELECT,computedValue:e=>this.service.buildValueText("Planned Delivery Place",e.label),validation:e=>t.required(e),options:(e,a="")=>v(a),config:{footerBtns:[{name:"Here",slot:"end",onClickComponentEvents:{setValue:e=>e.btnOutput},onClick:()=>r.getLocationName()}],showKeyboard:!0,isFilterDataViaApi:!0}},{id:"bed_net_available_for_use",helpText:"Mosquito net in good condition available for own use",type:i.TT_SELECT,condition:()=>!1,computedValue:e=>this.service.buildValueCoded("Do you use bed nets",e.value),validation:e=>t.required(e),options:()=>this.yesNoOptions()},{id:"bed_net_given",helpText:"Bed net given today",type:i.TT_SELECT,computedValue:e=>this.service.buildValueCoded("Mosquito net started",e.value),validation:e=>t.required(e),options:()=>this.yesNoOptions()},{id:"previous_td_given",helpText:"Previous TD given before this pregnancy",type:i.TT_NUMBER,computedValue:e=>this.service.buildValueNumber("TD Booster",e.value),validation:e=>t.required(e)}]}}});function D(e,a,s,n,V,k){const l=o("his-standard-form"),d=o("ion-page");return _(),y(d,null,{default:b(()=>[T(l,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])]),_:1})}const O=f(g,[["render",D]]);export{O as default};
