import{d as p,I as u,ad as _,ae as T,aV as l,ao as d,aN as f,dM as x,as as t,dN as i,H as w,aa as I,af as m,a as D,c as v,w as N,b as S}from"./index-CMZASHAR.js";import{_ as g}from"./ReportMixin.vue_vue_type_script_lang-CqLvuQmv.js";import{R as E}from"./TableReportTemplate-CRKA8rFt.js";import"./BasicReportTemplate-CbJ_oMga.js";import"./Export-CpyT9Gk1.js";import"./index-_zuoFVCp.js";import"./Pagination-D_B_LriE.js";import"./HisStandardForm-BCjM4-bc.js";import"./ReportErrors-JbEvJfLt.js";const C=p({mixins:[g],components:{ReportTemplate:E,IonPage:u},data:()=>({title:"Data cleaning report",rows:[],columns:[],defaultIndicator:{}}),created(){this.fields=[{id:"indicator",helpText:"Select indicator",type:_.TT_SELECT,requireNext:!1,condition:()=>!this.defaultIndicator,defaultOutput:()=>this.defaultIndicator,validation:e=>T.required(e),options:()=>this.getIndicatorOptions()},...l({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e}),...l({id:"end_date",helpText:"End",required:!0,minDate:(e,a)=>a.start_date,maxDate:()=>d.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e})],this.defaultIndicator=f.find(this.getIndicatorOptions(),{value:this.$route.query.cleaning_tool})||null},methods:{async onPeriod(e,a){const s=o=>w.toStandardHisDisplayFormat(o);this.rows=[],this.title=e.indicator.label;const n=e.indicator;this.columns=n.other.columns,this.report=new x,this.report.setStartDate(a.start_date),this.report.setEndDate(a.end_date),this.period="".concat(s(a.start_date)," - ").concat(s(a.end_date));const r=await this.report.getDataToolReport(n.value);r&&(this.rows=await Promise.all(r.map(o=>n.other.formatRow(o))))},showPatientBtn(e){return t.tdBtn("View",()=>this.$router.push("/patient/dashboard/"+e))},getIndicatorOptions(){return[{label:"Males with ANC Encounters",value:i.MALES_WITH_ANC_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Total Encounters"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Encounters after death",value:i.ENCOUNTERS_AFTER_DEATH,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Date of death"),t.thTxt("Recent encounter date"),t.thTxt("Count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.tdDate(e.patient_died_date),t.tdDate(e.minimum_encounter_datetime),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Incomplete visits",value:i.INCOMPLETE_VISITS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Name"),t.thTxt("Visit date"),t.thTxt("Incomplete count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.n_id),t.td(e.name),t.td(e.visit_date),t.td(e.visit_no),this.showPatientBtn(e.patient_id)]}},{label:"Duplicate encounters",value:i.DUPLICATE_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Name"),t.thTxt("Total"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.name),t.td(e.total),this.showPatientBtn(e.patient_id)]}},{label:"Missing HIV Status",value:i.MISSING_HIV_STATUS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}},{label:"Missing Last Menstrual Period (LMP)",value:i.MISSING_LMP,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}}]}}});function R(e,a,s,n,r,o){const h=m("report-template"),c=m("ion-page");return D(),v(c,null,{default:N(()=>[S(h,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,showFilters:!0,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const $=I(C,[["render",R]]);export{$ as default};
