import{d as w,r as m,o as A,a as D,c as C,w as O,b as N,u as T,D as R,I as M,i as S,aN as y}from"./index-CMZASHAR.js";import{v as x}from"./TableView-DhTjQT8r.js";import{C as B}from"./clinic_report_service-Clk-6w4F.js";import{a as j,w as z}from"./v2utils-DPaBC-nQ.js";import"./Export-CpyT9Gk1.js";import"./index-_zuoFVCp.js";const G=w({__name:"ClinicTpTOutcomes",setup(H){const P=S("reports.png"),o=m([]),u=m(""),i=new B,t=n=>({...n,toValue:e=>e.length,tdClick:e=>{j({title:"".concat(e.data.age_group," ").concat(e.column.label),subtitle:u.value,patientIdentifiers:e.refData.map(s=>s.patient_id)})}}),v=[[{label:"Age group",ref:"age_group"},{label:"TPT Type",ref:"tpt_type"},t({label:"Started TPT (New on ART)",ref:"started_tpt_new"}),t({label:"Started TPT (Previous on ART)",ref:"started_tpt_prev"}),t({label:"Completed TPT (New on ART)",ref:"completed_tpt_new"}),t({label:"Completed TPT (Previous on ART)",ref:"completed_tpt_prev"}),t({label:"Not completed TPT",ref:"not_completed_tpt"}),t({label:"Died",ref:"died"}),t({label:"Defaulted",ref:"defaulted"}),t({label:"Stopped ART",ref:"stopped"}),t({label:"TO",ref:"transfer_out"}),t({label:"Confirmed TB ",ref:"confirmed_tb"}),t({label:"Pregnant",ref:"pregnant"}),t({label:"Breastfeeding",ref:"breast_feeding"}),t({label:"Skin rash",ref:"skin_rash"}),t({label:"Peripheral neuropathy",ref:"peripheral_neuropathy"}),t({label:"Yellow eyes",ref:"yellow_eyes"}),t({label:"Nausea",ref:"nausea"}),t({label:"Dizziness",ref:"dizziness"})]],f=()=>z(async()=>{o.value=[];const n=(await i.getTtpOutcomes()).reduce((a,r)=>({...a,[r.tpt_type]:[...a[r.tpt_type],r]}),{"3HP":[],"6H":[]});o.value=[...n["3HP"],...n["6H"]];const e=o.value.reduce((a,r)=>(Object.keys(r).forEach(l=>{if(Array.isArray(r[l])){const _=c=>{var g,b;return{...a[c],[l]:[...(b=(g=a==null?void 0:a[c])==null?void 0:g[l])!=null?b:[],...r[l].filter(h=>h.gender===c)]}};a={M:_("M"),F:_("F")}}}),a),{M:{},F:{}}),s=y.uniq(e.F.pregnant),p=y.uniq(e.F.breast_feeding),F=s.concat(p);o.value=[...o.value,{age_group:"All",tpt_type:"Male",...e.M},{age_group:"All",tpt_type:"FP",...Object.keys(e.F).reduce((a,r)=>({...a,[r]:e.F[r].filter(l=>s.includes(l))}),{})},{age_group:"All",tpt_type:"FNP",...Object.keys(e.F).reduce((a,r)=>({...a,[r]:e.F[r].filter(l=>!F.includes(l))}),{})},{age_group:"All",tpt_type:"FBF",...Object.keys(e.F).reduce((a,r)=>({...a,[r]:e.F[r].filter(l=>p.includes(l))}),{})}]}),d=()=>R({onFinish:(n,e,s,p)=>{p&&i.setOccupation(p),u.value="".concat(s),i.startDate=n,i.endDate=e,f()}});return A(()=>!o.value.length&&d()),(n,e)=>(D(),C(T(M),null,{default:O(()=>[N(x,{"icon-url":T(P),subtitle:u.value,title:"TPT Outcome","report-prefix":"Clinic",columns:v,onConfigure:d,columnData:o.value,rowsPerPage:100,onRefresh:f},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{G as default};
