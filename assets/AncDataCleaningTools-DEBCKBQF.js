import{d as u,a5 as p,a9 as _,aa as T,aO as l,aj as d,aM as f,dH as x,ao as t,dI as i,ag as w,a6 as I,ab as m,u as D,v,w as g,x as S}from"./index-BoUMTIjB.js";import{_ as N}from"./ReportMixin.vue_vue_type_script_lang-CU0Nt6VM.js";import{R as E}from"./TableReportTemplate-BLHGBhIO.js";import"./BasicReportTemplate-CICg2e7L.js";import"./Export-UGDCL4eA.js";import"./index-Wy4X0smJ.js";import"./Pagination-_uFX5UdO.js";import"./HisStandardForm-MXkZ0BQm.js";import"./ReportErrors-Dh0ArIqP.js";const C=u({mixins:[N],components:{ReportTemplate:E,IonPage:p},data:()=>({title:"Data cleaning report",rows:[],columns:[],defaultIndicator:{}}),created(){this.fields=[{id:"indicator",helpText:"Select indicator",type:_.TT_SELECT,requireNext:!1,condition:()=>!this.defaultIndicator,defaultOutput:()=>this.defaultIndicator,validation:e=>T.required(e),options:()=>this.getIndicatorOptions()},...l({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e}),...l({id:"end_date",helpText:"End",required:!0,minDate:(e,a)=>a.start_date,maxDate:()=>d.getSessionDate(),estimation:{allowUnknown:!1},computeValue:e=>e})],this.defaultIndicator=f.find(this.getIndicatorOptions(),{value:this.$route.query.cleaning_tool})||null},methods:{async onPeriod(e,a){const s=o=>w.toStandardHisDisplayFormat(o);this.rows=[],this.title=e.indicator.label;const n=e.indicator;this.columns=n.other.columns,this.report=new x,this.report.setStartDate(a.start_date),this.report.setEndDate(a.end_date),this.period="".concat(s(a.start_date)," - ").concat(s(a.end_date));const r=await this.report.getDataToolReport(n.value);r&&(this.rows=await Promise.all(r.map(o=>n.other.formatRow(o))))},showPatientBtn(e){return t.tdBtn("View",()=>this.$router.push("/patient/dashboard/"+e))},getIndicatorOptions(){return[{label:"Males with ANC Encounters",value:i.MALES_WITH_ANC_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Total Encounters"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Encounters after death",value:i.ENCOUNTERS_AFTER_DEATH,other:{columns:[[t.thTxt("National ID"),t.thTxt("First name"),t.thTxt("Last name"),t.thTxt("Date of death"),t.thTxt("Recent encounter date"),t.thTxt("Count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.tdDate(e.patient_died_date),t.tdDate(e.minimum_encounter_datetime),t.td(e.total_encounters),this.showPatientBtn(e.patient_id)]}},{label:"Incomplete visits",value:i.INCOMPLETE_VISITS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Name"),t.thTxt("Visit date"),t.thTxt("Incomplete count"),t.thTxt("Action")]],formatRow:e=>[t.td(e.n_id),t.td(e.name),t.td(e.visit_date),t.td(e.visit_no),this.showPatientBtn(e.patient_id)]}},{label:"Duplicate encounters",value:i.DUPLICATE_ENCOUNTERS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Name"),t.thTxt("Total"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),t.td(e.name),t.td(e.total),this.showPatientBtn(e.patient_id)]}},{label:"Missing HIV Status",value:i.MISSING_HIV_STATUS,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}},{label:"Missing Last Menstrual Period (LMP)",value:i.MISSING_LMP,other:{columns:[[t.thTxt("National ID"),t.thTxt("Given name"),t.thTxt("Family name"),t.thTxt("Action")]],formatRow:e=>[t.td(e.identifier),t.td(e.given_name),t.td(e.family_name),this.showPatientBtn(e.patient_id)]}}]}}});function R(e,a,s,n,r,o){const h=m("report-template"),c=m("ion-page");return D(),v(c,null,{default:g(()=>[S(h,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,showFilters:!0,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const V=I(C,[["render",R]]);export{V as default};
