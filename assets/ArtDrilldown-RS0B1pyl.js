import{d as m,I as b,K as l,J as h,a8 as g,ab as v,c9 as _,bA as P,aW as D,_ as w,r as f,o as A,c as y,w as E,b as $}from"./index-iM2cGz0p.js";import{v as k}from"./TableView-9ZGLqfGO.js";import{P as F}from"./person_service-W_duOiY7.js";const I=25,C=m({props:{title:{type:String,default:"Drilldown"},patientIdentifiers:{type:Object},onFinish:{type:Function}},components:{IonPage:b,v2Datatable:k},setup(e){const o=l(!0),a=l("-"),n=l([]),c=h(),u=[[{label:"ARV Number",ref:"identifier"},{label:"Gender",ref:"gender"},{label:"Birthdate",ref:"birthdate"},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:t})=>c.push({path:"/patient/dashboard/".concat(t.person_id)}),value:()=>"View client"}]];function r(){o.value=!1,typeof e.onFinish=="function"&&e.onFinish()}return g(()=>e.patientIdentifiers,async t=>{if(n.value=[],a.value="Total: 0",!(t&&t.length))return;const p=v.chunk(t,1e3);for(const d of p){try{if(!o.value)break;const s=(await F.getPersons(d)).map(i=>({...i,birthdate:_(i.birthdate),gender:P(i.gender)}));n.value=[...n.value,...s]}catch(s){console.error(s)}a.value="Total: ".concat(n.value.length," of ").concat((t||[]).length),await D(100)}},{immediate:!0}),{columns:u,subtitle:a,reportData:n,canLoadData:o,ITEMS_PER_PAGE:I,runFinishAction:r}}});function G(e,o,a,n,c,u){const r=f("v2Datatable"),t=f("ion-page");return A(),y(t,null,{default:E(()=>[$(r,{title:e.title,subtitle:e.subtitle,columnData:e.reportData,columns:e.columns,"on-finish":e.runFinishAction,rowsPerPage:e.ITEMS_PER_PAGE},null,8,["title","subtitle","columnData","columns","on-finish","rowsPerPage"])]),_:1})}const B=w(C,[["render",G]]);export{B as A};
