const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MinimalToolbar-DGwvuL6p.js","assets/index-CMZASHAR.js","assets/index-DRfyWMnt.css"])))=>i.map(i=>d[i]);
import{d as O,b1 as rt,a3 as j,a4 as F,a9 as U,Y as z,a8 as W,X as G,Z as dt,aN as $,ab as vt,i as ut,au as K,W as Y,aj as Ct,aa as S,af as s,a as l,E as f,b as n,w as i,C as p,a2 as g,J as T,G as A,c as h,b2 as ct,a5 as x,_ as tt,$ as et,am as Z,K as m,M as y,b3 as yt,a6 as kt,b4 as pt,ay as nt,b5 as It,b6 as mt,b7 as Q,r as ht,o as Dt,b8 as $t,b9 as wt,ba as Et,I as Tt,bb as Pt,aL as Lt,bc as At,bd as Vt,be as Ot,bf as St,bg as Nt,bh as Bt,bi as Mt,bj as zt,aT as Ht,bk as Rt,bl as qt,bm as jt,bn as B,bo as H,bp as J,bq as R,aw as M,br as Ft,H as q,bs as X,al as Ut,bt as Wt,ak as Gt,bu as Kt,bv as Jt,bw as Xt,R as Yt,bx as Zt,by as Qt,bz as xt,bA as te,bB as ee,O as at}from"./index-CMZASHAR.js";import{D as ne}from"./drug_order_service-DwQHOfYk.js";import{T as ie}from"./TaskCard-Dkrn79h4.js";import{p as oe}from"./VoidReason-H99Hq1yQ.js";import se from"./DashboardAppIcon-BJ1sti-L.js";const ae=O({components:{IonGrid:rt,IonRow:j,IonCol:F,TaskCard:ie,IonFooter:U,IonToolbar:z,IonButton:W,IonHeader:G,IonTitle:dt},props:{title:{type:String,default:"Select Activity"},items:{type:Object,required:!0},taskParams:{type:Object,required:!1}},data:()=>({filteredItems:[]}),watch:{items:{async handler(t){if(!(!t||$.isEmpty(t)))for(const e in t){const o=t[e];o.globalProperty&&!await vt.isProp(o.globalProperty)||o.condition&&!await o.condition(this.taskParams)||this.filteredItems.push(o)}},deep:!0,immediate:!0}},methods:{img(t){return ut(t)},isDisabled(t){return typeof t=="function"?t(this.taskParams):!1},closeModal(){K.dismiss({})},async doTask(t){var e;if(this.isDisabled(t.disabled))return Y("This task is disabled");typeof t.taskCompleted=="boolean"&&(t!=null&&t.taskCompleted)&&!await Ct("This task was already completed. Do you want to continue?")||(t.action?t.action(this.taskParams,this.$router):t.url?this.$router.push({path:t.url}):this.$router.push({name:t.id,params:{patient_id:(e=this.taskParams)==null?void 0:e.patient.patient_id}}),this.closeModal())}}});function le(t,e,o,a,k,w){const b=s("ion-title"),r=s("ion-toolbar"),d=s("ion-header"),C=s("task-card"),E=s("ion-col"),v=s("ion-row"),u=s("ion-grid"),I=s("ion-button"),D=s("ion-footer");return l(),f(T,null,[n(d,null,{default:i(()=>[n(r,null,{default:i(()=>[n(b,null,{default:i(()=>[p(g(t.title),1)]),_:1})]),_:1})]),_:1}),n(u,{class:"selector"},{default:i(()=>[n(v,null,{default:i(()=>[(l(!0),f(T,null,A(t.filteredItems,(_,P)=>(l(),h(E,{"size-lg":"4","size-sm":"6",key:P},{default:i(()=>[n(C,{onClick:L=>t.doTask(_),title:_.name.toUpperCase(),description:_.description,taskCompleted:_.taskCompleted,taskDisabled:t.isDisabled(_.disabled),icon:t.img(_.icon)},null,8,["onClick","title","description","taskCompleted","taskDisabled","icon"])]),_:2},1024))),128))]),_:1})]),_:1}),n(D,null,{default:i(()=>[n(r,null,{default:i(()=>[n(I,{class:"close-btn",color:"danger",size:"large",onClick:t.closeModal,slot:"end"},{default:i(()=>e[0]||(e[0]=[p(" Close ")])),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const lt=S(ae,[["render",le],["__scopeId","data-v-701ae879"]]),re=O({components:{HisBasicTable:ct,IonButton:W,IonToolbar:z,IonList:x,IonFooter:U,IonContent:tt,IonRow:j,IonCol:F,IonTitle:dt,IonHeader:G,IonItem:et},data:()=>({active:{id:-1,name:"",provider:"",rows:[],columns:[]},encounters:[]}),computed:{canVoid(){return!$.isEmpty(this.active)}},watch:{items:{handler(t){$.isEmpty(t)||(this.encounters=t,this.showDetails(this.encounters[0]))},immediate:!0,deep:!0}},props:{title:{type:String,required:!0},items:{type:Object,required:!0}},methods:{closeModal(){K.dismiss({})},removeEncounter(t){this.encounters=this.encounters.filter(e=>e.other.id!=t)},voidActiveItem(){oe(async t=>{try{await this.active.onVoid(t),this.removeEncounter(this.active.id),this.active={},$.isEmpty(this.encounters)||this.showDetails(this.encounters[0])}catch(e){Z("".concat(e))}},"void-modal custom-modal-backdrop")},async showDetails(t){var e;this.active.id=t.other.id,this.active.name=t.label,this.active.columns=t.other.columns,this.active.onVoid=t.other.onVoid,this.active.rows=await t.other.getRows(),this.active.provider=await t.other.provider,this.active.isBDE=(e=t.other.isBDE)!=null?e:!1}}}),de={class:"his-md-text",style:{display:"flex","justify-content":"space-between",width:"100%"}},ue={class:"ion-margin-start"},ce={class:"ion-margin-end"},pe={class:"tb"};function me(t,e,o,a,k,w){const b=s("ion-text"),r=s("ion-toolbar"),d=s("ion-header"),C=s("ion-item"),E=s("ion-list"),v=s("ion-col"),u=s("his-basic-table"),I=s("ion-row"),D=s("ion-content"),_=s("ion-button"),P=s("ion-footer");return l(),f(T,null,[n(d,null,{default:i(()=>[n(r,null,{default:i(()=>[m("div",de,[m("span",ue,g(t.title),1),t.active.isBDE?(l(),h(b,{key:0,color:"danger"},{default:i(()=>e[0]||(e[0]=[p("BDE Record")])),_:1})):y("",!0),m("span",ce,"Provider: "+g(t.active.provider),1)])]),_:1})]),_:1}),n(D,null,{default:i(()=>[n(I,null,{default:i(()=>[n(v,{size:"4"},{default:i(()=>[n(E,null,{default:i(()=>[(l(!0),f(T,null,A(t.encounters,(L,N)=>(l(),h(C,{class:"his-sm-text",key:N,color:L.other.id===t.active.id?"primary":"",detail:!0,onClick:()=>t.showDetails(L)},{default:i(()=>[p(g(L.label),1)]),_:2},1032,["color","onClick"]))),128))]),_:1})]),_:1}),n(v,{size:"8"},{default:i(()=>[m("div",pe,[n(u,{columns:t.active.columns,rows:t.active.rows},null,8,["columns","rows"])])]),_:1})]),_:1})]),_:1}),n(P,null,{default:i(()=>[n(r,null,{default:i(()=>[n(_,{color:"danger",onClick:t.voidActiveItem,disabled:!t.canVoid,size:"large"},{default:i(()=>e[1]||(e[1]=[p(" Void encounter")])),_:1},8,["onClick","disabled"]),n(_,{onClick:t.closeModal,size:"large",slot:"end"},{default:i(()=>e[2]||(e[2]=[p(" Close ")])),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const he=S(re,[["render",me],["__scopeId","data-v-1d3f0719"]]),fe=O({components:{HisBasicTable:ct,IonHeader:G,IonToolbar:z,IonContent:tt,IonFooter:U,IonButton:W},props:{title:{type:String,required:!0},columns:{type:Array,required:!0},rows:{type:Array,default:()=>[]}},methods:{async closeModal(){await K.dismiss({})}}});function ge(t,e,o,a,k,w){const b=s("ion-title"),r=s("ion-toolbar"),d=s("ion-header"),C=s("his-basic-table"),E=s("ion-content"),v=s("ion-button"),u=s("ion-footer");return l(),f(T,null,[n(d,null,{default:i(()=>[n(r,null,{default:i(()=>[n(b,{class:"his-md-text"},{default:i(()=>[p(g(t.title),1)]),_:1})]),_:1})]),_:1}),n(E,null,{default:i(()=>[n(C,{columns:t.columns,rows:t.rows},null,8,["columns","rows"])]),_:1}),n(u,null,{default:i(()=>[n(r,null,{default:i(()=>[n(v,{size:"large",onClick:t.closeModal,slot:"end"},{default:i(()=>e[0]||(e[0]=[p(" Close ")])),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const _e=S(fe,[["render",ge]]),be=O({components:{TextSkeleton:yt,IonLabel:kt,IonList:x,IonItem:et,IonChip:pt,IonIcon:nt,IonBadge:It},data:()=>({time:mt}),props:{isEnabled:{type:Boolean,default:()=>!0},counter:{type:Number,required:!1},isLoading:{type:Boolean},icon:{type:String},title:{type:String,required:!0},items:{type:Object},titleColor:{type:String,required:!1,default:()=>"#337ab7"}}});function ve(t,e,o,a,k,w){const b=s("ion-badge"),r=s("ion-label"),d=s("ion-item"),C=s("text-skeleton"),E=s("ion-icon"),v=s("ion-chip"),u=s("ion-list");return l(),f("div",{class:Q(["card",{inactive:!t.isEnabled,clickable:t.isEnabled}])},[n(d,{color:t.titleColor,lines:"none",class:"his-md-text title-card"},{default:i(()=>[n(b,{slot:"start",class:"his-sm-text",color:"light"},{default:i(()=>[m("b",null,g(t.counter),1)]),_:1}),n(r,null,{default:i(()=>[p(g(t.title),1)]),_:1})]),_:1},8,["color"]),t.isLoading?(l(),h(C,{key:0,itemCount:5})):y("",!0),t.isLoading?y("",!0):(l(),h(u,{key:1},{default:i(()=>[(l(!0),f(T,null,A(t.items,(I,D)=>(l(),h(d,{key:D},{default:i(()=>{var _,P;return[n(r,{class:Q((_=I==null?void 0:I.other)!=null&&_.wrapTxt?"ion-text-wrap":""),innerHTML:I.label},null,8,["class","innerHTML"]),I.value?(l(),h(v,{key:0,class:"his-sm-text ion-no-margin",slot:"end"},{default:i(()=>[n(E,{icon:t.icon},null,8,["icon"]),n(r,null,{default:i(()=>[p(g(I.value),1)]),_:2},1024)]),_:2},1024)):y("",!0),(P=I.other)!=null&&P.isBDE?(l(),h(v,{key:1,class:"his-sm-text ion-no-margin",slot:"end",color:"danger",style:{"margin-left":".2rem"}},{default:i(()=>[n(r,null,{default:i(()=>e[0]||(e[0]=[p("BDE")])),_:1})]),_:1})):y("",!0)]}),_:2},1024))),128))]),_:1}))],2)}const Ce=S(be,[["render",ve],["__scopeId","data-v-5f54c099"]]),ye=O({components:{IonList:x,IonItem:et},props:{title:{type:String,default:()=>"Visits"},items:{type:Object,required:!0}},data:()=>({active:{},activeListItems:[],paginatedListItems:[],index:-1,perPage:6,btnSize:45}),computed:{listAlignmentClass(){return this.activeListItems&&this.activeListItems.length===this.perPage?"vertically-align":""},upbuttonImg(){return"/assets/images/drop-up-arrow.svg"},downbuttonImg(){return"/assets/images/drop-down-arrow.svg"},showNextButton(){return this.index+1<this.paginatedListItems.length},showPrevButton(){return this.index>=1}},watch:{items:{handler(t){if(!$.isEmpty(t)){this.index=0,this.paginatedListItems=$.chunk(t,this.perPage),this.activeListItems=this.paginatedListItems[0],this.active=this.activeListItems[0];for(const e in this.paginatedListItems){const o=$.findIndex(this.paginatedListItems[e],a=>a.other.isActive===!0,0);if(o!=-1){this.index=parseInt(e),this.activeListItems=this.paginatedListItems[e],this.active=this.activeListItems[o];break}}}},deep:!0,immediate:!0},index:{handler(t){this.activeListItems=this.paginatedListItems[t]},immediate:!0},active(t){this.$emit("onselect",t)}},methods:{onselect(t){this.active=t},isActive(t){return t.label===this.active.label},goNext(){const t=this.index+1;t<=this.paginatedListItems.length&&(this.index=t)},goPrev(){this.paginatedListItems.length>=1&&(this.index-=1)}}}),ke={class:"card his-card"},Ie={class:"his-md-text header-section"},De=["disabled"],$e=["src","width"],we={class:"bottom-section"},Ee=["disabled"],Te=["src","width"];function Pe(t,e,o,a,k,w){const b=s("ion-item"),r=s("ion-list");return l(),f("div",ke,[m("div",Ie,g(t.title),1),m("button",{class:"nav-btn nav-btn-top clickable",disabled:!t.showPrevButton,onClick:e[0]||(e[0]=(...d)=>t.goPrev&&t.goPrev(...d))},[m("img",{src:t.upbuttonImg,width:t.btnSize},null,8,$e)],8,De),m("div",{class:Q(t.listAlignmentClass)},[n(r,null,{default:i(()=>[(l(!0),f(T,null,A(t.activeListItems,(d,C)=>(l(),h(b,{class:"his-md-text",key:C,onClick:E=>t.onselect(d),detail:!0,color:t.isActive(d)?"primary":""},{default:i(()=>[p(g(d.label),1)]),_:2},1032,["onClick","color"]))),128))]),_:1})],2),m("div",we,[m("button",{class:"nav-btn nav-btn-bottom clickable",disabled:!t.showNextButton,onClick:e[1]||(e[1]=(...d)=>t.goNext&&t.goNext(...d))},[m("img",{src:t.downbuttonImg,width:t.btnSize},null,8,Te)],8,Ee)])])}const Le=S(ye,[["render",Pe],["__scopeId","data-v-751691ca"]]);function Ae(){const t=ht({width:window.innerWidth,height:window.innerHeight});function e(o){t.value={height:o.currentTarget.innerHeight,width:o.currentTarget.innerWidth}}return Dt(()=>{addEventListener("resize",e)}),$t(()=>{removeEventListener("resize",e)}),{resolution:t}}const Ve=O({name:"HisResultCard",components:{IonIcon:nt},props:{icon:{required:!1},items:{type:Object,required:!0}},methods:{hasIcon(t){return"other"in t&&"icon"in t.other}}}),Oe={class:"tool-bar-medium-card"};function Se(t,e,o,a,k,w){const b=s("ion-icon");return l(),f("div",Oe,[(l(!0),f(T,null,A(t.items,(r,d)=>(l(),f("div",{key:d},[t.hasIcon(r)?(l(),h(b,{key:0,icon:r.other.icon},null,8,["icon"])):y("",!0),p(" "+g(r.label)+": ",1),m("b",null,g(r.value),1)]))),128))])}const Ne=S(Ve,[["render",Se],["__scopeId","data-v-f304e49e"]]),Be=O({name:"PatientToolbar",components:{IonHeader:G,IonToolbar:z,IonCol:F,IonRow:j,InfoCard:Ne,IconCard:se},props:{app:{type:Object},appVersion:{type:String},patientCardInfo:{type:Array,required:!0},programCardInfo:{type:Array,required:!0},appIcon:{type:String,required:!0}},computed:{logo(){return ut(this.appIcon)}}});function Me(t,e,o,a,k,w){const b=s("info-card"),r=s("ion-col"),d=s("icon-card"),C=s("ion-row"),E=s("ion-toolbar"),v=s("ion-header");return l(),h(v,{translucent:!0},{default:i(()=>[n(E,null,{default:i(()=>[n(C,null,{default:i(()=>[n(r,{size:"5"},{default:i(()=>[n(b,{items:t.patientCardInfo},null,8,["items"])]),_:1}),n(r,{size:"5"},{default:i(()=>[n(b,{items:t.programCardInfo},null,8,["items"])]),_:1}),n(r,{size:"2"},{default:i(()=>[n(d,{app:t.app,version:t.appVersion,icon:t.logo},null,8,["app","version","icon"])]),_:1})]),_:1})]),_:1})]),_:1})}const ze=S(Be,[["render",Me]]),He=O({components:{IonSegment:wt,IonSegmentButton:Et,IonChip:pt,IonPage:Tt,IonIcon:nt,IonFooter:U,IonContent:tt,IonButton:W,IonToolbar:z,IonGrid:rt,IonRow:j,IonCol:F,FullToolbar:ze,PrimaryCard:Ce,VisitDatesCard:Le,MinimalToolbar:Pt(()=>ee(()=>import("./MinimalToolbar-DGwvuL6p.js"),__vite__mapDeps([0,1,2])))},setup(){const t=ht("lg"),{resolution:e}=Ae();return Lt(()=>e.value,o=>{o&&o.width<=900?t.value="sm":t.value="lg"},{immediate:!0,deep:!0}),{time:mt,person:At,calendar:Vt,medical:Ot,clipboard:St,apps:Nt,folder:Bt,logOut:Mt,clipboardOutline:zt,appsOutline:Ht,folderOutline:Rt,logOutOutline:qt,alertCircle:jt,screenBreakPoint:t}},data:()=>({activeTab:1,app:{},dashboardComponent:{},isBDE:!1,currentDate:"",sessionDate:"",nextTask:{},programId:0,patientId:0,patient:{},patientProgram:{},patientCardInfo:[],programCardInfo:[],visitDates:[],activeVisitDate:"",patientCards:[],appVersion:B.getFullVersion(),sessionEncounterMap:{},savedEncounters:[]}),computed:{patientIsset(){return!$.isEmpty(this.patient)},patientName(){return $.isEmpty(this.patient)?"N/A":this.patient.getFullName()},appHasCustomContent(){return!$.isEmpty(this.app.customPatientDashboardContentComponent)},customDashboardContent(){return this.app.customPatientDashboardContentComponent},visitDatesTitle(){return"".concat(this.visitDates.length," Visits")}},watch:{activeVisitDate(t){this.appHasCustomContent||this.updateCardVisitData(t)}},created(){this.app=H.getActiveApp(),this.patientCards=[{items:[],cache:{},label:"Activities",color:"primary",isLoading:!1,icon:J,isEnabled:this.isCardEnabled("activitiesEnabled"),onVisitDate:(t,e)=>{t.isLoading=!0,R.getEncounters(this.patientId,{date:e}).then(o=>{t.items=this.getActivitiesCardInfo(o),t.cache[e]=t.items,t.isLoading=!1,this.sessionEncounterMap={},e===B.getSessionDate()&&!$.isEmpty(o)&&(this.sessionEncounterMap=o.reduce((a,k)=>(a[k.type.name.toLowerCase()]=k.observations.reduce((w,b)=>w.concat(b.concept.concept_names),[]).map(w=>w.name.toLowerCase()),a),{}))}).catch(()=>{t.items=[],t.cache[e]=t.items,t.isLoading=!1})},onClick:t=>{t.isEnabled&&(t.isLoading?Y("Please wait..."):this.openModal(t.items,"Select Activities",he))}},{items:[],cache:{},color:"success",isLoading:!1,label:"Lab Orders",icon:J,isEnabled:this.isCardEnabled("labEnabled"),onVisitDate:(t,e,o,a)=>{o&&a==="LAB ORDERS"&&M.invalidate("PATIENT_LAB_ORDERS"),t.isLoading=!0,this.getLabOrderCardInfo(e).then(k=>{t.items=k,t.cache[e]=t.items,t.isLoading=!1}).catch(()=>{t.items=[],t.cache[e]=t.items,t.isLoading=!1})},onClick:t=>{var e;return t.isEnabled&&this.$router.push((e=this.app)!=null&&e.getPatientDashboardLabCardRoute?"".concat(this.app.getPatientDashboardLabCardRoute,"/").concat(this.patient.getID(),"?date=").concat(this.activeVisitDate):"/art/encounters/lab/".concat(this.patient.getID()))}},{items:[],label:"Alerts and Clinic Notes",color:"danger",icon:Ft,isLoading:!1,isInit:!1,isEnabled:this.isCardEnabled("alertsEnabled"),onVisitDate:t=>{if(t.isInit)return;const e=this.getPatientAlertCardInfo();typeof e=="object"&&typeof e.then=="function"&&(t.isLoading=!0,this.getPatientAlertCardInfo().then(o=>{o&&(t.items=o),t.isInit=!0,t.isLoading=!1}).catch(()=>{t.items=[],t.isInit=!0,t.isLoading=!1})),e&&(t.items=e)},onClick:()=>{}},{items:[],cache:{},label:"Medications",color:"warning",icon:J,isLoading:!1,isEnabled:this.isCardEnabled("medicationsEnabled"),onVisitDate:(t,e)=>{t.isLoading=!0,ne.getOrderByPatient(this.patientId,{start_date:e}).then(o=>{t.items=this.getMedicationCardInfo(o),t.cache[e]=t.items,t.isLoading=!1}).catch(()=>{t.data,t.items=[],t.cache[e]=t.items,t.isLoading=!1})},onClick:t=>{if(!t.isEnabled)return;if(t.isLoading)return Y("Please wait..");const e=["Medication","Start date","End date","Amount given"],o=t.items.map(a=>["".concat(a.other.drug.name).concat(a.other.regimen?" (".concat(a.other.regimen,")"):"").trim(),this.toDate(a.other.order.start_date),this.toDate(a.other.order.auto_expire_date),a.other.quantity]);this.openTableModal(e,o,"Medication History")}}]},mounted(){this.patientId=parseInt("".concat(this.$route.params.id)),this.patientId&&H.doAppManagementTasks().then(()=>{this.app=H.getActiveApp(),this.programId=this.app.programID,this.appHasCustomContent&&(this.patientCards=[]),this.initData()})},methods:{initData(){var t,e;this.programCardInfo=typeof((t=this.app)==null?void 0:t.patientProgramInfoData)=="function"?(e=this.app)==null?void 0:e.patientProgramInfoData(this.patientId):[],this.currentDate=q.currentDisplayDate(),this.sessionDate=this.toDate(B.getSessionDate()),this.isBDE=B.isBDE()||!1,M.get("ACTIVE_PATIENT",{patientID:this.patientId}).then(async o=>{this.patient=o,this.patientCardInfo=this.getPatientCardInfo(o),this.getNextTask().then(a=>this.nextTask=a),this.getPatientVisitDates(this.patientId).then(a=>{this.visitDates=a,this.loadSavedEncounters()}).catch(a=>{console.error(a)});for(const a of this.programCardInfo)typeof a.init=="function"&&await a.init(),typeof a.asyncValue=="function"?a.asyncValue().then(k=>a.value=k):typeof a.staticValue=="function"&&(a.value=a.staticValue())}).catch(o=>Z("".concat(o)))},isCardEnabled(t){var o;const e=(o=this.app)==null?void 0:o.configDefaultPatientDashboardCards;return e&&t in e?e[t]||!1:!0},async showLoader(){(await X.create({message:"Please wait....",backdropDismiss:!1})).present()},clearLoader(){X.getTop().then(t=>t?X.dismiss():null)},toDate(t){return q.toStandardHisDisplayFormat(t)},toTime(t){return q.toStandardHisTimeFormat(t)},loadSavedEncounters(){R.getSavedEncounters(this.patientId).then(t=>{this.savedEncounters=t})},updateCardVisitData(t,e=!1,o=""){this.patientCards.forEach(a=>{if(a.isEnabled&&typeof a.onVisitDate=="function"){if(typeof a.cache=="object"&&a.cache[t]&&!e){a.items=a.cache[t];return}a.onVisitDate(a,t,e,o)}})},async getPatientVisitDates(t){return(await Ut.getPatientVisits(t,!1)).map(e=>({label:this.toDate(e),value:e,other:{isActive:e===B.getSessionDate()}}))},getNextTask(){return Wt.getNextTaskParams(this.patientId)},goToNextTask(){Gt(this.patientId,this.$router)},onActiveVisitDate(t){this.activeVisitDate=t.value},getPatientCardInfo(t){const e=t.getBirthdate(),o=t.getGender()==="M"?Kt:Jt;return[{label:"Name",value:t.getFullName(),other:{icon:o}},{label:"Birthdate",value:"\n                    ".concat(this.toDate(e),"\n                    (").concat(t.getAge(),") \n                    (").concat(t.getNationalID(),")")},{label:"Current Village",value:t.getCurrentVillage()},{label:"Phone#",value:t.getPhoneNumber()}]},getActivitiesCardInfo(t){return t.map(e=>({label:e.type.name,value:this.toTime(e.encounter_datetime),other:{provider:Xt.getPersonFullName(e.provider_id),isBDE:R.isEncounterInBDE(e),id:e.encounter_id,columns:["Observation","Value","Time"],onVoid:async o=>{await this.showLoader(),R.voidEncounter(e.encounter_id,o).then(()=>{this.clearLoader(),this.loadSavedEncounters(),this.updateCardVisitData(this.activeVisitDate,!0,e.type.name),this.getNextTask().then(a=>this.nextTask=a),Yt("Encounter has been voided!",2e3)}).catch(a=>{this.clearLoader(),Z("".concat(a),32e3)})},getRows:async()=>{var k,w,b,r,d,C;const o=[],{observations:a}=e;for(const E in a){let v="<UNKNOWN CONCEPT>";const u=a[E];try{if((k=u==null?void 0:u.concept)!=null&&k.concept_names){const _=(C=(d=(b=(w=u==null?void 0:u.drug)==null?void 0:w.drug_cms)==null?void 0:b.short_name)!=null?d:(r=u==null?void 0:u.drug)==null?void 0:r.name)!=null?C:"",P=_?"(".concat(_,")"):"";v="".concat(u.concept.concept_names[0].name," ").concat(P).trim()}else v=await Zt.getConceptName(u.concept_id)}catch(_){console.error(u,_)}const I=await Qt.resolvePrimaryValue(u),D=q.toStandardHisTimeFormat(u.date_created);o.push([v,I,D])}return o}}}))},getMedicationCardInfo(t){return t.map(e=>({label:"".concat(e.drug.name).concat(e.regimen?" (".concat(e.regimen,")"):""),value:this.toTime(e.order.start_date),other:e}))},async getLabOrderCardInfo(t){return typeof this.app.getPatientDashboardLabOrderCardItems=="function"?this.app.getPatientDashboardLabOrderCardItems(this.patientId,t):(await xt.getOrders(this.patientId,{date:t})).map(o=>({label:o.specimen.name,value:this.toTime(o.order_date)}))},async getPatientAlertCardInfo(){if("getPatientDashboardAlertsAndNotes"in this.app)return this.app.getPatientDashboardAlertsAndNotes(this.patient)},async changeApp(){const t=await H.selectApplication("PatientDashboard",!0);t&&(t.programID!=this.programId?(this.programId=t.programID,this.$router.push("/patients/confirm?patient_barcode=".concat(this.patient.getNationalID()))):this.initData())},async showTasks(){if("primaryPatientActivites"in this.app){const t=[...this.app.primaryPatientActivites].map(e=>{const o=(e.encounterTypeName||e.name).toLowerCase();return typeof e.taskCompletionChecklist=="object"&&!$.isEmpty(this.sessionEncounterMap)?e.taskCompleted=e.taskCompletionChecklist.every(a=>$.isArray(this.sessionEncounterMap[o])&&this.sessionEncounterMap[o].includes(a.toLowerCase())):e.taskCompleted=!$.isEmpty(this.sessionEncounterMap[o]),e});this.openModal(t,"Tasks for",lt,this.sessionDate)}},showOptions(){if("secondaryPatientActivites"in this.app){const t=this.app.secondaryPatientActivites;this.openModal(t,"Select Activity",lt)}},async startModal(t,e){(await K.create({component:t,backdropDismiss:!1,cssClass:"large-modal",componentProps:e})).present()},async openModal(t,e,o,a=""){$.isEmpty(this.patientProgram)&&(this.patientProgram=await new te(this.patientId).getProgram()),this.startModal(o,{items:t,title:"".concat(e,": ").concat(a||this.toDate(this.activeVisitDate.toString())),taskParams:{patient:this.patient.getObj(),program:this.patientProgram,visitDate:this.activeVisitDate,patientID:this.patientId,savedEncounters:this.savedEncounters}})},openTableModal(t,e,o){this.startModal(_e,{columns:t,rows:e,title:"".concat(o,": ").concat(this.toDate(this.activeVisitDate.toString()))})},onCancel(){M.invalidate("ACTIVE_PATIENT"),M.invalidate("PATIENT_PROGRAM"),M.invalidate("PATIENT_LAB_ORDERS"),this.$router.push({path:"/"})}}}),Re={key:0},qe={class:"his-card info-card-item"},je={class:"his-card info-card-item"},Fe={class:"his-card info-card-item"},Ue={class:"his-sm-text his-card"},We={key:0},Ge={key:1},Ke={key:0},Je={key:1},Xe={key:1};function Ye(t,e,o,a,k,w){const b=s("minimal-toolbar"),r=s("ion-icon"),d=s("ion-label"),C=s("ion-segment-button"),E=s("ion-segment"),v=s("ion-toolbar"),u=s("ion-button"),I=s("primary-card"),D=s("ion-col"),_=s("ion-row"),P=s("ion-grid"),L=s("ion-item"),N=s("ion-list"),it=s("ion-content"),ft=s("ion-footer"),ot=s("ion-page"),gt=s("full-toolbar"),_t=s("visit-dates-card"),st=s("ion-chip");return l(),f(T,null,[t.screenBreakPoint==="sm"?(l(),h(ot,{key:0},{default:i(()=>[n(b,{title:t.patientName,menuTitle:t.visitDatesTitle,menuItems:t.visitDates,appIcon:t.app.applicationIcon,onOnClickMenuItem:t.onActiveVisitDate},null,8,["title","menuTitle","menuItems","appIcon","onOnClickMenuItem"]),t.screenBreakPoint==="sm"?(l(),h(v,{key:0},{default:i(()=>[n(E,{value:t.activeTab,class:"ion-justify-content-center"},{default:i(()=>[n(C,{value:"1",onClick:e[0]||(e[0]=c=>t.activeTab=1)},{default:i(()=>[n(r,{icon:t.calendar},null,8,["icon"]),n(d,null,{default:i(()=>e[5]||(e[5]=[p("Visits")])),_:1})]),_:1}),n(C,{value:"2",onClick:e[1]||(e[1]=c=>t.activeTab=2)},{default:i(()=>[n(r,{icon:t.person},null,8,["icon"]),n(d,null,{default:i(()=>e[6]||(e[6]=[p("Patient")])),_:1})]),_:1}),n(C,{value:"3",onClick:e[2]||(e[2]=c=>t.activeTab=3)},{default:i(()=>[n(r,{icon:t.medical},null,8,["icon"]),n(d,null,{default:i(()=>e[7]||(e[7]=[p("Program")])),_:1})]),_:1}),n(C,{value:"4",onClick:e[3]||(e[3]=c=>t.activeTab=4)},{default:i(()=>[n(r,{icon:t.time},null,8,["icon"]),n(d,null,{default:i(()=>e[8]||(e[8]=[p("Dates")])),_:1})]),_:1})]),_:1},8,["value"])]),_:1})):y("",!0),t.nextTask.name&&t.screenBreakPoint==="sm"?(l(),h(v,{key:1},{default:i(()=>[n(u,{style:{width:"100%"},color:"success",onClick:t.goToNextTask},{default:i(()=>[n(d,null,{default:i(()=>[m("b",null,"Next Task: "+g(t.nextTask.name.toUpperCase()),1)]),_:1}),n(r,{icon:t.alertCircle},null,8,["icon"])]),_:1},8,["onClick"])]),_:1})):y("",!0),n(it,{id:"main-content"},{default:i(()=>[t.screenBreakPoint==="sm"?(l(),f("div",Re,[t.appHasCustomContent&&t.activeTab===1&&t.patientIsset?(l(),h(at(t.customDashboardContent),{key:0,patient:t.patient,visitDate:t.activeVisitDate},null,8,["patient","visitDate"])):y("",!0),!t.appHasCustomContent&&t.activeTab===1?(l(),h(P,{key:1},{default:i(()=>[n(_,null,{default:i(()=>[(l(!0),f(T,null,A(t.patientCards,(c,V)=>(l(),h(D,{size:"12",key:V},{default:i(()=>[(l(),h(I,{key:"mcard".concat(V),isEnabled:c.isEnabled,counter:c.items.length,icon:c.icon,title:c.label,titleColor:c.color,items:c.items,isLoading:c.isLoading,onClick:bt=>c.onClick(c)},null,8,["isEnabled","counter","icon","title","titleColor","items","isLoading","onClick"]))]),_:2},1024))),128))]),_:1})]),_:1})):y("",!0),t.activeTab===2?(l(),h(N,{key:2},{default:i(()=>[(l(!0),f(T,null,A(t.patientCardInfo,(c,V)=>(l(),f("div",{class:"his-card info-card-item",key:V},[n(L,{lines:"none"},{default:i(()=>[n(d,null,{default:i(()=>[p(g(c.label),1)]),_:2},1024),n(d,{slot:"end"},{default:i(()=>[m("b",null,g(c.value),1)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):y("",!0),t.activeTab===3?(l(),h(N,{key:3},{default:i(()=>[(l(!0),f(T,null,A(t.programCardInfo,(c,V)=>(l(),f("div",{class:"his-card info-card-item",key:V},[n(L,{lines:"none"},{default:i(()=>[n(d,null,{default:i(()=>[p(g(c.label),1)]),_:2},1024),n(d,{slot:"end"},{default:i(()=>[m("b",null,g(c.value),1)]),_:2},1024)]),_:2},1024),e[9]||(e[9]=m("p",null,null,-1))]))),128))]),_:1})):y("",!0),t.activeTab===4?(l(),h(N,{key:4},{default:i(()=>[m("div",qe,[n(L,{lines:"none"},{default:i(()=>[n(d,null,{default:i(()=>e[10]||(e[10]=[p(" Today ")])),_:1}),n(d,{slot:"end"},{default:i(()=>[m("b",null,g(t.currentDate),1)]),_:1})]),_:1})]),m("div",je,[n(L,{lines:"none"},{default:i(()=>[n(d,null,{default:i(()=>e[11]||(e[11]=[p(" Session ")])),_:1}),n(d,{slot:"end"},{default:i(()=>[m("b",null,g(t.sessionDate),1)]),_:1})]),_:1})]),m("div",Fe,[n(L,{lines:"none"},{default:i(()=>[n(d,null,{default:i(()=>e[12]||(e[12]=[p(" Current visit date ")])),_:1}),n(d,{slot:"end"},{default:i(()=>[m("b",null,g(t.activeVisitDate),1)]),_:1})]),_:1})])]),_:1})):y("",!0)])):y("",!0)]),_:1}),n(ft,null,{default:i(()=>[t.screenBreakPoint==="sm"?(l(),h(v,{key:0,color:"dark"},{default:i(()=>[n(u,{color:"primary",size:"medium",slot:"end",onClick:t.showTasks},{default:i(()=>[n(r,{icon:t.clipboard},null,8,["icon"])]),_:1},8,["onClick"]),n(u,{color:"primary",size:"medium",slot:"end",onClick:t.showOptions},{default:i(()=>[n(r,{icon:t.folder},null,8,["icon"])]),_:1},8,["onClick"]),n(u,{color:"primary",size:"medium",slot:"end",onClick:t.changeApp},{default:i(()=>[n(r,{icon:t.apps},null,8,["icon"])]),_:1},8,["onClick"]),n(u,{color:"success",size:"medium",slot:"end",onClick:t.onCancel},{default:i(()=>[n(r,{icon:t.logOut},null,8,["icon"])]),_:1},8,["onClick"])]),_:1})):y("",!0)]),_:1})]),_:1})):y("",!0),t.screenBreakPoint==="lg"?(l(),h(ot,{key:1},{default:i(()=>[n(gt,{app:t.app,appVersion:t.appVersion,appIcon:t.app.applicationIcon,patientCardInfo:t.patientCardInfo,programCardInfo:t.programCardInfo},null,8,["app","appVersion","appIcon","patientCardInfo","programCardInfo"]),n(it,{id:"main-content"},{default:i(()=>[n(P,{class:"grid-custom vertically-align"},{default:i(()=>[n(_,null,{default:i(()=>[n(D,{size:"2.4"},{default:i(()=>[n(_t,{title:t.visitDatesTitle,items:t.visitDates,onOnselect:t.onActiveVisitDate},null,8,["title","items","onOnselect"])]),_:1}),n(D,{size:"9.6"},{default:i(()=>[m("div",Ue,[n(_,null,{default:i(()=>[n(D,{"size-md":"4","size-sm":"6"},{default:i(()=>[e[13]||(e[13]=p(" Today's Date: ")),m("b",null,g(t.currentDate),1)]),_:1}),n(D,{"size-md":"4","size-sm":"6"},{default:i(()=>[t.nextTask.name?(l(),f("span",We,[n(st,{class:"next-task",color:"success",onClick:t.goToNextTask},{default:i(()=>[p("Next Task: "+g(t.nextTask.name.toUpperCase()),1)]),_:1},8,["onClick"])])):(l(),f("span",Ge,e[14]||(e[14]=[p(" Next Task: "),m("b",null,"NONE",-1)])))]),_:1}),n(D,{"size-md":"4","size-sm":"12"},{default:i(()=>[t.isBDE?(l(),f("span",Ke,[n(st,{style:{marginTop:"-8px"},color:"danger",onClick:e[4]||(e[4]=c=>t.$router.push({name:"Session Date"}))},{default:i(()=>[m("b",null," BDE: "+g(t.sessionDate.toUpperCase()),1)]),_:1})])):(l(),f("span",Je,[e[15]||(e[15]=p(" Set Date: ")),m("b",null,g(t.sessionDate),1)]))]),_:1})]),_:1}),t.appHasCustomContent&&t.patientIsset?(l(),h(at(t.customDashboardContent),{key:0,patient:t.patient,visitDate:t.activeVisitDate},null,8,["patient","visitDate"])):y("",!0),t.appHasCustomContent?y("",!0):(l(),f("div",Xe,[n(_,null,{default:i(()=>[(l(!0),f(T,null,A(t.patientCards,(c,V)=>(l(),h(D,{size:"6",key:V},{default:i(()=>[(l(),h(I,{key:c.label,isEnabled:c.isEnabled,counter:c.items.length,icon:c.icon,title:c.label,titleColor:c.color,items:c.items,isLoading:c.isLoading,onClick:bt=>c.onClick(c)},null,8,["isEnabled","counter","icon","title","titleColor","items","isLoading","onClick"]))]),_:2},1024))),128))]),_:1})]))])]),_:1})]),_:1})]),_:1})]),_:1}),n(v,{color:"dark"},{default:i(()=>[n(u,{color:"primary",size:"large",slot:"end",onClick:t.showTasks},{default:i(()=>[n(r,{icon:t.clipboardOutline},null,8,["icon"]),e[16]||(e[16]=p(" Tasks "))]),_:1},8,["onClick"]),n(u,{color:"primary",size:"large",slot:"end",onClick:t.showOptions},{default:i(()=>[n(r,{icon:t.folderOutline},null,8,["icon"]),e[17]||(e[17]=p(" Printouts/Other "))]),_:1},8,["onClick"]),n(u,{color:"primary",size:"large",slot:"end",onClick:t.changeApp},{default:i(()=>[n(r,{icon:t.appsOutline},null,8,["icon"]),e[18]||(e[18]=p(" Applications "))]),_:1},8,["onClick"]),n(u,{onClick:t.onCancel,color:"success",size:"large",slot:"end"},{default:i(()=>[n(r,{icon:t.logOutOutline},null,8,["icon"]),e[19]||(e[19]=p(" Finish "))]),_:1},8,["onClick"])]),_:1})]),_:1})):y("",!0)],64)}const nn=S(He,[["render",Ye],["__scopeId","data-v-ac0d1e98"]]);export{nn as default};
