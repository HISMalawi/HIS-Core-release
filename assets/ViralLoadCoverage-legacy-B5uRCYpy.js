System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-Cbxcxwf4.js","./TableReportTemplate-legacy-CxKxnBF6.js","./index-legacy--hxN_V8z.js","./viral_load_report-legacy-C-riy_Ey.js","./MultiFieldDateHelper-legacy-B97J9Bxd.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./BasicReportTemplate-legacy-B1A4xCu4.js","./Export-legacy-BAJiCfrv.js","./SIngleTouchField-legacy-X9PnjTsk.js","./Pagination-legacy-Dw_YvCGa.js","./HisStandardForm-legacy-C7VqHmr3.js","./TouchScreenForm-legacy-DxIQwsU4.js","./ToolbarMediumCard-legacy-CzmL2SiF.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-TUlObaz7.js","./ReportErrors-legacy-Btn46Hsy.js"],(function(t,e){"use strict";var o,i,l,r,s,a,n,d,h,u,w,g,c,p;return{setters:[t=>{o=t._},t=>{i=t.R},t=>{l=t.d,r=t.I,s=t.L,a=t.ab,n=t.cx,d=t._,h=t.r,u=t.o,w=t.c,g=t.w,c=t.b},t=>{p=t.V},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=l({mixins:[o],components:{ReportTemplate:i,IonPage:r},data:()=>({title:"VL Coverage report",cohort:{},rows:[],totals:{F:{},M:{}},columns:[[s.thTxt("",{colspan:4,exportable:!1}),s.thTxt("Sample Drawn",{colspan:2,exportable:!1}),s.thTxt("High VL (>=1000 copies)",{colspan:2,exportable:!1}),s.thTxt("Low VL (<1000 copies)",{colspan:2,exportable:!1})],[s.thTxt("Age group"),s.thTxt("Gender"),s.thTxt("Due for VL"),s.thTxt("Routine",{value:"Routine (Sample Drawn)"}),s.thTxt("Targeted",{value:"Targeted (Sample Drawn)"}),s.thTxt("Routine",{value:"Routine (High VL (>=1000 copies))"}),s.thTxt("Targeted",{value:"Targeted High VL (>=1000 copies)"}),s.thTxt("Routine",{value:"Routine (Low VL (<1000 copies))"}),s.thTxt("Targeted",{value:"Targeted (Low VL (<1000 copies))"})]]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.rows=[],this.totals={F:{},M:{}},this.report=new p,this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getVLCoverage(),await this.setRows("F"),await this.setRows("M"),this.setAllMalesTotalsRow(),await this.setFemaleTotalsRow()},setTotals(t,e,o){this.totals[e][t]||(this.totals[e][t]=[]),this.totals[e][t]=this.totals[e][t].concat(o)},drillDown(t,e){if(t.length>=1){const o=[[s.thTxt("ARV #"),s.thTxt("DOB"),s.thTxt("Gender"),s.thTxt("Action")]],i=()=>this.sortByArvNumber(t).map((t=>[this.tdARV(t.arv_number),s.tdDate(t.birthdate),s.td(this.formatGender(t.gender)),s.tdBtn("Show",(()=>this.$router.push({path:`/patient/dashboard/${t.patient_id}`})))]));return s.tdLink(t.length,(()=>this.drilldownAsyncRows(e,o,i)))}return s.td(0)},async setFemaleTotalsRow(){const t=this.totals.F,e=Object.values(t).reduce(((t,e)=>a.uniq(t.concat(e.map((t=>t.patient_id))))),[]),o=await this.report.getMaternalStatus(e),i=o.FBf.concat(o.FP),l=(t,e)=>e.filter((e=>o[t].includes(e.patient_id))),r=t=>t.filter((t=>!i.includes(t.patient_id)));this.rows.push([s.td("All"),s.td("FP"),this.drillDown(l("FP",t.due_for_vl),"Due for VL FP"),this.drillDown(l("FP",t.drawn_routine),"Routine (Sample Drawn) FP"),this.drillDown(l("FP",t.drawn_targeted),"Targetted (Sample Drawn) FP"),this.drillDown(l("FP",t.high_vl_routine),"Routine (High VL (>=1000 copies)) FP"),this.drillDown(l("FP",t.high_vl_targeted),"Targeted High VL (>=1000 copies) FP"),this.drillDown(l("FP",t.low_vl_routine),"Routine (Low VL (<1000 copies)) FP"),this.drillDown(l("FP",t.low_vl_targeted),"Targeted (Low VL (<1000 copies)) FP")]),this.rows.push([s.td("All"),s.td("FNP"),this.drillDown(r(t.due_for_vl),"Due for VL FNP"),this.drillDown(r(t.drawn_routine),"Routine (Sample Drawn) FNP"),this.drillDown(r(t.drawn_targeted),"Targetted (Sample Drawn) FNP"),this.drillDown(r(t.high_vl_routine),"Routine (High VL (>=1000 copies)) FNP"),this.drillDown(r(t.high_vl_targeted),"Targeted High VL (>=1000 copies) FNP"),this.drillDown(r(t.low_vl_routine),"Routine (Low VL (<1000 copies)) FNP"),this.drillDown(r(t.low_vl_targeted),"Targeted (Low VL (<1000 copies)) FNP")]),this.rows.push([s.td("All"),s.td("FBF"),this.drillDown(l("FBf",t.due_for_vl),"Due for VL FBf"),this.drillDown(l("FBf",t.drawn_routine),"Routine (Sample Drawn) FBf"),this.drillDown(l("FBf",t.drawn_targeted),"Targetted (Sample Drawn) FBf"),this.drillDown(l("FBf",t.high_vl_routine),"Routine (High VL (>=1000 copies)) FBf"),this.drillDown(l("FBf",t.high_vl_targeted),"Targeted High VL (>=1000 copies) FBf"),this.drillDown(l("FBf",t.low_vl_routine),"Routine (Low VL (<1000 copies)) FBf"),this.drillDown(l("FBf",t.low_vl_targeted),"Targeted (Low VL (<1000 copies)) FBf")])},setAllMalesTotalsRow(){const t=this.totals.M;return this.rows.push([s.td("All"),s.td("Male"),this.drillDown(t.due_for_vl,"Due for VL Male"),this.drillDown(t.drawn_routine,"Routine (Sample Drawn) Male"),this.drillDown(t.drawn_targeted,"Targetted (Sample Drawn) Male"),this.drillDown(t.high_vl_routine,"Routine (High VL (>=1000 copies)) Male"),this.drillDown(t.high_vl_targeted,"Targeted High VL (>=1000 copies) Male"),this.drillDown(t.low_vl_routine,"Routine (Low VL (<1000 copies)) Male"),this.drillDown(t.low_vl_targeted,"Targeted (Low VL (<1000 copies)) Male")])},async setRows(t){const e=this.formatGender(t);for(const o of n)if(o in this.cohort){const i=this.cohort[o],l=(e,o,i)=>{const l=o.filter((e=>e.gender===t));return this.setTotals(e,t,l),this.drillDown(l,i)};this.rows.push([s.td(o),s.td(e),l("due_for_vl",i.due_for_vl,`${o} Due for VL (${e})`),l("drawn_routine",i.drawn.routine,`${o} Routine (Sample Drawn) (${e}s)`),l("drawn_targeted",i.drawn.targeted,`${o} Targeted (Sample Drawn) (${e}s)`),l("high_vl_routine",i.high_vl.routine,`${o} Routine (High VL (>=1000 copies)) (${e}s)`),l("high_vl_targeted",i.high_vl.targeted,`${o} Targeted High VL (>=1000 copies) (${e}s)`),l("low_vl_routine",i.low_vl.routine,`${o} Routine (Low VL (<1000 copies)) (${e}s)`),l("low_vl_targeted",i.low_vl.targeted,`${o} Targeted (Low VL (<1000 copies)) (${e}s)`)])}else this.rows.push([s.td(o),s.td(e),s.td(0),s.td(0),s.td(0),s.td(0),s.td(0),s.td(0)])}}});t("default",d(e,[["render",function(t,e,o,i,l,r){const s=h("report-template"),a=h("ion-page");return u(),w(a,null,{default:g((()=>[c(s,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},reportPrefix:"PEPFAR",onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
