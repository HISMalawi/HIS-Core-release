System.register(["./index-legacy-BikDJqIc.js","./HisStandardForm-legacy-C2hYSmp0.js","./useEncounter-legacy-BXMNOBcm.js","./relations_service-legacy-BuebGJ3J.js","./VoidReason-legacy-D_ty2Dff.js","./isEmpty-legacy-Dmsr-BqB.js","./encounter_guidelines-legacy-BpmJWOJc.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,n,i,o,r,s,l,d,c,u,p,h,y,g,m,_,v,f,b,T,w;return{setters:[e=>{a=e.d,n=e.r,i=e.am,o=e.av,r=e.p,s=e.bI,l=e.a$,d=e.al,c=e.a,u=e.w,p=e.e,h=e.f,y=e.n,g=e.B,m=e.b,_=e.bN,v=e.ea},e=>{f=e.H},e=>{b=e.u},e=>{T=e.R},e=>{w=e.p},null,null,null],execute:function(){e("default",a({__name:"Contacts",setup(e){const t=n([]),a=n();function F(e){const t=g(),a=g(e),n=t.diff(a,"year"),i=t.diff(a.add(n,"year"),"month"),o=t.diff(a.add(n,"year").add(i,"month"),"day");return n>0?`${n} year${n>1?"s":""} old`:i>0?`${i} month${i>1?"s":""} old`:`${o} day${o>1?"s":""} old`}const{patientDashboardUrl:$,patientId:j}=b(((e,n,c)=>{a.value=c,t.value=[(()=>{let e={},t=[];return{id:"contacts",helpText:"Contacts",type:i.TT_TABLE_VIEWER,onload:t=>e=t,init:async()=>(t=await c.getGuardian(),!0),options:()=>[{label:"",value:"",other:{columns:["Name","Gender","Age","Screen","Void"],rows:t.map((t=>[`${t.relation.names[0].given_name} ${t.relation.names[0].family_name}`,"M"===t.relation.gender?"Male":"Female",F(t.relation.birthdate),{name:"Screen",type:"button",action:()=>o(t.relation.person_id,r)},{id:t.relationship_id,name:"Void",type:"button",color:"danger",action:()=>w((async a=>{await T.voidRelation(n,t.relationship_id,a),e.rows=e.rows.filter((e=>e[e.length-1].id!=t.relationship_id))}))}]))}}],config:{overrideDefaultFooterBtns:{nextBtn:{name:"Add contact"}}}}})(),s.getGivenNameField(),s.getFamilyNameField(),s.getGenderField(),...l(s.getDobConfig()),s.getCellNumberField(),{id:"action",helpText:"Next step:",type:i.TT_SELECT,requireNext:!1,validation:e=>d.required(e),options:()=>[{label:"Add another contact",value:1,other:{action:()=>location.reload()}},{label:"Proceed to diagnosis",value:2,other:{action:e=>o(e,r)}},{label:"Go to dashboard",value:3,other:{action:()=>r.push($.value)}}]}]}));function x(){const e=a.value.patient;return{home_district:e.person.addresses[0].address2,current_district:e.person.addresses[0].state_province,current_village:e.person.addresses[0].city_village,current_traditional_authority:e.person.addresses[0].township_division,home_village:e.person.addresses[0].neighborhood_cell,home_traditional_authority:e.person.addresses[0].county_district}}async function C(e,t){const a=new _,n={...x(),...s.resolvePerson(t)};await a.createPerson(n),await a.createPatient(),await T.createRelation(j.value,a.personId,v.TB_CONTACT),"function"==typeof e.action?.other?.action&&e.action.other.action(a.personId)}return(e,a)=>(m(),c(h(y),null,{default:u((()=>[p(f,{cancelDestinationPath:h($),onFinishAction:C,fields:t.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
