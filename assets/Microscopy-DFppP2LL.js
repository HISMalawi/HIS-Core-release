import{d as C,K as P,b5 as R,cV as I,V as d,o as b,c as L,w as h,b as $,cl as S,I as U}from"./index-BCTN_bnC.js";import{H as B}from"./HisStandardForm-CaDwl-hA.js";import{u as F}from"./useEncounter-CDUT-p5Y.js";import{F as n}from"./dynamic-import-helper-BkBZiFw5.js";import{r as M}from"./commons-BDvZ1JFN.js";import{g as a}from"./util-CyjuS_4X.js";import"./TouchScreenForm-TKB9q3ZD.js";import"./ToolbarMediumCard-O_J6wu7C.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-BCxYiILf.js";import"./isEmpty-OXtHK5dz.js";import"./_Set-VKtKUQAI.js";import"./_setToArray-BLmuRUHx.js";import"./encounter_guidelines-DZpIPlYY.js";import"./GuidelineEngine-D6V1_Znr.js";const j=C({__name:"Microscopy",setup(N){const r=P([]),o=new R(-1,I.LAB_RESULTS),{goToNextTask:v,patientDashboardUrl:O}=F((l,i)=>{o.patientID=i,o.providerID=l;const u=t=>({id:"sample".concat(t,"PhysicalAppearance"),helpText:"Sample ".concat(t," Physical Appearance:"),type:n.TT_SELECT,computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_PHYSICAL_APPEARANCE")),value_coded:a("".concat(e.value)),obs_datetime:o.date}),validation:e=>d.required(e),options:()=>[{value:"MUCO_PURULENT",label:"Muco-purulent"},{value:"BLOOD_STAINED",label:"Blood-stained"},{value:"SALIVA",label:"Saliva"},{value:"OTHER",label:"Other"}]}),s=t=>({id:"sample".concat(t,"Procedure"),helpText:"Sample ".concat(t," Procedure:"),type:n.TT_SELECT,computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_PROCEDURE")),value_coded:a("".concat(e.value)),obs_datetime:o.date}),validation:e=>d.required(e),options:()=>[{value:"ZIEHL_NEELSEN",label:"Ziehl-Neelsen"},{value:"FLUORESCENCE",label:"Fluorescence"}]}),c=t=>({id:"sample".concat(t,"Result"),helpText:"Sample ".concat(t," Result:"),type:n.TT_SELECT,computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_RESULT")),value_coded:a("".concat(e.value)),obs_datetime:o.date}),validation:e=>d.required(e),options:()=>[{value:"AFB_POSITIVE",label:"AFB Positive"},{value:"AFB_NEGATIVE",label:"AFB Negative"}]}),_=t=>({id:"sample".concat(t,"Grading"),helpText:"Sample ".concat(t," Grading:"),type:n.TT_SELECT,validation:e=>d.required(e),condition:e=>e["sample".concat(t,"Result")].value==="AFB_POSITIVE",computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_GRADING")),value_text:e.value,obs_datetime:o.date}),options:()=>[{value:"1+",label:"1+"},{value:"2+",label:"2+"},{value:"3+",label:"3+"},{value:"OTHER",label:"Other"}]}),p=t=>({id:"sample".concat(t,"OtherGrading"),helpText:"Sample ".concat(t," Other Grading:"),type:n.TT_TEXT,computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_GRADING")),value_text:e.value,obs_datetime:o.date}),validation:e=>d.required(e),condition:e=>e["sample".concat(t,"Grading")].value==="OTHER"}),E=t=>({id:"sample".concat(t,"BaciliSeen"),type:n.TT_NUMBER,helpText:"Sample ".concat(t," no. Of Bacilli Seen:"),computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_NUMBER_OF_BACILI_SEEN")),value_numeric:e.value,obs_datetime:o.date}),validation:e=>d.required(e),condition:e=>e["sample".concat(t,"Grading")].value==="OTHER"}),m=t=>({id:"sample".concat(t,"ResultDate"),helpText:"Sample ".concat(t," Result Date:"),type:n.TT_FULL_DATE,computedValue:e=>({concept_id:a("SAMPLE_".concat(t.toUpperCase(),"_MICROSCOPY_RESULT_DATE")),value_datetime:e.value,obs_datetime:o.date}),validation:e=>d.required(e)});r.value=[u("One"),s("One"),c("One"),_("One"),p("One"),E("One"),m("One"),u("Two"),s("Two"),c("Two"),_("Two"),p("Two"),E("Two"),m("Two")]});function T(l){const i=[];return l.sampleOneResult.value==="AFB_POSITIVE"||l.sampleTwoResult.value==="AFB_POSITIVE"?(i.push({concept_id:a("TB_TYPE"),value_coded:a("PULMONARY_TB"),obs_datetime:o.date}),i.push({concept_id:a("TB_STATUS"),value_coded:a("POSITIVE"),obs_datetime:o.date}),i.push({concept_id:a("TUBERCULOSIS_CLASS"),value_coded:a("All Other"),obs_datetime:o.date})):i.push({concept_id:a("TB_STATUS"),value_coded:a("NEGATIVE"),obs_datetime:o.date}),i.push({concept_id:a("BACTERIOLOGICALLY_DIAGNOSED"),value_coded:a("YES_ANSWER"),obs_datetime:o.date}),i.push({concept_id:a("PROCEDURE_TYPE"),value_coded:a("MICROSCOPY"),obs_datetime:o.date}),i}async function A(l,i){await o.createEncounter(),await o.saveObservationList([...T(l),...await M(i)]),v()}return(l,i)=>(b(),L(S(U),null,{default:h(()=>[$(B,{cancelDestinationPath:S(O),onFinishAction:A,fields:r.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])]),_:1}))}});export{j as default};
