var f=Object.defineProperty;var v=(t,r,o)=>r in t?f(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o;var p=(t,r,o)=>v(t,typeof r!="symbol"?r+"":r,o);import{ce as T,d as R,a5 as w,aq as e,ab as x,ac as y,aL as c,a8 as S,v as b,w as _,ad as m,u as C,x as I}from"./index-DLUr6P7m.js";import{_ as A}from"./ReportMixin.vue_vue_type_script_lang-CXxGyV2O.js";import{R as E}from"./TableReportTemplate-D2QfHBwQ.js";import"./BasicReportTemplate-BpLJU3Mo.js";import"./Export-CkPEf1jI.js";import"./index-DjieabqU.js";import"./Pagination-CNX1jSEO.js";import"./HisStandardForm-CHh-Kykj.js";import"./ReportErrors-CoJcPm2D.js";var u=(t=>(t.GENERAL="General",t.CHILDREN="Children",t.WOMEN="Women",t))(u||{});class G extends T{constructor(){super();p(this,"ageGroup");p(this,"quarter");p(this,"regenerate");this.quarter="",this.regenerate=!1,this.ageGroup="General"}setRegenerate(o){this.regenerate=o}getAgeGroup(){return this.ageGroup}setQuarter(o){this.quarter=o}setAgeGroup(o){this.ageGroup=o}getSurvivalAnalysis(){return this.getReport("cohort_survival_analysis",{quarter:this.quarter,regenerate:this.regenerate,date:this.date,age_group:this.ageGroup,program_id:this.programID})}}const g={style:{borderRight:"5px solid black !important"}},D=R({mixins:[A],components:{ReportTemplate:E,IonPage:w},data:()=>({title:"Survival analysis report",totalClients:[],rows:[],columns:[[e.thTxt("Reg cohort"),e.thTxt("Interval (months)"),e.thTxt("Sub group"),e.thTxt("Total Reg (database)"),e.thTxt("Total Reg (Confirmed)",g),e.thTxt("Alive"),e.thTxt("Died"),e.thTxt("Defaulted"),e.thTxt("Stopped"),e.thTxt("TO"),e.thTxt("Unknown")]]}),created(){this.fields=[...this.getDateDurationFields(!0,!1,17),{id:"group",helpText:"Select sub-group",type:x.TT_SELECT,validation:t=>y.required(t),options:()=>[{label:"General",value:u.GENERAL},{label:"Children",value:u.CHILDREN},{label:"Option B+",value:u.WOMEN}]}]},methods:{async onPeriod({quarter:t,group:r},o,s=!1){this.rows=[],this.period=t.label,this.report=new G,this.report.setOccupation(o.occupation),this.report.setRegenerate(s),this.report.setQuarter(t.label),this.report.setAgeGroup(r.value);const n=await this.report.getSurvivalAnalysis();this.title="Survival analysis report ".concat(r.label),this.rows=this.getRows(n)},getRows(t){return Object.keys(t).filter(r=>!c.isEmpty(t[r])).sort((r,o)=>{const s=r.split(" ")[1],n=o.split(" ")[1];return parseInt(s)-parseInt(n)}).map(r=>{const o=t[r];let s=0,n=0;const a={"On antiretrovirals":0,Defaulted:0,"Patient died":0,"Treatment stopped":0,"Patient transferred out":0,unknown:0};if(!c.isEmpty(o)){for(const i in o){const l=o[i];for(const h in l){const d=l[h];s=parseInt(h),i in a?a[i]=d:a.unknown=d,n+=d}}return[e.td(r),e.td(s),e.td(this.report.getAgeGroup()),e.td(n),e.td("",g),e.td(a["On antiretrovirals"]),e.td(a["Patient died"]),e.td(a.Defaulted),e.td(a["Treatment stopped"]),e.td(a["Patient transferred out"]),e.td(a.unknown)]}})}}});function k(t,r,o,s,n,a){const i=m("report-template"),l=m("ion-page");return C(),b(l,null,{default:_(()=>[I(i,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!1},reportPrefix:"MoH",hasServerSideCaching:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const W=S(D,[["render",k]]);export{W as default};
