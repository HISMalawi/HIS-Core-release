import{a as B,ar as r,ap as C,ai as m,as as d,aq as l,ah as b,aM as f,ab as w,aK as E,ac as s,al as I}from"./index-BXYGQb-P.js";import{D as R}from"./BasicReportTemplate-Bkb94e9t.js";function q(D="Report"){const a=B({title:D,rows:[],columns:[],fields:[],period:"",drill:[],service:{},other:{}}),v=r(()=>a.rows),y=r(()=>a.period),g=r(()=>a.fields),T=r(()=>a.columns),x=r(()=>a.title),c=C();function F(e){c.push("/patient/dashboard/".concat(e))}function S(e){return m.toStandardHisDisplayFormat(e)}function P(e){const t=open("","","width:1024px, height:768px"),n=document.getElementById(e.containerID);n&&t&&(t.document.write('\n                <html>\n                <head>\n                    <title>Print Cohort</title>\n                    <link rel="stylesheet" media="print"  href="'.concat(e.cssFile,'"/>\n                </head>\n                <body>\n                    ').concat(n.innerHTML,"\n                </body>\n                </html>\n            ")),setTimeout(()=>{t.print(),t.close()},3500))}async function h(e,t){(await d.create({component:R,cssClass:"large-modal",componentProps:{title:e||"Drilldown",columns:[[l.thTxt("National ID"),l.thTxt("First name"),l.thTxt("Last name"),l.thTxt("Birthdate"),l.thTxt("Action")]],rows:t,rowParser:async n=>{const u=[];for(const o of n){if(a.drill[o]){u.push(a.drill[o]);continue}try{const i=new b(await b.findByID(o));a.drill[o]=[l.td(i.getNationalID()),l.td(i.getGivenName()),l.td(i.getFamilyName()),l.tdDate("".concat(i.getBirthdate())),l.tdBtn("Show",()=>{c.push({path:"/patient/dashboard/".concat(o)}),d.dismiss({})})],u.push(a.drill[o])}catch(i){console.error(i)}}return u},showFilters:!0,footerColor:"light",showReportStamp:!1,paginated:!0,rowsPerPage:20,onFinish:()=>d.dismiss()}})).present()}function N(e,t){return t.length?l.tdLink(t.length,()=>h(e,t)):l.td(0)}function p(e={}){return[...f({id:"start_date",helpText:"Start",required:!0,minDate:()=>(e==null?void 0:e.minDate)||null,maxDate:()=>(e==null?void 0:e.maxDate)||null,estimation:{allowUnknown:!1},computeValue:t=>t}),...f({id:"end_date",helpText:"End",required:!0,minDate:(t,n)=>n.start_date,maxDate:()=>(e==null?void 0:e.maxDate)||null,estimation:{allowUnknown:!1},computeValue:t=>t})]}a.fields=p();function M(){return[{id:"year",helpText:"Select Year",type:w.TT_NUMBER,computedValue:e=>e.value,validation:e=>{const t=E.isPlainObject(e)?e.value:-1;return s.validateSeries([()=>s.required(e),()=>isNaN(parseInt("".concat(t)))?["Invalid year"]:null,()=>s.rangeOf(e,2e3,m.getYear(I.getSessionDate()))])}},{id:"month",helpText:"Select Month",type:w.TT_SELECT,validation:e=>s.required(e),computedValue:e=>e.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}]}return{fd:S,drill:N,presentDrillDown:h,getMonthlyReportFields:M,showPrintWindow:P,buildTimeIntervalFields:p,gotoPatientDashboard:F,reportData:a,rows:v,period:y,fields:g,columns:T,title:x}}export{q as A};
