System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-iBlnUK4E.js","./tx_report_service-legacy-upQL0aoD.js","./TableReportTemplate-legacy-Lwzk_ZnC.js","./index-legacy-2bdI6aeZ.js","./moh_cohort_service-legacy-r9GjLt8k.js","./MultiFieldDateHelper-legacy-ABlXxdvs.js","./dynamic-import-helper-legacy-BhGHTWZn.js","./KbLayouts-legacy-NQmKRJpJ.js","./HisKbConfigurations-legacy-AV_G95Cg.js","./BasicReportTemplate-legacy--ps8EHUm.js","./Export-legacy-cuEy_-Nh.js","./SIngleTouchField-legacy-hpCyTWH6.js","./Pagination-legacy-rUvGUE2N.js","./HisStandardForm-legacy-lMXEnQxA.js","./TouchScreenForm-legacy-H8a4O6o5.js","./ToolbarMediumCard-legacy-EA1aA9jU.js","./Transformers-legacy-PbfCTy2a.js","./ViewPort-legacy-AULqwBLs.js","./ReportErrors-legacy-IkveOCYc.js"],(function(t,e){"use strict";var s,o,r,i,a,l,n,h,c,d,u,p,f;return{setters:[t=>{s=t._},t=>{o=t.T},t=>{r=t.R},t=>{i=t.d,a=t.L,l=t.cx,n=t._,h=t.r,c=t.o,d=t.c,u=t.w,p=t.b},t=>{f=t.M},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=i({mixins:[s],components:{ReportTemplate:r},data:()=>({title:"TX Curr MMD Report",cohort:{},rows:[],totals:new Set,errors:[],showStatus:!1,columns:[[a.thTxt("Age group"),a.thTxt("Gender"),a.thNum("# of clients on <3 months of ARVs"),a.thNum("# of clients on 3 - 5 months of ARVs"),a.thNum("# of clients on >= 6 months of ARVs")]],headerInfoList:[],mohCohort:{},canValidate:!1}),watch:{async canValidate(t){t&&await this.validateReport()}},created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.canValidate=!1,this.totals.clear(),this.errors=[],this.showStatus=!1,this.rows=[],this.report=new o,this.mohCohort=new f,this.mohCohort.setOccupation(e.occupation),this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.report.initArvRefillPeriod(!0),await this.setRows(),this.canValidate=!0,this.showStatus=!0,this.setHeaderInfoList()},getValues(t,e){const s=[],o=[],r=[];for(const i in t){const e=t[i].prescribed_days;this.totals.add(i),e<90&&s.push(i),e>=90&&e<=150&&o.push(i),e>150&&r.push(i)}return[this.drill(s,`# of clients on < 3 months of ARVs (${e})`),this.drill(o,`# of clients on 3 - 5 months of ARVs (${e})`),this.drill(r,`# of clients on  >= 6 months of ARVs (${e})`)]},async setRows(){let t=0,e=0;const s=[],o=[];for(const r in l){const i=l[r];if("<1 year"===i)t=0,e=0;else if("90 plus years"===i)t=90,e=1e4;else{const[s,o]=i.split("-");t=parseInt(s),e=parseInt(o)}const n=await this.report.getTxCurrMMDReport(t,e);this.report.initArvRefillPeriod(!1),n?(o.push([a.td(i),a.td("Female"),...this.getValues(n.Female,`${i} Female`)]),s.push([a.td(i),a.td("Male"),...this.getValues(n.Male,`${i} Male`)])):(o.push([a.td(i),a.td("Female"),a.td(0),a.td(0),a.td(0)]),s.push([a.td(i),a.td("Male"),a.td(0),a.td(0),a.td(0)])),this.rows=[...o,...s]}},setHeaderInfoList(){this.headerInfoList=[{label:"Total clients",value:this.totals.size,other:{onclick:()=>this.runTableDrill(Array.from(this.totals),"Total Clients")}}]},validateReport(){const t={total_alive_and_on_art:{param:this.totals.size,check:(t,e)=>e>t,error:(t,e)=>`\n                        MoH cohort Alive and on ART clients <b>(${t})</b> is not\n                        matching with total TX MMD clients <b>(${e})</b>.\n                    `}};-1===this.mohCohort.validateIndicators(t,(t=>this.errors=t))&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}});t("default",n(e,[["render",function(t,e,s,o,r,i){const a=h("report-template"),l=h("ion-page");return c(),d(l,null,{default:u((()=>[p(a,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,reportPrefix:"PEPFAR",config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerInfoList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])])),_:1})}]]))}}}));
