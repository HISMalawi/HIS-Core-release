System.register(["./index-legacy-Dg5P6bX-.js","./dynamic-import-helper-legacy-arUa2LZV.js","./HisStandardForm-legacy-BXV61qjj.js","./useEncounter-legacy-Bp6E5sCN.js","./util-legacy-CjANJSja.js","./commons-legacy-CiEua9CM.js","./LocationFieldOptions-legacy-dM5Ij6EC.js","./TouchScreenForm-legacy-Bqug27CT.js","./ToolbarMediumCard-legacy-DWokgyDV.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-D3j1oaCn.js","./isEmpty-legacy-rdjCNuhy.js","./_Set-legacy-BL8ow4HL.js","./_setToArray-legacy-jEwcQpqP.js","./encounter_guidelines-legacy-mRSBdMQj.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,l,i,n,o,r,c,s,u,d,E,T,p,_,g,S,N,v,y,m,A;return{setters:[e=>{a=e.d,l=e.K,i=e.b5,n=e.cV,o=e.V,r=e.cY,c=e.o,s=e.c,u=e.w,d=e.b,E=e.cl,T=e.ag,p=e.b9,_=e.cW,g=e.I},e=>{S=e.F},e=>{N=e.H},e=>{v=e.u},e=>{y=e.g},e=>{m=e.r},e=>{A=e.g},null,null,null,null,null,null,null,null,null],execute:function(){e("default",a({__name:"Reception",setup(e){const t=l([]),a=new i(-1,n.TB_RECEPTION),{goToNextTask:R,patientDashboardUrl:h}=v(((e,l,i)=>{a.patientID=l,a.providerID=e,t.value=[{id:"treatForIpt",helpText:"Enroll in TPT program?",type:S.TT_SELECT,requireNext:!1,options:()=>[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}],validation:e=>o.required(e),condition:()=>i.getAge()>=0&&i.getAge()<r},{id:"catchmentArea",helpText:"Patient living within catchment area?",type:S.TT_SELECT,requireNext:!1,Validation:e=>o.required(e),computedValue:e=>({concept_id:y("LIVES_NEAR"),value_coded:y(`${e.value}`),obs_datetime:a.date}),options:()=>[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}]},{id:"livesNearTB",helpText:"Patient living near a TB registration centre?",type:S.TT_SELECT,requireNext:!1,computedValue:e=>({concept_id:y("TRANSFERRED_OUT_EXTERN"),value_coded:y(`${e.value}`),obs_datetime:a.date}),options:()=>[{value:"YES_ANSWER",label:"Yes"},{value:"NO_ANSWER",label:"No"}],validation:e=>o.required(e),condition:e=>"NO_ANSWER"===e.catchmentArea.value},{id:"locationId",type:S.TT_SELECT,helpText:"Select TB Registration Centre:",computedValue:e=>({concept_id:y("FACILITY_NAME"),value_text:e.label,obs_datetime:a.date}),options:(e,t="")=>A(t),config:{showKeyboard:!0,isFilterDataViaApi:!0},validation:e=>o.required(e),condition:e=>"YES_ANSWER"===e.livesNearTB.value,requireNext:!1}]}));async function b(e,t){if("NO_ANSWER"===e.treatForIpt?.value)return T.push(h.value);await a.createEncounter(),await a.saveObservationList(await m(t));const l=new p(a.patientID);l.setStateDate(a.date);try{await l.enrollProgram()}catch(i){console.warn(`${i}`)}"YES_ANSWER"===e.treatForIpt?.value&&l.setStateId(_.TPT),"YES_ANSWER"===e.livesNearTB?.value&&l.setStateId(_.TRANSFER_OUT),-1!=l.stateId&&await l.updateState(),R()}return(e,a)=>(c(),s(E(g),null,{default:u((()=>[d(N,{cancelDestinationPath:E(h),onFinishAction:b,fields:t.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
