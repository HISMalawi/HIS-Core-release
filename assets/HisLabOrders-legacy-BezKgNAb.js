System.register(["./index-legacy-2OuOZQ1w.js","./LabOrderModal-legacy-C63c6_5L.js","./FieldMixin.vue_vue_type_script_lang-legacy-dDuAoURA.js","./VoidReason-legacy-Sz1tr4lF.js","./lab_order_service-legacy-BUwyFfNb.js"],(function(e,t){"use strict";var r,d,s,n,i,a,o,l,c,u,h,m,_,p,y,g,f,v,b,w,O,D,k,x,S,C,$,j,F,T,A,H,P,z,E;return{setters:[e=>{r=e.d,d=e.H,s=e.et,n=e.eu,i=e.ev,a=e.aE,o=e.i,l=e.c1,c=e.dG,u=e.p,h=e.y,m=e.q,_=e.z,p=e.a_,y=e.cw,g=e.S,f=e.aw,v=e.am,b=e.ar,w=e.a,O=e.b,D=e.w,k=e.g,x=e.h,S=e.a9,C=e.aa,$=e.t,j=e.j,F=e.aP,T=e.e,A=e.ak,H=e.al},e=>{P=e.L},e=>{z=e._},e=>{E=e.p},null],execute:function(){var t=document.createElement("style");t.textContent="table[data-v-07fd4d82]{font-family:arial,sans-serif;border-collapse:collapse;width:100%}td[data-v-07fd4d82],th[data-v-07fd4d82]{border:1px solid #dddddd;text-align:left;padding:8px}tr[data-v-07fd4d82]:nth-child(2n){background-color:#ddd}\n/*$vite$:1*/",document.head.appendChild(t);const I=r({components:{ViewPort:l,IonButton:o,IonIcon:a},mixins:[z],data:()=>({trash:i,print:n,pencil:s,HisDate:d,rows:[],fetchingOrders:!1,ordersToday:{}}),methods:{async init(){this.$emit("onFieldActivated",this),this.fetchingOrders=!0;let e=[];try{e=await this.options(this.fdata)}catch(r){console.error(`${r}`)}this.fetchingOrders=!1;const t=e[0].other.values;this.ordersToday=t.reduce(((e,t)=>(y(t.ordered)!==y(g.getSessionDate())||t.result.length||(e[t.test_name]=!0),e)),{}),this.rows=t.map((e=>(e.id=e.order_id,e.ordered&&(e.ordered=d.toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=d.toStandardHisDisplayFormat(e.released)),e)))},async printOrder(e){if(y(e.ordered)!=y(g.getSessionDate()))return m(`Printing order #${e.accession_number} is restricted to today. Consider using BDE mode/set session date to the order date`);"function"==typeof this.config?.printOrder&&await f(`Do you want to print order with accession number ${e.accession_number}?`)&&this.config.printOrder(e.id)},formatOrders:e=>e.map((e=>({id:e.order_id,encounter_id:e.encounter_id,result_given:e.result_given,accession_number:e.accession_number,test_name:e.tests[0].name,specimen:e.specimen.name,ordered:d.toStandardHisDisplayFormat(e.order_date),result:[],release:""}))),async launchOrderSelection(e=null){if(this.fetchingOrders)return m("Please wait....");const t=await _.create({component:P,backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:e,ordersToday:this.ordersToday,onOrderAdded:e=>this.ordersToday[e]=!0}});t.present();const{data:r}=await t.onDidDismiss();p.isEmpty(r)||(this.rows=[...this.formatOrders(r),...this.rows])},voidOrder(e){E((async t=>{new c(-1).voidOrder(e.order_id,t).then((()=>{this.rows=this.rows.filter((t=>t.order_id!=e.order_id)),u("Record has been voided successfully!")})).catch((e=>{h(`An error has occured while deleting order: ${e}`)}))}))}},mounted(){this.init()},activated(){this.init()}}),R=e=>(A("data-v-07fd4d82"),e=e(),H(),e),B={class:"view-port-content"},L={class:"his-sm-text"},V=R((()=>k("tr",null,[k("th",null,"Accession #"),k("th",null,"Test Name"),k("th",null,"Specimen"),k("th",null,"Ordered"),k("th",null,"Result"),k("th",null,"Released"),k("th",null,"Given"),k("th",null,"Action")],-1))),G=R((()=>k("br",null,null,-1)));e("default",v(I,[["render",function(e,t,r,d,s,n){const i=b("ion-icon"),a=b("ion-button"),o=b("view-port");return O(),w(o,null,{default:D((()=>[k("div",B,[k("table",L,[V,(O(!0),x(S,null,C(e.rows,((t,r)=>(O(),x("tr",{key:r},[k("td",null,$(t.accession_number),1),k("td",null,$(t.test_name),1),k("td",null,$(t.specimen),1),k("td",null,$(t.ordered),1),k("td",null,[(O(!0),x(S,null,C(t.result,((e,t)=>(O(),x("span",{key:t},[j($(e)+" ",1),G])))),128))]),k("td",null,$(t.released),1),k("td",null,[k("span",{style:F("color: "+("Yes"===t.result_given?"green;":"black;"))},$(t.result_given),5)]),k("td",null,[T(a,{onClick:r=>e.printOrder(t)},{default:D((()=>[T(i,{size:"large",icon:e.print},null,8,["icon"])])),_:2},1032,["onClick"]),T(a,{disabled:!!t.delivery_mode&&"test_results_delivered_to_site_manually"!=t.delivery_mode,color:"success"},{default:D((()=>[T(i,{size:"large",icon:e.pencil},null,8,["icon"])])),_:2},1032,["disabled"]),T(a,{disabled:"test_results_delivered_to_site_manually"!=t.delivery_mode&&(t.result??[]).length>=1,onClick:r=>e.voidOrder(t),color:"danger"},{default:D((()=>[T(i,{size:"large",icon:e.trash},null,8,["icon"])])),_:2},1032,["disabled","onClick"])])])))),128))])])])),_:1})}],["__scopeId","data-v-07fd4d82"]]))}}}));
