import{d as Z,R as K,W as X,aw as Y,a1 as A,a3 as J,a4 as Q,r as B,ap as $,cW as x,aU as H,aM as q,cX as ee,cY as te,cZ as ae,a6 as oe,ab as N,u as i,B as m,G as P,E as T,C as E,x as p,w as d,v as D,H as j,Z as S,b9 as le,z as V,c_ as ne,a as se,cn as re,y,bc as F,b7 as W,bb as ue,bI as ie}from"./index-ii3Qn3XY.js";const de=Z({components:{IonToolbar:K,IonItem:X,IonIcon:Y,IonLabel:A,IonButton:J,IonFooter:Q},props:{columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},rowsPerPage:{type:Number,default:10},defaultSortedColumn:{type:String},defaultSortOrder:{type:Object}},setup(e){const c=B([]),v=B(0),w=B(""),C=B("desc"),g=$(()=>{let n=c.value;return C.value&&w.value&&(n=x(c.value)[C.value](u=>u.sortData[w.value])),n}),s=$(()=>H.chunk(g.value,e.rowsPerPage).length),R=$(()=>v.value+2<=s.value),L=$(()=>v.value>0),a=$(()=>H.chunk(g.value,e.rowsPerPage)[v.value]),t=n=>{w.value=n,C.value=C.value==="asc"?"desc":"asc"},o=()=>ae(n=>{const u=parseInt(n);parseInt(n)<=s.value&&(v.value=u)},{title:"Select page"}),r=()=>v.value=0,k=()=>v.value=s.value-1||0,l=()=>v.value+=1,b=()=>v.value-=1,h=n=>{var u,I;try{typeof((u=n.column)==null?void 0:u.tdClick)=="function"&&((I=n.column)==null||I.tdClick(n));return}catch(O){console.error(O)}},z=()=>e.columns.reduce((n,u)=>n.concat(u),[]).filter(n=>n.value||n.ref),M=n=>{n.forEach(u=>{const I={...u},O=z().map(f=>{let _="";const U=u[f.ref];try{H.isEmpty(u)?_="":typeof f.toValue=="function"?_="".concat(f.toValue(U)):typeof f.value=="function"?_=f.value(u):_=u[f.ref]||""}catch(G){_=(f==null?void 0:f.defaultValue)||"_ERROR_",console.error(G)}return I[f.ref]=_,typeof f.sortValue=="function"&&(I[f.ref]=f.sortValue(U)),{column:f,refData:U,value:_,data:u}});c.value.push({row:O,data:u,sortData:I,searchIndex:[...O,O.map(f=>f.value).join(" ")]})})};return q(()=>e.columnData,n=>{var u;if(c.value=[],!Array.isArray(n)||!n.length){v.value=0,w.value=(u=e.defaultSortedColumn)!=null?u:"",C.value=e.defaultSortOrder||"desc",M(Array.from({length:0}).map(()=>({})));return}M(n)},{immediate:!0,deep:!0}),{first:r,last:k,next:l,prev:b,selectPage:o,sortColumn:t,onClickTablecell:h,close,arrowUp:ee,arrowDown:te,page:a,canNext:R,totalPages:s,sortOrder:C,canPrev:L,currentPage:v,columnSorted:w}}}),ce={style:{width:"100%"}},fe={class:"stick-report-header"},pe=["colspan","rowspan","onClick"],ve=["onClick"],ge=["innerHTML"];function me(e,c,v,w,C,g){const s=N("ion-icon"),R=N("ion-label"),L=N("ion-item"),a=N("ion-button"),t=N("ion-toolbar"),o=N("ion-footer");return i(),m(T,null,[P("div",null,[P("table",ce,[P("thead",fe,[(i(!0),m(T,null,E(e.columns,(r,k)=>(i(),m("tr",{key:k},[(i(!0),m(T,null,E(r,(l,b)=>{var h,z;return i(),m("th",{key:b,colspan:((h=l==null?void 0:l.span)==null?void 0:h.thColspan)||1,rowspan:((z=l==null?void 0:l.span)==null?void 0:z.thRowspan)||1,onClick:M=>e.sortColumn(l.ref)},[p(L,{lines:"none"},{default:d(()=>[e.columnSorted&&e.columnSorted===l.ref?(i(),D(s,{key:0,icon:e.sortOrder==="asc"?e.arrowUp:e.arrowDown},null,8,["icon"])):j("",!0),p(R,null,{default:d(()=>[P("b",null,S(l.label),1)]),_:2},1024)]),_:2},1024)],8,pe)}),128))]))),128))]),P("tbody",null,[(i(!0),m(T,null,E(e.page,(r,k)=>(i(),m("tr",{key:k},[(i(!0),m(T,null,E(r.row,(l,b)=>{var h;return i(),m("td",{key:b,onClick:()=>e.onClickTablecell(l),class:le({"clickable-cell":(h=l==null?void 0:l.column)==null?void 0:h.tdClick})},[P("span",{innerHTML:l.value,class:"his-sm-text"},null,8,ge)],10,ve)}),128))]))),128))])])]),c[4]||(c[4]=P("p",null,null,-1)),p(o,null,{default:d(()=>[p(t,{color:"light"},{default:d(()=>[e.totalPages>1?(i(),D(a,{key:0,onClick:e.first,disabled:e.currentPage===0||e.totalPages<=2,size:"large",slot:"end"},{default:d(()=>c[0]||(c[0]=[V(" First ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(i(),D(a,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:d(()=>c[1]||(c[1]=[V(" Prev ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(i(),D(a,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:d(()=>[V(S(e.currentPage)+" / "+S(e.totalPages-1),1)]),_:1},8,["onClick"])):j("",!0),e.totalPages>1?(i(),D(a,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:d(()=>c[2]||(c[2]=[V(" Next ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(i(),D(a,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:d(()=>c[3]||(c[3]=[V(" Last ")])),_:1},8,["onClick","disabled"])):j("",!0)]),_:1})]),_:1})],64)}const ke=oe(de,[["render",me],["__scopeId","data-v-6173022f"]]),be={key:0},ye={key:1,class:"his-card ion-text-center his-lg-text"},Ce=Z({__name:"HomeNotifications",setup(e){const{sortedNotifications:c,hasNotifications:v,clearNotification:w,openNotification:C}=ne(),g=B("highVL"),s=se({highVL:[],rejectedVL:[],normalVL:[],initiatedData:{},stats:{}}),R=$(()=>[[{ref:"arv",label:"ARV #"},{ref:"accession",label:"Accession #"},{ref:"order_date",label:"Order Date",toValue:a=>"".concat(re(a))},...g.value==="rejectedVL"?[{ref:"rejection_reason",label:"Rejection Reason"}]:[],{ref:"id",label:"View",toValue:()=>"View",tdClick:a=>C(a.data)},{ref:"id",label:"Clear",toValue:()=>"Clear",tdClick:a=>w(a.refData,t=>{s[g.value]=s[g.value].filter(o=>o.id!=t)})}]]);async function L(a,t=c.value){var k,l,b;if(t.length&&s.initiatedData[a])return;let o=6e3;const r=H.chunk((b=(l=(k=t==null?void 0:t[0])==null?void 0:k.vlMessageObs)==null?void 0:l[a])!=null?b:{},7);s.initiatedData[a]=t.length>0,s[a]=[];for(const h of r)s[a]=[...s[a],...h],await ie(o),o=80}return q(c,async a=>{L(g.value,a),setTimeout(()=>{var o,r,k,l,b;const t=(r=(o=a==null?void 0:a[0])==null?void 0:o.vlMessageObs)!=null?r:{};s.stats.highVL=((k=t.highVL)!=null?k:[]).length,s.stats.normalVL=((l=t.normalVL)!=null?l:[]).length,s.stats.rejectedVL=((b=t.rejectedVL)!=null?b:[]).length},450)},{immediate:!0,deep:!0}),(a,t)=>(i(),m("div",null,[y(v)?(i(),m("div",be,[p(y(ue),{mode:"ios",modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=o=>g.value=o),class:"ion-justify-content-center"},{default:d(()=>[p(y(F),{onClick:t[0]||(t[0]=o=>L("highVL")),value:"highVL"},{default:d(()=>[p(y(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[4]||(t[4]=[V("High Vl")])),_:1}),p(y(W),{color:"danger"},{default:d(()=>{var o,r;return[V(S((r=(o=s.stats)==null?void 0:o.highVL)!=null?r:"-"),1)]}),_:1})]),_:1}),p(y(F),{onClick:t[1]||(t[1]=o=>L("rejectedVL")),value:"rejectedVL"},{default:d(()=>[p(y(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[5]||(t[5]=[V("Rejected")])),_:1}),p(y(W),{color:"warning"},{default:d(()=>{var o,r;return[V(S((r=(o=s.stats)==null?void 0:o.rejectedVL)!=null?r:"-"),1)]}),_:1})]),_:1}),p(y(F),{onClick:t[2]||(t[2]=o=>L("normalVL")),value:"normalVL"},{default:d(()=>[p(y(A),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:d(()=>t[6]||(t[6]=[V("Normal Results")])),_:1}),p(y(W),{color:"success"},{default:d(()=>{var o,r;return[V(S((r=(o=s.stats)==null?void 0:o.normalVL)!=null?r:"-"),1)]}),_:1})]),_:1})]),_:1},8,["modelValue"]),t[7]||(t[7]=P("p",null,null,-1)),(i(),D(ke,{key:g.value,columns:R.value,"column-data":s[g.value],"rows-per-page":7},null,8,["columns","column-data"]))])):(i(),m("div",ye," No notifications "))]))}});export{Ce as default};
