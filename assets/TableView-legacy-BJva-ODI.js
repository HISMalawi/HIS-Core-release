System.register(["./index-legacy-DzF0J2nr.js","./PopupKeyboard-legacy-D5AXh9gb.js","./fuse-legacy-CQoBB3MK.js","./Export-legacy-nGdXEsf9.js","./HisKeyboard-legacy-BA3ln4in.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./KbHandler-legacy-De8o5nTq.js"],(function(e,l){"use strict";var t,o,a,n,r,c,s,i,u,d,f,p,h,g,y,b,m,k,v,C,P,x,w,_,I,S,V,z,T,K,F,D,$,j,H,R,U,E,M,O,Q,A,B,L,N,Y,q,G,W,J,X;return{setters:[e=>{t=e.d,o=e.i,a=e.h,n=e.ao,r=e.C,c=e.k,s=e.j,i=e.f,u=e.m,d=e.l,f=e.bh,p=e.an,h=e.bo,g=e.bp,y=e.J,b=e.K,m=e.M,k=e.a8,v=e.cd,C=e.ce,P=e.cf,x=e.cg,w=e.ch,_=e.ci,I=e.a$,S=e.S,V=e.cj,z=e.ab,T=e.bq,K=e.ck,F=e._,D=e.r,$=e.o,j=e.x,H=e.b,R=e.w,U=e.c,E=e.z,M=e.u,O=e.v,Q=e.A,A=e.F,B=e.y,L=e.ar},e=>{N=e.n},e=>{Y=e.F},e=>{q=e.a,G=e.t},e=>{W=e.H},e=>{J=e.Q},e=>{X=e.k}],execute:function(){var l=document.createElement("style");l.textContent="th[data-v-540e223c],td[data-v-540e223c]{width:4%;border-collapse:collapse;text-align:center}td[data-v-540e223c]{border-bottom:1px solid rgb(165,165,165);padding:.6em;font-weight:500;font-size:.8em}.stick-report-header[data-v-540e223c]{background:#fff;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:1000}tr[data-v-540e223c]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-540e223c]{color:#0645ad;font-weight:600;font-size:1em}.his-floating-keyboard[data-v-540e223c]{bottom:70px!important}\n",document.head.appendChild(l);const Z=t({components:{IonToolbar:o,IonItem:a,IonIcon:n,IonLabel:r,IonTitle:c,IonHeader:s,IonButton:i,IonFooter:u,IonContent:d,IonButtons:f,IonChip:p,HisKeyboard:W,IonThumbnail:h,IonImg:g},props:{title:{type:String,default:"Report"},headerBadge:{type:Object},iconUrl:{type:String},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},enablePagination:{type:Boolean,default:!0},rowsPerPage:{type:Number,default:10},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},reportPrefix:{type:String,default:""}},setup(e){const l=y(),t=b([]),o=b(0),a=b(""),n=b(""),r=b("desc"),c=b(!1),s=m((()=>{let l=t.value;return r.value&&n.value&&(l=V(t.value)[r.value]((e=>e.data[n.value]))),a.value?new Y(l,{threshold:.3,keys:["searchIndex"],useExtendedSearch:!0}).search(a.value,{limit:e.rowsPerPage}).map((e=>e.item)):l})),i=m((()=>z.chunk(s.value,e.rowsPerPage).length)),u=m((()=>o.value+2<=i.value)),d=m((()=>o.value>0)),f=m((()=>z.chunk(s.value,e.rowsPerPage)[o.value])),p=()=>e.columns.reduce(((e,l)=>e.concat(l)),[]).filter((e=>e.value||e.ref)),h=l=>{const o=p().filter((e=>[!e.canExport||e?.canExport[l],"boolean"!=typeof e.exportable||e.exportable].every(Boolean))),a=o.map((e=>e.exportedValue&&e.exportedValue.column?e.exportedValue.column(e):e.secondaryLabel||e.label)),n=o.map((e=>e.ref));return{headers:a,rows:t.value.reduce(((e,l)=>[...e,l.row.filter((({column:e})=>n.includes(e.ref))).map((e=>e.column.exportedValue&&e.column.exportedValue.dataValue?e.column.exportedValue.dataValue(e):e.value))]),[]),filename:`${e.reportPrefix} ${S.getLocationName()??""} ${T(e.title).replace(e.reportPrefix,"")} ${K(e.csvQuarter??e.subtitle??"")}`}},g=e=>{e.forEach((e=>{const l=p().map((l=>{let t="";const o=e[l.ref];try{t=z.isEmpty(e)?"...":"function"==typeof l.toValue?`${l.toValue(o)}`:"function"==typeof l.value?l.value(e):e[l.ref]||""}catch(a){t=l?.defaultValue||"_ERROR_",console.error(a)}return{column:l,refData:o,value:t,data:e}}));t.value.push({row:l,data:e,searchIndex:[...l,l.map((e=>e.value)).join(" ")]})}))};return k((()=>e.columnData),(l=>{if(t.value=[],!Array.isArray(l)||!l.length)return o.value=0,a.value="",n.value="",void g(Array.from({length:e.rowsPerPage}).map((()=>({}))));g(l)}),{immediate:!0,deep:!0}),{first:()=>o.value=0,last:()=>o.value=i.value-1||0,next:()=>o.value+=1,prev:()=>o.value-=1,selectPage:()=>N((e=>{const l=parseInt(e);parseInt(e)<=i.value&&(o.value=l)}),{title:"Select page"}),sortColumn:e=>{n.value=e,r.value="asc"===r.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(l){console.error(l)}},toPDF:()=>{const{headers:e,rows:l,filename:t}=h("pdf");q([e],l,t,!0)},toCSV:()=>{const{headers:l,rows:t,filename:o}=h("csv");G([l],[...t,[`Date Created: ${I().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${S.getCoreVersion()}`],[`API Version: ${S.getApiVersion()}`],[`Site UUID: ${S.getSiteUUID()}`],[`Generated by: ${S.getUserName()}`]],o)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():l.push("/")},filterTable:e=>{a.value=X(e,a.value),o.value=0},sync:v,search:C,close:P,arrowUp:x,arrowDown:w,funnelOutline:_,page:f,canNext:u,searchTerm:a,totalPages:i,sortOrder:r,canPrev:d,currentPage:o,columnSorted:n,QWERTY:J,showSearchKeyboard:c}}}),ee={key:0},le={class:"his-sm-text"},te={class:"art-report-theme"},oe={class:"stick-report-header"},ae=["colspan","rowspan","onClick"],ne=["onClick"],re={class:"his-sm-text"};e("v",F(Z,[["render",function(e,l,t,o,a,n){const r=D("ion-img"),c=D("ion-thumbnail"),s=D("ion-title"),i=D("ion-icon"),u=D("ion-button"),d=D("ion-label"),f=D("ion-chip"),p=D("ion-buttons"),h=D("ion-toolbar"),g=D("ion-header"),y=D("ion-item"),b=D("ion-content"),m=D("his-keyboard"),k=D("ion-footer");return $(),j(A,null,[H(g,null,{default:R((()=>[H(h,null,{default:R((()=>[e.iconUrl?($(),U(c,{key:0,slot:"start"},{default:R((()=>[H(r,{src:e.iconUrl},null,8,["src"])])),_:1})):E("",!0),H(s,{slot:"start",class:"his-md-text"},{default:R((()=>[M(O(e.title)+" ",1),e.subtitle?($(),j("br",ee)):E("",!0),Q("span",le,O(e.subtitle),1)])),_:1}),H(p,{slot:"end"},{default:R((()=>["function"==typeof e.onConfigure?($(),U(u,{key:0,onClick:l[0]||(l[0]=()=>e.onConfigure?e.onConfigure():null)},{default:R((()=>[H(i,{size:"large",icon:e.funnelOutline},null,8,["icon"])])),_:1})):E("",!0),e.searchTerm?($(),U(f,{key:1,onClick:l[1]||(l[1]=()=>{e.searchTerm="",e.showSearchKeyboard=!1}),class:"his-md-text",color:"primary"},{default:R((()=>[H(d,null,{default:R((()=>[M(O(e.searchTerm?`Search: ${e.searchTerm}`:""),1)])),_:1}),H(i,{icon:e.close},null,8,["icon"])])),_:1})):E("",!0),H(u,{color:e.showSearchKeyboard?"primary":"dark",onClick:l[2]||(l[2]=()=>e.showSearchKeyboard=!e.showSearchKeyboard),size:"large"},{default:R((()=>[H(i,{size:"large",icon:e.search},null,8,["icon"])])),_:1},8,["color"]),"function"==typeof e.onRefresh?($(),U(u,{key:2,onClick:l[3]||(l[3]=()=>e.onRefresh?e.onRefresh():null),color:"success",size:"large"},{default:R((()=>[H(i,{size:"large",icon:e.sync},null,8,["icon"])])),_:1})):E("",!0)])),_:1})])),_:1}),(e.headerBadge||[]).length?($(),U(h,{key:0,color:"light"},{default:R((()=>[($(!0),j(A,null,B(e.headerBadge,((l,t)=>($(),U(f,{onClick:e=>"function"==typeof l.action?l.action():null,key:t,color:l?.color||"dark"},{default:R((()=>[H(i,{icon:l?.icon||e.search},null,8,["icon"]),H(d,{innerHTML:l?.text},null,8,["innerHTML"])])),_:2},1032,["onClick","color"])))),128))])),_:1})):E("",!0)])),_:1}),H(b,{"scroll-y":"","scroll-x":""},{default:R((()=>[Q("table",te,[Q("thead",oe,[($(!0),j(A,null,B(e.columns,((l,t)=>($(),j("tr",{key:t},[($(!0),j(A,null,B(l,((l,t)=>($(),j("th",{key:t,colspan:l?.span?.thColspan||1,rowspan:l?.span?.thRowspan||1,onClick:t=>e.sortColumn(l.ref)},[H(y,{lines:"none"},{default:R((()=>[e.columnSorted&&e.columnSorted===l.ref?($(),U(i,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):E("",!0),H(d,{class:"ion-text-center"},{default:R((()=>[Q("b",null,O(l.label),1)])),_:2},1024)])),_:2},1024)],8,ae)))),128))])))),128))]),Q("tbody",null,[($(!0),j(A,null,B(e.page,((l,t)=>($(),j("tr",{key:t},[($(!0),j(A,null,B(l.row,((l,t)=>($(),j("td",{key:t,onClick:()=>e.onClickTablecell(l),class:L({"clickable-cell":l?.column?.tdClick})},[Q("span",re,O(l.value),1)],10,ne)))),128))])))),128))])])])),_:1}),H(k,null,{default:R((()=>[e.showSearchKeyboard?($(),U(m,{key:0,kbConfig:e.QWERTY,onKeyPress:e.filterTable},null,8,["kbConfig","onKeyPress"])):E("",!0),H(h,{color:"dark"},{default:R((()=>[H(u,{onClick:l[4]||(l[4]=l=>e.toCSV()),size:"large"},{default:R((()=>[M(" CSV ")])),_:1}),H(u,{onClick:l[5]||(l[5]=l=>e.toPDF()),size:"large"},{default:R((()=>[M(" PDF ")])),_:1}),e.totalPages>1?($(),U(u,{key:0,onClick:e.first,disabled:0===e.currentPage||e.totalPages<=2,size:"large",slot:"end"},{default:R((()=>[M(" First ")])),_:1},8,["onClick","disabled"])):E("",!0),e.totalPages>1?($(),U(u,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:R((()=>[M(" Prev ")])),_:1},8,["onClick","disabled"])):E("",!0),e.totalPages>1?($(),U(u,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:R((()=>[M(O(e.currentPage)+" / "+O(e.totalPages-1),1)])),_:1},8,["onClick"])):E("",!0),e.totalPages>1?($(),U(u,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:R((()=>[M(" Next ")])),_:1},8,["onClick","disabled"])):E("",!0),e.totalPages>1?($(),U(u,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:R((()=>[M(" Last ")])),_:1},8,["onClick","disabled"])):E("",!0),H(u,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:R((()=>[M(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-540e223c"]]))}}}));
