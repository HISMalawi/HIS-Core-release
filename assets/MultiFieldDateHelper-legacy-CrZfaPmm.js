System.register(["./dynamic-import-helper-legacy-DYK5bIOV.js","./index-legacy-Dab_9-0G.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js"],(function(e,a){"use strict";var t,n,i,o,l,u,r,s;return{setters:[e=>{t=e.F},e=>{n=e.V,i=e.H,o=e.a$,l=e.S,u=e.b0},e=>{r=e.N},e=>{s=e.a}],execute:function(){e("g",(function(e){let d="",y="",v="",h="",b=!1;const $=`year_${e.id}`,x=`month_${e.id}`,g=`day_${e.id}`,T=`age_estimate_${e.id}`,D=`duration_estimate_${e.id}`,w=function(e,a,n=!0){const i=[];return n&&i.push("UNKNOWN"),{id:e,helpText:`${a} Year`,appearInSummary:()=>!1,type:t.TT_TEXT,config:{customKeyboard:[r,[i,["DELETE"]]]}}}($,e.helpText,e.estimation.allowUnknown),V=(_=x,Y=e.helpText,{id:_,helpText:`${Y} Month`,appearInSummary:()=>!1,type:t.TT_SELECT,options:()=>a}),N=function(e,a){return{id:e,helpText:`${a} Day`,type:t.TT_MONTHLY_DAYS,appearInSummary:()=>!1}}(g,e.helpText),S=function(e,a){return{id:e,helpText:`${a} Age Estimate`,type:t.TT_NUMBER,appearInSummary:()=>!1,config:{keypad:s}}}(T,e.helpText),I=function(e,a){return{id:e,helpText:`${a} Estimated period`,type:t.TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}(D,e.helpText),k="boolean"==typeof e.estimation.allowUnknownMonthDay&&e.estimation.allowUnknownMonthDay,E=a=>!(a[$]&&a[$].value&&["Unknown"].includes(a[$].value))&&(!e.condition||e.condition(a)),M=(e,a)=>[{type:"year",value:y,default:"YYYY"},{type:"month",value:v,default:"MM"},{type:"day",value:h,default:"DD"}].reduce(((t,n)=>{const i=[null,void 0,"Unknown",""];return a===n.type?i.includes(e)?t.push(n.default):t.push(e):i.includes(n.value)?t.push(n.default):t.push(n.value),t}),[]).join("-");var _,Y;"function"==typeof e.init&&(w.init=e.init),w.updateHelpTextOnValue=e=>`${w.helpText} (${M(e?.label,"year")})`,w.proxyID=e.id,w.unload=e=>y=e.value.toString(),w.config={...w.config,...e.config},w.defaultValue=a=>p(a,e,"Year"),w.condition=a=>!e.condition||e.condition(a),w.validation=(a,t,o)=>{if(e.required&&n.required(a))return["Year cannot be empty"];const l=a?a.value:"";if(!e.estimation.allowUnknown&&l.toString().match(/unknown/i))return["Value unknown is not permitted"];if(l&&!["Unknown"].includes(l)&&isNaN(l)||l<1900)return["Invalid Year"];if(l&&"function"==typeof e.minDate){const a=i.getYear(e.minDate(t,o));if(parseInt(l)<a)return[`Year of ${l} is less than Minimum year of ${a}`]}if(l&&"function"==typeof e.maxDate){const a=e.maxDate(t,o);if(a&&l>i.getYear(a))return[`Year of ${l} exceeds Maximum year of ${i.getYear(a)}`]}return null},w.summaryMapValue=()=>({label:e.summaryLabel||e.helpText,value:d?m(d):"Unknown"}),w.appearInSummary=(a,t)=>t===e.id,w.computedValue=a=>{if(d){const[,t,n]=d.split("-");return d=`${a.value}-${t}-${n}`,e.computeValue(d,!1)}if(a&&"Unknown"===a.value)return d="",e.computeValue("Unknown",!1)},V.updateHelpTextOnValue=e=>`${V.helpText} (${M(e?.label,"month")})`,V.proxyID=e.id,V.unload=e=>v=c(e.value.toString()),V.condition=e=>E(e),V.validation=e=>n.required(e),V.defaultValue=a=>p(a,e,"Month"),k&&(V.options=()=>[...a,{label:"Unknown",value:"Unknown"}]),V.computedValue=(a,t)=>{if(`${a.value}`.match(/unknown/i))return d=`${t[$].value}-07-15`,e.computeValue(d,!0);if(d){const[t,,n]=d.split("-"),i=c(`${a.value}`);return d=`${t}-${i}-${n}`,e.computeValue(d,!1)}},N.proxyID=e.id,N.updateHelpTextOnValue=e=>`${N.helpText} (${M(e?.label,"day")})`,N.condition=e=>!`${e[x].value}`.match(/unknown/i)&&E(e),N.validation=(a,t,i)=>n.required(a)?["Day is required for date"]:(b=!!`${a.value}`.match(/unknown/i),h=b?"15":c(`${a.value}`),d=`${y}-${v}-${h}`,f(d,e,t,i)),N.defaultValue=a=>p(a,e,"Day"),N.computedValue=()=>e.computeValue(d,b),N.unload=(a,t,n,i)=>{e.unload&&e.unload(a,t,n,i)},N.beforeNext=(a,t)=>!e.beforeNext||e.beforeNext(d,t),N.config={year:e=>e[$].value,month:e=>e[x].value},k||(N.config.keyboardActions=[]);const U=(a,t)=>["Unknown"===a[$].value,!e.condition||e.condition(a),e.estimation.estimationFieldType===t].every(Boolean);return S.proxyID=e.id,S.validation=(a,t,n)=>{if(a&&a.value>300)return["Age estimate is too high and exceeding hard limit of 300"];if(isNaN(parseInt(a.value.toString())))return["Please enter a valid number"];if(!a.value.toString().match(/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/))return["Not a valid age estimate"];const i=o(l.getSessionDate()).subtract(a.value,"years").year();return d=`${i}-07-15`,f(d,e,t,n)},S.condition=e=>U(e,"age-estimate-field"),S.computedValue=()=>e.computeValue(d,!0),S.beforeNext=(a,t)=>!e.beforeNext||e.beforeNext(d,t),I.proxyID=e.id,I.validation=(a,t,i)=>n.required(a)?["Please select an estimate"]:(d=o(l.getSessionDate()).subtract(a.value,"day").format(u),f(d,e,t,i)),I.condition=e=>U(e,"month-period-estimate-field"),I.computedValue=()=>e.computeValue(d,!0),I.beforeNext=(a,t)=>!e.beforeNext||e.beforeNext(d,t),[w,V,N,S,I]}));const a=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}];var d=e("E",(e=>(e.AGE_ESTIMATE_FIELD="age-estimate-field",e.MONTH_ESTIMATE_FIELD="month-period-estimate-field",e))(d||{}));function c(e){return parseInt(e)<10?`0${e}`:e}async function p(e,a,t){if(a.defaultValue){const n=await a.defaultValue(e);if(n){const[e,a,i]=n.split("-");switch(t){case"Year":return e||"";case"Month":return parseInt(a)||"";case"Day":return parseInt(i)||""}}}return""}function m(e){return i.toStandardHisDisplayFormat(e)}function f(e,a,t,n){if(a.minDate){const i=a.minDate(t,n);if(new Date(e)<new Date(i))return[`${m(e)} is less than minimum date of ${m(i)}`]}if(a.maxDate){const i=a.maxDate(t,n);if(i&&new Date(e)>new Date(i))return[`${m(e)} is greater than max date of  ${m(i)}`]}}}}}));
