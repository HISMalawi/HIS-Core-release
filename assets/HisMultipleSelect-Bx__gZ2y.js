import K from"./SelectMixin-BUhWCATE.js";import{d as x,ac as B,ak as F,aZ as N,W as O,a0 as P,a1 as S,a_ as y,aN as H,aV as U,d0 as L,d6 as M,a6 as T,ab as a,u as o,B as h,x as l,w as n,v as c,H as r,E as u,C as m,z as C,Z as f,G as b}from"./index-CyYd6aWW.js";import"./BaseTextInput-R_3uIRWn.js";import"./FieldMixin.vue_vue_type_script_lang-DVMlEpjU.js";const Z=x({components:{IonCheckbox:B,IonText:F,IonChip:N,IonItem:O,IonList:P,IonLabel:S,IonIcon:y},data:()=>({listData:[],filter:""}),name:"HisMultipleSelect",mixins:[K],methods:{clearValue(){this.listData=this.listData.map(e=>(e.isChecked=!1,e))},async init(){this.$emit("onFieldActivated",this),!(!H.isEmpty(this.listData)&&this.config.buildOptionsOnce)&&(this.listData=await this.options(this.fdata,this.getChecked(this.listData),this.cdata,this.listData),this.$emit("onValue",this.getChecked(this.listData)))},async onselect(e){var s;if(setTimeout(()=>this.filter="",30),typeof((s=e==null?void 0:e.other)==null?void 0:s.onEvent)=="function"&&await e.other.onEvent(e.isChecked),this.onValue&&e.isChecked&&!await this.onValue(e,this.fdata,this.cdata)){e.isChecked=!1;return}this.updateParent(e)},async updateParent(e){this.onValueUpdate&&(this.listData=await this.onValueUpdate([...this.listData],e,this.fdata,this.cdata)),this.$emit("onValue",this.getChecked(this.listData))},onKbValue(e){this.filter=e},keypress(e){this.filter=U(e,this.filter)},uncheck(e){let s=null;this.listData.forEach(i=>{i.label===e&&!i.disabled&&(s=i,i.isChecked=!1)}),this.updateParent(s)},getChecked(e){return e.filter(s=>s.isChecked)},isDescription(e,s=!1){return e?e!=null&&e.show?e.show==="onChecked"&&s||e.show==="always":!0:!1}},computed:{closeIcon:()=>L,listValues(){return this.filter?new M(this.listData,{threshold:.3,keys:["label"],useExtendedSearch:!0}).search(this.filter).map(s=>s.item):this.listData},checkedItems(){return this.getChecked(this.listData)}},watch:{clear(){this.listData.forEach(e=>e.isChecked=!1)},footerButtonEvent:{async handler(e){var s,i;e&&typeof((s=e.onClickComponentEvents)==null?void 0:s.refreshOptions)=="function"&&(this.listData=await((i=e.onClickComponentEvents)==null?void 0:i.refreshOptions(e,this.listData,this.fdata,this.cdata)),this.$emit("onValue",this.getChecked(this.listData)))},deep:!0,immediate:!0}},mounted(){this.init()},activated(){this.init()}});function z(e,s,i,A,G,W){const _=a("his-text-input"),w=a("ion-icon"),D=a("ion-chip"),V=a("ion-checkbox"),p=a("ion-text"),I=a("ion-label"),g=a("ion-item"),v=a("ion-list"),E=a("view-port"),$=a("his-keyboard");return o(),h(u,null,[l(E,{showFull:!e.showKeyboard},{default:n(()=>[e.showKeyboard?(o(),c(_,{key:0,value:e.filter,onOnValue:s[0]||(s[0]=t=>e.onKbValue(t,e.showKeyboard)),disabled:!1},null,8,["value"])):r("",!0),(o(!0),h(u,null,m(e.checkedItems,(t,d)=>(o(),h("span",{key:d},[l(D,{class:"his-md-text",color:"primary",onClick:k=>e.uncheck(t.label)},{default:n(()=>[C(f(t.label)+" ",1),l(w,{icon:e.closeIcon},null,8,["icon"])]),_:2},1032,["onClick"])]))),128)),l(v,{class:"view-port-content"},{default:n(()=>[(o(!0),h(u,null,m(e.listValues,(t,d)=>(o(),c(g,{onClick:()=>e.onselect(t),key:d,color:t.isChecked?"lightblue":"",lines:t.isChecked?"none":""},{default:n(()=>[l(V,{slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":k=>t.isChecked=k,disabled:t==null?void 0:t.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"]),l(I,null,{default:n(()=>[l(p,{class:"his-md-text"},{default:n(()=>[C(f(t.label),1)]),_:2},1024),e.isDescription(t.description,t.isChecked)?(o(),c(p,{key:0,color:t.description.color},{default:n(()=>[b("p",null,[b("i",null,f(t.description.text),1)])]),_:2},1032,["color"])):r("",!0)]),_:2},1024)]),_:2},1032,["onClick","color","lines"]))),128))]),_:1})]),_:1},8,["showFull"]),e.showKeyboard?(o(),c($,{key:0,kbConfig:e.keyboard,onKeyPress:e.keypress},null,8,["kbConfig","onKeyPress"])):r("",!0)],64)}const R=T(Z,[["render",z]]);export{R as default};
