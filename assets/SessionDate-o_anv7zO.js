import{d as m,S as e,H as r,ad as D,R as h,T as c,t as d,p as l,_ as u,r as f,o as S,c as y}from"./index-DTBWhHAq.js";import{g as _}from"./MultiFieldDateHelper-BWKgkEkB.js";import{H as $}from"./HisStandardForm-lonwENLb.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./TouchScreenForm-BeJsJnwt.js";import"./ToolbarMediumCard-wr9sTFDK.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DbAo6hHM.js";const B=m({components:{HisStandardForm:$},data:()=>({apiDate:"",fields:[]}),async created(){this.apiDate=await e.getApiDate(),this.fields=_({id:"session_date",helpText:"Session Date",required:!0,minDate:()=>"2000-01-01",maxDate:()=>this.apiDate,estimation:{allowUnknown:!1},computeValue:t=>t,config:{footerBtns:[{name:"Reset",slot:"end",color:"success",state:{visible:{default:()=>e.isBDE()}},onClick:async()=>{await this.resetSessionDate()}}]}})},async mounted(){await this.showBdeNotice()},methods:{async showBdeNotice(){if(!e.isBDE())return;const t=r.toStandardHisDisplayFormat(e.getCachedApiDate()||""),i=r.toStandardHisDisplayFormat(e.getSessionDate()),s=await D("BDE Notice","The system is currently in Back Data Entry Mode(BDE).                 Do you wish to reset the date to ".concat(t,"?"),"BDE Date: ".concat(i),[{name:"Reset Date",slot:"start",color:"success"},{name:"Keep BDE Date",slot:"end",color:"danger"},{name:"New date",slot:"end"}]);if(s==="Reset Date")return await this.resetSessionDate();s==="Keep BDE Date"&&this.redirect()},async resetSessionDate(){try{await e.resetSessionDate(),h.invalidate("PROVIDERS"),c("Session date has been reset to ".concat(this.formatDate(this.apiDate))),this.redirect()}catch(t){d("".concat(t))}},redirect(){const t=this.$route.query.patient_dashboard_redirection_id;t?this.$router.push("/patient/dashboard/".concat(t)):this.$router.back()},async onSubmit(t,i){var o,n;const s=i.session_date;try{await e.setSessionDate(s),c("Successfully Back dated to ".concat(this.formatDate(s)));const a=(n=(o=this.$route)==null?void 0:o.query)==null?void 0:n.patient_id;a?l(a,this.$router):this.redirect()}catch(a){d("".concat(a))}},formatDate(t){return r.toStandardHisDisplayFormat(t)}}});function w(t,i,s,o,n,a){const p=f("his-standard-form");return S(),y(p,{skipSummary:!0,fields:t.fields,onOnFinish:t.onSubmit},null,8,["fields","onOnFinish"])}const N=u(B,[["render",w]]);export{N as default};
