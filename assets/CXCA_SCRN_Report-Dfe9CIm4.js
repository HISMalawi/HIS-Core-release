import{d as $,a5 as y,cz as L,t as D,r as o,O as P,ah as R,d2 as k,co as m,aq as _,a6 as S,ab as v,u as N,v as A,w as F,x as b}from"./index-BMVUUxuO.js";import{v as Q}from"./TableView-BoNb-DDa.js";import{C as x}from"./cxca_report_service-BknSudae.js";import{D as I}from"./DrillPatientIds-50rZApfS.js";import"./Export-BdZiLVD9.js";import"./index-tytmNkJf.js";const n=o([]),l=o(""),i=o(""),d=o(""),g=o(!1),C=o(""),X=$({components:{IonPage:y,IonLoading:L,v2Datatable:Q},setup(){const s=async(e,t)=>{t.length<=0||(await _.create({component:I,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:d,patientIdentifiers:t,onFinish:()=>_.getTop().then(r=>r&&_.dismiss())}})).present()},f=[[{label:"#",ref:"index",span:{thRowspan:2}},{label:"Age group",ref:"age_group",span:{thRowspan:2}},{label:"Gender",ref:"gender",exportable:!1,span:{thRowspan:2}},{label:"1st time screened",ref:"",span:{thColspan:3}},{label:"Rescreened after previous negative",ref:"",span:{thColspan:3}},{label:"Post-treatment follow-up",ref:"",span:{thColspan:3}}],[{label:"Negative",ref:"first_time_screened_negative",secondaryLabel:"1st screened (Negative)",value:e=>e.first_time_screened.negative.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.negative)},{label:"Positive",ref:"first_time_screened_positive",secondaryLabel:"1st time screened (Positive)",value:e=>e.first_time_screened.positive.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.positive)},{label:"Suspected Cancer",ref:"first_time_screened_suspected_cancer",secondaryLabel:"1st screened(Suspected cancer)",value:e=>e.first_time_screened.suspected.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.suspected)},{label:"Negative",ref:"rescreened_after_prev_visit_negative",secondaryLabel:"Rescreen after prev visit (Negative)",value:e=>e.rescreened_after_prev_visit.negative.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.negative)},{label:"Positive",ref:"rescreened_after_prev_visit_positive",secondaryLabel:"Rescreen after prev visit (Positive)",value:e=>e.rescreened_after_prev_visit.positive.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.positive)},{label:"Suspected cancer",ref:"rescreened_after_prev_visit_suspected",secondaryLabel:"Rescreen after prev visit (Suspected)",value:e=>e.rescreened_after_prev_visit.suspected.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.suspected)},{label:"Negative",ref:"post_treatment_followup_negative",secondaryLabel:"Post-treatment followup(Negative)",value:e=>e.post_treatment_followup.negative.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.negative)},{label:"Positive",ref:"post_treatment_followup_positive",secondaryLabel:"Post-treatment followup (Positive)",value:e=>e.post_treatment_followup.positive.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.positive)},{label:"Suspected cancer",ref:"post_treatment_followup_suspected",secondaryLabel:"Post-treatment followup (Suspected)",value:e=>e.post_treatment_followup.suspected.length,tdClick:({column:e,data:t})=>s("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.suspected)}]],c=async()=>{if(!(l.value&&i.value))return P("Start date and end date required!");g.value=!0,n.value=[];const e=new x;e.startDate=l.value,e.endDate=i.value;try{n.value=(await e.getClinicReport("CXCA SCRN")).slice(5).map((r,a)=>(r.index=a+1,r.gender="Female",r));const t=r=>{const a=u=>n.value.reduce((h,w)=>h.concat(w[r][u]||[]),[]);return{positive:a("positive"),negative:a("negative"),suspected:a("suspected")}};n.value.push({age_group:"All",gender:"Female",index:n.value.length+1,first_time_screened:t("first_time_screened"),post_treatment_followup:t("post_treatment_followup"),rescreened_after_prev_visit:t("rescreened_after_prev_visit")})}catch(t){R("Unable to generate report!")}g.value=!1},p=()=>k({onFinish:(e,t,r)=>{l.value=e,i.value=t,d.value="Period (".concat(r,")"),C.value="".concat(m(l.value)," to ").concat(m(i.value)),c()}});return D(()=>!n.value.length&&p()),{columns:f,isLoading:g,reportData:n,period:d,csvQuarter:C,generate:c,configure:p}}});function q(s,f,c,p,e,t){const r=v("ion-loading"),a=v("v2Datatable"),u=v("ion-page");return N(),A(u,null,{default:F(()=>[b(r,{"is-open":s.isLoading,message:"Please wait..."},null,8,["is-open"]),b(a,{title:"CXCA SCRN Report",csvQuarter:s.csvQuarter,subtitle:s.period,columns:s.columns,columnData:s.reportData,rowsPerPage:25,onConfigure:s.configure,onRefresh:()=>s.generate()},null,8,["csvQuarter","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const U=S(X,[["render",q]]);export{U as default};
