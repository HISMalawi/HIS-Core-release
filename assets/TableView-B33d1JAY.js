import{d as N,Q as j,U as H,aZ as P,a0 as Q,R as Y,O as G,a3 as J,a4 as q,S as W,cL as Z,ap as K,r as E,ar as L,aI as X,cQ as x,cR as ee,cS as te,cT as ne,cU as oe,dL as ae,b6 as se,al as h,bw as re,aL as M,a8 as le,ad as d,u as i,B as f,x as l,w as c,z as g,Y as k,G as D,a1 as y,v as T,E as b,C as A,b0 as ce}from"./index-DLUr6P7m.js";import{b as ie,t as ue}from"./Export-CkPEf1jI.js";const de=N({components:{IonToolbar:j,IonItem:H,IonIcon:P,IonLabel:Q,IonTitle:Y,IonHeader:G,IonButton:J,IonFooter:q,IonContent:W,IonButtons:Z},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(e){const m=K(),I=E([]),w=E(""),v=E("desc"),B=L(()=>e.columns.slice(0,2)),S=L(()=>{var o;const n=[];return(o=e.columnData)==null||o.forEach((t,r)=>{const s=e.columns[0].map(a=>{let u="";try{M.isEmpty(t)?u="...":typeof a.value=="function"?u=a.value(t,r):u=t[a.ref]||""}catch(U){u="_ERROR_",console.error(U)}return{column:a,data:t,value:u,[a.ref||"nada"]:u}});n.push({row:s,data:t,searchIndex:[...s,s.map(a=>a.value).join(" ")]})}),n}),_=n=>{w.value=n,v.value=v.value==="asc"?"desc":"asc"},p=()=>{typeof e.onFinish=="function"?e.onFinish():m.push("/")},$=n=>{var o,t;try{typeof((o=n.column)==null?void 0:o.tdClick)=="function"&&((t=n.column)==null||t.tdClick(n));return}catch(r){console.error(r)}},C=()=>e.columns.reduce((n,o)=>n.concat(o),[]).filter(n=>n.value||n.ref),R=()=>{var o;const n=(o=window==null?void 0:window.document)==null?void 0:o.getElementById("report-content");ie("\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ".concat(n.innerHTML,"    \n                </body>\n                </html>\n            "))},V=n=>n.map(t=>Object.values(t).map(a=>Array.isArray(a)?a.length:a)),F=n=>n.map(t=>Object.values(t)),O=()=>{const t=(s=>{const a=JSON.parse(JSON.stringify(s)),u=V(a);return F(u)})(e.columnData),r="".concat(h.getLocationName()||"Unknown site","-").concat(e.title,"-").concat(e.subtitle,"-").concat(h.getSessionDate());ue([e.headers],[...t,["Date Created: ".concat(re().format("DD/MMM/YYYY HH:MM:ss"))],["Quarter: ".concat(e.csvQuarter||e.subtitle)],["HIS-Core Version: ".concat(h.getCoreVersion())],["API Version: ".concat(h.getApiVersion())],["Site UUID: ".concat(h.getSiteUUID())],["Generated by: ".concat(h.getUserName())]],r)},z=n=>{n.forEach((o,t)=>{const r=C().map(s=>{let a="";try{M.isEmpty(o)?a="...":typeof s.value=="function"?a=s.value(o,t):a=o[s.ref]||""}catch(u){a="_ERROR_",console.error(u)}return{column:s,data:o,value:a,[s.ref||"nada"]:a}});I.value.push({row:r,data:o,searchIndex:[...r,r.map(s=>s.value).join(" ")]})})};return X(()=>e.columnData,n=>{I.value=[],Array.isArray(n)&&z(n)},{immediate:!0,deep:!0}),{sortColumn:_,onClickTablecell:$,toPDF:R,toCSV:O,finish:p,columnsMinusOne:B,sync:x,search:ee,close:te,arrowUp:ne,arrowDown:oe,document:ae,calendar:se,sortOrder:v,reportBody:S,columnSorted:w}}}),fe={key:0},pe={class:"his-sm-text"},ye={id:"report-content"},me={class:"art-report-theme"},he={class:"stick-report-header"},_e=["colspan","rowspan","onClick"],be=["onClick"],ve={class:"his-sm-text"};function Ce(e,m,I,w,v,B){const S=d("ion-title"),_=d("ion-icon"),p=d("ion-button"),$=d("ion-buttons"),C=d("ion-toolbar"),R=d("ion-header"),V=d("ion-label"),F=d("ion-item"),O=d("ion-content"),z=d("ion-footer");return i(),f(b,null,[l(R,null,{default:c(()=>[l(C,null,{default:c(()=>[l(S,{class:"his-md-text"},{default:c(()=>[g(k(e.title)+" ",1),e.subtitle?(i(),f("br",fe)):D("",!0),y("span",pe,k(e.subtitle),1)]),_:1}),l($,{slot:"end"},{default:c(()=>[typeof e.onConfigure=="function"?(i(),T(p,{key:0,onClick:e.onConfigure},{default:c(()=>[l(_,{size:"large",icon:e.calendar},null,8,["icon"])]),_:1},8,["onClick"])):D("",!0),typeof e.onRefresh=="function"?(i(),T(p,{key:1,onClick:e.onRefresh,color:"success",size:"large"},{default:c(()=>[l(_,{size:"large",icon:e.sync},null,8,["icon"])]),_:1},8,["onClick"])):D("",!0)]),_:1})]),_:1})]),_:1}),l(O,{"scroll-y":"","scroll-x":""},{default:c(()=>[y("div",ye,[y("table",me,[y("thead",he,[(i(!0),f(b,null,A(e.columnsMinusOne,(n,o)=>(i(),f("tr",{key:o},[(i(!0),f(b,null,A(n,(t,r)=>{var s,a;return i(),f("th",{key:r,colspan:((s=t==null?void 0:t.span)==null?void 0:s.thColspan)||1,rowspan:((a=t==null?void 0:t.span)==null?void 0:a.thRowspan)||1,onClick:u=>e.sortColumn(t.ref)},[l(F,{lines:"none"},{default:c(()=>[e.columnSorted&&e.columnSorted===t.ref?(i(),T(_,{key:0,icon:e.sortOrder==="asc"?e.arrowUp:e.arrowDown},null,8,["icon"])):D("",!0),l(V,{class:"ion-text-center"},{default:c(()=>[y("b",null,k(t.label),1)]),_:2},1024)]),_:2},1024)],8,_e)}),128))]))),128))]),y("tbody",null,[(i(!0),f(b,null,A(e.reportBody,(n,o)=>(i(),f("tr",{key:o},[(i(!0),f(b,null,A(n.row||[],(t,r)=>{var s;return i(),f("td",{key:r,onClick:()=>e.onClickTablecell(t),class:ce({"clickable-cell":(s=t==null?void 0:t.column)==null?void 0:s.tdClick})},[y("b",ve,k(t.value),1)],10,be)}),128))]))),128))])])])]),_:1}),l(z,null,{default:c(()=>[l(C,{color:"dark"},{default:c(()=>[l(p,{onClick:m[0]||(m[0]=n=>e.toCSV()),size:"large"},{default:c(()=>[g(" CSV ")]),_:1}),l(p,{onClick:m[1]||(m[1]=n=>e.toPDF()),size:"large"},{default:c(()=>[g(" PDF ")]),_:1}),l(p,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:c(()=>[g(" Finish ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const De=le(de,[["render",Ce],["__scopeId","data-v-f1278bbd"]]);export{De as v};
