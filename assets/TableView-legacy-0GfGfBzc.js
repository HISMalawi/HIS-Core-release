System.register(["./index-legacy-iEOS67hm.js","./Export-legacy-Rw89F9c2.js"],(function(e,t){"use strict";var a,o,l,r,n,c,s,i,u,d,f,p,h,g,y,m,v,b,k,C,P,w,x,S,_,I,D,V,T,F,z,R,U,$,E,H,K,O,M,L,N,B,Y,Q,j,A,G,W,q,X,Z,J;return{setters:[e=>{a=e.d,o=e.S,l=e.X,r=e.aY,n=e.a1,c=e.U,s=e.R,i=e.a3,u=e.a4,d=e.W,f=e.cG,p=e.aX,h=e.aP,g=e.bY,y=e.bZ,m=e.ap,v=e.r,b=e.ar,k=e.aH,C=e.cL,P=e.cM,w=e.cN,x=e.cO,S=e.cP,_=e.cQ,I=e.cR,D=e.cS,V=e.aN,T=e.al,F=e.bv,z=e.aS,R=e.cT,U=e.cU,$=e.aK,E=e.b_,H=e.cV,K=e.a8,O=e.ad,M=e.u,L=e.B,N=e.x,B=e.w,Y=e.v,Q=e.H,j=e.E,A=e.z,G=e.K,W=e.G,q=e.C,X=e.a$},e=>{Z=e.a,J=e.t}],execute:function(){var t=document.createElement("style");t.textContent="th[data-v-33ef3337],td[data-v-33ef3337]{width:4%;border-collapse:collapse;text-align:center}td[data-v-33ef3337]{border-bottom:1px solid rgb(165,165,165);padding:.6em;font-weight:500;font-size:.8em}.stick-report-header[data-v-33ef3337]{background:#fff;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:1000}tr[data-v-33ef3337]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-33ef3337]{color:#0645ad;font-weight:600;font-size:1em}.his-floating-keyboard[data-v-33ef3337]{bottom:70px!important}\n",document.head.appendChild(t);const ee=a({components:{IonToolbar:o,IonItem:l,IonIcon:r,IonLabel:n,IonTitle:c,IonHeader:s,IonButton:i,IonFooter:u,IonContent:d,IonButtons:f,IonChip:p,HisKeyboard:h,IonThumbnail:g,IonImg:y},props:{title:{type:String,default:"Report"},headerBadge:{type:Object},iconUrl:{type:String},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},enablePagination:{type:Boolean,default:!0},rowsPerPage:{type:Number,default:10},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},reportPrefix:{type:String,default:""},defaultSortedColumn:{type:String},defaultSortOrder:{type:Object,default:"desc"}},setup(e){const t=m(),a=v([]),o=v(0),l=v(""),r=v(""),n=v("desc"),c=v(!1),s=b((()=>{let t=a.value;return n.value&&r.value&&(t=R(a.value)[n.value]((e=>e.sortData[r.value]))),l.value?new U(t,{threshold:.3,keys:["searchIndex"],useExtendedSearch:!0}).search(l.value,{limit:e.rowsPerPage}).map((e=>e.item)):t})),i=b((()=>$.chunk(s.value,e.rowsPerPage).length)),u=b((()=>o.value+2<=i.value)),d=b((()=>o.value>0)),f=b((()=>$.chunk(s.value,e.rowsPerPage)[o.value])),p=()=>e.columns.reduce(((e,t)=>e.concat(t)),[]).filter((e=>e.value||e.ref)),h=(t,o=!1)=>{const l=p().filter((e=>["pdf"!==t||"boolean"!=typeof e.encrypted||e?.encrypted&&!o,"csv"!==t||!e?.encrypted,!e.canExport||e?.canExport[t],"boolean"!=typeof e.exportable||e.exportable].every(Boolean))),r=l.map((e=>e.exportedValue&&e.exportedValue.column?e.exportedValue.column(e):e.secondaryLabel||e.label)),n=l.map((e=>e.ref));return{headers:r,rows:a.value.reduce(((e,t)=>[...e,t.row.filter((({column:e})=>n.includes(e.ref))).map((e=>e.column.exportedValue&&e.column.exportedValue.dataValue?e.column.exportedValue.dataValue(e):e.value))]),[]),filename:`${e.reportPrefix} ${T.getLocationName()??""} ${E(e.title).replace(e.reportPrefix,"")} ${H(e.csvQuarter??e.subtitle??"")}`}},g=e=>{e.forEach((e=>{const t={...e},o=p().map((a=>{let o="";const l=e[a.ref];try{o=$.isEmpty(e)?"...":"function"==typeof a.toValue?`${a.toValue(l)}`:"function"==typeof a.value?a.value(e):e[a.ref]||""}catch(r){o=a?.defaultValue||"_ERROR_",console.error(r)}return t[a.ref]=o,"function"==typeof a.sortValue&&(t[a.ref]=a.sortValue(l)),{column:a,refData:l,value:o,data:e}}));a.value.push({row:o,data:e,sortData:t,searchIndex:[...o,o.map((e=>e.value)).join(" ")]})}))};return k((()=>e.columnData),(t=>{if(a.value=[],!Array.isArray(t)||!t.length)return o.value=0,l.value="",r.value=e.defaultSortedColumn??"",n.value=e.defaultSortOrder,void g(Array.from({length:e.rowsPerPage}).map((()=>({}))));g(t)}),{immediate:!0,deep:!0}),{first:()=>o.value=0,last:()=>o.value=i.value-1||0,next:()=>o.value+=1,prev:()=>o.value-=1,selectPage:()=>D((e=>{const t=parseInt(e);parseInt(e)<=i.value&&(o.value=t)}),{title:"Select page"}),sortColumn:e=>{r.value=e,n.value="asc"===n.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(t){console.error(t)}},toPDF:async()=>{let e;if(p().some((e=>e?.encrypted))&&"Secure PDF"===await V("Security warning","PDF may contain private data that will require a password to unlock","To access private data choose Secure PDF over Regular PDF",[{name:"Secure PDF",slot:"start",color:"success"},{name:"Regular PDF",slot:"start",color:"success"}],"his-danger-color")){const t=T.getUserName();e={encryption:{userPassword:t,ownerPassword:t,userPermissions:["print"]}}}const{headers:t,rows:a,filename:o}=h("pdf",!e);Z([t],a,o,!0,e)},toCSV:()=>{const{headers:t,rows:a,filename:o}=h("csv");J([t],[...a,[`Date Created: ${F().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${T.getCoreVersion()}`],[`API Version: ${T.getApiVersion()}`],[`Site UUID: ${T.getSiteUUID()}`],[`Generated by: ${T.getUserName()}`]],o)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():t.push("/")},filterTable:e=>{l.value=z(e,l.value),o.value=0},sync:C,search:P,close:w,arrowUp:x,arrowDown:S,funnelOutline:_,page:f,canNext:u,searchTerm:l,totalPages:i,sortOrder:n,canPrev:d,currentPage:o,columnSorted:r,QWERTY:I,showSearchKeyboard:c}}}),te={key:0},ae={class:"his-sm-text"},oe={class:"art-report-theme"},le={class:"stick-report-header"},re=["colspan","rowspan","onClick"],ne=["onClick"],ce=["innerHTML"];e("v",K(ee,[["render",function(e,t,a,o,l,r){const n=O("ion-img"),c=O("ion-thumbnail"),s=O("ion-title"),i=O("ion-icon"),u=O("ion-button"),d=O("ion-label"),f=O("ion-chip"),p=O("ion-buttons"),h=O("ion-toolbar"),g=O("ion-header"),y=O("ion-item"),m=O("ion-content"),v=O("his-keyboard"),b=O("ion-footer");return M(),L(W,null,[N(g,null,{default:B((()=>[N(h,null,{default:B((()=>[e.iconUrl?(M(),Y(c,{key:0,slot:"start"},{default:B((()=>[N(n,{src:e.iconUrl},null,8,["src"])])),_:1})):Q("",!0),N(s,{slot:"start",class:"his-md-text"},{default:B((()=>[A(j(e.title)+" ",1),e.subtitle?(M(),L("br",te)):Q("",!0),G("span",ae,j(e.subtitle),1)])),_:1}),N(p,{slot:"end"},{default:B((()=>["function"==typeof e.onConfigure?(M(),Y(u,{key:0,onClick:t[0]||(t[0]=()=>e.onConfigure?e.onConfigure():null)},{default:B((()=>[N(i,{size:"large",icon:e.funnelOutline},null,8,["icon"])])),_:1})):Q("",!0),e.searchTerm?(M(),Y(f,{key:1,onClick:t[1]||(t[1]=()=>{e.searchTerm="",e.showSearchKeyboard=!1}),class:"his-md-text",color:"primary"},{default:B((()=>[N(d,null,{default:B((()=>[A(j(e.searchTerm?`Search: ${e.searchTerm}`:""),1)])),_:1}),N(i,{icon:e.close},null,8,["icon"])])),_:1})):Q("",!0),N(u,{color:e.showSearchKeyboard?"primary":"dark",onClick:t[2]||(t[2]=()=>e.showSearchKeyboard=!e.showSearchKeyboard),size:"large"},{default:B((()=>[N(i,{size:"large",icon:e.search},null,8,["icon"])])),_:1},8,["color"]),"function"==typeof e.onRefresh?(M(),Y(u,{key:2,onClick:t[3]||(t[3]=()=>e.onRefresh?e.onRefresh():null),color:"success",size:"large"},{default:B((()=>[N(i,{size:"large",icon:e.sync},null,8,["icon"])])),_:1})):Q("",!0)])),_:1})])),_:1}),(e.headerBadge||[]).length?(M(),Y(h,{key:0,color:"light"},{default:B((()=>[(M(!0),L(W,null,q(e.headerBadge,((t,a)=>(M(),Y(f,{onClick:e=>"function"==typeof t.action?t.action():null,key:a,color:t?.color||"dark"},{default:B((()=>[N(i,{icon:t?.icon||e.search},null,8,["icon"]),N(d,{innerHTML:t?.text},null,8,["innerHTML"])])),_:2},1032,["onClick","color"])))),128))])),_:1})):Q("",!0)])),_:1}),N(m,{"scroll-y":"","scroll-x":""},{default:B((()=>[G("table",oe,[G("thead",le,[(M(!0),L(W,null,q(e.columns,((t,a)=>(M(),L("tr",{key:a},[(M(!0),L(W,null,q(t,((t,a)=>(M(),L("th",{key:a,colspan:t?.span?.thColspan||1,rowspan:t?.span?.thRowspan||1,onClick:a=>e.sortColumn(t.ref)},[N(y,{lines:"none"},{default:B((()=>[e.columnSorted&&e.columnSorted===t.ref?(M(),Y(i,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):Q("",!0),N(d,{class:"ion-text-center"},{default:B((()=>[G("b",null,j(t.label),1)])),_:2},1024)])),_:2},1024)],8,re)))),128))])))),128))]),G("tbody",null,[(M(!0),L(W,null,q(e.page,((t,a)=>(M(),L("tr",{key:a},[(M(!0),L(W,null,q(t.row,((t,a)=>(M(),L("td",{key:a,onClick:()=>e.onClickTablecell(t),class:X({"clickable-cell":t?.column?.tdClick})},[G("span",{innerHTML:t.value,class:"his-sm-text"},null,8,ce)],10,ne)))),128))])))),128))])])])),_:1}),N(b,null,{default:B((()=>[e.showSearchKeyboard?(M(),Y(v,{key:0,kbConfig:e.QWERTY,onKeyPress:e.filterTable},null,8,["kbConfig","onKeyPress"])):Q("",!0),N(h,{color:"dark"},{default:B((()=>[N(u,{onClick:t[4]||(t[4]=t=>e.toCSV()),size:"large"},{default:B((()=>[A(" CSV ")])),_:1}),N(u,{onClick:t[5]||(t[5]=t=>e.toPDF()),size:"large"},{default:B((()=>[A(" PDF ")])),_:1}),e.totalPages>1?(M(),Y(u,{key:0,onClick:e.first,disabled:0===e.currentPage||e.totalPages<=2,size:"large",slot:"end"},{default:B((()=>[A(" First ")])),_:1},8,["onClick","disabled"])):Q("",!0),e.totalPages>1?(M(),Y(u,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:B((()=>[A(" Prev ")])),_:1},8,["onClick","disabled"])):Q("",!0),e.totalPages>1?(M(),Y(u,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:B((()=>[A(j(e.currentPage)+" / "+j(e.totalPages-1),1)])),_:1},8,["onClick"])):Q("",!0),e.totalPages>1?(M(),Y(u,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:B((()=>[A(" Next ")])),_:1},8,["onClick","disabled"])):Q("",!0),e.totalPages>1?(M(),Y(u,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:B((()=>[A(" Last ")])),_:1},8,["onClick","disabled"])):Q("",!0),N(u,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:B((()=>[A(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-33ef3337"]]))}}}));
