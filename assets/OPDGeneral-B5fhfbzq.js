import{d as z,K as v,I as H,c7 as X,N as Z,a$ as N,c9 as $,O as S,V as y,_ as ee,r as M,o as te,c as ae,w as re,b as x}from"./index-DTBWhHAq.js";import{v as ne}from"./TableView-DlaqMnk5.js";import{A as oe}from"./aetc_report_service-j_5woSSN.js";import{D as le}from"./DrillPatientIds-D8dl9vmd.js";import{M as se}from"./PopupKeyboard-C_Gld6ml.js";import{F as g}from"./dynamic-import-helper-Bsjrd6Ro.js";import"./Export-CLFPyxXu.js";import"./TableView-BllKSVel.js";import"./fuse-YdZE3OCN.js";import"./HisKeyboard-DQi-3Zd4.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./KbLayouts-VRA-vjeH.js";import"./BaseKeyboard-Ck5oXEIk.js";import"./KbHandler-BuQ4TFU6.js";import"./SIngleTouchField-0q-gpRlN.js";import"./TouchScreenForm-BeJsJnwt.js";import"./ToolbarMediumCard-wr9sTFDK.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DbAo6hHM.js";import"./HisKeypad-BxyyAkla.js";const w=v([]),l=v(""),u=v(""),Y=v(""),ue=v(!1),B=v(""),J=v(""),U=v(""),j=v(""),ie=z({components:{IonPage:H,IonLoading:X,v2Datatable:ne},setup(){const p=async()=>{const e=new oe;e.startDate=l.value,e.endDate=u.value,e.startAge=J.value,e.endAge=U.value,e.reportType=j.value;try{const a=await e.getClinicReport("OPD GENERAL");w.value=a}catch(a){console.log(a)}},k=async(e,a)=>{a.length<=0||(await S.create({component:le,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:Y,patientIdentifiers:a,onFinish:()=>S.getTop().then(i=>i&&S.dismiss())}})).present()},f=()=>{let e=[];const a=new Date().getFullYear();for(let i=2008;i<=a;i++)e.push(i+"");return e.reverse()},E=()=>{let e=[];const a=new Date().getFullYear(),i=new Date().getMonth()+1,h=i<=3?1:i<=6?2:i<=9?3:4;for(let d=2008;d<=a;d++)for(let D=1;D<=4;D++)(d<a||d===a&&D<=h)&&e.push("Q".concat(D," ").concat(d));return e.reverse()},T=e=>e.map(a=>({label:a,value:a})),V=["Data Element","Value"],b=[[{label:"No",ref:"",value:(e,a)=>++a},{label:"Data Element",ref:"",value:e=>e.diagnosis},{label:"Value",ref:"",value:e=>e.patients.length,tdClick:({column:e,data:a})=>k("".concat(e.secondaryLabel," ").concat(a.diagnosis," "),a.patients)}]],m=()=>se([{id:"start_age",helpText:"Start Age",type:g.TT_NUMBER,computedValue:e=>e.value,validation:e=>y.required(e)},{id:"end_age",helpText:"End Age",type:g.TT_NUMBER,computedValue:e=>e.value,validation:e=>y.required(e)},{id:"report_type",helpText:"Report type",type:g.TT_SELECT,computedValue:e=>e.value,options:()=>[{label:"General Outpatient",value:"General Outpatient"},{label:"Pediatrics",value:"Pediatrics"},{label:"General Diagnoses",value:"General Diagnoses"},{label:"Pediatrics Diagnosis",value:"Pediatrics Diagnosis"}]},{id:"report_range",helpText:"Select Range",type:g.TT_SELECT,computedValue:e=>e.value,options:()=>[{label:"Week",value:"Week"},{label:"Month",value:"Month"},{label:"Quarter",value:"Quarter"},{label:"Year",value:"Year"},{label:"Select Range",value:"Select-Range"}]},{id:"report_range_year",helpText:"Select Year",type:g.TT_SELECT,condition:e=>e.report_range.value==="Year"||e.report_range.value==="Month"||e.report_range.value==="Week",computedValue:e=>e.label,options:()=>{const e=f();return[...T(e)]}},{id:"report_range_quaters",helpText:"Select Quater",type:g.TT_SELECT,condition:e=>e.report_range.value==="Quarter",computedValue:e=>e.value,options:()=>{const e=E();return[...T(e)]}},{id:"start_date",helpText:"Start Date",type:g.TT_FULL_DATE,validation:e=>y.required(e),computedValue:e=>e.value,condition:e=>e.report_range.value==="Select-Range"},{id:"report_range_month",helpText:"Select Month",type:g.TT_SELECT,validation:e=>y.required(e),computedValue:e=>e.value,condition:e=>e.report_range.value==="Month",options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]},{id:"report_range_week",helpText:"Select Week",type:g.TT_SELECT,condition:e=>{const a=new Date().getFullYear()+"";return e.report_range.value==="Week"&&e.report_range_year.value===a},options:()=>[{label:"This Week",value:"This Week"},{label:"Last Week",value:"Last Week"},{label:"This Month",value:"This Month"},{label:"Last Month",value:"Last Month"},{label:"All Dates",value:"All Dates"}]}],(e,a)=>{var i,h,d,D,L,W,O,A,C,F,P,R,q,Q,G,I;if(((i=e.report_range)==null?void 0:i.value)==="Month"&&(l.value="".concat(a.report_range_year,"-").concat(a.report_range_month,"-01"),u.value=N(new Date(l.value).toISOString()).endOf("month").format("YYYY-MM-DD")),((h=e.report_range)==null?void 0:h.value)==="Select-Range"&&(l.value="".concat(e.year.value,"-").concat(e.month.value,"-01"),u.value=N(new Date(l.value).toISOString()).endOf("month").format("YYYY-MM-DD")),((d=e.report_range)==null?void 0:d.value)==="Year"&&(l.value="".concat(a.report_range_year,"-01-01"),u.value="".concat(a.report_range_year,"-12-31")),((D=e.report_range)==null?void 0:D.value)==="Week"&&((L=e.report_range_week)==null?void 0:L.value)==="This Week"){const t=new Date,n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=new Date(t);o.setDate(t.getDate()-t.getDay());const s=new Date(t);s.setDate(t.getDate()+(6-t.getDay()));const c="".concat(n,"-").concat(r,"-").concat(String(o.getDate()).padStart(2,"0")),_="".concat(n,"-").concat(r,"-").concat(String(s.getDate()).padStart(2,"0"));l.value=c,u.value=_}if(((W=e.report_range)==null?void 0:W.value)==="Week"&&((O=e.report_range_week)==null?void 0:O.value)==="Last Week"){const t=new Date;t.setDate(t.getDate()-7);const n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o=new Date(t);o.setDate(t.getDate()-t.getDay());const s=new Date(t);s.setDate(t.getDate()+(6-t.getDay()));const c="".concat(n,"-").concat(r,"-").concat(String(o.getDate()).padStart(2,"0")),_="".concat(n,"-").concat(r,"-").concat(String(s.getDate()).padStart(2,"0"));l.value=c,u.value=_}if(((A=e.report_range)==null?void 0:A.value)==="Week"&&((C=e.report_range_week)==null?void 0:C.value)==="This Month"){const t=new Date,n=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),o="".concat(n,"-").concat(r,"-01"),s=new Date(n,t.getMonth()+1,0),c="".concat(n,"-").concat(r,"-").concat(String(s.getDate()).padStart(2,"0"));l.value=o,u.value=c}if(((F=e.report_range)==null?void 0:F.value)==="Week"&&((P=e.report_range_week)==null?void 0:P.value)==="Last Month"){const t=new Date,n=t.getFullYear(),r=t.getMonth()+1,o=r===1?12:r-1,s=o===12?n-1:n,c=new Date(n,r-1,0),_="".concat(s,"-").concat(String(o).padStart(2,"0"),"-01"),K="".concat(s,"-").concat(String(o).padStart(2,"0"),"-").concat(String(c.getDate()).padStart(2,"0"));l.value=_,u.value=K}if(((R=e.report_range)==null?void 0:R.value)==="Week"&&((q=e.report_range_week)==null?void 0:q.value)==="All Dates"){const t=new Date,n=t.getFullYear(),r="".concat(n,"-01-01"),o=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),c="".concat(n,"-").concat(o,"-").concat(s);l.value=r,u.value=c}if(((Q=e.report_range)==null?void 0:Q.value)==="Quarter"){const t=a.report_range_quaters.split(" "),n=parseInt(t[0].slice(1),10),r=parseInt(t[1],10),o={1:"".concat(r,"-01-01"),2:"".concat(r,"-04-01"),3:"".concat(r,"-07-01"),4:"".concat(r,"-10-01")},s={1:"".concat(r,"-03-31"),2:"".concat(r,"-06-30"),3:"".concat(r,"-09-30"),4:"".concat(r,"-12-31")};l.value=o[n],u.value=s[n]}((G=e.report_range)==null?void 0:G.value)==="Week"&&((I=e.report_range_year)==null?void 0:I.value)<new Date().getFullYear()&&(l.value="".concat(e.report_range_year.value,"-01-01"),u.value="".concat(e.report_range_year.value,"-12-31")),J.value=a.start_age,U.value=a.end_age,j.value=a.report_type,Y.value="Period (".concat($(l.value)," to ").concat($(u.value),")"),S.dismiss(),B.value="".concat($(l.value)," to ").concat($(u.value)),p()});return Z(()=>!w.value.length&&m()),{columns:b,isLoading:ue,reportData:w,period:Y,csvQuarter:B,csvheaders:V,generate:p,configure:m}}});function pe(p,k,f,E,T,V){const b=M("ion-loading"),m=M("v2Datatable"),e=M("ion-page");return te(),ae(e,null,{default:re(()=>[x(b,{"is-open":p.isLoading,message:"Please wait..."},null,8,["is-open"]),x(m,{title:"OPD General Report",subtitle:p.period,columns:p.columns,columnData:p.reportData,rowsPerPage:25,onConfigure:p.configure,csvQuarter:p.csvQuarter,headers:p.csvheaders,onRefresh:()=>p.generate()},null,8,["subtitle","columns","columnData","onConfigure","csvQuarter","headers","onRefresh"])]),_:1})}const Le=ee(ie,[["render",pe]]);export{Le as default};
