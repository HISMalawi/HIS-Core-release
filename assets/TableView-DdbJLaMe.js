import{d as j,Y as H,$ as L,ay as P,a6 as Y,Z as J,X as Q,a8 as G,a9 as q,_ as K,c3 as W,ag as X,r as z,at as B,aL as Z,c6 as x,c7 as ee,c8 as te,c9 as oe,ca as ne,dU as ae,bd as se,ao as b,bC as re,aN as U,aa as le,af as f,a as i,E as y,b as l,w as c,C as g,a2 as k,M as D,K as m,c as M,J as _,G as A,b7 as ce}from"./index-CMZASHAR.js";import{b as ie,a as ue}from"./Export-CpyT9Gk1.js";const de=j({components:{IonToolbar:H,IonItem:L,IonIcon:P,IonLabel:Y,IonTitle:J,IonHeader:Q,IonButton:G,IonFooter:q,IonContent:K,IonButtons:W},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(e){const u=X(),I=z([]),w=z(""),v=z("desc"),N=B(()=>e.columns.slice(0,2)),S=B(()=>{var n;const o=[];return(n=e.columnData)==null||n.forEach((t,r)=>{const s=e.columns[0].map(a=>{let d="";try{U.isEmpty(t)?d="...":typeof a.value=="function"?d=a.value(t,r):d=t[a.ref]||""}catch(T){d="_ERROR_",console.error(T)}return{column:a,data:t,value:d,[a.ref||"nada"]:d}});o.push({row:s,data:t,searchIndex:[...s,s.map(a=>a.value).join(" ")]})}),o}),h=o=>{w.value=o,v.value=v.value==="asc"?"desc":"asc"},p=()=>{typeof e.onFinish=="function"?e.onFinish():u.push("/")},$=o=>{var n,t;try{typeof((n=o.column)==null?void 0:n.tdClick)=="function"&&((t=o.column)==null||t.tdClick(o));return}catch(r){console.error(r)}},C=()=>e.columns.reduce((o,n)=>o.concat(n),[]).filter(o=>o.value||o.ref),V=()=>{var n;const o=(n=window==null?void 0:window.document)==null?void 0:n.getElementById("report-content");ie("\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ".concat(o.innerHTML,"    \n                </body>\n                </html>\n            "))},F=o=>o.map(t=>Object.values(t).map(a=>Array.isArray(a)?a.length:a)),O=o=>o.map(t=>Object.values(t)),R=()=>{const t=(s=>{const a=JSON.parse(JSON.stringify(s)),d=F(a);return O(d)})(e.columnData),r="".concat(b.getLocationName()||"Unknown site","-").concat(e.title,"-").concat(e.subtitle,"-").concat(b.getSessionDate());ue([e.headers],[...t,["Date Created: ".concat(re().format("DD/MMM/YYYY HH:MM:ss"))],["Quarter: ".concat(e.csvQuarter||e.subtitle)],["HIS-Core Version: ".concat(b.getCoreVersion())],["API Version: ".concat(b.getApiVersion())],["Site UUID: ".concat(b.getSiteUUID())],["Generated by: ".concat(b.getUserName())]],r)},E=o=>{o.forEach((n,t)=>{const r=C().map(s=>{let a="";try{U.isEmpty(n)?a="...":typeof s.value=="function"?a=s.value(n,t):a=n[s.ref]||""}catch(d){a="_ERROR_",console.error(d)}return{column:s,data:n,value:a,[s.ref||"nada"]:a}});I.value.push({row:r,data:n,searchIndex:[...r,r.map(s=>s.value).join(" ")]})})};return Z(()=>e.columnData,o=>{I.value=[],Array.isArray(o)&&E(o)},{immediate:!0,deep:!0}),{sortColumn:h,onClickTablecell:$,toPDF:V,toCSV:R,finish:p,columnsMinusOne:N,sync:x,search:ee,close:te,arrowUp:oe,arrowDown:ne,document:ae,calendar:se,sortOrder:v,reportBody:S,columnSorted:w}}}),fe={key:0},ye={class:"his-sm-text"},pe={id:"report-content"},me={class:"art-report-theme"},be={class:"stick-report-header"},he=["colspan","rowspan","onClick"],_e=["onClick"],ve={class:"his-sm-text"};function Ce(e,u,I,w,v,N){const S=f("ion-title"),h=f("ion-icon"),p=f("ion-button"),$=f("ion-buttons"),C=f("ion-toolbar"),V=f("ion-header"),F=f("ion-label"),O=f("ion-item"),R=f("ion-content"),E=f("ion-footer");return i(),y(_,null,[l(V,null,{default:c(()=>[l(C,null,{default:c(()=>[l(S,{class:"his-md-text"},{default:c(()=>[g(k(e.title)+" ",1),e.subtitle?(i(),y("br",fe)):D("",!0),m("span",ye,k(e.subtitle),1)]),_:1}),l($,{slot:"end"},{default:c(()=>[typeof e.onConfigure=="function"?(i(),M(p,{key:0,onClick:e.onConfigure},{default:c(()=>[l(h,{size:"large",icon:e.calendar},null,8,["icon"])]),_:1},8,["onClick"])):D("",!0),typeof e.onRefresh=="function"?(i(),M(p,{key:1,onClick:e.onRefresh,color:"success",size:"large"},{default:c(()=>[l(h,{size:"large",icon:e.sync},null,8,["icon"])]),_:1},8,["onClick"])):D("",!0)]),_:1})]),_:1})]),_:1}),l(R,{"scroll-y":"","scroll-x":""},{default:c(()=>[m("div",pe,[m("table",me,[m("thead",be,[(i(!0),y(_,null,A(e.columnsMinusOne,(o,n)=>(i(),y("tr",{key:n},[(i(!0),y(_,null,A(o,(t,r)=>{var s,a;return i(),y("th",{key:r,colspan:((s=t==null?void 0:t.span)==null?void 0:s.thColspan)||1,rowspan:((a=t==null?void 0:t.span)==null?void 0:a.thRowspan)||1,onClick:d=>e.sortColumn(t.ref)},[l(O,{lines:"none"},{default:c(()=>[e.columnSorted&&e.columnSorted===t.ref?(i(),M(h,{key:0,icon:e.sortOrder==="asc"?e.arrowUp:e.arrowDown},null,8,["icon"])):D("",!0),l(F,{class:"ion-text-center"},{default:c(()=>[m("b",null,k(t.label),1)]),_:2},1024)]),_:2},1024)],8,he)}),128))]))),128))]),m("tbody",null,[(i(!0),y(_,null,A(e.reportBody,(o,n)=>(i(),y("tr",{key:n},[(i(!0),y(_,null,A(o.row||[],(t,r)=>{var s;return i(),y("td",{key:r,onClick:()=>e.onClickTablecell(t),class:ce({"clickable-cell":(s=t==null?void 0:t.column)==null?void 0:s.tdClick})},[m("b",ve,k(t.value),1)],10,_e)}),128))]))),128))])])])]),_:1}),l(E,null,{default:c(()=>[l(C,{color:"dark"},{default:c(()=>[l(p,{onClick:u[0]||(u[0]=o=>e.toCSV()),size:"large"},{default:c(()=>u[2]||(u[2]=[g(" CSV ")])),_:1}),l(p,{onClick:u[1]||(u[1]=o=>e.toPDF()),size:"large"},{default:c(()=>u[3]||(u[3]=[g(" PDF ")])),_:1}),l(p,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:c(()=>u[4]||(u[4]=[g(" Finish ")])),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const De=le(de,[["render",Ce],["__scopeId","data-v-f1278bbd"]]);export{De as v};
