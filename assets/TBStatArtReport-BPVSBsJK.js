import{d as w,r as d,o as v,a as T,c as D,w as R,b,u as m,D as A,f as P,i as h,m as u,t as F}from"./index-4ZhJu3VE.js";import{w as y}from"./v2utils-D-WXYwWm.js";import{T as g}from"./tb_report_service-CQW3cg_m.js";import{v as B}from"./TableView-al7pPq3G.js";import{T as C}from"./TBDrilldown-CJGeEGPM.js";import"./Export--AC_4hfU.js";import"./index-CoZ4oawq.js";const I=w({__name:"TBStatArtReport",setup(x){const f=h("login-logos/PEPFAR.png"),i=d([]),l=d(""),s=new g,o=(e,a)=>({label:e,ref:a,toValue:t=>t.length,tdClick:async t=>(await u.create({component:C,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:t.column.label,patientIdentifiers:t.refData,subtitle:"Period: ".concat(l.value),onFinish:()=>u.getTop().then(n=>n&&u.dismiss())}})).present()}),_=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},o("Known positive","known_positive"),o("Newly Tested Positives","newly_tested_positive"),o("New Negatives","new_negative"),o("Recent negative","recent_negative"),o("Not Done","not_done"),o("New on ART","new_on_art"),o("Already on ART","already_on_art")]],c=()=>y(async()=>{if(!(s.startDate&&s.endDate))return F("Start date and end date required!");i.value=[];const e=await g.getJson("programs/2/reports/TB_ART_STAT",s.buildRequestParams({})),a=Object.keys(e).reduce((n,r)=>(/unknown|all/i.test(r)||(n.M.push({age_group:r,gender:"Male",...e[r].M}),n.F.push({age_group:r,gender:"Female",...e[r].F})),n),{F:[],M:[]}),t=[...a.F,...a.M];i.value=t.map((n,r)=>({index:r+1,...n}))}),p=()=>A({onFinish:(e,a,t)=>{l.value="".concat(t),s.startDate=e,s.endDate=a,c()}});return v(()=>p()),(e,a)=>(T(),D(m(P),null,{default:R(()=>[b(B,{title:"TB STAT ART Report","report-prefix":"PEPFAR","icon-url":m(f),subtitle:l.value,columns:_,columnData:i.value,rowsPerPage:50,onConfigure:p,onRefresh:()=>c()},null,8,["icon-url","subtitle","columnData","onRefresh"])]),_:1}))}});export{I as default};
