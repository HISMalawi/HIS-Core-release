System.register(["./HisStandardForm-legacy-D6wc8RJ-.js","./index-legacy-DA9zHw1d.js"],(function(e,a){"use strict";var o,t,i,n,s,r,l,d,c,u,v,h;return{setters:[e=>{o=e.H},e=>{t=e.d,i=e.r,n=e.ag,s=e.ad,r=e.ae,l=e.W,d=e.a,c=e.c,u=e.ah,v=e.U,h=e.ai}],execute:function(){e("default",t({__name:"ResetPassword",setup(e){const a=new u,t=i(!1),p=i("welcome"),w=n(),y=[{id:"welcome",helpText:"Password Reset",type:s.TT_TEXT_BANNER,options:()=>{const e='\n        <h1 style="font-weight: bold;">Welcome to the password reset module</h1>\n        <h2>Please ensure that you\'ve received a verification code from <b>Helpdesk</b></h2>\n        <h3>You can either scan the code or enter it manually</h3>\n        <h4>Click <b>NEXT</b> below to begin</h4>\n      ';return[{label:e,value:e}]}},{id:"has_scanner",helpText:"Do you wish to scan the verification code?",type:s.TT_SELECT,validation:r.required,condition:()=>!t.value,options:()=>[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},{id:"scanner_code",proxyID:"code",helpText:"Scan verification code",type:s.TT_BARCODE,validation:r.required,condition:e=>"Yes"===e.has_scanner.value&&!t.value,onValue:async e=>{t.value=await a.validateResetPasswordToken(e.replace(/-/g,"")),t.value?p.value="new_password":l("Invalid verification code")},config:{hiddenFooterBtns:["Next","Clear"]}},{id:"keyboard_code",proxyID:"code",helpText:"Enter verification Code",type:s.TT_TEXT,validation:r.required,condition:e=>"No"===e.has_scanner.value&&!t.value,beforeNext:async e=>(t.value=await a.validateResetPasswordToken(`${e.value}`.replace(/-/g,"")),!!t.value||(l("Invalid verification code"),!1)),config:{customKeyboard:[[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m","-","CAPS"]],[["Delete"],["Clear"]]]}},{id:"new_password",proxyID:"password",helpText:"New Password",type:s.TT_PASSWORD,condition:()=>t.value,validation:e=>r.required(e),computedValue:e=>`${e.value}`.toLowerCase(),config:{hiddenFooterBtns:["Back"]}},{id:"verify_password",proxyID:"password",helpText:"Confirm Password",type:s.TT_PASSWORD,condition:()=>t.value,validation:(e,a)=>r.validateSeries([()=>r.required(e),()=>e.value!==a.password.value?["Passwords do not match"]:null]),computedValue:e=>`${e.value}`.toLowerCase()}];async function T(e,o){try{await v.updateUser(a.userID,o)&&(await a.resetUserPasswordChangeCheck(),setTimeout((()=>{w.push("/login")}),100))}catch(t){h("Unable to save changes.. Make sure you're not reusing an old password")}}return(e,a)=>(d(),c(o,{cancelDestinationPath:"/login",fields:y,onFinishAction:T,activeField:p.value,"skip-summary":""},null,8,["activeField"]))}}))}}}));
