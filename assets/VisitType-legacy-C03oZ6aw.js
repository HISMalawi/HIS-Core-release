System.register(["./EncounterMixin.vue_vue_type_script_lang-legacy-qUwf12Yn.js","./index-legacy-CA6M7ipO.js","./encounter_guidelines-legacy-Bcz_Mw7r.js","./GuidelineEngine-legacy-KsvQuFdF.js","./HisStandardForm-legacy-a9YJRGaH.js"],(function(e,i){"use strict";var t,s,a,n,r,l,u,o,c,d,h,v,m;return{setters:[e=>{t=e._},e=>{s=e.bQ,a=e.aN,n=e.d,r=e.I,l=e.ad,u=e.ae,o=e.aa,c=e.af,d=e.a,h=e.c,v=e.w,m=e.b},null,null,null],execute:function(){class i extends s{lastVisitNumber;constructor(e,i){super(e,107,i),this.lastVisitNumber=0}async loadLastVisitNumber(){const e=await s.getJson(`programs/${this.programID}/patients/${this.patientID}/anc_visit`);!a.isEmpty(e)&&e.visit_number.length&&(this.lastVisitNumber=e.visit_number[e.visit_number.length-1])}}const b=n({components:{IonPage:r},mixins:[t],data:()=>({service:{},helpText:"ANC Visit Number"}),watch:{ready:{async handler(e){e&&(this.service=new i(this.patientID,this.providerID),await this.service.loadLastVisitNumber(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,i){await this.service.createEncounter();const t=await this.resolveObs(i);await this.service.saveObservationList(t),this.nextTask()},getFields(){return[{id:"visit_number",helpText:this.helpText,dynamicHelpText:()=>this.service.lastVisitNumber?`${this.helpText} (Last visit number: ${this.service.lastVisitNumber})`:this.helpText,defaultValue:()=>this.service.lastVisitNumber+1,type:l.TT_NUMBER,computedValue:e=>({obs:[this.service.buildValueNumber("Type of visit",e.value),this.service.buildValueCoded("Has extended ANC visits",e.value>8?"Yes":"No")]}),validation:e=>this.validateSeries([()=>u.required(e),()=>u.rangeOf(e,this.service.lastVisitNumber+1,15)])},{id:"reasons",helpText:"Provide reason for having more than 8 visits",type:l.TT_TEXT,computedValue:e=>({obs:this.service.buildValueText("Reason for extended ANC visits",e.value)}),condition:e=>e.visit_number.value>8,validation:e=>u.required(e)}]}}});e("default",o(b,[["render",function(e,i,t,s,a,n){const r=c("his-standard-form"),l=c("ion-page");return d(),h(l,null,{default:v((()=>[m(r,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])])),_:1})}]]))}}}));
