System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-BI1_Se6D.js","./index-legacy-CA6M7ipO.js","./TableReportTemplate-legacy-CB8GOx4t.js","./BasicReportTemplate-legacy-VHTBSvfP.js","./Export-legacy-SGgsNE3Q.js","./index-legacy-DZOKxSjk.js","./Pagination-legacy-BXR2lmLV.js","./HisStandardForm-legacy-a9YJRGaH.js","./ReportErrors-legacy-DajcGv3V.js"],(function(t,e){"use strict";var o,r,a,l,s,n,i,d,p,_,u,m,c,h;return{setters:[t=>{o=t._},t=>{r=t.cy,a=t.dd,l=t.d,s=t.as,n=t.aN,i=t.dz,d=t.aa,p=t.c,_=t.w,u=t.af,m=t.a,c=t.b},t=>{h=t.R},null,null,null,null,null,null],execute:function(){class e extends r{constructor(){super()}getTBPrevReport(){return this.getReport(`/programs/${this.programID}/reports/tb_prev2`)}getMaternalStatus(t){const e={start_date:this.startDate,end_date:this.endDate,date:this.date,program_id:this.programID,report_definition:"pepfar"};this.occupation&&(e.occupation=this.occupation);const o=a.parameterizeObjToString(e);return r.postJson(`vl_maternal_status?${o}`,{patient_ids:t})}}const w=l({mixins:[o],components:{ReportTemplate:h},data:()=>({title:"TB PREV Report",cohort:{},rows:[],columns:[[s.thTxt("",{colspan:3,sortable:!1,exportable:!1}),s.thTxt("Started new on ART",{colspan:2,sortable:!1,exportable:!1}),s.thTxt("Started previously on ART",{colspan:2,sortable:!1,exportable:!1}),s.thTxt("Completed New on ART",{colspan:2,sortable:!1,exportable:!1}),s.thTxt("Completed previously on ART",{colspan:2,sortable:!1,exportable:!1})],[s.thTxt("Age group"),s.thTxt("Gender"),s.thNum("3HP",{value:"3HP(Started New on ART)"}),s.thNum("6H",{value:"6H(Started New on ART)"}),s.thNum("3HP",{value:"3HP(Started Previously on ART)"}),s.thNum("6H",{value:"6H(Started Previously on ART)"}),s.thNum("3H",{value:"3HP(Completed New on ART)"}),s.thNum("6H",{value:"6H(Completed New on ART)"}),s.thNum("3H",{value:"3HP(Completed Previously on ART)"}),s.thNum("6H",{value:"6H(Completed Previously on ART)"})]]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,o){this.rows=[],this.report=new e,this.report.setOccupation(o.occupation),this.report.setStartDate(o.start_date),this.report.setEndDate(o.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTBPrevReport(),this.setRows("F"),this.setRows("M"),this.setTotalMaleRow(),this.setMaternityRows()},makeDrilldown(t,e){if(t.length){const o=[[s.thTxt("ARV#"),s.thTxt("Birthdate"),s.thTxt("TPT Initiation Date"),s.thTxt("Outcome"),s.thTxt("Art start date")]],r=()=>this.sortByArvNumber(t,"arv_number").map((t=>[s.td(t.arv_number),s.tdDate(t.birthdate),s.tdDate(t.tpt_initiation_date),s.td(t.outcome),s.tdDate(t.art_start_date)]));return s.tdLink(t.length,(()=>this.drilldownAsyncRows(e,o,r)))}return s.td(0)},aggregate(t,e,o){return Object.values(this.cohort).reduce(((r,a)=>[...a[t][e][o],...r]),[])},async setMaternityRows(){const t=["started_new_on_art","started_previously_on_art","completed_new_on_art","completed_previously_on_art"].reduce(((t,e)=>[...t,{group:"3HP",indicator:e,data:this.aggregate("F","3HP",e)},{group:"6H",indicator:e,data:this.aggregate("F","6H",e)}]),[]),e=await this.report.getMaternalStatus(n.uniq(t.reduce(((t,e)=>[...t,...e.data]),[]).map((t=>t.patient_id)))),o=(e,o)=>t.reduce(((t,r)=>r.indicator===e&&o===r.group?[...t,...r.data]:t),[]),r=(t,r,a)=>[this.makeDrilldown(o(r,"3HP").filter((o=>e[t].includes(o.patient_id))),`All ${a} (3HP)`),this.makeDrilldown(o(r,"6H").filter((o=>e[t].includes(o.patient_id))),`All ${a} (6H)`)],a=e.FBf.concat(e.FP),l=(t,e)=>[this.makeDrilldown(o(t,"3HP").filter((t=>!a.includes(t.patient_id))),`All ${e} (3HP)`),this.makeDrilldown(o(t,"6H").filter((t=>!a.includes(t.patient_id))),`All ${e} (6H)`)];this.rows.push([s.td("All"),s.td("FP"),...r("FP","started_new_on_art","Started new on ART"),...r("FP","started_previously_on_art","Started previously on ART"),...r("FP","completed_new_on_art","Completed new on ART"),...r("FP","completed_previously_on_art","Completed previously on ART")]),this.rows.push([s.td("All"),s.td("FNP"),...l("started_new_on_art","Started new on ART"),...l("started_previously_on_art","Started previously on ART"),...l("completed_new_on_art","Completed new on ART"),...l("completed_previously_on_art","Completed previously on ART")]),this.rows.push([s.td("All"),s.td("FBF"),...r("FBf","started_new_on_art","Started new on ART"),...r("FBf","started_previously_on_art","Started previously on ART"),...r("FBf","completed_new_on_art","Completed new on ART"),...r("FBf","completed_previously_on_art","Completed previously on ART")])},setTotalMaleRow(){this.rows.push([s.td("All"),s.td("Male"),this.makeDrilldown(this.aggregate("M","3HP","started_new_on_art"),"All male started new on 3HP"),this.makeDrilldown(this.aggregate("M","6H","started_new_on_art"),"All male started new on ART 6H"),this.makeDrilldown(this.aggregate("M","3HP","started_previously_on_art"),"All male started previously on ART 3HP"),this.makeDrilldown(this.aggregate("M","6H","started_previously_on_art"),"All male started previously on ART 6H"),this.makeDrilldown(this.aggregate("M","3HP","completed_new_on_art"),"All male completed new on ART 3HP"),this.makeDrilldown(this.aggregate("M","6H","completed_new_on_art"),"All male completed new on ART 6H"),this.makeDrilldown(this.aggregate("M","3HP","completed_previously_on_art"),"All male completed previously on ART 3HP"),this.makeDrilldown(this.aggregate("M","6H","completed_previously_on_art"),"All male completed previously on ART 6H")])},async setRows(t){for(const e in i){const o=i[e],r=this.cohort[o][t],a=this.formatGender(t);this.rows.push([s.td(o),s.td(a),this.makeDrilldown(r["3HP"].started_new_on_art,`${o} started new on ART 3HP (${a}s)`),this.makeDrilldown(r["6H"].started_new_on_art,`${o} started new on ART 6H (${a}s)`),this.makeDrilldown(r["3HP"].started_previously_on_art,`${o} started previously on ART 3HP (${a}s)`),this.makeDrilldown(r["6H"].started_previously_on_art,`${o} started previously on ART 6H (${a}s)`),this.makeDrilldown(r["3HP"].completed_new_on_art,`${o} completed new on ART 3HP (${a}s)`),this.makeDrilldown(r["6H"].completed_new_on_art,`${o} completed new on ART 6H (${a}s)`),this.makeDrilldown(r["3HP"].completed_previously_on_art,`${o} completed previously on ART 3HP (${a}s)`),this.makeDrilldown(r["6H"].completed_previously_on_art,`${o} completed previously on ART 6H (${a}s)`)])}}}});t("default",d(w,[["render",function(t,e,o,r,a,l){const s=u("report-template"),n=u("ion-page");return m(),p(n,null,{default:_((()=>[c(s,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,reportPrefix:"PEPFAR",config:{showIndex:!0},onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
