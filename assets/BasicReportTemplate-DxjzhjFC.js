import{d as I,W as U,$ as _,_ as V,a2 as A,a3 as O,r as S,aJ as E,aq as H,ch as L,a9 as z,a6 as $,ab as a,u as d,v as c,w as t,aF as q,G as l,Z as F,ci as M,H as w,x as s,z as v,al as G,b$ as Z,a5 as j,Q as J,U as K,R as Q,aZ as W,a4 as X,aj as f,ag as Y,c3 as R,aP as x}from"./index-5HNeqEZr.js";import{t as ee,a as oe}from"./Export-xOOutIU0.js";import{P as te}from"./Pagination-BI4Le8NT.js";const se=I({emits:["onItemsPerPage","onSearchFilter","onItemsVLtype"],components:{IonItem:U,IonCol:_,IonRow:V,IonInput:A,IonButton:O},props:{customFilter:{type:Function},totalRowCount:{type:Number,default:15e3},disableSearchFilter:{type:Boolean,default:!1},disablePerPageFilter:{type:Boolean,default:!1},showPerPageFilter:{type:Boolean,default:!1}},setup(e,{emit:o}){const m=S(50),i=S(""),y=S("");async function b(r,g){(await H.create({component:L,backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:r,onFinish:g}})).present()}function u(r){o("onSearchFilter",r)}function P(){i.value="",u("")}async function p(){typeof e.customFilter=="function"&&(y.value=await e.customFilter())}function h(){b({id:"search",helpText:"Search table data",defaultValue:()=>i.value,type:z.TT_TEXT},r=>{i.value=r?r.value:"",u(i.value)})}return E(m,r=>{typeof r=="number"&&o("onItemsPerPage",r)},{immediate:!0}),{reset:P,itemsPerPage:m,searchFilter:i,launchFilter:p,launchKeyboard:b,launchSearcher:h,customFilterValue:y}}}),ae=["disabled"],ne=["selected"],re=["selected"],le=["selected"],ie=["selected"],ue=["selected"],pe=["selected"],de=["selected","value"];function ce(e,o,m,i,y,b){const u=a("ion-col"),P=a("ion-input"),p=a("ion-button"),h=a("ion-item"),r=a("ion-row");return d(),c(r,null,{default:t(()=>[e.showPerPageFilter?(d(),c(u,{key:0},{default:t(()=>[q(l("select",{class:"input_display","onUpdate:modelValue":o[0]||(o[0]=g=>e.itemsPerPage=g),disabled:e.disablePerPageFilter},[l("option",{selected:e.itemsPerPage===5,value:5},"5 rows/page",8,ne),l("option",{selected:e.itemsPerPage===10,value:10},"10 rows/page",8,re),l("option",{selected:e.itemsPerPage===20,value:20},"20 rows/page",8,le),l("option",{selected:e.itemsPerPage===50,value:50},"50 rows/page",8,ie),l("option",{selected:e.itemsPerPage===100,value:100},"100 rows/page",8,ue),l("option",{selected:e.itemsPerPage===1e3,value:1e3},"1000 rows/page",8,pe),l("option",{selected:e.itemsPerPage===e.totalRowCount,value:e.totalRowCount},"Show all rows("+F(e.totalRowCount)+")",9,de)],8,ae),[[M,e.itemsPerPage]])]),_:1})):w("",!0),typeof e.customFilter=="function"?(d(),c(u,{key:1},{default:t(()=>[s(P,{class:"input_display",value:e.customFilterValue,onClick:e.launchFilter,placeholder:"Filter..."},null,8,["value","onClick"])]),_:1})):w("",!0),s(u,null,{default:t(()=>[s(h,{lines:"none"},{default:t(()=>[s(P,{disabled:e.disableSearchFilter,class:"input_display",value:e.searchFilter,onClick:e.launchSearcher,placeholder:"Search here..."},null,8,["disabled","value","onClick"]),e.searchFilter?(d(),c(p,{key:0,class:"reset_button",size:"large",onClick:o[1]||(o[1]=g=>e.reset()),color:"secondary"},{default:t(()=>o[2]||(o[2]=[v(" Reset ")])),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})}const me=$(se,[["render",ce],["__scopeId","data-v-7bf42b5b"]]),Pe=I({components:{IonCol:_,IonRow:V,Pagination:te,ReportTable:G,ReportFilter:me,HisFooter:Z,IonPage:j,IonHeader:J,IonContent:K,IonToolbar:Q,IonChip:W,IonFooter:X},props:{title:{type:String,required:!0},columns:{type:Array,required:!0},encryptPDF:{type:Boolean,default:!1},rows:{type:Array,default:()=>[]},rowParser:{type:Function},showFilters:{type:Boolean,default:!1},rowsPerPage:{type:Number},asyncRows:{type:Function},paginated:{type:Boolean,default:!1},customBtns:{type:Array,default:()=>[]},showReportStamp:{type:Boolean,default:!0},footerColor:{type:String,default:"dark"},customFileName:{type:String,default:""},canExport:{type:Boolean,default:!0},onFinish:{type:Function}},data:()=>({btns:[],isTableLoading:!1,searchFilter:"",itemsPerPage:50,currentPage:0,coreVersion:f.getCoreVersion(),tableRows:[],totalPages:0,activeColumns:[],activeRows:[],date:Y.toStandardHisDisplayFormat(f.getSessionDate()),apiVersion:f.getApiVersion(),siteUUID:f.getSiteUUID()}),methods:{getFileName(){return this.customFileName?this.customFileName:this.title},pdfEncryptionData(){const e=f.getUserName();return{encryption:{userPassword:e,ownerPassword:e,userPermissions:["print"]}}}},created(){this.btns=[...this.customBtns,{name:"CSV",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:()=>{const{columns:e,rows:o}=R(this.activeColumns,this.activeRows,"csvMode");ee(e,[...o,["Date Created: ".concat(this.date)],["HIS-Core Version: ".concat(this.coreVersion)],["API Version: ".concat(this.apiVersion)],["Site UUID: ".concat(this.siteUUID)],["Generated by: ".concat(f.getUserName())]],this.getFileName())}},{name:"PDF",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:async()=>{let e="pdfMode";this.encryptPDF&&(e=await x("Security warning","PDF may contain private data that will require a password to unlock","To access private data choose Secure PDF over Regular PDF",[{name:"Secure PDF",slot:"start",color:"success"},{name:"Regular PDF",slot:"start",color:"success"}],"his-danger-color")==="Secure PDF"?"pdfMode":"ignorePDFColumnexport");const{columns:o,rows:m}=R(this.activeColumns,this.activeRows,e);oe(o,m,this.getFileName(),!1,this.encryptPDF&&e!="ignorePDFColumnexport"?this.pdfEncryptionData():{})}},{name:"Finish",size:"large",slot:"end",color:"success",visible:!0,onClick:()=>{if(typeof this.onFinish=="function")return this.onFinish();this.$router.push({path:"/"})}}]}}),ge={class:"report-content"};function fe(e,o,m,i,y,b){const u=a("ion-col"),P=a("ion-row"),p=a("ion-toolbar"),h=a("report-filter"),r=a("ion-header"),g=a("report-table"),D=a("ion-content"),T=a("pagination"),C=a("ion-chip"),k=a("ion-footer"),B=a("his-footer"),N=a("ion-page");return d(),c(N,null,{default:t(()=>[s(r,null,{default:t(()=>[s(p,null,{default:t(()=>[s(P,null,{default:t(()=>[s(u,null,{default:t(()=>[l("h1",null,F(e.title),1)]),_:1})]),_:1})]),_:1}),s(p,null,{default:t(()=>[s(h,{showPerPageFilter:e.showFilters||e.paginated,disableSearchFilter:e.isTableLoading,disablePerPageFilter:e.isTableLoading,totalRowCount:e.tableRows.length,onOnItemsPerPage:o[0]||(o[0]=n=>e.itemsPerPage=n),onOnSearchFilter:o[1]||(o[1]=n=>e.searchFilter=n)},null,8,["showPerPageFilter","disableSearchFilter","disablePerPageFilter","totalRowCount"])]),_:1})]),_:1}),s(D,null,{default:t(()=>[l("div",ge,[s(g,{rows:e.rows,paginated:e.paginated,asyncRows:e.asyncRows,rowParser:e.rowParser,columns:e.columns,showFilters:e.showFilters,newPage:e.currentPage,searchFilter:e.searchFilter,rowsPerPage:e.itemsPerPage,onOnIsLoading:o[2]||(o[2]=n=>e.isTableLoading=n),onOnTableRows:o[3]||(o[3]=n=>e.tableRows=n),onOnPagination:o[4]||(o[4]=n=>e.totalPages=n.length),onOnActiveColumns:o[5]||(o[5]=n=>e.activeColumns=n),onOnActiveRows:o[6]||(o[6]=n=>e.activeRows=n)},null,8,["rows","paginated","asyncRows","rowParser","columns","showFilters","newPage","searchFilter","rowsPerPage"])])]),_:1}),s(k,null,{default:t(()=>[s(p,null,{default:t(()=>[!e.searchFilter&&e.paginated||!e.searchFilter&&e.totalPages>0&&e.paginated?(d(),c(T,{key:0,perPage:e.itemsPerPage,maxVisibleButtons:10,totalPages:e.totalPages,onOnChangePage:o[7]||(o[7]=n=>e.currentPage=n)},null,8,["perPage","totalPages"])):w("",!0)]),_:1}),e.showReportStamp?(d(),c(p,{key:0},{default:t(()=>[s(C,{color:"primary"},{default:t(()=>[o[8]||(o[8]=v("Date Created: ")),l("b",null,F(e.date),1)]),_:1}),s(C,{color:"primary"},{default:t(()=>[o[9]||(o[9]=v("His-Core Version: ")),l("b",null,F(e.coreVersion),1)]),_:1}),s(C,{color:"primary"},{default:t(()=>[o[10]||(o[10]=v("API Version: ")),l("b",null,F(e.apiVersion),1)]),_:1})]),_:1})):w("",!0)]),_:1}),s(B,{color:e.footerColor,btns:e.btns},null,8,["color","btns"])]),_:1})}const ye=$(Pe,[["render",fe]]);export{ye as D,me as R};
