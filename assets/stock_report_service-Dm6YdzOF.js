var c=Object.defineProperty;var p=(s,a,r)=>a in s?c(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r;var i=(s,a,r)=>p(s,typeof a!="symbol"?a+"":a,r);import{cy as o}from"./index-CMZASHAR.js";class d extends o{constructor(){super();i(this,"stock");this.stock=[]}async loadStock(){this.stock=await this.getReport("pharmacy/items",{paginate:!1})}getStockReport(){return o.getJson("pharmacy/stock_report",{paginate:!1})}getStockCardReport(){return this.getReport("programs/".concat(this.programID,"/reports/stock_card"))}loadTrail(){return this.getReport("pharmacy/audit_trail/grouped")}getTrailDetails(r,e,t){return this.getReport("pharmacy/audit_trail",{transaction_date:r,drug_id:e,transaction_reason:t})}getScCurrReport(){return this.getReport("programs/1/reports/sc_curr")}getDiscrepancyReport(){return this.getReport("programs/".concat(this.programID,"/reports/discrepancy_report"))}groupStock(){const r={};for(const e in this.stock){const t=this.stock[e],n=t.drug_id;r[n]||(r[n]={current_quantity:0,dispensed_quantity:0,pack_size:t.pack_size,drug_name:t.drug_name===null?t.drug_legacy_name:t.drug_name}),t.current_quantity!==0&&(r[n].current_quantity+=parseFloat(t.current_quantity),t.dispensed_quantity&&(r[n].dispensed_quantity+=parseFloat(t.dispensed_quantity)))}return Object.values(r).map(e=>{let t="0";return e.pack_size==null?t=e.current_quantity+"(tabs)":t=Math.trunc(e.current_quantity/e.pack_size),{drugName:e.drug_name,quantintyDispensed:e.dispensed_quantity,currentQuantity:t,quantityIsTabs:e.pack_size===null}})}}export{d as S};
