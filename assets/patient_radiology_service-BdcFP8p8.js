import{bL as l,bs as c,am as r,aN as u,S as g,H as p}from"./index-DOO_dFo7.js";class y extends l{constructor(t,e){super(t,121,e)}static async getRadiologyList(t,e=""){return c.getConceptSet(t,e)}async getRadiologyObs(t){try{const e="radiology/radiology_orders?patient_id="+t;return await r.getJson(e)}catch(e){return 0}}async showPreviousRadiolgy(t){return(await this.getRadiologyObs(t.getID())).length>0}async getPreviousRadiologyExaminations(t){const e=await r.getThirdpartyApps();let a="";for(const n of e)n.name=="pacs"&&(a=n.url);u.isEmpty(a)&&(a="opd/encounters/radiology/".concat(this.patientID));const s=await this.getRadiologyObs(t.getID());return s.length>0?{data:s,url:a}:!1}async submitToPacs(t,e){let a;for(const o of t)a=o.children[0].accession_number;const s=await Promise.all(t.map(async o=>({main_value_text:o.value_text,obs_id:o.obs_id,sub_value_text:o.children[0].value_text}))),n={patient_name:e.getFullName(),patientAge:e.getAge(),patientDOB:e.getBirthdate(),patientGender:e.getGender(),national_id:e.getNationalID(),person_id:e.getID(),encounter_id:this.getEncounterID(),date_created:this.getDate(),accession_number:a},i={username:r.getUserName(),userID:r.getUserID(),userRoles:r.getUserRoles()};return r.postJson("radiology/radiology_orders",{patient_details:n,physician_details:i,radiology_orders:s})}async getAccesionNumber(){return(await r.getJson("sequences/next_accession_number")).accession_number}async obsObj(t){const e=await this.getAccesionNumber(),a=[];for(const s of t)a.push({concept_id:s.concept_id,value_text:await c.getConceptName(s.child.concept_id),child:[{concept_id:s.child.concept_id,accession_number:e,value_text:await c.getConceptName(s.child.value_coded)}]});return a}async printOrders(t,e){const a=new g,s=e.getNationalID(),n=e.getFullName(),i=[];for(const o of t){const d=o.value_text+": "+o.children[0].value_text;i.push("/radiology/barcode?accession_number=".concat(o.children[0].accession_number,"&patient_national_id=").concat(s,"&patient_name=").concat(n,"&radio_order=").concat(d,"&date_created=").concat(p.toStandardHisDisplayFormat(o.obs_datetime)))}await a.batchPrintLbls(i,!0)}}export{y as P};
