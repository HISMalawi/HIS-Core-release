var f=Object.defineProperty;var v=(t,r,o)=>r in t?f(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o;var p=(t,r,o)=>v(t,typeof r!="symbol"?r+"":r,o);import{bM as T,d as R,I as w,L as e,F as y,V as b,ae as c,_ as x,r as g,o as S,c as _,w as C,b as I}from"./index-BHR-Bvru.js";import{_ as A}from"./ReportMixin.vue_vue_type_script_lang-B3e-CpEM.js";import{R as E}from"./TableReportTemplate-BEXWX8HX.js";import"./BasicReportTemplate-ytL0-QT3.js";import"./Export-C00HI6jU.js";import"./Pagination-DHZzCz5x.js";import"./HisStandardForm-BjRuivl7.js";import"./ReportErrors-AdUv7FI5.js";var u=(t=>(t.GENERAL="General",t.CHILDREN="Children",t.WOMEN="Women",t))(u||{});class G extends T{constructor(){super();p(this,"ageGroup");p(this,"quarter");p(this,"regenerate");this.quarter="",this.regenerate=!1,this.ageGroup="General"}setRegenerate(o){this.regenerate=o}getAgeGroup(){return this.ageGroup}setQuarter(o){this.quarter=o}setAgeGroup(o){this.ageGroup=o}getSurvivalAnalysis(){return this.getReport("cohort_survival_analysis",{quarter:this.quarter,regenerate:this.regenerate,date:this.date,age_group:this.ageGroup,program_id:this.programID})}}const m={style:{borderRight:"5px solid black !important"}},D=R({mixins:[A],components:{ReportTemplate:E,IonPage:w},data:()=>({title:"Survival analysis report",totalClients:[],rows:[],columns:[[e.thTxt("Reg cohort"),e.thTxt("Interval (months)"),e.thTxt("Sub group"),e.thTxt("Total Reg (database)"),e.thTxt("Total Reg (Confirmed)",m),e.thTxt("Alive"),e.thTxt("Died"),e.thTxt("Defaulted"),e.thTxt("Stopped"),e.thTxt("TO"),e.thTxt("Unknown")]]}),created(){this.fields=[...this.getDateDurationFields(!0,!1,17),{id:"group",helpText:"Select sub-group",type:y.TT_SELECT,validation:t=>b.required(t),options:()=>[{label:"General",value:u.GENERAL},{label:"Children",value:u.CHILDREN},{label:"Option B+",value:u.WOMEN}]}]},methods:{async onPeriod({quarter:t,group:r},o,a=!1){this.rows=[],this.period=t.label,this.report=new G,this.report.setOccupation(o.occupation),this.report.setRegenerate(a),this.report.setQuarter(t.label),this.report.setAgeGroup(r.value);const n=await this.report.getSurvivalAnalysis();this.title="Survival analysis report ".concat(r.label),this.rows=this.getRows(n)},getRows(t){return Object.keys(t).filter(r=>!c.isEmpty(t[r])).sort((r,o)=>{const a=r.split(" ")[1],n=o.split(" ")[1];return parseInt(a)-parseInt(n)}).map(r=>{const o=t[r];let a=0,n=0;const s={"On antiretrovirals":0,Defaulted:0,"Patient died":0,"Treatment stopped":0,"Patient transferred out":0,unknown:0};if(!c.isEmpty(o)){for(const i in o){const l=o[i];for(const h in l){const d=l[h];a=parseInt(h),i in s?s[i]=d:s.unknown=d,n+=d}}return[e.td(r),e.td(a),e.td(this.report.getAgeGroup()),e.td(n),e.td("",m),e.td(s["On antiretrovirals"]),e.td(s["Patient died"]),e.td(s.Defaulted),e.td(s["Treatment stopped"]),e.td(s["Patient transferred out"]),e.td(s.unknown)]}})}}});function k(t,r,o,a,n,s){const i=g("report-template"),l=g("ion-page");return S(),_(l,null,{default:C(()=>[I(i,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!1},reportPrefix:"MoH",hasServerSideCaching:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}const H=x(D,[["render",k]]);export{H as default};
