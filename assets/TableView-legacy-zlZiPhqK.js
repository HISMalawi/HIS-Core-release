System.register(["./index-legacy-pSEoxn3J.js","./Export-legacy-YUdcFBN9.js"],(function(e,a){"use strict";var t,l,o,n,r,c,s,i,u,d,f,p,h,y,g,m,b,v,k,C,P,w,x,S,_,I,D,V,T,F,z,$,R,E,U,H,K,M,O,B,L,j,N,A,Q,Y,q,W,G,J,X,Z;return{setters:[e=>{t=e.d,l=e.ca,o=e.cb,n=e.b1,r=e.ba,c=e.cc,s=e.I,i=e.k,u=e.i,d=e.a4,f=e.a5,p=e.ah,h=e.aE,y=e.a7,g=e.l,m=e.r,b=e.c,v=e.aR,k=e.cd,C=e.ce,P=e.cf,w=e.cg,x=e.ch,S=e.ci,_=e.cj,I=e.ck,D=e.as,V=e.a$,T=e.B,F=e.S,z=e.b4,$=e.cl,R=e.cm,E=e.cn,U=e.co,H=e.a_,K=e.am,M=e.h,O=e.e,B=e.w,L=e.a,j=e.a6,N=e.ar,A=e.j,Q=e.g,Y=e.t,q=e.a9,W=e.aa,G=e.b,J=e.bc},e=>{X=e.t,Z=e.a}],execute:function(){var a=document.createElement("style");a.textContent="th[data-v-2ab83098],td[data-v-2ab83098]{border-collapse:collapse;min-width:160px;border:1px solid rgb(158,158,158)}td[data-v-2ab83098]{font-weight:500;font-size:.8em;padding:.4em}.stick-report-header[data-v-2ab83098]{position:sticky;top:0;z-index:1000}tr[data-v-2ab83098]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-2ab83098]{color:#0645ad}.his-floating-keyboard[data-v-2ab83098]{bottom:70px!important}\n/*$vite$:1*/",document.head.appendChild(a);const ee=t({components:{IonToolbar:g,IonItem:y,IonIcon:h,IonLabel:p,IonTitle:f,IonHeader:d,IonButton:u,IonFooter:i,IonContent:s,IonButtons:c,IonChip:r,HisKeyboard:n,IonThumbnail:o,IonImg:l},props:{title:{type:String,default:"Report"},headerBadge:{type:Object},iconUrl:{type:String},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},enablePagination:{type:Boolean,default:!0},rowsPerPage:{type:Number,default:10},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},reportPrefix:{type:String,default:""},defaultSortedColumn:{type:String},defaultSortOrder:{type:String,default:"desc"}},setup(e){const a=D(),t=m([]),l=m(0),o=m(""),n=m(""),r=m("desc"),c=m(!1),s=b((()=>{let a=t.value;return r.value&&n.value&&(a=E(t.value)[r.value]((e=>e.sortData[n.value]))),o.value?new U(a,{threshold:.3,keys:["searchIndex"],useExtendedSearch:!0}).search(o.value,{limit:e.rowsPerPage}).map((e=>e.item)):a})),i=b((()=>H.chunk(s.value,e.rowsPerPage).length)),u=b((()=>l.value+2<=i.value)),d=b((()=>l.value>0)),f=b((()=>H.chunk(s.value,e.rowsPerPage)[l.value])),p=()=>e.columns.reduce(((e,a)=>e.concat(a)),[]).filter((e=>e.value||e.ref)),h=(a,l=!1)=>{const o=p().filter((e=>["pdf"!==a||"boolean"!=typeof e.encrypted||e?.encrypted&&!l,"csv"!==a||!e?.encrypted,!e.canExport||e?.canExport[a],"boolean"!=typeof e.exportable||e.exportable].every(Boolean))),n=o.map((e=>e.exportedValue&&e.exportedValue.column?e.exportedValue.column(e):e.secondaryLabel||e.label)),r=o.map((e=>e.ref));return{headers:n,rows:t.value.reduce(((e,a)=>[...e,a.row.filter((({column:e})=>r.includes(e.ref))).map((e=>e.column.exportedValue&&e.column.exportedValue.dataValue?e.column.exportedValue.dataValue(e):e.value))]),[]),filename:`${e.reportPrefix} ${F.getLocationName()??""} ${$(e.title).replace(e.reportPrefix,"")} ${R(e.csvQuarter??e.subtitle??"")}`}},y=e=>{e.forEach((e=>{const a={...e},l=p().map((t=>{let l="";const o=e[t.ref];try{l=H.isEmpty(e)?"":"function"==typeof t.toValue?`${t.toValue(o)}`:"function"==typeof t.value?t.value(e):e[t.ref]||""}catch(n){l=t?.defaultValue??"_ERROR_"}return a[t.ref]=l,"function"==typeof t.sortValue&&(a[t.ref]=t.sortValue(o)),{column:t,refData:o,value:l,data:e}}));t.value.push({row:l,data:e,sortData:a,searchIndex:[...l,l.map((e=>e.value)).join(" ")]})}))};return v((()=>e.columnData),(a=>{if(t.value=[],!Array.isArray(a)||!a.length)return l.value=0,o.value="",n.value=e.defaultSortedColumn??"",r.value=e.defaultSortOrder,void y(Array.from({length:0}).map((()=>({}))));y(a)}),{immediate:!0,deep:!0}),{first:()=>l.value=0,last:()=>l.value=i.value-1||0,next:()=>l.value+=1,prev:()=>l.value-=1,selectPage:()=>I((e=>{const a=parseInt(e);parseInt(e)<=i.value&&(l.value=a)}),{title:"Select page"}),sortColumn:e=>{n.value=e,r.value="asc"===r.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(a){console.error(a)}},toPDF:async()=>{let e;if(p().some((e=>e?.encrypted))&&"Secure PDF"===await V("Security warning","PDF may contain private data that will require a password to unlock","To access private data choose Secure PDF over Regular PDF",[{name:"Secure PDF",slot:"start",color:"success"},{name:"Regular PDF",slot:"start",color:"success"}],"his-danger-color")){const a=F.getUserName();e={encryption:{userPassword:a,ownerPassword:a,userPermissions:["print"]}}}const{headers:a,rows:t,filename:l}=h("pdf",!e);X([a],t,l,!0,e)},toCSV:()=>{const{headers:a,rows:t,filename:l}=h("csv");Z([a],[...t,[`Date Created: ${T().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${F.getCoreVersion()}`],[`API Version: ${F.getApiVersion()}`],[`Site UUID: ${F.getSiteUUID()}`],[`Generated by: ${F.getUserName()}`]],l)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():a.push("/")},filterTable:e=>{o.value=z(e,o.value),l.value=0},sync:_,search:S,close:x,arrowUp:w,arrowDown:P,funnelOutline:C,page:f,canNext:u,searchTerm:o,totalPages:i,sortOrder:r,canPrev:d,currentPage:l,columnSorted:n,QWERTY:k,showSearchKeyboard:c}}}),ae={key:0},te={class:"his-sm-text"},le={style:{width:"100%"}},oe={class:"stick-report-header"},ne=["colspan","rowspan","onClick"],re=["onClick"],ce=["innerHTML"];e("v",K(ee,[["render",function(e,a,t,l,o,n){const r=N("ion-img"),c=N("ion-thumbnail"),s=N("ion-title"),i=N("ion-icon"),u=N("ion-button"),d=N("ion-label"),f=N("ion-chip"),p=N("ion-buttons"),h=N("ion-toolbar"),y=N("ion-header"),g=N("ion-item"),m=N("ion-content"),b=N("his-keyboard"),v=N("ion-footer");return G(),M(q,null,[O(y,null,{default:B((()=>[O(h,null,{default:B((()=>[e.iconUrl?(G(),L(c,{key:0,slot:"start"},{default:B((()=>[O(r,{src:e.iconUrl},null,8,["src"])])),_:1})):j("",!0),O(s,{slot:"start",class:"his-md-text"},{default:B((()=>[A(Y(e.title)+" ",1),e.subtitle?(G(),M("br",ae)):j("",!0),Q("span",te,Y(e.subtitle),1)])),_:1}),O(p,{slot:"end"},{default:B((()=>["function"==typeof e.onConfigure?(G(),L(u,{key:0,onClick:a[0]||(a[0]=()=>e.onConfigure?e.onConfigure():null)},{default:B((()=>[O(i,{size:"large",icon:e.funnelOutline},null,8,["icon"])])),_:1})):j("",!0),e.searchTerm?(G(),L(f,{key:1,onClick:a[1]||(a[1]=()=>{e.searchTerm="",e.showSearchKeyboard=!1}),class:"his-md-text",color:"primary"},{default:B((()=>[O(d,null,{default:B((()=>[A(Y(e.searchTerm?`Search: ${e.searchTerm}`:""),1)])),_:1}),O(i,{icon:e.close},null,8,["icon"])])),_:1})):j("",!0),O(u,{color:e.showSearchKeyboard?"primary":"dark",onClick:a[2]||(a[2]=()=>e.showSearchKeyboard=!e.showSearchKeyboard),size:"large"},{default:B((()=>[O(i,{size:"large",icon:e.search},null,8,["icon"])])),_:1},8,["color"]),"function"==typeof e.onRefresh?(G(),L(u,{key:2,onClick:a[3]||(a[3]=()=>e.onRefresh?e.onRefresh():null),color:"success",size:"large"},{default:B((()=>[O(i,{size:"large",icon:e.sync},null,8,["icon"])])),_:1})):j("",!0)])),_:1})])),_:1}),(e.headerBadge||[]).length?(G(),L(h,{key:0,color:"light"},{default:B((()=>[(G(!0),M(q,null,W(e.headerBadge,((a,t)=>(G(),L(f,{onClick:e=>"function"==typeof a.action?a.action():null,key:t,color:a?.color||"dark"},{default:B((()=>[O(i,{icon:a?.icon||e.search},null,8,["icon"]),O(d,{innerHTML:a.text},null,8,["innerHTML"])])),_:2},1032,["onClick","color"])))),128))])),_:1})):j("",!0)])),_:1}),O(m,{"scroll-y":"","scroll-x":""},{default:B((()=>[Q("table",le,[Q("thead",oe,[(G(!0),M(q,null,W(e.columns,((a,t)=>(G(),M("tr",{key:t},[(G(!0),M(q,null,W(a,((a,t)=>(G(),M("th",{key:t,colspan:a?.span?.thColspan||1,rowspan:a?.span?.thRowspan||1,onClick:t=>e.sortColumn(a.ref)},[O(g,{lines:"none"},{default:B((()=>[e.columnSorted&&e.columnSorted===a.ref?(G(),L(i,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):j("",!0),O(d,null,{default:B((()=>[Q("b",null,Y(a.label),1)])),_:2},1024)])),_:2},1024)],8,ne)))),128))])))),128))]),Q("tbody",null,[(G(!0),M(q,null,W(e.page,((a,t)=>(G(),M("tr",{key:t},[(G(!0),M(q,null,W(a.row,((a,t)=>(G(),M("td",{key:t,onClick:()=>e.onClickTablecell(a),class:J({"clickable-cell":a?.column?.tdClick})},[Q("span",{innerHTML:a.value,class:"his-sm-text"},null,8,ce)],10,re)))),128))])))),128))])])])),_:1}),O(v,null,{default:B((()=>[e.showSearchKeyboard?(G(),L(b,{key:0,kbConfig:e.QWERTY,onKeyPress:e.filterTable},null,8,["kbConfig","onKeyPress"])):j("",!0),O(h,{color:"dark"},{default:B((()=>[O(u,{onClick:a[4]||(a[4]=a=>e.toCSV()),size:"large"},{default:B((()=>[A(" CSV ")])),_:1}),O(u,{onClick:a[5]||(a[5]=a=>e.toPDF()),size:"large"},{default:B((()=>[A(" PDF ")])),_:1}),e.totalPages>1?(G(),L(u,{key:0,onClick:e.first,disabled:0===e.currentPage||e.totalPages<=2,size:"large",slot:"end"},{default:B((()=>[A(" First ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(G(),L(u,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:B((()=>[A(" Prev ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(G(),L(u,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:B((()=>[A(Y(e.currentPage)+" / "+Y(e.totalPages-1),1)])),_:1},8,["onClick"])):j("",!0),e.totalPages>1?(G(),L(u,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:B((()=>[A(" Next ")])),_:1},8,["onClick","disabled"])):j("",!0),e.totalPages>1?(G(),L(u,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:B((()=>[A(" Last ")])),_:1},8,["onClick","disabled"])):j("",!0),O(u,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:B((()=>[A(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-2ab83098"]]))}}}));
