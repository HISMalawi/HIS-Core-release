System.register(["./index-legacy-DLdqxVnr.js","./HisStandardForm-legacy-D9LtBbE8.js","./useEncounter-legacy-BWIHzFlJ.js","./identifier_service-legacy-CDoyf5iP.js","./isEmpty-legacy-0aF-DGmx.js","./encounter_guidelines-legacy-Cn5GVi4r.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,a){"use strict";var t,i,n,l,s,r,u,d,o,c,y,g,I,f,p,v,T,N;return{setters:[e=>{t=e.d,i=e.r,n=e.am,l=e.a9,s=e.aa,r=e.u,u=e.v,d=e.w,o=e.x,c=e.y,y=e.dV,g=e.aJ,I=e.O,f=e.as,p=e.a5},e=>{v=e.H},e=>{T=e.u},e=>{N=e.I},null,null,null],execute:function(){e("default",t({__name:"NationalID",setup(e){const a=i([]),t=i(),D=n(),w=()=>!/unknown/i.test(t.value.getMWNationalID()),{goToNextTask:E,patientDashboardUrl:_}=T(((e,i,n)=>{t.value=n,a.value=[{id:"currentNationalID",helpText:"Current national identifier:",type:l.TT_TEXT_BANNER,condition:()=>!D.query.reassign&&w(),options:()=>{const e=`<b>${n.getMWNationalID()}</b>`;return[{label:e,value:e}]}},{id:"patientIdentifier",helpText:"Malawi National ID",type:l.TT_TEXT,defaultValue:()=>w()?n.getMWNationalID():"",validation:e=>s.validateSeries([()=>s.required(e),()=>s.isMWNationalID(e)])}]}));async function m(e){const a=`${e.patientIdentifier.value}`,i=new N;if(i.identifierType=y.MW,!g.isEmpty(await i.getPatientsByIdentifier(a)))return I("ID was already assigned",15e3);if(D.query.reassign){const a=parseInt(`${D.query.reassign}`);await t.value.changeMwNationalId(a,e.patientIdentifier.value)}else await t.value.updateMWNationalId(e.patientIdentifier.value);f.invalidate("ACTIVE_PATIENT"),E()}return(e,t)=>(r(),u(c(p),null,{default:d((()=>[o(v,{cancelDestinationPath:c(_),onFinishAction:m,fields:a.value,skipSummary:!0},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
