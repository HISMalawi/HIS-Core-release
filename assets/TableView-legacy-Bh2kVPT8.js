System.register(["./index-legacy-CHWOUhn2.js","./Export-legacy-B3zQASob.js"],(function(e,t){"use strict";var l,o,a,n,r,c,i,s,u,d,f,p,h,g,y,m,b,k,v,C,x,P,w,_,I,S,z,V,T,D,F,$,R,E,K,U,B,M,j,A,H,O,L,N,Q,Y,q,W,G,J,X;return{setters:[e=>{l=e.d,o=e.i,a=e.h,n=e.av,r=e.D,c=e.k,i=e.j,s=e.f,u=e.m,d=e.l,f=e.cd,p=e.au,h=e.ak,g=e.bx,y=e.by,m=e.J,b=e.K,k=e.M,v=e.ab,C=e.ch,x=e.ci,P=e.cj,w=e.ck,_=e.cl,I=e.cm,S=e.cn,z=e.co,V=e.b3,T=e.S,D=e.an,F=e.cp,$=e.cq,R=e.ae,E=e.bz,K=e.cr,U=e._,B=e.r,M=e.o,j=e.x,A=e.b,H=e.w,O=e.c,L=e.z,N=e.u,Q=e.v,Y=e.A,q=e.B,W=e.y,G=e.ay},e=>{J=e.a,X=e.t}],execute:function(){var t=document.createElement("style");t.textContent="th[data-v-540e223c],td[data-v-540e223c]{width:4%;border-collapse:collapse;text-align:center}td[data-v-540e223c]{border-bottom:1px solid rgb(165,165,165);padding:.6em;font-weight:500;font-size:.8em}.stick-report-header[data-v-540e223c]{background:#fff;border-bottom:2px solid #ccc;position:sticky;top:0;z-index:1000}tr[data-v-540e223c]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-540e223c]{color:#0645ad;font-weight:600;font-size:1em}.his-floating-keyboard[data-v-540e223c]{bottom:70px!important}\n",document.head.appendChild(t);const Z=l({components:{IonToolbar:o,IonItem:a,IonIcon:n,IonLabel:r,IonTitle:c,IonHeader:i,IonButton:s,IonFooter:u,IonContent:d,IonButtons:f,IonChip:p,HisKeyboard:h,IonThumbnail:g,IonImg:y},props:{title:{type:String,default:"Report"},headerBadge:{type:Object},iconUrl:{type:String},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},enablePagination:{type:Boolean,default:!0},rowsPerPage:{type:Number,default:10},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},reportPrefix:{type:String,default:""}},setup(e){const t=m(),l=b([]),o=b(0),a=b(""),n=b(""),r=b("desc"),c=b(!1),i=k((()=>{let t=l.value;return r.value&&n.value&&(t=F(l.value)[r.value]((e=>e.data[n.value]))),a.value?new $(t,{threshold:.3,keys:["searchIndex"],useExtendedSearch:!0}).search(a.value,{limit:e.rowsPerPage}).map((e=>e.item)):t})),s=k((()=>R.chunk(i.value,e.rowsPerPage).length)),u=k((()=>o.value+2<=s.value)),d=k((()=>o.value>0)),f=k((()=>R.chunk(i.value,e.rowsPerPage)[o.value])),p=()=>e.columns.reduce(((e,t)=>e.concat(t)),[]).filter((e=>e.value||e.ref)),h=t=>{const o=p().filter((e=>[!e.canExport||e?.canExport[t],"boolean"!=typeof e.exportable||e.exportable].every(Boolean))),a=o.map((e=>e.exportedValue&&e.exportedValue.column?e.exportedValue.column(e):e.secondaryLabel||e.label)),n=o.map((e=>e.ref));return{headers:a,rows:l.value.reduce(((e,t)=>[...e,t.row.filter((({column:e})=>n.includes(e.ref))).map((e=>e.column.exportedValue&&e.column.exportedValue.dataValue?e.column.exportedValue.dataValue(e):e.value))]),[]),filename:`${e.reportPrefix} ${T.getLocationName()??""} ${E(e.title).replace(e.reportPrefix,"")} ${K(e.csvQuarter??e.subtitle??"")}`}},g=e=>{e.forEach((e=>{const t=p().map((t=>{let l="";const o=e[t.ref];try{l=R.isEmpty(e)?"...":"function"==typeof t.toValue?`${t.toValue(o)}`:"function"==typeof t.value?t.value(e):e[t.ref]||""}catch(a){l=t?.defaultValue||"_ERROR_",console.error(a)}return{column:t,refData:o,value:l,data:e}}));l.value.push({row:t,data:e,searchIndex:[...t,t.map((e=>e.value)).join(" ")]})}))};return v((()=>e.columnData),(t=>{if(l.value=[],!Array.isArray(t)||!t.length)return o.value=0,a.value="",n.value="",void g(Array.from({length:e.rowsPerPage}).map((()=>({}))));g(t)}),{immediate:!0,deep:!0}),{first:()=>o.value=0,last:()=>o.value=s.value-1||0,next:()=>o.value+=1,prev:()=>o.value-=1,selectPage:()=>z((e=>{const t=parseInt(e);parseInt(e)<=s.value&&(o.value=t)}),{title:"Select page"}),sortColumn:e=>{n.value=e,r.value="asc"===r.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(t){console.error(t)}},toPDF:()=>{const{headers:e,rows:t,filename:l}=h("pdf");J([e],t,l,!0)},toCSV:()=>{const{headers:t,rows:l,filename:o}=h("csv");X([t],[...l,[`Date Created: ${V().format("DD/MMM/YYYY HH:MM:ss")}`],[`Quarter: ${e.csvQuarter||e.subtitle}`],[`HIS-Core Version: ${T.getCoreVersion()}`],[`API Version: ${T.getApiVersion()}`],[`Site UUID: ${T.getSiteUUID()}`],[`Generated by: ${T.getUserName()}`]],o)},finish:()=>{"function"==typeof e.onFinish?e.onFinish():t.push("/")},filterTable:e=>{a.value=D(e,a.value),o.value=0},sync:C,search:x,close:P,arrowUp:w,arrowDown:_,funnelOutline:I,page:f,canNext:u,searchTerm:a,totalPages:s,sortOrder:r,canPrev:d,currentPage:o,columnSorted:n,QWERTY:S,showSearchKeyboard:c}}}),ee={key:0},te={class:"his-sm-text"},le={class:"art-report-theme"},oe={class:"stick-report-header"},ae=["colspan","rowspan","onClick"],ne=["onClick"],re={class:"his-sm-text"};e("v",U(Z,[["render",function(e,t,l,o,a,n){const r=B("ion-img"),c=B("ion-thumbnail"),i=B("ion-title"),s=B("ion-icon"),u=B("ion-button"),d=B("ion-label"),f=B("ion-chip"),p=B("ion-buttons"),h=B("ion-toolbar"),g=B("ion-header"),y=B("ion-item"),m=B("ion-content"),b=B("his-keyboard"),k=B("ion-footer");return M(),j(q,null,[A(g,null,{default:H((()=>[A(h,null,{default:H((()=>[e.iconUrl?(M(),O(c,{key:0,slot:"start"},{default:H((()=>[A(r,{src:e.iconUrl},null,8,["src"])])),_:1})):L("",!0),A(i,{slot:"start",class:"his-md-text"},{default:H((()=>[N(Q(e.title)+" ",1),e.subtitle?(M(),j("br",ee)):L("",!0),Y("span",te,Q(e.subtitle),1)])),_:1}),A(p,{slot:"end"},{default:H((()=>["function"==typeof e.onConfigure?(M(),O(u,{key:0,onClick:t[0]||(t[0]=()=>e.onConfigure?e.onConfigure():null)},{default:H((()=>[A(s,{size:"large",icon:e.funnelOutline},null,8,["icon"])])),_:1})):L("",!0),e.searchTerm?(M(),O(f,{key:1,onClick:t[1]||(t[1]=()=>{e.searchTerm="",e.showSearchKeyboard=!1}),class:"his-md-text",color:"primary"},{default:H((()=>[A(d,null,{default:H((()=>[N(Q(e.searchTerm?`Search: ${e.searchTerm}`:""),1)])),_:1}),A(s,{icon:e.close},null,8,["icon"])])),_:1})):L("",!0),A(u,{color:e.showSearchKeyboard?"primary":"dark",onClick:t[2]||(t[2]=()=>e.showSearchKeyboard=!e.showSearchKeyboard),size:"large"},{default:H((()=>[A(s,{size:"large",icon:e.search},null,8,["icon"])])),_:1},8,["color"]),"function"==typeof e.onRefresh?(M(),O(u,{key:2,onClick:t[3]||(t[3]=()=>e.onRefresh?e.onRefresh():null),color:"success",size:"large"},{default:H((()=>[A(s,{size:"large",icon:e.sync},null,8,["icon"])])),_:1})):L("",!0)])),_:1})])),_:1}),(e.headerBadge||[]).length?(M(),O(h,{key:0,color:"light"},{default:H((()=>[(M(!0),j(q,null,W(e.headerBadge,((t,l)=>(M(),O(f,{onClick:e=>"function"==typeof t.action?t.action():null,key:l,color:t?.color||"dark"},{default:H((()=>[A(s,{icon:t?.icon||e.search},null,8,["icon"]),A(d,{innerHTML:t?.text},null,8,["innerHTML"])])),_:2},1032,["onClick","color"])))),128))])),_:1})):L("",!0)])),_:1}),A(m,{"scroll-y":"","scroll-x":""},{default:H((()=>[Y("table",le,[Y("thead",oe,[(M(!0),j(q,null,W(e.columns,((t,l)=>(M(),j("tr",{key:l},[(M(!0),j(q,null,W(t,((t,l)=>(M(),j("th",{key:l,colspan:t?.span?.thColspan||1,rowspan:t?.span?.thRowspan||1,onClick:l=>e.sortColumn(t.ref)},[A(y,{lines:"none"},{default:H((()=>[e.columnSorted&&e.columnSorted===t.ref?(M(),O(s,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):L("",!0),A(d,{class:"ion-text-center"},{default:H((()=>[Y("b",null,Q(t.label),1)])),_:2},1024)])),_:2},1024)],8,ae)))),128))])))),128))]),Y("tbody",null,[(M(!0),j(q,null,W(e.page,((t,l)=>(M(),j("tr",{key:l},[(M(!0),j(q,null,W(t.row,((t,l)=>(M(),j("td",{key:l,onClick:()=>e.onClickTablecell(t),class:G({"clickable-cell":t?.column?.tdClick})},[Y("span",re,Q(t.value),1)],10,ne)))),128))])))),128))])])])),_:1}),A(k,null,{default:H((()=>[e.showSearchKeyboard?(M(),O(b,{key:0,kbConfig:e.QWERTY,onKeyPress:e.filterTable},null,8,["kbConfig","onKeyPress"])):L("",!0),A(h,{color:"dark"},{default:H((()=>[A(u,{onClick:t[4]||(t[4]=t=>e.toCSV()),size:"large"},{default:H((()=>[N(" CSV ")])),_:1}),A(u,{onClick:t[5]||(t[5]=t=>e.toPDF()),size:"large"},{default:H((()=>[N(" PDF ")])),_:1}),e.totalPages>1?(M(),O(u,{key:0,onClick:e.first,disabled:0===e.currentPage||e.totalPages<=2,size:"large",slot:"end"},{default:H((()=>[N(" First ")])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(M(),O(u,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:H((()=>[N(" Prev ")])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(M(),O(u,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:H((()=>[N(Q(e.currentPage)+" / "+Q(e.totalPages-1),1)])),_:1},8,["onClick"])):L("",!0),e.totalPages>1?(M(),O(u,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:H((()=>[N(" Next ")])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(M(),O(u,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:H((()=>[N(" Last ")])),_:1},8,["onClick","disabled"])):L("",!0),A(u,{onClick:e.finish,color:"success",size:"large",slot:"end"},{default:H((()=>[N(" Finish ")])),_:1},8,["onClick"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-540e223c"]]))}}}));
