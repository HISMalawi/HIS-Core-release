import{d as P,v as D,n as S,o as R,aE as A,r as o,z as p,s as N,y as T,al as v,am as g,ct as c,ak as k,ap as f,a as I,b as V,w as E,e as h}from"./index-DO7Erl4-.js";import{v as x}from"./TableView-lG-jFuUM.js";import{C as F}from"./cxca_report_service-D-IS6NLd.js";import{D as q}from"./DrillPatientIds-BkzaKPdf.js";import"./Export-D9QvNgBk.js";import"./index-D93MWXf-.js";const n=o([]),l=o(""),i=o(""),L=o(""),m=o(""),b=o(!1),y=o(""),M=P({components:{IonPage:S,IonLoading:D,v2Datatable:x},setup(){const a=async(e,t)=>{t.length<=0||(await p.create({component:q,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:m,patientIdentifiers:t,onFinish:()=>p.getTop().then(r=>r&&p.dismiss())}})).present()},C=[[{label:"#",ref:"index",span:{thRowspan:2}},{label:"Age group",ref:"age_group",span:{thRowspan:2}},{label:"Gender",ref:"gender",exportable:!1,span:{thRowspan:2}},{label:"1st time screened",ref:"",span:{thColspan:3}},{label:"Rescreened after previous negative",ref:"",span:{thColspan:3}},{label:"Post-treatment follow-up",ref:"",span:{thColspan:3}}],[{label:"Negative",ref:"first_time_screened_negative",secondaryLabel:"1st screened (Negative)",value:e=>e.first_time_screened.negative.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.negative)},{label:"Positive",ref:"first_time_screened_positive",secondaryLabel:"1st time screened (Positive)",value:e=>e.first_time_screened.positive.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.positive)},{label:"Suspected Cancer",ref:"first_time_screened_suspected_cancer",secondaryLabel:"1st screened(Suspected cancer)",value:e=>e.first_time_screened.suspected.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.suspected)},{label:"Negative",ref:"rescreened_after_prev_visit_negative",secondaryLabel:"Rescreen after prev visit (Negative)",value:e=>e.rescreened_after_prev_visit.negative.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.negative)},{label:"Positive",ref:"rescreened_after_prev_visit_positive",secondaryLabel:"Rescreen after prev visit (Positive)",value:e=>e.rescreened_after_prev_visit.positive.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.positive)},{label:"Suspected cancer",ref:"rescreened_after_prev_visit_suspected",secondaryLabel:"Rescreen after prev visit (Suspected)",value:e=>e.rescreened_after_prev_visit.suspected.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.suspected)},{label:"Negative",ref:"post_treatment_followup_negative",secondaryLabel:"Post-treatment followup(Negative)",value:e=>e.post_treatment_followup.negative.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.negative)},{label:"Positive",ref:"post_treatment_followup_positive",secondaryLabel:"Post-treatment followup (Positive)",value:e=>e.post_treatment_followup.positive.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.positive)},{label:"Suspected cancer",ref:"post_treatment_followup_suspected",secondaryLabel:"Post-treatment followup (Suspected)",value:e=>e.post_treatment_followup.suspected.length,tdClick:({column:e,data:t})=>a("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.suspected)}]],u=async()=>{if(!(l.value&&i.value))return N("Start date and end date required!");b.value=!0,n.value=[];const e=new F;e.startDate=l.value,e.endDate=i.value;try{n.value=(await e.getClinicReport("CLINIC CXCA SCRN",L.value)).slice(5).map((r,s)=>(r.index=s+1,r.gender="Female",r));const t=r=>{const s=_=>n.value.reduce((w,$)=>w.concat($[r][_]||[]),[]);return{positive:s("positive"),negative:s("negative"),suspected:s("suspected")}};n.value.push({age_group:"All",gender:"Female",index:n.value.length+1,first_time_screened:t("first_time_screened"),post_treatment_followup:t("post_treatment_followup"),rescreened_after_prev_visit:t("rescreened_after_prev_visit")})}catch(t){T("Unable to generate report!")}b.value=!1},d=()=>A([{id:"start_date",helpText:"Start Date",type:g.TT_FULL_DATE,validation:e=>v.required(e),computedValue:e=>e.value},{id:"end_date",helpText:"End Date",type:g.TT_FULL_DATE,validation:e=>v.required(e),computedValue:e=>e.value},{id:"screening_method",helpText:"Disaggregate by Screening Methods",type:g.TT_SELECT,computedValue:e=>e.value,validation:e=>v.required(e),options:()=>[{label:"All",value:"All"},{label:"VIA",value:"VIA"},{label:"PAP Smear",value:"PAP Smear"},{label:"HPV DNA",value:"HPV DNA"},{label:"Speculum Exam",value:"Speculum Exam"}]}],(e,t)=>{l.value=t.start_date,i.value=t.end_date,L.value=t.screening_method,m.value="Period (".concat(c(l.value)," to ").concat(c(i.value),")"),p.dismiss(),y.value="".concat(c(l.value)," to ").concat(c(i.value)),u()});return R(()=>!n.value.length&&d()),{columns:C,isLoading:b,reportData:n,period:m,csvQuarter:y,generate:u,configure:d}}});function Q(a,C,u,d,e,t){const r=f("ion-loading"),s=f("v2Datatable"),_=f("ion-page");return V(),I(_,null,{default:E(()=>[h(r,{"is-open":a.isLoading,message:"Please wait..."},null,8,["is-open"]),h(s,{title:"CLINIC SCRN Report",csvQuarter:a.csvQuarter,subtitle:a.period,columns:a.columns,columnData:a.reportData,rowsPerPage:25,onConfigure:a.configure,onRefresh:()=>a.generate()},null,8,["csvQuarter","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const W=k(M,[["render",Q]]);export{W as default};
