System.register(["./dynamic-import-helper-legacy-DYK5bIOV.js","./HisStandardForm-legacy-C7VqHmr3.js","./index-legacy--hxN_V8z.js","./overlays-04a9a43f-legacy-CQAadd9M.js","./TouchScreenForm-legacy-DxIQwsU4.js","./ToolbarMediumCard-legacy-CzmL2SiF.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-TUlObaz7.js"],(function(e,t){"use strict";var i,r,s,n,a,l,o,h,c,d,u,f;return{setters:[e=>{i=e.F},e=>{r=e.H},e=>{s=e.d,n=e.ae,a=e.ab,l=e.t,o=e.q,h=e._,c=e.r,d=e.o,u=e.c},e=>{f=e.l},null,null,null,null],execute:function(){const t=s({components:{HisStandardForm:r},data:()=>({printFieldContext:null,printerService:{},defaultPrinter:{},refreshKey:0,fields:[],refreshInterval:null,isRefreshingDevices:!1}),async mounted(){this.printerService=new n,this.defaultPrinter=await this.printerService.getDefaultPrinter()||{},this.fields=this.getFields()},unmounted(){this.refreshInterval&&clearInterval(this.refreshInterval)},methods:{async onFinish(){this.$router.back()},isDefaultPrinter(e){return e.name&&this.defaultPrinter.name?e.name===this.defaultPrinter.name:e.deviceID===this.defaultPrinter.deviceID},sortPrinters(e){return e.sort(((e,t)=>this.isDefaultPrinter(e)&&!this.isDefaultPrinter(t)?-1:!this.isDefaultPrinter(e)&&this.isDefaultPrinter(t)?1:(e.name||e.deviceID).localeCompare(t.name||t.deviceID)))},defaultPrinterStyle(){const e=[];return a.isEmpty(this.defaultPrinter)||e.push({indexes:[0],class:"adherence-txt-good adherence-col-bg bold"}),e},getFields(){return[{id:"printer_settings",helpText:"Printer Settings",type:i.TT_TABLE_VIEWER,config:{hiddenFooterBtns:["Clear"],footerBtns:[{name:"Refresh",size:"large",slot:"end",color:"warning",visible:!0,onClick:async()=>{if(this.isRefreshingDevices)return l("Please wait...");if(this.printFieldContext){(await f.create({backdropDismiss:!1,message:"Please wait..."})).present(),this.isRefreshingDevices=!0;try{await this.printFieldContext.init()}catch(e){o(`${e}`)}this.isRefreshingDevices=!1,f.dismiss()}}}]},init:()=>{this.refreshInterval=setInterval((async()=>{this.printFieldContext&&!this.isRefreshingDevices&&(this.isRefreshingDevices=!0,await this.printFieldContext.init(),this.isRefreshingDevices=!1)}),5e3)},onload:e=>{this.printFieldContext=e},options:async()=>{const e=await this.printerService.getAllPrinters(),t=this.sortPrinters(e);return[{other:{rowColors:this.defaultPrinterStyle(),columns:["Available Devices"],rows:t.map((e=>[e.name||e.deviceID,{type:"button",name:"Test Printer",action:()=>this.printerService.printTestLbl(e)},this.isDefaultPrinter(e)?"Default Printer":{type:"button",name:"Set as Default",visible:!this.isDefaultPrinter(e),action:()=>{this.printerService.setDefaultPrinter(e),this.defaultPrinter=e,this.refreshKey=1e4*Math.random()}}]))}}]}}]}}});e("default",h(t,[["render",function(e,t,i,r,s,n){const a=c("his-standard-form");return d(),u(a,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,key:e.refreshKey},null,8,["fields","onFinishAction"])}]]))}}}));
