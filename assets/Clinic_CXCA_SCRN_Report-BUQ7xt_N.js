import{d as y,I as D,c4 as P,N as R,K as n,t as N,q as S,cb as p,O as c,V as b,_ as k,r as v,o as T,c as F,w as I,b as C}from"./index-CEHwIYqs.js";import{v as A}from"./TableView-43kv1W4y.js";import{C as V}from"./cxca_report_service-Tjc736Ko.js";import{D as q}from"./DrillPatientIds-BVCWK_Fq.js";import{M as x}from"./PopupKeyboard-DgztAoge.js";import{F as h}from"./dynamic-import-helper-Bsjrd6Ro.js";import"./fuse-YdZE3OCN.js";import"./Export-BQ97ckzh.js";import"./HisKeyboard-Cc2Qw-pR.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./KbLayouts-VRA-vjeH.js";import"./BaseKeyboard-DpiehQdr.js";import"./KbHandler-BuQ4TFU6.js";import"./SIngleTouchField-l8pjEMFV.js";import"./TouchScreenForm-CoH4BwNu.js";import"./ToolbarMediumCard-C9Oru3Lp.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-CUJZqAQw.js";import"./HisKeypad-C6pkMGeu.js";const o=n([]),i=n(""),l=n(""),g=n(""),f=n(!1),L=n(""),Q=y({components:{IonPage:D,IonLoading:P,v2Datatable:A},setup(){const r=async(e,t)=>{t.length<=0||(await c.create({component:q,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,subtitle:g,patientIdentifiers:t,onFinish:()=>c.getTop().then(a=>a&&c.dismiss())}})).present()},m=[[{label:"#",ref:"index",span:{thRowspan:2}},{label:"Age group",ref:"age_group",span:{thRowspan:2}},{label:"Gender",ref:"gender",exportable:!1,span:{thRowspan:2}},{label:"1st time screened",ref:"",span:{thColspan:3}},{label:"Rescreened after previous negative",ref:"",span:{thColspan:3}},{label:"Post-treatment follow-up",ref:"",span:{thColspan:3}}],[{label:"Negative",ref:"first_time_screened_negative",secondaryLabel:"1st screened (Negative)",value:e=>e.first_time_screened.negative.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.negative)},{label:"Positive",ref:"first_time_screened_positive",secondaryLabel:"1st time screened (Positive)",value:e=>e.first_time_screened.positive.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.positive)},{label:"Suspected Cancer",ref:"first_time_screened_suspected_cancer",secondaryLabel:"1st screened(Suspected cancer)",value:e=>e.first_time_screened.suspected.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.first_time_screened.suspected)},{label:"Negative",ref:"rescreened_after_prev_visit_negative",secondaryLabel:"Rescreen after prev visit (Negative)",value:e=>e.rescreened_after_prev_visit.negative.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.negative)},{label:"Positive",ref:"rescreened_after_prev_visit_positive",secondaryLabel:"Rescreen after prev visit (Positive)",value:e=>e.rescreened_after_prev_visit.positive.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.positive)},{label:"Suspected cancer",ref:"rescreened_after_prev_visit_suspected",secondaryLabel:"Rescreen after prev visit (Suspected)",value:e=>e.rescreened_after_prev_visit.suspected.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.rescreened_after_prev_visit.suspected)},{label:"Negative",ref:"post_treatment_followup_negative",secondaryLabel:"Post-treatment followup(Negative)",value:e=>e.post_treatment_followup.negative.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.negative)},{label:"Positive",ref:"post_treatment_followup_positive",secondaryLabel:"Post-treatment followup (Positive)",value:e=>e.post_treatment_followup.positive.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.positive)},{label:"Suspected cancer",ref:"post_treatment_followup_suspected",secondaryLabel:"Post-treatment followup (Suspected)",value:e=>e.post_treatment_followup.suspected.length,tdClick:({column:e,data:t})=>r("".concat(t.age_group," ").concat(e.secondaryLabel),t.post_treatment_followup.suspected)}]],u=async()=>{if(!(i.value&&l.value))return N("Start date and end date required!");f.value=!0,o.value=[];const e=new V;e.startDate=i.value,e.endDate=l.value;try{o.value=(await e.getClinicReport("CLINIC CXCA SCRN")).slice(5).map((a,s)=>(a.index=s+1,a.gender="Female",a));const t=a=>{const s=d=>o.value.reduce((w,$)=>w.concat($[a][d]||[]),[]);return{positive:s("positive"),negative:s("negative"),suspected:s("suspected")}};o.value.push({age_group:"All",gender:"Female",index:o.value.length+1,first_time_screened:t("first_time_screened"),post_treatment_followup:t("post_treatment_followup"),rescreened_after_prev_visit:t("rescreened_after_prev_visit")})}catch(t){S("Unable to generate report!")}f.value=!1},_=()=>x([{id:"start_date",helpText:"Start Date",type:h.TT_FULL_DATE,validation:e=>b.required(e),computedValue:e=>e.value},{id:"end_date",helpText:"End Date",type:h.TT_FULL_DATE,validation:e=>b.required(e),computedValue:e=>e.value}],(e,t)=>{i.value=t.start_date,l.value=t.end_date,g.value="Period (".concat(p(i.value)," to ").concat(p(l.value),")"),c.dismiss(),L.value="".concat(p(i.value)," to ").concat(p(l.value)),u()});return R(()=>!o.value.length&&_()),{columns:m,isLoading:f,reportData:o,period:g,csvQuarter:L,generate:u,configure:_}}});function E(r,m,u,_,e,t){const a=v("ion-loading"),s=v("v2Datatable"),d=v("ion-page");return T(),F(d,null,{default:I(()=>[C(a,{"is-open":r.isLoading,message:"Please wait..."},null,8,["is-open"]),C(s,{title:"CLINIC SCRN Report",csvQuarter:r.csvQuarter,subtitle:r.period,columns:r.columns,columnData:r.reportData,rowsPerPage:25,onConfigure:r.configure,onRefresh:()=>r.generate()},null,8,["csvQuarter","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const oe=k(Q,[["render",E]]);export{oe as default};
