System.register(["./index-legacy-B-IGLekl.js","./HisStandardForm-legacy-zrsmj5en.js"],(function(e,t){"use strict";var a,o,n,i,r,u,l,s,d,c,m,b,p,T,f,h;return{setters:[e=>{a=e.bQ,o=e.d,n=e.a5,i=e.r,r=e.ei,u=e.a9,l=e.bl,s=e.bY,d=e.aO,c=e.a6,m=e.v,b=e.w,p=e.ab,T=e.u,f=e.x},e=>{h=e.H}],execute:function(){class t extends a{constructor(e,t=-1){super(e,10,t)}}const v=o({components:{IonPage:n,HisStandardForm:h},setup(){const e=i([]),a=new t(-1),{visitID:o,htsClient:n,yesNoOptions:c,saveEncounter:m,mapStrToOptions:b,patientDashboardUrl:p}=r({onInitVisit:()=>{e.value=[T(),{id:"outcome",helpText:"ART Outcome Referral",type:u.TT_SELECT,isRequired:()=>!0,condition:e=>null===e.on_art,finalComputedValue:e=>({obs:a.buildValueCoded("Antiretroviral status or outcome",e.value)}),options:()=>b(["Linked","Refused","Died","Already on ART","Unknown"])},...d({id:"outcome_date",helpText:"Outcome",required:!0,minDate:()=>n.birthDate,maxDate:()=>a.date,condition:e=>!/unknown/i.test(e.outcome.value),computeValue:e=>({date:e,obs:a.buildValueDate("Outcome date",e)}),estimation:{allowUnknown:!1}}),{id:"art_site",helpText:"Visited Clinic Name",type:u.TT_SELECT,isRequired:()=>!0,condition:e=>/Linked|Already on art/i.test(e.outcome.value),finalComputedValue:e=>({obs:a.buildValueText("ART clinic location",e.label)}),options:(e,t="")=>s(t),config:{footerBtns:[{name:"Here",slot:"end",onClickComponentEvents:{setValue:()=>t.getLocationName()},onClick:()=>null}],showKeyboard:!0,isFilterDataViaApi:!0}},{id:"has_arv_number",helpText:"ARV Number available",type:u.TT_YES_NO,isRequired:()=>!0,condition:e=>/linked|already on art/i.test(e.outcome.value),options:()=>[{label:"ARV number available?",values:c()}]},{id:"arv_number",helpText:"ARV Number",type:u.TT_TEXT,isRequired:()=>!0,condition:e=>"Yes"===e.has_arv_number,finalComputedValue:e=>({obs:a.buildValueText("Art number",`${e.value}`)})}]}});function T(){let e=!1,t=[],n=!1;return{id:"on_art",helpText:"ART Summary",type:u.TT_HIDDEN,init:async()=>{try{const i=await l.getProgramInformation(o.value);n=i&&/Linked|art/i.test(i.art_outcome);const r=await l.getProgramSummary(o.value,1);if(e=[!/unknown/.test(r.current_outcome),!/n\/a/i.test(r.art_start_date)].every(Boolean),!e)return!0;t=[{label:"Outcome",value:r.current_outcome,other:{obs:()=>a.buildValueCoded("Antiretroviral status or outcome","Linked")}},{label:"Outcome date",value:r.art_start_date,other:{obs:()=>a.buildValueDate("Outcome date",r.art_start_date)}},{label:"Facility",value:l.getLocationName(),other:{obs:()=>a.buildValueText("ART clinic location",`${l.getLocationName()}`)}},{label:"ARV Number",value:r.arv_number,other:{obs:()=>a.buildValueText("Art number",r.arv_number)}}]}catch(i){console.error(i)}return!0},summaryMapValue:e=>e,condition:()=>e,defaultValue:()=>t,finalComputedValue:e=>{if(!n)return{obs:e.filter((e=>"function"==typeof e.other.obs)).map((e=>e.other.obs()))}},options:()=>t}}return{patientDashboardUrl:p,onFinish:function(e,t){m({encounterName:"ART Referral Outcome",encounterTypeID:a.encounterTypeID,computedData:t})},fields:e}}});e("default",c(v,[["render",function(e,t,a,o,n,i){const r=p("his-standard-form"),u=p("ion-page");return T(),m(u,null,{default:b((()=>[f(r,{formLabel:"ART Referral outcome",fields:e.fields,onFinishAction:e.onFinish,cancelDestinationPath:e.patientDashboardUrl()},null,8,["fields","onFinishAction","cancelDestinationPath"])])),_:1})}]]))}}}));
