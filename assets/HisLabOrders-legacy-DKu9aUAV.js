System.register(["./index-legacy-DJZIfc2x.js","./LabOrderModal-legacy-D7dnKk7U.js","./FieldMixin.vue_vue_type_script_lang-legacy-JBRA5Vl3.js","./VoidReason-legacy-B_PhHnEp.js","./lab_order_service-legacy-B6VbnK1l.js"],(function(e,t){"use strict";var r,n,s,i,d,o,a,l,c,u,h,m,p,_,f,g,y,v,b,w,O,D,x,k,C,S,$,j,E,F,T,A,z;return{setters:[e=>{r=e.d,n=e.bO,s=e.a3,i=e.aX,d=e.e8,o=e.e9,a=e.ea,l=e.ag,c=e.cO,u=e.aj,h=e.O,m=e.ad,p=e.aq,_=e.aJ,f=e.bi,g=e.K,y=e.ah,v=e.a6,b=e.ab,w=e.u,O=e.v,D=e.w,x=e.G,k=e.B,C=e.E,S=e.C,$=e.Z,j=e.z,E=e.aE,F=e.x},e=>{T=e.L},e=>{A=e._},e=>{z=e.p},null],execute:function(){var t=document.createElement("style");t.textContent="table[data-v-f918568f]{font-family:arial,sans-serif;border-collapse:collapse;width:100%}td[data-v-f918568f],th[data-v-f918568f]{border:1px solid #dddddd;text-align:left;padding:8px}tr[data-v-f918568f]:nth-child(2n){background-color:#ddd}\n/*$vite$:1*/",document.head.appendChild(t);const H=r({components:{ViewPort:n,IonButton:s,IonIcon:i},mixins:[A],data:()=>({trash:d,print:o,pencil:a,HisDate:l,rows:[],fetchingOrders:!1,ordersToday:{}}),methods:{async init(){this.$emit("onFieldActivated",this),this.fetchingOrders=!0;let e=[];try{e=await this.options(this.fdata)}catch(r){console.error(`${r}`)}this.fetchingOrders=!1;const t=e[0].other.values;this.ordersToday=t.reduce(((e,t)=>(c(t.ordered)!==c(u.getSessionDate())||t.result.length||(e[t.test_name]=!0),e)),{}),this.rows=t.map((e=>(e.id=e.order_id,e.ordered&&(e.ordered=l.toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=l.toStandardHisDisplayFormat(e.released)),e)))},async printOrder(e){if(c(e.ordered)!=c(u.getSessionDate()))return h(`Printing order #${e.accession_number} is restricted to today. Consider using BDE mode/set session date to the order date`);"function"==typeof this.config?.printOrder&&await m(`Do you want to print order with accession number ${e.accession_number}?`)&&this.config.printOrder(e.id)},formatOrders:e=>e.map((e=>({id:e.order_id,encounter_id:e.encounter_id,result_given:e.result_given,accession_number:e.accession_number,test_name:e.tests[0].name,specimen:e.specimen.name,ordered:l.toStandardHisDisplayFormat(e.order_date),result:[],release:""}))),async launchOrderSelection(e=null){if(this.fetchingOrders)return h("Please wait....");const t=await p.create({component:T,backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:e,ordersToday:this.ordersToday,onOrderAdded:e=>this.ordersToday[e]=!0}});t.present();const{data:r}=await t.onDidDismiss();_.isEmpty(r)||(this.rows=[...this.formatOrders(r),...this.rows])},voidOrder(e){z((async t=>{f.voidEncounter(e.encounter_id,t).then((()=>{this.rows=this.rows.filter((t=>t.encounter_id!=e.encounter_id)),g("Record has been voided successfully!")})).catch((e=>{y(`An error has occured while deleting order: ${e}`)}))}))}},mounted(){this.init()},activated(){this.init()}}),I={class:"view-port-content"},P={class:"his-sm-text"};e("default",v(H,[["render",function(e,t,r,n,s,i){const d=b("ion-icon"),o=b("ion-button"),a=b("view-port");return w(),O(a,null,{default:D((()=>[x("div",I,[x("table",P,[t[1]||(t[1]=x("tr",null,[x("th",null,"Accession #"),x("th",null,"Test Name"),x("th",null,"Specimen"),x("th",null,"Ordered"),x("th",null,"Result"),x("th",null,"Released"),x("th",null,"Given"),x("th",null,"Action")],-1)),(w(!0),k(C,null,S(e.rows,((r,n)=>(w(),k("tr",{key:n},[x("td",null,$(r.accession_number),1),x("td",null,$(r.test_name),1),x("td",null,$(r.specimen),1),x("td",null,$(r.ordered),1),x("td",null,[(w(!0),k(C,null,S(r.result,((e,r)=>(w(),k("span",{key:r},[j($(e)+" ",1),t[0]||(t[0]=x("br",null,null,-1))])))),128))]),x("td",null,$(r.released),1),x("td",null,[x("span",{style:E("color: "+("Yes"===r.result_given?"green;":"black;"))},$(r.result_given),5)]),x("td",null,[F(o,{onClick:t=>e.printOrder(r)},{default:D((()=>[F(d,{size:"large",icon:e.print},null,8,["icon"])])),_:2},1032,["onClick"]),F(o,{disabled:!!r.delivery_mode&&"test_results_delivered_to_site_manually"!=r.delivery_mode,color:"success"},{default:D((()=>[F(d,{size:"large",icon:e.pencil},null,8,["icon"])])),_:2},1032,["disabled"]),F(o,{disabled:(r.result??[]).length,onClick:t=>e.voidOrder(r),color:"danger"},{default:D((()=>[F(d,{size:"large",icon:e.trash},null,8,["icon"])])),_:2},1032,["disabled","onClick"])])])))),128))])])])),_:1})}],["__scopeId","data-v-f918568f"]]))}}}));
