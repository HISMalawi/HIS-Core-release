import{bT as h,d as P,r as d,bp as o,ai as k,aj as D,a as T,c as y,u as O,t as i,_ as x}from"./index-4ZhJu3VE.js";import{H as E}from"./HisStandardForm-K1lIrz3_.js";import{u as F}from"./useEncounter-BL6Y94J5.js";import"./isEmpty-Cw9u0tW9.js";import"./encounter_guidelines-DE8ypU-x.js";import"./GuidelineEngine-D6V1_Znr.js";class N extends h{constructor(e,n){super(e,184,n)}}const W=P({__name:"CxCaOutcome",setup(p){let e,n;const c=d([]),l=d([]),u=o.getProgramID(),f=o.getLocationName(),v=o.getSessionDate(),{patientDashboardUrl:_,goToNextTask:b}=F(async(t,r)=>{n=r,e=new N(r,t),o.getProgramWorkflows(u).then(a=>{l.value=a}),c.value=g()});async function w(t){if(!await e.createEncounter())return i("Unable to create encounter");const a=t.select_referral_outcome.value,m=l.value.flatMap(s=>s.states).find(s=>s.concept.concept_names.some(S=>S.name===a));if(!m)return i("Unable to find workflow state for outcome: ".concat(a));if(!await o.createState(n,u,{state:m.program_workflow_state_id,location_id:f,date:v}))return i("Unable to update state");const C=await e.buildValueCoded("Outcome",a);await e.saveObservationList([C]),x("Observations and encounter created!"),b()}function g(){return[{id:"select_referral_outcome",helpText:"Referral outcome",type:k.TT_SELECT,validation:t=>D.required(t),options:()=>[{label:"Continue follow-up",value:"Continue follow-up"},{label:"No Dysplasia/Cancer",value:"No Dysplasia/Cancer"},{label:"Palliative Care",value:"Palliative Care"},{label:"Patient died",value:"Patient died"}]}]}return(t,r)=>(T(),y(E,{fields:c.value,onFinishAction:w,skipSummary:!0,cancelDestinationPath:O(_)},null,8,["fields","cancelDestinationPath"]))}});export{W as default};
