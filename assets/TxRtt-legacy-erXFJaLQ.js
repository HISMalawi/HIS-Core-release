System.register(["./index-legacy--hxN_V8z.js","./ReportDateSelectionPrompt-legacy-ChCyO68J.js","./tx_report_service-legacy-aGSGshPC.js","./TableView-legacy-Bw3PienI.js","./ArtDrilldown-legacy-BMJ0tTiG.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./MultiFieldDateHelper-legacy-B97J9Bxd.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./PopupKeyboard-legacy-Cmizlmo9.js","./SIngleTouchField-legacy-X9PnjTsk.js","./TouchScreenForm-legacy-DxIQwsU4.js","./ToolbarMediumCard-legacy-CzmL2SiF.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-TUlObaz7.js","./HisKeypad-legacy-BtDv5qCA.js","./BaseKeyboard-legacy-B0v61IaY.js","./KbHandler-legacy-De8o5nTq.js","./overlays-04a9a43f-legacy-CQAadd9M.js","./fuse-legacy-CQoBB3MK.js","./Export-legacy-BAJiCfrv.js","./HisKeyboard-legacy-C2eWFoVg.js","./person_service-legacy-BPtn1P_Z.js"],(function(e,a){"use strict";var n,r,l,t,o,s,g,u,c,i,d,_,p,y,f,m,b,j,h,D;return{setters:[e=>{n=e.d,r=e.I,l=e.c2,t=e.K,o=e.N,s=e.a9,g=e.t,u=e.ab,c=e.q,i=e.O,d=e._,_=e.r,p=e.o,y=e.c,f=e.w,m=e.b},e=>{b=e.D},e=>{j=e.T},e=>{h=e.v},e=>{D=e.A},null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const a=n({components:{IonPage:r,IonLoading:l,v2Datatable:h},setup(){const e=t([]),a=t(""),n=t(!1),r=new j;function l(e,a){return{ref:a,label:e,toValue:e=>e.length,tdClick:async e=>{e.refData.length&&(await i.create({component:D,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:`${e.data.age_group} ${e.data.gender} ${e.column.label}`,patientIdentifiers:e.refData,onFinish:()=>i.getTop().then((e=>e&&i.dismiss()))}})).present()}}}const d=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},l("CD4 <200","cd4_less_than_200"),l("CD4 >=200","cd4_greater_than_or_equal_to_200"),l("Unknown CD4","unknown_cd4_count"),l("Not Eligible for CD4","not_eligible_for_cd4"),l("Returned <3 mo","returned_less_than_3_months"),l("Returned 3-5 mo","returned_greater_than_3_months_and_less_than_6_months"),l("Returned 6+ mo","returned_greater_than_or_equal_to_6_months")]],_=async()=>{r.startDate&&r.endDate||g("Start date and end date required!"),n.value=!0;try{const a=await r.getTxRttReport(),n={F:"Female",M:"Male"},l=a.reduce(((e,a)=>("Unknown"!=a.age_group&&(e[a.gender].rows.push({...a,gender:n[a.gender]}),e[a.gender].aggregate=Object.keys(a).reduce(((e,n)=>Array.isArray(a[n])?{...e,[n]:[...e[n]||[],...a[n]]}:e),e[a.gender].aggregate)),e)),{M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}});e.value=[...l.F.rows,...l.M.rows,{age_group:"All",gender:"Male",...l.M.aggregate}];const t=Object.values(l.F.aggregate).flat(1),o=await r.getMaternalStatus(u.uniq(t)),s=o.FBf.concat(o.FP);["FP","FNP","FBf"].forEach((a=>{e.value.push(Object.keys(l.F.aggregate).reduce(((e,n)=>({...e,[n]:l.F.aggregate[n].filter((e=>"FNP"===a?!s.includes(e):o[a].includes(e)))})),{age_group:"All",gender:a}))})),e.value=e.value.map(((e,a)=>({index:a+1,...e})))}catch(a){console.error(a),c("Unable to generate report!")}n.value=!1},p=()=>b({onFinish:(e,n,l)=>{a.value=l,r.startDate=e,r.endDate=n,_()}});return o((()=>p())),{reportData:e,isLoading:n,Img:s,configure:p,generate:_,columns:d,period:a}}});e("default",d(a,[["render",function(e,a,n,r,l,t){const o=_("ion-loading"),s=_("v2Datatable"),g=_("ion-page");return p(),y(g,null,{default:f((()=>[m(o,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),m(s,{title:"TX RTT Report","report-prefix":"Pepfar","icon-url":e.Img("login-logos/PEPFAR.png"),subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,onConfigure:e.configure,onRefresh:()=>e.generate()},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])])),_:1})}]]))}}}));
