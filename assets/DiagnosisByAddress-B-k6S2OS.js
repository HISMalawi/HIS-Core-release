import{O as d}from"./opd_report_service-BW3g2xcY.js";import{R as c}from"./BaseTableReport-R7T0EYYv.js";import{d as m,ay as s,n as u,aZ as h,z as n,ak as f,ap as a,a as g,b as _,w,e as D}from"./index-3BeNlo1y.js";import{_ as v}from"./ReportMixin.vue_vue_type_script_lang-BBSfcw4O.js";import{D as C}from"./DrillPatientIds-DHgcCQhK.js";import"./Export-CbOZpD_i.js";import"./index-DgFByFCT.js";import"./HisStandardForm-D73p5TNy.js";import"./BasicReportTemplate-Bcf-MaNI.js";import"./Pagination-B-18n-hT.js";import"./TableView-C7p0Xx0H.js";const b=m({components:{ReportTemplate:c,IonPage:u},mixins:[v],data:()=>({title:"OPD diagnosis by address report",rows:[],reportService:{},columns:[[s.thTxt("Address"),s.thTxt("Diagnosis"),s.thTxt("Count")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async init(t,e){this.reportService=new d,this.reportService.setStartDate(e.start_date),this.reportService.setEndDate(e.end_date),this.period=this.reportService.getDateIntervalPeriod(),this.rows=this.buildRows(await this.reportService.getDiagnosisByAddress())},async drill(t,e){!t||!t.length||(await n.create({component:C,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:e,patientIdentifiers:t,subtitle:this.period,onFinish:()=>n.getTop().then(o=>o&&n.dismiss())}})).present()},totalDiagnosis(t){return Object.values(t).reduce((e,o)=>e+o,0)},buildRows(t){const e=[];if(h.isEmpty(t))return e;for(const o in t)for(const r in t[o]){const i=t[o][r];e.push([s.td(r),s.td(o),s.tdLink(i.length,()=>this.drill(i,r))])}return e}}});function S(t,e,o,r,i,y){const p=a("report-template"),l=a("ion-page");return _(),g(l,null,{default:w(()=>[D(p,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,period:t.period,reportPrefix:"Clinic",onReportConfiguration:t.init},null,8,["title","rows","fields","columns","period","onReportConfiguration"])]),_:1})}const j=f(b,[["render",S]]);export{j as default};
