System.register(["./index-legacy-pSEoxn3J.js","./ActionSideButton-legacy-q6Fqrxt1.js","./ResetButton-legacy-FscDj0PU.js","./FieldMixin.vue_vue_type_script_lang-legacy-BlfTynPc.js"],(function(t,e){"use strict";var a,i,n,s,l,o,d,c,u,r,h,p,m,b,v,g,f,y,_,k,w,x,D,C,A;return{setters:[t=>{a=t.d,i=t.ei,n=t.z,s=t.am,l=t.ar,o=t.h,d=t.b,c=t.e,u=t.w,r=t.g,h=t.a9,p=t.aa,m=t.j,b=t.t,v=t.ak,g=t.al,f=t.ad,y=t.ac,_=t.b2,k=t.c1,w=t.a,x=t.a6},t=>{D=t.O},t=>{C=t.R},t=>{A=t._}],execute:function(){var e=document.createElement("style");e.textContent="table[data-v-59c9686c]{width:98%;margin:auto}table[data-v-59c9686c],td[data-v-59c9686c],th[data-v-59c9686c]{text-align:center;vertical-align:middle}td[data-v-59c9686c]{height:100px}.btn-list[data-v-59c9686c]{list-style:none;margin:0;padding:0}.dispense-btn[data-v-59c9686c]{width:60px}.input-field[data-v-59c9686c]{font-weight:700;font-size:1.3em;background-color:#f8f8a7}.keypad[data-v-59c9686c]{margin:auto}.centered[data-v-59c9686c]{width:90%;background:#f4f4f4;padding:1.2em;margin:auto}.his-keyboard-btn[data-v-59c9686c]{width:110px;font-size:1.4em;height:70px}.keypad-input[data-v-59c9686c]{border:solid 1px #ccc;background:#fff;border-radius:10px;width:92%;height:100px;text-align:center;font-size:3em;margin:15px}.view-port-content[data-v-57e38329]{height:100%}.prescription-tab[data-v-57e38329]{position:relative;height:75vh}.prescription-table-section[data-v-57e38329]{position:absolute;top:0;left:0;right:0;height:76%;overflow-x:auto}.barcode-section[data-v-57e38329]{position:absolute;left:0;right:0;bottom:-20px}.dosage-input[data-v-57e38329]{text-align:center;font-weight:700;border:solid 1px #ccc;height:50px;width:80%;margin:auto;background-color:#fff8dd}table[data-v-57e38329]{width:100%}td[data-v-57e38329],th[data-v-57e38329]{border:1px solid #ccc;padding:.6em!important}\n/*$vite$:1*/",document.head.appendChild(e);const z=a({data:()=>({amount:"",keyboard:i}),props:{drugName:{type:String,required:!0},amountNeeded:{type:String,required:!0},onDispense:{type:Function,required:!0}},methods:{async onKeyPress(t){const e=this.amount;t.match(/del/i)?this.amount=e.substring(0,e.length-1):t.match(/clear/i)?this.amount="":t.match(/close/i)?this.onClose():t.match(/reset/i)?this.amount="":t.match(/dispense/i)?(this.amount&&this.onDispense(this.amount),this.onClose()):this.amount+=t},async onClose(){await n.dismiss({})}}}),V=t=>(v("data-v-59c9686c"),t=t(),g(),t),S={class:"",style:{border:".1rem solid #c2c2c2c2"}},R={class:"keypad"},I=V((()=>r("b",null,"Medication: ",-1))),N=V((()=>r("b",null,"Amount needed: ",-1))),O=V((()=>r("b",null,"Amount Dispensed: ",-1))),P=s(z,[["render",function(t,e,a,i,n,s){const v=l("ion-input"),g=l("ion-button"),f=l("ion-col"),y=l("ion-label"),_=l("ion-item"),k=l("ion-list"),w=l("ion-row"),x=l("ion-grid"),D=l("ion-content"),C=l("ion-toolbar"),A=l("ion-footer");return d(),o(h,null,[c(D,null,{default:u((()=>[c(x,null,{default:u((()=>[c(w,null,{default:u((()=>[c(f,{size:"5"},{default:u((()=>[r("div",S,[c(v,{type:"text",class:"keypad-input",value:t.amount},null,8,["value"]),r("table",R,[(d(!0),o(h,null,p(t.keyboard,((e,a)=>(d(),o("tr",{key:a},[(d(!0),o(h,null,p(e,((e,a)=>(d(),o("td",{class:"his-keyboard-margin",key:`btn-${a}`},[c(g,{color:"primary",class:"his-keyboard-btn",onClick:a=>t.onKeyPress(e)},{default:u((()=>[m(b(e),1)])),_:2},1032,["onClick"])])))),128))])))),128))])])])),_:1}),c(f,{size:"7"},{default:u((()=>[c(k,null,{default:u((()=>[c(_,null,{default:u((()=>[c(y,null,{default:u((()=>[I,m(" "+b(t.drugName),1)])),_:1})])),_:1}),c(_,null,{default:u((()=>[c(y,null,{default:u((()=>[N,m(b(t.amountNeeded),1)])),_:1})])),_:1}),c(_,null,{default:u((()=>[c(y,null,{default:u((()=>[O,m(b(t.amount.length?t.amount:0),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),c(A,null,{default:u((()=>[c(C,null,{default:u((()=>[c(g,{onClick:t.onClose,color:"danger",size:"large",slot:"start"},{default:u((()=>[m(" Close ")])),_:1},8,["onClick"]),c(g,{onClick:e[0]||(e[0]=e=>t.onDispense(t.amount)),disabled:t.amount.length<=0,color:"success",size:"large",slot:"end"},{default:u((()=>[m(" Dispense ")])),_:1},8,["disabled"])])),_:1})])),_:1})],64)}],["__scopeId","data-v-59c9686c"]]),j=a({components:{ViewPort:k,Barcode:_,NavButton:D,ResetButton:C,IonRow:y,IonCol:f},mixins:[A],data:()=>({isDispensing:!1,tab:"prescribe",listData:[]}),mounted(){this.init()},activated(){this.init()},computed:{medicationHistory(){return this.config&&this.config.medicationHistory?this.config.medicationHistory:[]}},methods:{async init(){this.$emit("onFieldActivated",this),this.listData=await this.options(this.fdata)},async onScan(t){const[e,a]=t.split("-"),i=this.listData.map((async t=>{if(t.other.drug_id===parseInt(e)){const e=parseInt(t.value.toString()),i=parseInt(a);await this.updateOnValue(t,i,[],!0)&&(t.value=i+e)}return t}));this.listData=await Promise.all(i)},async onReset(t){await this.updateOnValue(t,-1)},async updateOnValue(t,e,a=[],i=!1){return!(this.onValue&&!(await this.onValue({label:t.label,other:{dispenses:a,...t.other},value:e},i)))&&(t.value=e<0?0:e,this.$emit("onValue",t),this.onValueUpdate&&(this.listData=await this.onValueUpdate(t,this.listData)),!0)},async launchDispenser(t){if(this.isDispensing)return;this.isDispensing=!0;const e=await n.create({component:P,backdropDismiss:!1,cssClass:"custom-modal",componentProps:{drugName:t.label,amountNeeded:t.other.amount_needed,onDispense:async e=>{await this.updateOnValue(t,e)&&await n.dismiss({})}}});e.present(),await e.onDidDismiss(),this.isDispensing=!1}}}),B=t=>(v("data-v-57e38329"),t=t(),g(),t),H={class:"view-port-content"},$={key:0,class:"his-card history"},M={class:"his-table"},q=B((()=>r("tr",null,[r("th",null," Medication"),r("th",null," Date"),r("th",null," Amount dispensed ")],-1))),F={key:1,class:"prescription-tab"},K={class:"prescription-table-section his-card"},U={class:"his-table"},E=B((()=>r("tr",null,[r("th",null," Medication"),r("th",null," Amount needed"),r("th",null," Amount dispensed "),r("th",null," Reset ")],-1))),Q={class:"barcode-section"};t("default",s(j,[["render",function(t,e,a,i,n,s){const m=l("nav-button"),v=l("ion-col"),g=l("ion-input"),f=l("reset-button"),y=l("barcode"),_=l("ion-row"),k=l("view-port");return d(),w(k,null,{default:u((()=>[r("div",H,[c(_,null,{default:u((()=>[c(v,{size:"2"},{default:u((()=>[c(m,{onClick:e[0]||(e[0]=e=>t.tab="prescribe"),isActive:"prescribe"===t.tab,image:"prescription/rx",label:"Prescribed"},null,8,["isActive"]),c(m,{onClick:e[1]||(e[1]=e=>t.tab="history"),isActive:"history"===t.tab,image:"prescription/history",label:"History"},null,8,["isActive"])])),_:1}),c(v,{size:"10"},{default:u((()=>["history"===t.tab?(d(),o("div",$,[r("table",M,[q,(d(!0),o(h,null,p(t.medicationHistory,((t,e)=>(d(),o("tr",{key:e},[r("td",null,b(t.medication),1),r("td",null,b(t.date),1),r("td",null,b(t.amount),1)])))),128))])])):x("",!0),"prescribe"===t.tab?(d(),o("div",F,[r("div",K,[r("table",U,[E,(d(!0),o(h,null,p(t.listData,((e,a)=>(d(),o("tr",{key:a},[r("td",null,b(e.label),1),r("td",null,b(e.other.amount_needed),1),r("td",null,[c(g,{disabled:e.value>0,value:e.value,onClick:a=>e.value<=0?t.launchDispenser(e):null,class:"dosage-input"},null,8,["disabled","value","onClick"])]),r("td",null,[c(f,{disabled:e.value<=0,onClick:a=>e.value>0?t.onReset(e):null},null,8,["disabled","onClick"])])])))),128))])]),r("div",Q,[c(y,{onOnScan:t.onScan,class:"his-card"},null,8,["onOnScan"])])])):x("",!0)])),_:1})])),_:1})])])),_:1})}],["__scopeId","data-v-57e38329"]]))}}}));
