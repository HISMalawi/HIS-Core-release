import{d as I,$ as U,a4 as _,a3 as V,a7 as A,a8 as H,r as S,aL as O,au as E,cz as L,ad as z,aa as T,af as s,a as d,c,w as t,aH as M,K as l,a2 as F,cA as q,M as w,b as a,C as v,aq as K,cu as X,I as G,X as W,_ as Y,Y as j,b4 as J,a9 as Q,ao as f,H as Z,cv as R,aW as x}from"./index-CMZASHAR.js";import{a as ee,t as oe}from"./Export-CpyT9Gk1.js";import{P as te}from"./Pagination-D_B_LriE.js";const ae=I({emits:["onItemsPerPage","onSearchFilter","onItemsVLtype"],components:{IonItem:U,IonCol:_,IonRow:V,IonInput:A,IonButton:H},props:{customFilter:{type:Function},totalRowCount:{type:Number,default:15e3},disableSearchFilter:{type:Boolean,default:!1},disablePerPageFilter:{type:Boolean,default:!1},showPerPageFilter:{type:Boolean,default:!1}},setup(e,{emit:o}){const m=S(50),i=S(""),y=S("");async function b(r,g){(await E.create({component:L,backdropDismiss:!1,cssClass:"full-modal",componentProps:{dismissType:"modal",currentField:r,onFinish:g}})).present()}function u(r){o("onSearchFilter",r)}function P(){i.value="",u("")}async function p(){typeof e.customFilter=="function"&&(y.value=await e.customFilter())}function h(){b({id:"search",helpText:"Search table data",defaultValue:()=>i.value,type:z.TT_TEXT},r=>{i.value=r?r.value:"",u(i.value)})}return O(m,r=>{typeof r=="number"&&o("onItemsPerPage",r)},{immediate:!0}),{reset:P,itemsPerPage:m,searchFilter:i,launchFilter:p,launchKeyboard:b,launchSearcher:h,customFilterValue:y}}}),se=["disabled"],ne=["selected"],re=["selected"],le=["selected"],ie=["selected"],ue=["selected"],pe=["selected"],de=["selected","value"];function ce(e,o,m,i,y,b){const u=s("ion-col"),P=s("ion-input"),p=s("ion-button"),h=s("ion-item"),r=s("ion-row");return d(),c(r,null,{default:t(()=>[e.showPerPageFilter?(d(),c(u,{key:0},{default:t(()=>[M(l("select",{class:"input_display","onUpdate:modelValue":o[0]||(o[0]=g=>e.itemsPerPage=g),disabled:e.disablePerPageFilter},[l("option",{selected:e.itemsPerPage===5,value:5},"5 rows/page",8,ne),l("option",{selected:e.itemsPerPage===10,value:10},"10 rows/page",8,re),l("option",{selected:e.itemsPerPage===20,value:20},"20 rows/page",8,le),l("option",{selected:e.itemsPerPage===50,value:50},"50 rows/page",8,ie),l("option",{selected:e.itemsPerPage===100,value:100},"100 rows/page",8,ue),l("option",{selected:e.itemsPerPage===1e3,value:1e3},"1000 rows/page",8,pe),l("option",{selected:e.itemsPerPage===e.totalRowCount,value:e.totalRowCount},"Show all rows("+F(e.totalRowCount)+")",9,de)],8,se),[[q,e.itemsPerPage]])]),_:1})):w("",!0),typeof e.customFilter=="function"?(d(),c(u,{key:1},{default:t(()=>[a(P,{class:"input_display",value:e.customFilterValue,onClick:e.launchFilter,placeholder:"Filter..."},null,8,["value","onClick"])]),_:1})):w("",!0),a(u,null,{default:t(()=>[a(h,{lines:"none"},{default:t(()=>[a(P,{disabled:e.disableSearchFilter,class:"input_display",value:e.searchFilter,onClick:e.launchSearcher,placeholder:"Search here..."},null,8,["disabled","value","onClick"]),e.searchFilter?(d(),c(p,{key:0,class:"reset_button",size:"large",onClick:o[1]||(o[1]=g=>e.reset()),color:"secondary"},{default:t(()=>o[2]||(o[2]=[v(" Reset ")])),_:1})):w("",!0)]),_:1})]),_:1})]),_:1})}const me=T(ae,[["render",ce],["__scopeId","data-v-7bf42b5b"]]),Pe=I({components:{IonCol:_,IonRow:V,Pagination:te,ReportTable:K,ReportFilter:me,HisFooter:X,IonPage:G,IonHeader:W,IonContent:Y,IonToolbar:j,IonChip:J,IonFooter:Q},props:{title:{type:String,required:!0},columns:{type:Array,required:!0},encryptPDF:{type:Boolean,default:!1},rows:{type:Array,default:()=>[]},rowParser:{type:Function},showFilters:{type:Boolean,default:!1},rowsPerPage:{type:Number},asyncRows:{type:Function},paginated:{type:Boolean,default:!1},customBtns:{type:Array,default:()=>[]},showReportStamp:{type:Boolean,default:!0},footerColor:{type:String,default:"dark"},customFileName:{type:String,default:""},canExport:{type:Boolean,default:!0},onFinish:{type:Function}},data:()=>({btns:[],isTableLoading:!1,searchFilter:"",itemsPerPage:50,currentPage:0,coreVersion:f.getCoreVersion(),tableRows:[],totalPages:0,activeColumns:[],activeRows:[],date:Z.toStandardHisDisplayFormat(f.getSessionDate()),apiVersion:f.getApiVersion(),siteUUID:f.getSiteUUID()}),methods:{getFileName(){return this.customFileName?this.customFileName:this.title},pdfEncryptionData(){const e=f.getUserName();return{encryption:{userPassword:e,ownerPassword:e,userPermissions:["print"]}}}},created(){this.btns=[...this.customBtns,{name:"CSV",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:()=>{const{columns:e,rows:o}=R(this.activeColumns,this.activeRows,"csvMode");ee(e,[...o,["Date Created: ".concat(this.date)],["HIS-Core Version: ".concat(this.coreVersion)],["API Version: ".concat(this.apiVersion)],["Site UUID: ".concat(this.siteUUID)],["Generated by: ".concat(f.getUserName())]],this.getFileName())}},{name:"PDF",size:"large",slot:"start",color:"primary",visible:this.canExport,onClick:async()=>{let e="pdfMode";this.encryptPDF&&(e=await x("Security warning","PDF may contain private data that will require a password to unlock","To access private data choose Secure PDF over Regular PDF",[{name:"Secure PDF",slot:"start",color:"success"},{name:"Regular PDF",slot:"start",color:"success"}],"his-danger-color")==="Secure PDF"?"pdfMode":"ignorePDFColumnexport");const{columns:o,rows:m}=R(this.activeColumns,this.activeRows,e);oe(o,m,this.getFileName(),!1,this.encryptPDF&&e!="ignorePDFColumnexport"?this.pdfEncryptionData():{})}},{name:"Finish",size:"large",slot:"end",color:"success",visible:!0,onClick:()=>{if(typeof this.onFinish=="function")return this.onFinish();this.$router.push({path:"/"})}}]}}),ge={class:"report-content"};function fe(e,o,m,i,y,b){const u=s("ion-col"),P=s("ion-row"),p=s("ion-toolbar"),h=s("report-filter"),r=s("ion-header"),g=s("report-table"),D=s("ion-content"),$=s("pagination"),C=s("ion-chip"),k=s("ion-footer"),B=s("his-footer"),N=s("ion-page");return d(),c(N,null,{default:t(()=>[a(r,null,{default:t(()=>[a(p,null,{default:t(()=>[a(P,null,{default:t(()=>[a(u,null,{default:t(()=>[l("h1",null,F(e.title),1)]),_:1})]),_:1})]),_:1}),a(p,null,{default:t(()=>[a(h,{showPerPageFilter:e.showFilters||e.paginated,disableSearchFilter:e.isTableLoading,disablePerPageFilter:e.isTableLoading,totalRowCount:e.tableRows.length,onOnItemsPerPage:o[0]||(o[0]=n=>e.itemsPerPage=n),onOnSearchFilter:o[1]||(o[1]=n=>e.searchFilter=n)},null,8,["showPerPageFilter","disableSearchFilter","disablePerPageFilter","totalRowCount"])]),_:1})]),_:1}),a(D,null,{default:t(()=>[l("div",ge,[a(g,{rows:e.rows,paginated:e.paginated,asyncRows:e.asyncRows,rowParser:e.rowParser,columns:e.columns,showFilters:e.showFilters,newPage:e.currentPage,searchFilter:e.searchFilter,rowsPerPage:e.itemsPerPage,onOnIsLoading:o[2]||(o[2]=n=>e.isTableLoading=n),onOnTableRows:o[3]||(o[3]=n=>e.tableRows=n),onOnPagination:o[4]||(o[4]=n=>e.totalPages=n.length),onOnActiveColumns:o[5]||(o[5]=n=>e.activeColumns=n),onOnActiveRows:o[6]||(o[6]=n=>e.activeRows=n)},null,8,["rows","paginated","asyncRows","rowParser","columns","showFilters","newPage","searchFilter","rowsPerPage"])])]),_:1}),a(k,null,{default:t(()=>[a(p,null,{default:t(()=>[!e.searchFilter&&e.paginated||!e.searchFilter&&e.totalPages>0&&e.paginated?(d(),c($,{key:0,perPage:e.itemsPerPage,maxVisibleButtons:10,totalPages:e.totalPages,onOnChangePage:o[7]||(o[7]=n=>e.currentPage=n)},null,8,["perPage","totalPages"])):w("",!0)]),_:1}),e.showReportStamp?(d(),c(p,{key:0},{default:t(()=>[a(C,{color:"primary"},{default:t(()=>[o[8]||(o[8]=v("Date Created: ")),l("b",null,F(e.date),1)]),_:1}),a(C,{color:"primary"},{default:t(()=>[o[9]||(o[9]=v("His-Core Version: ")),l("b",null,F(e.coreVersion),1)]),_:1}),a(C,{color:"primary"},{default:t(()=>[o[10]||(o[10]=v("API Version: ")),l("b",null,F(e.apiVersion),1)]),_:1})]),_:1})):w("",!0)]),_:1}),a(B,{color:e.footerColor,btns:e.btns},null,8,["color","btns"])]),_:1})}const ye=T(Pe,[["render",fe]]);export{ye as D,me as R};
