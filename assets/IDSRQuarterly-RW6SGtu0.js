import{d as _,cJ as g,cu as v,I,_ as $,aq as P,as as t,aG as R,H as u,ao as w,W as L,aa as x,af as i,a as l,E as N,b as n,c as p,M as m,w as d,K as h,J as O}from"./index-CMZASHAR.js";import{H as F}from"./HisStandardForm-BCjM4-bc.js";import{_ as S}from"./ReportMixin.vue_vue_type_script_lang-C_U669Qn.js";import{I as k,a as M}from"./MOHReportHeader-CX05ZO2I.js";import{a as E}from"./Export-CpyT9Gk1.js";import"./BasicReportTemplate-CbJ_oMga.js";import"./Pagination-D_B_LriE.js";import"./opd_report_service-56DRmHjV.js";import"./index-_zuoFVCp.js";const V=_({mixins:[S],components:{IonLoading:g,IdsrH:k,HisStandardForm:F,HisFooter:v,IonPage:I,IonContent:$,ReportTable:P},data:()=>({formData:{},componentKey:0,computedFormData:{},btns:[],isLoading:!1,fields:[],reportID:-1,periodLabel:"Quarter Periods",reportTitle:"",periodDates:"",reportName:"QUARTERLY DISEASE SURVEILLANCE REPORT",rangeLabel:"Quarter",range:"",TotalOPDVisits:0,reportReady:!1,tableCssTheme:"opd-report-theme",rows:[],columns:[[t.thTxt("",{colspan:2,sortable:!1}),t.thTxt("Out-patient Cases",{colspan:3,sortable:!1}),t.thTxt("In-patient Cases",{colspan:3,sortable:!1}),t.thTxt("In-patient Cases Death",{colspan:3,sortable:!1}),t.thTxt("Laboratory Findings",{colspan:6,sortable:!1})],[t.thTxt("",{colspan:2,sortable:!1}),t.thTxt("",{colspan:3,sortable:!1}),t.thTxt("",{colspan:3,sortable:!1}),t.thTxt("",{colspan:3,sortable:!1}),t.thTxt("No. of Tested Cases",{colspan:3,sortable:!1}),t.thTxt("No. of Positive Cases",{colspan:3,sortable:!1})],[t.thTxt("Diseases/Events/Conditions",{colspan:2}),t.thTxt("< 5 yrs"),t.thTxt(">= 5 yrs"),t.thTxt("Total"),t.thTxt("< 5 yrs"),t.thTxt(">= 5 yrs"),t.thTxt("Total"),t.thTxt("< 5 yrs"),t.thTxt(">= 5 yrs"),t.thTxt("Total"),t.thTxt("< 5 yrs"),t.thTxt(">= 5 yrs"),t.thTxt("Total"),t.thTxt("< 5 yrs"),t.thTxt(">= 5 yrs"),t.thTxt("Total")]]}),computed:{clinicName(){return R().facilityName.value}},created(){this.btns=this.getBtns(),this.fields=this.getDateDurationFields(!0)},methods:{async onPeriod(e,r,a=!1){this.componentKey+=1,this.formData=e,this.computedFormData=r,this.reportReady=!0,this.isLoading=!0,this.report=new M,this.report.setRegenerate(a),this.report.setStartDate(u.toStandardHisFormat(e.quarter.other.start)),this.report.setEndDate(u.toStandardHisFormat(e.quarter.other.end)),this.periodDates=this.report.getReportPeriod(),this.range=e.quarter.label.split(" ")[0],this.reportTitle="MOH ".concat(w.getLocationName()," Quarterly IDSR ").concat(this.periodDates);try{const s=await this.report.requestIDSRQuarterly(),o=await this.report.getAttendance();s&&o&&(this.reportID="data",this.TotalOPDVisits=o.length,this.rows=this.buildRows(s))}catch(s){console.log(s),L("An error occurred while fetching the report data")}finally{this.isLoading=!1}},buildDrillColumn(e,r){return e.length>0?t.tdLink(e.length,()=>this.onDrillDown(r,e)):t.td(0)},buildRows(e){const r=[];return Object.entries(e).forEach(([a,s],o)=>{r.push([t.td(o+1),t.td(a,{style:{textAlign:"left"}}),this.buildDrillColumn(s["<5 yrs"].outpatient_cases,"".concat(a," < 5 yrs Out-patient Cases")),this.buildDrillColumn(s[">=5 yrs"].outpatient_cases,"".concat(a," >= 5 yrs Out-patient Cases")),this.buildDrillColumn(s["<5 yrs"].outpatient_cases.concat(s[">=5 yrs"].outpatient_cases),"".concat(a," Total Out-patient Cases")),this.buildDrillColumn(s["<5 yrs"].inpatient_cases,"".concat(a," < 5 yrs In-patient Cases")),this.buildDrillColumn(s[">=5 yrs"].inpatient_cases,"".concat(a," >= 5 yrs In-patient Cases")),this.buildDrillColumn(s["<5 yrs"].inpatient_cases.concat(s[">=5 yrs"].inpatient_cases),"".concat(a," Total In-patient Cases")),this.buildDrillColumn(s["<5 yrs"].inpatient_cases_death,"".concat(a," < 5 yrs In-patient Cases Death")),this.buildDrillColumn(s[">=5 yrs"].inpatient_cases_death,"".concat(a," >= 5 yrs In-patient Cases Death")),this.buildDrillColumn(s["<5 yrs"].inpatient_cases_death.concat(s[">=5 yrs"].inpatient_cases_death),"".concat(a," Total In-patient Cases Death")),this.buildDrillColumn(s["<5 yrs"].tested_malaria,"".concat(a," < 5 yrs Tested Malaria")),this.buildDrillColumn(s[">=5 yrs"].tested_malaria,"".concat(a," >= 5 yrs Tested Malaria")),this.buildDrillColumn(s["<5 yrs"].tested_malaria.concat(s[">=5 yrs"].tested_malaria),"".concat(a," Total Tested Malaria")),this.buildDrillColumn(s["<5 yrs"].tested_positive_malaria,"".concat(a," < 5 yrs Tested Positive Malaria")),this.buildDrillColumn(s[">=5 yrs"].tested_positive_malaria,"".concat(a," >= 5 yrs Tested Positive Malaria")),this.buildDrillColumn(s["<5 yrs"].tested_positive_malaria.concat(s[">=5 yrs"].tested_positive_malaria),"".concat(a," Total Tested Positive Malaria"))])}),r},getBtns(){return[{name:"CSV",size:"large",slot:"start",color:"primary",visible:!0,onClick:async()=>{const e=[["No.","Diseases/Events/Conditions","< 5 yrs Out-patient Cases",">= 5 yrs Out-patient Cases","Total Out-patient Cases","< 5 yrs In-patient Cases",">= 5 yrs In-patient Cases","Total In-patient Cases","< 5 yrs In-patient Cases Death",">= 5 yrs In-patient Cases Death","Total In-patient Cases Death","< 5 yrs Tested Malaria",">= 5 yrs Tested Malaria","Total Tested Malaria","< 5 yrs Tested Positive Malaria",">= 5 yrs Tested Positive Malaria","Total Tested Positive Malaria"]],r=this.rows.map(a=>a.map(s=>s.td));E(e,r,this.reportTitle)}},{name:"PDF",size:"large",slot:"start",color:"primary",visible:!0,onClick:()=>this.exportToCustomPDF(this.reportTitle)},{name:"Back",size:"large",slot:"end",color:"warning",visible:!0,onClick:()=>this.reportReady=!1},{name:"Refresh",size:"large",slot:"end",color:"warning",visible:!0,onClick:async()=>await this.onPeriod(this.formData,this.computedFormData,!0)},{name:"Finish",size:"large",slot:"end",color:"success",visible:!0,onClick:()=>this.$router.push({path:"/"})}]}}}),H={id:"report-content"},B={class:"my-table"};function A(e,r,a,s,o,Q){const c=i("ion-loading"),y=i("his-standard-form"),T=i("idsr-h"),b=i("report-table"),C=i("ion-content"),D=i("his-footer"),f=i("ion-page");return l(),N(O,null,[n(c,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),e.reportReady?m("",!0):(l(),p(y,{key:0,onOnFinish:e.onPeriod,skipSummary:!0,fields:e.fields},null,8,["onOnFinish","fields"])),e.reportReady?(l(),p(f,{key:1},{default:d(()=>[n(C,null,{default:d(()=>[h("div",H,[(l(),p(T,{key:e.componentKey,reportName:e.reportName,rangeLabel:e.rangeLabel,range:e.range,ref:"header",periodLabel:e.periodLabel,periodDates:e.periodDates,clinicName:e.clinicName,totalOPDVisits:e.TotalOPDVisits},null,8,["reportName","rangeLabel","range","periodLabel","periodDates","clinicName","totalOPDVisits"])),h("div",B,[n(b,{columns:e.columns,rows:e.rows,config:{tableCssTheme:e.tableCssTheme}},null,8,["columns","rows","config"])])])]),_:1}),n(D,{btns:e.btns},null,8,["btns"])]),_:1})):m("",!0),r[0]||(r[0]=h("div",{id:"print"},null,-1))],64)}const X=x(V,[["render",A],["__scopeId","data-v-17ba7449"]]);export{X as default};
