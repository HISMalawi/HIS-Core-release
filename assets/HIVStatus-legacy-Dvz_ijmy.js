System.register(["./HisStandardForm-legacy-DOc8dQFT.js","./EncounterMixin.vue_vue_type_script_lang-legacy-C_fLj1SO.js","./index-legacy-HpoRL6sM.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./LocationFieldOptions-legacy-CpjtC_88.js","./MultiFieldDateHelper-legacy-Ca_7culp.js","./TouchScreenForm-legacy-D3QVjNom.js","./ToolbarMediumCard-legacy-BjHrpWWd.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-u0ytW13O.js","./encounter_guidelines-legacy-uw7s2hWb.js","./GuidelineEngine-legacy-KsvQuFdF.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js"],(function(e,t){"use strict";var i,a,s,n,l,o,r,u,c,d,v,h,g,b;return{setters:[e=>{i=e.H},e=>{a=e._},e=>{s=e.b5,n=e.d,l=e.t,o=e.V,r=e._,u=e.r,c=e.o,d=e.c},e=>{v=e.F},e=>{h=e.g},e=>{g=e.g,b=e.E},null,null,null,null,null,null,null,null],execute:function(){class t extends s{constructor(e,t){super(e,39,t)}}const m=n({components:{HisStandardForm:i},mixins:[a],data:()=>({hivService:{}}),watch:{ready:{async handler(e){e&&(this.hivService=new t(this.patient.getID(),this.providerID),this.fields=this.getFields())},immediate:!0,deep:!0}},methods:{async onSubmit(e,t){if(!(await this.hivService.createEncounter()))return l("Unable to create encounter");const i=await this.resolveObs({...t});if(!(await this.hivService.saveObservationList(i)))return l("Unable to save observations");this.nextTask()},buildDateObs(e,t,i){let a={};return a=t.match(/unknown/i)?this.hivService.buildValueText(e,"Unknown"):i?this.hivService.buildValueDateEstimated(e,t):this.hivService.buildValueDate(e,t),a},getFields(){return[{id:"hiv_status",helpText:"HIV status",type:v.TT_SELECT,validation:e=>o.required(e),computedValue:({value:e})=>({obs:this.hivService.buildValueText("HIV status",e)}),options:()=>[{label:"Positive not ART",value:"Positive not ART"},{label:"Posititve on ART",value:"Positive on ART"},{label:"Previous negative",value:"Previous negative"},{label:"New positive",value:"New positive"},{label:"New negative",value:"New negative"},{label:"Never tested",value:"Never tested"}]},...g({id:"hiv_test_date",helpText:"HIV Test",required:!0,minDate:()=>this.patient.getBirthdate(),maxDate:()=>t.getSessionDate(),condition:e=>"Never tested"!==e.hiv_status.value,summaryLabel:"HIV test date",estimation:{allowUnknown:!0,estimationFieldType:b.MONTH_ESTIMATE_FIELD},computeValue:(e,t)=>this.buildDateObs("HIV test date",e,t)}),{id:"test_location",helpText:"HIV test location",type:v.TT_SELECT,validation:e=>o.required(e),defaultValue:()=>t.getLocationName(),computedValue:({label:e})=>({obs:this.hivService.buildValueText("HIV test location",e)}),condition:e=>"Never tested"!==e.hiv_status.value,options:(e,t="")=>h(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}}]}}});e("default",r(m,[["render",function(e,t,i,a,s,n){const l=u("his-standard-form");return c(),d(l,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}]]))}}}));
