import{O as p,N as d}from"./opd_report_service-gm_0cKv7.js";import{R as c}from"./BaseTableReport-BtLO7o8k.js";import{d as u,I as f,ar as e,aa as h,af as m,a as C,c as _,w,b as v}from"./index-DOO_dFo7.js";import{_ as g}from"./ReportMixin.vue_vue_type_script_lang-CMqkprJd.js";import"./Export-Cg2VfxNM.js";import"./index-BgISI6Sz.js";import"./HisStandardForm-Dxm9AvFo.js";import"./BasicReportTemplate-NqFWYStE.js";import"./Pagination-tJacL0c7.js";const x=u({components:{ReportTemplate:c,IonPage:f},mixins:[g],data:()=>({title:"Cases seen report",rows:[],reportService:{},columns:[[e.thTxt("",{sortable:!1,exportable:!1}),e.thTxt("New cases",{colspan:2,sortable:!1,exportable:!1}),e.thTxt("All cases",{colspan:2,sortable:!1,exportable:!1})],[e.thTxt("NCD type"),e.thTxt("Male",{value:"Male (New Cases)"}),e.thTxt("Female",{value:"Female (New Cases)"}),e.thTxt("Male",{value:"Male (All Cases)"}),e.thTxt("Female",{value:"Female (All Cases)"})]]}),created(){this.fields=this.getDateDurationFields()},methods:{async init(t,s){this.reportService=new p,this.reportService.setStartDate(s.start_date),this.reportService.setEndDate(s.end_date),this.period=this.reportService.getDateIntervalPeriod();const a=await this.reportService.getCasesSeen();this.rows=this.buildRows(a)},toDrillColumn(t,s,a,n){const l=t.filter(r=>n?r.name===s&&r.gender===a&&/new patient/i.test(r.type_of_visit):r.name===s&&r.gender===a);if(l.length){const r=[[e.thTxt("Name"),e.thTxt("Age Group"),e.thTxt("Address")]],i=l.map(o=>[e.td("".concat(o.given_name," ").concat(o.family_name)),e.td(o.age_group),e.td("".concat(o.village,", ").concat(o.ta,", ").concat(o.district))]);return e.tdLink(l.length,()=>this.drilldownData("".concat(this.formatGender(a)," patients with ").concat(s),r,i,void 0))}return e.td(0)},buildRows(t){return d.map(s=>[e.td(s,{style:{textAlign:"left"}}),this.toDrillColumn(t,s,"M",!0),this.toDrillColumn(t,s,"F",!0),this.toDrillColumn(t,s,"M",!1),this.toDrillColumn(t,s,"F",!1)])}}});function D(t,s,a,n,l,r){const i=m("report-template"),o=m("ion-page");return C(),_(o,null,{default:w(()=>[v(i,{title:t.title,rows:t.rows,fields:t.fields,columns:t.columns,period:t.period,reportPrefix:"Clinic",onReportConfiguration:t.init},null,8,["title","rows","fields","columns","period","onReportConfiguration"])]),_:1})}const P=h(x,[["render",D]]);export{P as default};
