System.register(["./index-legacy-DDADMnop.js","./index-legacy-Cjf3InP9.js"],(function(e,a){"use strict";var t,n,o,r,l,i,s,c,u,d,p,v,g,w,f,h,m,b,y,k,x,C,I,D,U,_;return{setters:[e=>{t=e.c8,n=e.bv,o=e.d,r=e.r,l=e.ar,i=e.t,s=e.cm,c=e.u,u=e.B,d=e.z,p=e.a1,v=e.Y,g=e.x,w=e.w,f=e.y,h=e.a3,m=e.cn,b=e.G,y=e.ax,k=e.J,x=e.M,C=e.a6,I=e.a7,D=e.a8},e=>{U=e.F,_=e.D}],execute:function(){var z=document.createElement("style");z.textContent="#update-notification[data-v-aa884abd]{opacity:.95;position:absolute;background:#e1fef2;color:#000;width:100vw;margin:auto;padding:1.6em;font-size:1.8rem;top:10%;left:50%;transform:translate(-50%,-50%);text-align:center;z-index:40}\n",document.head.appendChild(z);const A=t("CapacitorAppInstaller",{web:()=>n((()=>a.import("./web-legacy-CLO_rb3v.js")),void 0).then((e=>new e.CapacitorAppInstallerWeb))}),P=e=>(C("data-v-aa884abd"),e=e(),I(),e),S={key:0,id:"update-notification"},L=P((()=>p("br",null,null,-1))),M=P((()=>p("br",null,null,-1)));e("default",D(o({__name:"ApkUpdateNotification",props:{checkInterval:{type:Number,default:1e4}},setup(e){const a=e,t=r(!1),n=r(""),o=r(""),C=new y,I=l((()=>"-"!=o.value&&o.value!==n.value)),D=r("");function z(){o.value=n.value}async function P(){try{if(await async function(){try{const{publicStorage:e}=await U.checkPermissions();if("granted"!==e){const{publicStorage:e}=await U.requestPermissions();if("granted"!==e)return x("Permission to access storage is required to download the app."),!1}return!0}catch(e){return console.error(e),x("Unable to download the app. Please try again later"),!1}}()){t.value=!0,U.addListener("progress",(e=>{const a=Math.round(e.contentLength/1024),t=Math.round(e.bytes/1024),n=Math.round(e.bytes/e.contentLength*100);D.value=`Downloading... ${t}KB / ${a}KB (${n}%)`}));const e=await async function(){try{return(await U.downloadFile({url:await C.getApkDownloadLink(o.value),path:`Download/emr-${o.value}.apk`,directory:_.ExternalStorage,recursive:!0,progress:!0})).path}catch(e){console.error(e),x(e.toString())}}();if(t.value=!1,!e)throw new Error("Unable to download the app");k("Download completed. Installing the app..."),await async function(e){try{await A.install({file:e})}catch(a){console.error(a),x("Unable to install the app. Please try again later")}}(e),n.value=o.value}}catch(e){t.value=!1,console.error(e),x("Unable to update the app")}}return i((function(){s("mobile")&&s("android")&&setInterval((async()=>{I.value||(o.value=await C.getApkVersion(),n.value=C.getHeadVersion())}),a.checkInterval)})),(e,a)=>I.value?(c(),u("div",S,[d(" New version ("),p("strong",null,v(o.value),1),d(") update is available "),L,M,g(f(h),{onClick:P,color:"success",size:"medium"},{default:w((()=>[d(" Download Update ")])),_:1}),d("     "),g(f(h),{onClick:z,color:"danger",size:"medium"},{default:w((()=>[d(" Cancel ")])),_:1}),g(f(m),{"is-open":t.value,message:D.value},null,8,["is-open","message"])])):b("",!0)}}),[["__scopeId","data-v-aa884abd"]]))}}}));
