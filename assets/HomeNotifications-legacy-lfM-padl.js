System.register(["./index-legacy-BikDJqIc.js"],(function(e,a){"use strict";var t,l,o,n,r,s,i,c,u,d,f,v,p,m,g,h,k,b,y,w,C,V,_,P,x,L,j,D,I,S,O,N,R,z,A,T,M;return{setters:[e=>{t=e.d,l=e.l,o=e.k,n=e.ah,r=e.aC,s=e.a7,i=e.m,c=e.r,u=e.c,d=e.cm,f=e.aZ,v=e.aR,p=e.ce,m=e.cf,g=e.cj,h=e.ak,k=e.ap,b=e.h,y=e.b,w=e.g,C=e.e,V=e.a9,_=e.aa,P=e.w,x=e.a,L=e.a6,j=e.t,D=e.bb,I=e.j,S=e.d7,O=e.C,N=e.ct,R=e.f,z=e.bf,A=e.b8,T=e.bg,M=e.bM}],execute:function(){var a=document.createElement("style");a.textContent="th[data-v-6173022f],td[data-v-6173022f]{border-collapse:collapse;min-width:160px;border:1px solid rgb(158,158,158)}td[data-v-6173022f]{font-weight:500;font-size:.8em;padding:.4em}.stick-report-header[data-v-6173022f]{position:sticky;top:0;z-index:1000}tr[data-v-6173022f]:nth-child(2n){background-color:#f0f0f0}.clickable-cell[data-v-6173022f]{color:#0645ad}.his-floating-keyboard[data-v-6173022f]{bottom:70px!important}\n/*$vite$:1*/",document.head.appendChild(a);const E=t({components:{IonToolbar:i,IonItem:s,IonIcon:r,IonLabel:n,IonButton:o,IonFooter:l},props:{columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},rowsPerPage:{type:Number,default:10},defaultSortedColumn:{type:String},defaultSortOrder:{type:Object}},setup(e){const a=c([]),t=c(0),l=c(""),o=c("desc"),n=u((()=>{let e=a.value;return o.value&&l.value&&(e=d(a.value)[o.value]((e=>e.sortData[l.value]))),e})),r=u((()=>f.chunk(n.value,e.rowsPerPage).length)),s=u((()=>t.value+2<=r.value)),i=u((()=>t.value>0)),h=u((()=>f.chunk(n.value,e.rowsPerPage)[t.value])),k=t=>{t.forEach((t=>{const l={...t},o=e.columns.reduce(((e,a)=>e.concat(a)),[]).filter((e=>e.value||e.ref)).map((e=>{let a="";const o=t[e.ref];try{a=f.isEmpty(t)?"":"function"==typeof e.toValue?`${e.toValue(o)}`:"function"==typeof e.value?e.value(t):t[e.ref]||""}catch(n){a=e?.defaultValue||"_ERROR_",console.error(n)}return l[e.ref]=a,"function"==typeof e.sortValue&&(l[e.ref]=e.sortValue(o)),{column:e,refData:o,value:a,data:t}}));a.value.push({row:o,data:t,sortData:l,searchIndex:[...o,o.map((e=>e.value)).join(" ")]})}))};return v((()=>e.columnData),(n=>{if(a.value=[],!Array.isArray(n)||!n.length)return t.value=0,l.value=e.defaultSortedColumn??"",o.value=e.defaultSortOrder||"desc",void k(Array.from({length:0}).map((()=>({}))));k(n)}),{immediate:!0,deep:!0}),{first:()=>t.value=0,last:()=>t.value=r.value-1||0,next:()=>t.value+=1,prev:()=>t.value-=1,selectPage:()=>g((e=>{const a=parseInt(e);parseInt(e)<=r.value&&(t.value=a)}),{title:"Select page"}),sortColumn:e=>{l.value=e,o.value="asc"===o.value?"desc":"asc"},onClickTablecell:e=>{try{return void("function"==typeof e.column?.tdClick&&e.column?.tdClick(e))}catch(a){console.error(a)}},close:close,arrowUp:m,arrowDown:p,page:h,canNext:s,totalPages:r,sortOrder:o,canPrev:i,currentPage:t,columnSorted:l}}}),$={style:{width:"100%"}},H={class:"stick-report-header"},U=["colspan","rowspan","onClick"],F=["onClick"],q=["innerHTML"],B=h(E,[["render",function(e,a,t,l,o,n){const r=k("ion-icon"),s=k("ion-label"),i=k("ion-item"),c=k("ion-button"),u=k("ion-toolbar"),d=k("ion-footer");return y(),b(V,null,[w("div",null,[w("table",$,[w("thead",H,[(y(!0),b(V,null,_(e.columns,((a,t)=>(y(),b("tr",{key:t},[(y(!0),b(V,null,_(a,((a,t)=>(y(),b("th",{key:t,colspan:a?.span?.thColspan||1,rowspan:a?.span?.thRowspan||1,onClick:t=>e.sortColumn(a.ref)},[C(i,{lines:"none"},{default:P((()=>[e.columnSorted&&e.columnSorted===a.ref?(y(),x(r,{key:0,icon:"asc"===e.sortOrder?e.arrowUp:e.arrowDown},null,8,["icon"])):L("",!0),C(s,null,{default:P((()=>[w("b",null,j(a.label),1)])),_:2},1024)])),_:2},1024)],8,U)))),128))])))),128))]),w("tbody",null,[(y(!0),b(V,null,_(e.page,((a,t)=>(y(),b("tr",{key:t},[(y(!0),b(V,null,_(a.row,((a,t)=>(y(),b("td",{key:t,onClick:()=>e.onClickTablecell(a),class:D({"clickable-cell":a?.column?.tdClick})},[w("span",{innerHTML:a.value,class:"his-sm-text"},null,8,q)],10,F)))),128))])))),128))])])]),a[4]||(a[4]=w("p",null,null,-1)),C(d,null,{default:P((()=>[C(u,{color:"light"},{default:P((()=>[e.totalPages>1?(y(),x(c,{key:0,onClick:e.first,disabled:0===e.currentPage||e.totalPages<=2,size:"large",slot:"end"},{default:P((()=>[...a[0]||(a[0]=[I(" First ",-1)])])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(y(),x(c,{key:1,onClick:e.prev,disabled:!e.canPrev,color:"light",size:"large",slot:"end"},{default:P((()=>[...a[1]||(a[1]=[I(" Prev ",-1)])])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(y(),x(c,{key:2,onClick:e.selectPage,size:"large",slot:"end",color:"light"},{default:P((()=>[I(j(e.currentPage)+" / "+j(e.totalPages-1),1)])),_:1},8,["onClick"])):L("",!0),e.totalPages>1?(y(),x(c,{key:3,onClick:e.next,disabled:!e.canNext,color:"light",size:"large",slot:"end"},{default:P((()=>[...a[2]||(a[2]=[I(" Next ",-1)])])),_:1},8,["onClick","disabled"])):L("",!0),e.totalPages>1?(y(),x(c,{key:4,onClick:e.last,disabled:e.currentPage+1>=e.totalPages||e.totalPages<=2,size:"large",slot:"end"},{default:P((()=>[...a[3]||(a[3]=[I(" Last ",-1)])])),_:1},8,["onClick","disabled"])):L("",!0)])),_:1})])),_:1})],64)}],["__scopeId","data-v-6173022f"]]),Z={key:0},G={key:1,class:"his-card ion-text-center his-lg-text"};e("default",t({__name:"HomeNotifications",setup(e){const{notificationData:a,hasNotifications:t,clearNotification:l,openNotification:o}=S(),r=c("highViraemia"),s=O({highViraemia:[],rejectedVL:[],lowLevelViraemia:[],suppressed:[],initiatedData:{},stats:{}}),i=u((()=>[[{ref:"arv",label:"ARV #"},{ref:"accession",label:"Accession #"},{ref:"order_date",label:"Order Date",toValue:e=>`${N(e)}`},..."rejectedVL"===r.value?[{ref:"rejection_reason",label:"Rejection Reason"}]:[],{ref:"id",label:"View",toValue:()=>"View",tdClick:e=>o(e.data)},{ref:"id",label:"Clear",toValue:()=>"Clear",tdClick:e=>l(e.refData,(e=>{s[r.value]=s[r.value].filter((a=>a.id!=e))}))}]]));async function d(e,t=a.value){if(t.length&&s.initiatedData[e])return;let l=6e3;const o=f.chunk(t?.[0]?.vlMessageObs?.[e]??{},7);s.initiatedData[e]=t.length>0,s[e]=[];for(const a of o)s[e]=[...s[e],...a],await M(l),l=30;s[e]=[...s[e]].sort(((e,a)=>new Date(e.order_date)>new Date(a.order_date)?-1:1))}return v(a,(async e=>{d(r.value,e),setTimeout((()=>{const a=e?.[0]?.vlMessageObs??{};s.stats.highViraemia=(a.highViraemia??[]).length,s.stats.lowLevelViraemia=(a.lowLevelViraemia??[]).length,s.stats.rejectedVL=(a.rejectedVL??[]).length,s.stats.suppressed=(a.suppressed??[]).length}),50)}),{immediate:!0,deep:!0}),(e,a)=>(y(),b("div",null,[R(t)?(y(),b("div",Z,[C(R(T),{mode:"ios",modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=e=>r.value=e),class:"ion-justify-content-center"},{default:P((()=>[C(R(z),{onClick:a[0]||(a[0]=e=>d("suppressed")),value:"suppressed"},{default:P((()=>[C(R(n),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:P((()=>[...a[5]||(a[5]=[I("Suppressed",-1)])])),_:1}),C(R(A),{color:"success"},{default:P((()=>[I(j(s.stats?.suppressed??"-"),1)])),_:1})])),_:1}),C(R(z),{onClick:a[1]||(a[1]=e=>d("lowLevelViraemia")),value:"lowLevelViraemia"},{default:P((()=>[C(R(n),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:P((()=>[...a[6]||(a[6]=[I("Low-level viraemia",-1)])])),_:1}),C(R(A),{color:"warning"},{default:P((()=>[I(j(s.stats?.lowLevelViraemia??"-"),1)])),_:1})])),_:1}),C(R(z),{onClick:a[2]||(a[2]=e=>d("highViraemia")),value:"highViraemia"},{default:P((()=>[C(R(n),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:P((()=>[...a[7]||(a[7]=[I("Viraemia 1000+",-1)])])),_:1}),C(R(A),{color:"danger"},{default:P((()=>[I(j(s.stats?.highViraemia??"-"),1)])),_:1})])),_:1}),C(R(z),{onClick:a[3]||(a[3]=e=>d("rejectedVL")),value:"rejectedVL"},{default:P((()=>[C(R(n),{class:"his-sm-text",style:{"font-weight":"bold"}},{default:P((()=>[...a[8]||(a[8]=[I("Rejected",-1)])])),_:1}),C(R(A),{color:"danger"},{default:P((()=>[I(j(s.stats?.rejectedVL??"-"),1)])),_:1})])),_:1})])),_:1},8,["modelValue"]),a[9]||(a[9]=w("p",null,null,-1)),(y(),x(B,{key:r.value,columns:i.value,"column-data":s[r.value],"rows-per-page":7},null,8,["columns","column-data"]))])):(y(),b("div",G," No notifications "))]))}}))}}}));
