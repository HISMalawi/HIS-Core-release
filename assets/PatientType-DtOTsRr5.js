import{d as s,b7 as n,U as l,F as i,V as t,b5 as r,_ as p,r as d,o as u,c}from"./index-DsVZSn5I.js";import{H as y}from"./HisStandardForm-CBASeHGe.js";import{_ as h}from"./EncounterMixin.vue_vue_type_script_lang-C0K9gJxk.js";import"./encounter_guidelines-CYP5Ifi5.js";import"./GuidelineEngine-D6V1_Znr.js";const T=s({mixins:[h],components:{HisStandardForm:y},data:()=>({patientType:{}}),watch:{ready:{async handler(e){e&&(this.patientType=new n(this.patientID,this.providerID),await this.patientType.loadPatientType(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,a){await this.patientType.createEncounter(),await this.patientType.saveObservationList(await this.resolveObs(a)),l("Observations and encounter created!"),this.nextTask()},patientTypeField(){return{id:"patient_type",helpText:"Current type: ".concat(this.patientType.getType()),type:i.TT_SELECT,validation:e=>t.required(e)||t.notTheSame(e.value,this.patientType.getType()),options:()=>n.getPatientTypes(),computedValue:e=>this.patientType.buildPatientType(e.value)}},facilityLocationField(){return{...r.getFacilityLocationField(),computedValue:e=>this.patientType.buildLocationClinic(e.value),condition:e=>["Emergency supply","External consultation"].includes(e.patient_type.value)}},entryPointField(){return{id:"entry",helpText:"Entry point",type:i.TT_SELECT,computedValue:e=>this.patientType.buildEntryPoint(e.value),condition:e=>/external/i.test(e.patient_type.value),validation:e=>t.required(e),options:()=>this.mapStrToOptions(["ART","ANC","IPD","OPD"])}},hasViralLoadField(){return{id:"has_vl",helpText:"Viral load result available?",type:i.TT_SELECT,condition:e=>/external/i.test(e.patient_type.value),validation:e=>t.required(e),options:()=>this.yesNoOptions()}},viralLoadField(){return{id:"vl",helpText:"Viral load",type:i.TT_TEXT,condition:e=>e.has_vl.value==="Yes",computedValue:e=>this.patientType.buildVl(e.value),validation:e=>t.validateSeries([()=>t.required(e),()=>/^([=<>]\d*)$|^(LDL)$/i.test("".concat(e.value))?null:["Invalid value format. Viral load values should look similar to  >1000 or <250 or =650 or LDL"]]),config:{customKeyboard:[[["1","2","3","=","<",">"],["4","5","6","LDL"],["7","8","9"],["","0",""]],[["Delete"]]]}}},getFields(){return[this.patientTypeField(),this.facilityLocationField(),this.entryPointField(),this.hasViralLoadField(),this.viralLoadField()]}}});function m(e,a,v,_,f,F){const o=d("his-standard-form");return u(),c(o,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const D=p(T,[["render",m]]);export{D as default};
