import{d as C,I as _,cE as I,r,o as $,i as R,W as B,ak as k,d5 as b,D as A,at as p,aa as P,af as u,a as S,c as w,w as y,b as h}from"./index-DOO_dFo7.js";import{O,D as V}from"./opd_report_service-gm_0cKv7.js";import{v as G}from"./TableView-BvhBZtlg.js";import{A as L}from"./v2utils-CeAH6A4-.js";import"./Export-Cg2VfxNM.js";import"./index-BgISI6Sz.js";const x=C({components:{IonPage:_,IonLoading:I,v2Datatable:G},setup(){const e=r([]),s=r(""),m=r(""),i=r(!1),n=new O,l=r([]);let c=0;const d=async a=>{(await p.create({component:L,backdropDismiss:!1,cssClass:"large-modal",componentProps:{...a,subtitle:s.value,onFinish:()=>p.getTop().then(t=>t&&p.dismiss())}})).present()},g=(a,t)=>({ref:t,label:a,defaultValue:"0",toValue:o=>o.length,tdClick:async o=>{o.refData.length&&d({patientIdentifiers:o.refData,title:"".concat(o.data.age_group," ").concat(o.data.gender," ").concat(o.column.label)})}}),v=[[{label:"#",ref:"index",toValue:()=>++c},{label:"Age group",ref:"ageGroup"},{label:"Gender",ref:"gender"},...Object.entries(V).map(([a,t])=>g(t,a))]],f=async()=>{if(!(n.startDate&&n.endDate))return B("Start date and end date required!");i.value=!0;try{e.value=await n.getDisaggReport()}catch(a){console.error(a);const t="Unable to generate report!";k(t),l.value=[{text:t,color:"danger",icon:b,action:function(){l.value=[{text:"Exception occured: <b>".concat(a,"</b>"),color:"danger",icon:b}]}}]}i.value=!1,m.value=""},D=()=>A({onFinish:(a,t,o)=>{s.value=o,n.startDate=a,n.endDate=t,f()}});return $(()=>D()),{Img:R,headerBadge:l,reportData:e,isLoading:i,configure:D,generate:f,columns:v,period:s}}});function E(e,s,m,i,n,l){const c=u("ion-loading"),d=u("v2Datatable"),g=u("ion-page");return S(),w(g,null,{default:y(()=>[h(c,{"is-open":e.isLoading,message:"Please wait.."},null,8,["is-open"]),h(d,{"icon-url":e.Img("reports.png"),title:"Clinic Disaggregated Report","report-prefix":"clinic",subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:100,onConfigure:e.configure,onRefresh:e.generate,headerBadge:e.headerBadge},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh","headerBadge"])]),_:1})}const q=P(x,[["render",E]]);export{q as default};
