System.register(["./index-legacy-C29Eb2Qm.js","./KbLayouts-legacy-BKvPSxzZ.js","./PopupKeyboard-legacy-BqngSQ76.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./SIngleTouchField-legacy-BRNk_9sq.js","./TouchScreenForm-legacy-BmEuIwWy.js","./ToolbarMediumCard-legacy-CF38wqjC.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-CDi_rmkw.js","./HisKeypad-legacy-CPvjpCHl.js","./BaseKeyboard-legacy-BwPGWdsO.js","./KbHandler-legacy-De8o5nTq.js"],(function(e,a){"use strict";var t,o,n,r,i,s,l,d,u,c,p,f,g,h,m,y,b,w,v,I,k,x,C,_,T,P,L,S,V,N,A,$,j,O,B,E,z,D,K,U,F,R,M,H,Y,G,X,q,W,Q;return{setters:[e=>{t=e.d,o=e.W,n=e.X,r=e.t,i=e.V,s=e.Y,l=e.Z,d=e.q,u=e.$,c=e._,p=e.o,f=e.x,g=e.A,h=e.v,m=e.a0,y=e.a1,b=e.F,w=e.y,v=e.z,I=e.a2,k=e.a3,x=e.a4,C=e.h,_=e.f,T=e.k,P=e.C,L=e.I,S=e.j,V=e.i,N=e.l,A=e.m,$=e.a5,j=e.a6,O=e.K,B=e.a7,E=e.M,z=e.a8,D=e.N,K=e.a9,U=e.aa,F=e.ab,R=e.ac,M=e.r,H=e.c,Y=e.w,G=e.b,X=e.u},e=>{q=e.L},e=>{W=e.M},e=>{Q=e.F},null,null,null,null,null,null,null,null],execute:function(){var a=document.createElement("style");a.textContent=".input-boxes[data-v-260a844a]{height:70px;border:1px solid #ccc;border-radius:5px;width:50%;font-family:Nimbus Sans L,Arial Narrow,sans-serif;font-size:2.2em;background-color:#dcdcdc;color:#000;padding:8px}.main[data-v-260a844a]{width:100%;text-align:center;margin-top:5%;display:table}.keyboard[data-v-260a844a]{text-align:center;position:absolute;background-color:#fff;width:100%;border:1px solid rgb(204,204,204);word-wrap:normal!important;margin:0 auto;max-width:300px;left:0;right:0}.rows[data-v-260a844a]{display:table-row;line-height:1px}.cells[data-v-260a844a]{display:table-cell}.keyboard-btn[data-v-260a844a]{border:1px solid #7eb9d0;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:5px!important;font-size:1.6vw!important;font-family:arial,helvetica,sans-serif;text-decoration:none;display:inline-block;text-shadow:-1px -1px 0 rgba(0,0,0,.3);font-weight:700;color:#fff;background-color:#a7cfdf;background-image:-webkit-gradient(linear,left top,left bottom,from(#a7cfdf),to(#23538a));background-image:-webkit-linear-gradient(top,#a7cfdf,#23538a);background-image:-moz-linear-gradient(top,#a7cfdf,#23538a);background-image:-ms-linear-gradient(top,#a7cfdf,#23538a);background-image:-o-linear-gradient(top,#a7cfdf,#23538a);background-image:linear-gradient(to bottom,#a7cfdf,#23538a);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=#a7cfdf,endColorstr=#23538a);max-width:85px;max-height:85px;cursor:pointer;text-align:center;margin:3px;width:8vw;height:8vh;overflow:hidden;white-space:nowrap}@media screen and (max-width: 600px){.keyboard-btn[data-v-260a844a]{font-size:10px!important}}@media screen and (min-width: 1020px){.keyboard-btn[data-v-260a844a]{font-size:25px!important}}.login-btn[data-v-260a844a]{background-image:-webkit-gradient(linear,left top,left bottom,from(green),to green);background-image:-webkit-linear-gradient(top,green,green);background-image:-moz-linear-gradient(top,green,green);background-image:-ms-linear-gradient(top,green,green);background-image:-o-linear-gradient(top,green,green);background-image:linear-gradient(to bottom,green,green);filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=green,endColorstr=green)}.input-rows[data-v-260a844a]{line-height:140px}#coat[data-v-dc3f54cc]{width:8vw;height:8vw}#pepfar[data-v-dc3f54cc]{width:6vw;height:6vw}.devices[data-v-dc3f54cc]{background-color:var(--ion-color-primary);color:#fff;border:1px solid lightblue;font-size:1.3em;padding:1rem;margin-right:.5rem}.devices>option[data-v-dc3f54cc]{background:#fff;color:#000}\n",document.head.appendChild(a);const Z=t({props:{useVirtualInput:{type:Boolean}},data:function(){return{LOGIN_KEYBOARD:q,auth:{},userInput:{type:String,username:"",password:""},focusInput:{type:Object,value:"",id:""},display:"none",keyboardTop:"",btnCaption:"",Caps:{type:Boolean,on:!1}}},created(){this.auth=new o,n.clearScreenTimeout()},setup(){const{facilityName:e,district:a}=u();return{facilityName:e,district:a}},methods:{renderKeyBoard(e){this.focusInput=e.currentTarget,"password"==this.focusInput.id?this.btnCaption="Login":this.btnCaption="Next";let a=e.currentTarget.getBoundingClientRect().top;a=parseInt(a),this.keyboardTop=a+20+"px;",this.display="table",window.scrollTo(0,9999)},keyPress(e){const a=e.currentTarget.id;let t;try{a.match(/Del./i)?this.focusInput.value=this.focusInput.value.substring(0,this.focusInput.value.length-1):a.match(/Next/i)?(this.display="none",t=this.$refs.password,t.click()):a.match(/Login/i)?(this.display="none",this.doLogin()):a.match(/Caps/i)?(this.Caps.on=!this.Caps.on,this.display="none",t="username"===this.focusInput.id?this.$refs.username:this.$refs.password,t.click()):a.match(/Hide/i)?this.display="none":this.focusInput.value+=a,"username"==this.focusInput.id?this.userInput.username=this.focusInput.value:this.userInput.password=this.focusInput.value}catch(o){console.warn("input error")}},doLogin:async function(){if(this.userInput.username&&this.userInput.password){this.auth.setUsername(this.userInput.username);try{if(this.auth.versionLockingIsEnabled()&&await this.auth.validateIfCorrectAPIVersion(),!(await this.auth.checkTimeIntegrity()))throw"Local date does not match API date. Please Update your device's date";if(await this.auth.login(this.userInput.password),this.auth.startSession(),(await Promise.all([this.auth.passwordPolicyEnabled(),this.auth.passwordExpired()])).every(Boolean)){const e=e=>`${e.value}`.toLowerCase();return W([{id:"new_password",proxyID:"password",helpText:"Change your password",type:Q.TT_TEXT,init:()=>(setTimeout((()=>{r("Your password has expired! please change it now!",8e3)}),500),!0),computedValue:a=>e(a),validation:a=>i.validateSeries([()=>i.required(a),()=>i.hasLengthRangeOf(a,4,15),()=>{if(`${this.userInput.password}`.toLowerCase()===e(a))return["New password should not match old password"]}]),config:{inputType:"password"}},{id:"verify_password",proxyID:"password",helpText:"Confirm Password",type:Q.TT_TEXT,computedValue:a=>e(a),validation:(a,t)=>i.validateSeries([()=>i.required(a),()=>{if(e(t.verify_password)!=e(t.new_password))return["New password does not match current password"]}]),config:{inputType:"password"}}],(async(e,a)=>{await s.updateUser(this.auth.userID,a)?(await this.auth.resetUserPasswordChangeCheck(),this.$router.push("/select_hc_location")):r("Unable to update user")}))}this.$router.push("/select_hc_location")}catch(e){e instanceof l?r("Invalid username or password"):d(`${e}`,5e4)}}else r("Complete form to log in")}},computed:{btnStyles(){return`display: ${this.display}; top: ${this.keyboardTop};`}}}),J={class:"main",ref:"main"},ee={class:"cells ion-padding-bottom"},ae=(e=>(k("data-v-260a844a"),e=e(),x(),e))((()=>g("b",{style:{color:"#8b4513"}},"Facility: ",-1))),te={style:{color:"#cd853f"}},oe={class:"rows"},ne={class:"cells"},re=["readonly"],ie={class:"rows input-rows"},se={class:"cells"},le=["readonly"],de={class:"rows"},ue=["id"],ce=["id"],pe=t({name:"login",components:{IonItem:C,Inputs:c(Z,[["render",function(e,a,t,o,n,r){return p(),f(b,null,[g("div",J,[g("div",ee,[g("h3",null,[ae,g("b",te,h(e.facilityName)+" ("+h(e.district)+")",1)])]),g("div",oe,[g("div",ne,[m(g("input",{type:"text",name:"usename",autocomplete:"off",placeholder:"Username",id:"username",ref:"username","onUpdate:modelValue":a[0]||(a[0]=a=>e.userInput.username=a),onClick:a[1]||(a[1]=a=>e.renderKeyBoard(a)),class:"input-boxes",readonly:e.useVirtualInput},null,8,re),[[y,e.userInput.username]])])]),g("div",ie,[g("div",se,[m(g("input",{"onUpdate:modelValue":a[2]||(a[2]=a=>e.userInput.password=a),type:"password",name:"password",ref:"password",id:"password",onClick:a[3]||(a[3]=a=>e.renderKeyBoard(a)),class:"input-boxes",placeholder:"Password",readonly:e.useVirtualInput},null,8,le),[[y,e.userInput.password]])])])],512),g("div",{id:"keyboard",style:I(e.btnStyles),class:"keyboard"},[(p(!0),f(b,null,w(e.LOGIN_KEYBOARD,((t,o)=>(p(),f("span",{key:o},[g("div",de,[(p(!0),f(b,null,w(t,(t=>(p(),f("div",{class:"cells",key:t},["Next"===t||"Login"===t?(p(),f("button",{key:0,id:e.btnCaption,class:"keyboard-btn login-btn",onClick:a[4]||(a[4]=a=>e.keyPress(a))},h(e.btnCaption),9,ue)):v("",!0),"Login"!=t&&"Next"!=t?(p(),f("button",{key:1,id:e.Caps.on?t.toUpperCase():t.toLowerCase(),class:"keyboard-btn",onClick:a[5]||(a[5]=a=>e.keyPress(a))},h("Del."===t||"Caps"===t?t:e.Caps.on?t.toUpperCase():t.toLowerCase()),9,ce)):v("",!0)])))),128))])])))),128))],4)],64)}],["__scopeId","data-v-260a844a"]]),IonButton:_,IonTitle:T,IonLabel:P,IonPage:L,IonHeader:S,IonToolbar:V,IonContent:N,IonFooter:A,IonSelect:$,IonSelectOption:j},setup(){const e=O([]),{activePlatformProfile:a,platformProfiles:t}=B(),n=O(""),r=O(""),i=E((()=>a.value.keyboard===R.HIS_KEYBOARD_ONLY)),s=Object.keys(t.value).map((e=>({label:e,value:{profileName:e,...t.value[e]}})));return z(r,(e=>{a.value=(F.find(s,{label:e})||{}).value})),D((async()=>{const t=new o;e.value=(await t.loadConfig())?.otherApps||[];const i=t.getHeadVersion();t.setActiveVersion(i);const s=await t.getApiVersion();n.value=`${i} / ${s}`,r.value=a.value?.profileName||""})),{version:n,profile:r,otherApps:e,deviceProfiles:s,useVirtualInputOnly:i,activePlatformProfile:a,coatImg:K("login-logos/Malawi-Coat_of_arms_of_arms.png"),pepfarImg:K("login-logos/PEPFAR.png"),showConfig:"true"===localStorage.getItem("useLocalStorage"),openSelect:async()=>{const a=await U("Application Selection","Please specify the application you wish to use",e.value.map((e=>e.name)),[{name:"Cancel",color:"danger",slot:"start"},{name:"Confirm",color:"primary",slot:"end",role:"action"}]);if(a.selection&&"Cancel"!=a.action){const t=e.value.find((e=>e.name===a.selection));window.open(`${t.protocol||"http"}://${t.IP}:${t.port||80}`,"_blank")}}}}}),fe=e=>(k("data-v-dc3f54cc"),e=e(),x(),e),ge=fe((()=>g("b",{style:{color:"#8b4513"}},"National ",-1))),he=fe((()=>g("b",{style:{color:"#cd853f"}},"EMR",-1))),me={slot:"start"},ye=["src"],be=["src"];e("default",c(pe,[["render",function(e,a,t,o,n,r){const i=M("ion-label"),s=M("ion-title"),l=M("ion-toolbar"),d=M("ion-header"),u=M("inputs"),c=M("ion-content"),m=M("ion-select-option"),y=M("ion-select"),I=M("ion-button"),k=M("ion-item"),x=M("ion-footer"),C=M("ion-page");return p(),H(C,null,{default:Y((()=>[G(d,null,{default:Y((()=>[G(l,null,{default:Y((()=>[G(s,null,{default:Y((()=>[G(i,{style:{fontWeight:"bolder",fontSize:"1.9em"}},{default:Y((()=>[ge,he])),_:1})])),_:1}),G(i,{class:"ion-padding",slot:"end"},{default:Y((()=>[X(" Version: "),g("b",null,h(e.version),1)])),_:1})])),_:1})])),_:1}),G(c,{fullscreen:"false",style:{}},{default:Y((()=>[G(u,{useVirtualInput:e.useVirtualInputOnly},null,8,["useVirtualInput"])])),_:1}),G(x,null,{default:Y((()=>[G(l,null,{default:Y((()=>[g("span",me,[g("img",{id:"coat",src:e.coatImg,alt:"Malawi Coat of Arms logo"},null,8,ye),g("img",{id:"pepfar",src:e.pepfarImg,alt:"PEPFAR logo"},null,8,be)]),G(k,{class:"his-sm-text",style:{width:"75%"},slot:"end"},{default:Y((()=>[G(i,null,{default:Y((()=>[X("Device Profile")])),_:1}),G(y,{modelValue:e.profile,"onUpdate:modelValue":a[0]||(a[0]=a=>e.profile=a),value:e.profile},{default:Y((()=>[(p(!0),f(b,null,w(e.deviceProfiles,((e,a)=>(p(),H(m,{key:a,value:e.label},{default:Y((()=>[X(h(e.label),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","value"]),G(I,{color:"dark",fill:"outline",size:"large",slot:"end","router-link":"/settings/host"},{default:Y((()=>[X(" Network ")])),_:1}),e.otherApps.length?(p(),H(I,{key:0,color:"dark",fill:"outline",size:"large",slot:"end",onClick:e.openSelect},{default:Y((()=>[X(" Other Applications ")])),_:1},8,["onClick"])):v("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-dc3f54cc"]]))}}}));
