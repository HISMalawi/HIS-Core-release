System.register(["./HisStandardForm-legacy-Yzj84zTJ.js","./index-legacy-D1EyWbyq.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./LocationFieldOptions-legacy-pDcGW7s3.js","./commons-legacy-zTHv4eYO.js","./useEncounter-legacy-CiQF3Sz6.js","./TouchScreenForm-legacy-Cz0UXr2y.js","./ToolbarMediumCard-legacy-DG4P2wyL.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-Dt6qML7b.js","./isEmpty-legacy-ChPiFzhs.js","./_Set-legacy-pEWI0JQr.js","./_setToArray-legacy-CQiJvmDs.js","./encounter_guidelines-legacy-aDW7sCjC.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,l,i,n,o,r,s,c,u,d,y,g,f,m,b,h,p,v,T,w;return{setters:[e=>{a=e.H},e=>{l=e.b5,i=e.d,n=e.K,o=e.V,r=e.U,s=e.t,c=e.n,u=e.q,d=e.o,y=e.c,g=e.w,f=e.b,m=e.cl,b=e.I,h=e.ab},e=>{p=e.F},e=>{v=e.g},e=>{T=e.r},e=>{w=e.u},null,null,null,null,null,null,null,null,null],execute:function(){class t extends l{constructor(e,t){super(e,114,t)}}class S extends l{constructor(e,t){super(e,40,t)}}e("default",i({__name:"DischargePatient",setup(e){let l,i;const j=n([]),{goToNextTask:D,patientDashboardUrl:_}=w(((e,a)=>{i=new S(a,e),l=new t(a,e),j.value=[{id:"outcome_status",helpText:"Select Discharge Outcome",type:p.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"outcome",obs:i.buildValueCoded("outcome",e.value)}),options:()=>[{label:"Referred (Within the Facility)",value:"Patient transferred internally"},{label:"Dead",value:"Died in treatment"},{label:"Abscorded",value:"Absconded"},{label:"Alive (Discharged home)",value:"Discharged home"},{label:"Transferred (Another health facility)",value:"Discharged to another facility"}]},{id:"facility_name",helpText:"Select Facility name",type:p.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"referral",obs:l.buildValueText("Referred",e.label)}),condition:e=>"Discharged to another facility"===e.outcome_status.value,options:(e,t="")=>v(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"internal_sections",helpText:"Select Ward/internal section",type:p.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"referral",obs:l.buildValueText("Specialist clinic",e.label)}),condition:e=>"Patient transferred internally"===e.outcome_status.value,options:()=>r.getInternalSections(),config:{showKeyboard:!0,footerBtns:[{name:"Add Section",slot:"end",color:"success",onClick:async(e,t,a)=>{if("string"!=typeof a.filter||a.filter.length<3)return s("Please enter a valid section name");if(a.filtered.some((e=>e.label.toLowerCase()===a.filter.toLowerCase())))return s("Section already existing");if(await c("Do you want to add internal section?")){const e=await r.createInternalSection(a.filter.toUpperCase());e?(a.filter=e.name,a.listData=[{label:e.name,value:e.id},...a.listData]):u(`Unable to add ${a.filter}`)}}}]}}]}));async function x(e,t){await i.createEncounter();const a=await T({...t},"outcome");await i.saveObservationList(a);const n=await T({...t},"referral");h.isEmpty(n)||(await l.createEncounter(),await l.saveObservationList(n)),D()}return(e,t)=>(d(),y(m(b),null,{default:g((()=>[f(a,{cancelDestinationPath:m(_),fields:j.value,onFinishAction:x,skipSummary:""},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
