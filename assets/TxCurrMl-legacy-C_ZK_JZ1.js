System.register(["./ReportMixin.vue_vue_type_script_lang-legacy-Cbxcxwf4.js","./tx_report_service-legacy-aGSGshPC.js","./TableReportTemplate-legacy-CxKxnBF6.js","./index-legacy--hxN_V8z.js","./MultiFieldDateHelper-legacy-B97J9Bxd.js","./dynamic-import-helper-legacy-DYK5bIOV.js","./KbLayouts-legacy-BKvPSxzZ.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./BasicReportTemplate-legacy-B1A4xCu4.js","./Export-legacy-BAJiCfrv.js","./SIngleTouchField-legacy-X9PnjTsk.js","./Pagination-legacy-Dw_YvCGa.js","./HisStandardForm-legacy-C7VqHmr3.js","./TouchScreenForm-legacy-DxIQwsU4.js","./ToolbarMediumCard-legacy-CzmL2SiF.js","./Transformers-legacy-DhNYVLaS.js","./ViewPort-legacy-TUlObaz7.js","./ReportErrors-legacy-Btn46Hsy.js"],(function(t,e){"use strict";var s,o,r,a,i,l,n,d,u,c,h,p,T,g;return{setters:[t=>{s=t._},t=>{o=t.T},t=>{r=t.R},t=>{a=t.d,i=t.I,l=t.L,n=t.ab,d=t.cx,u=t._,c=t.r,h=t.o,p=t.c,T=t.w,g=t.b},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){const e=a({mixins:[s],components:{ReportTemplate:r,IonPage:i},data:()=>({title:"PEPFAR Tx ML Report",rows:[],drillData:{},columns:[[l.thTxt("Age group"),l.thTxt("Gender"),l.thTxt("Died"),l.thTxt("IIT <3 mo"),l.thTxt("IIT 3-5 mo"),l.thTxt("IIT 6+ mo"),l.thTxt("Transferred out"),l.thTxt("Refused (Stopped)")]],indexLabel:["Died","IIT <3 mo","IIT 3-5 mo","IIT 6+ mo","Tranferred out","Refused (Stopped)"],cohort:{}}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(t,e){this.rows=[],this.report=new o,this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),this.cohort=await this.report.getTxMlReport(),this.setRows("F"),this.setRows("M"),this.setTotalMaleRow(),this.setMaternalRows()},drilldown(t,e){const s=[[l.thTxt("ARV#"),l.thTxt("DOB"),l.thTxt("Dispensed"),l.thTxt("ARVs")]],o=async()=>{if(e in this.drillData)return this.drillData[e];const s=await this.report.getTxMMDClientLevelData(t);if(!s)return[];const o=this.report.remapTxClientLevelData(s).map((t=>{const e=t.drugs.map((t=>({tableView:`\n                                <table style='width: 100%;'> \n                                    <td style='width: 65%;'>${t.name}</td>\n                                    <td style='width: 30%;'>(${t.quantity}, ${t.dose} a day)</td>\n                                </table>`,dataView:`${t.name} (Quantity: ${t.quantity} Dose: ${t.dose})`})));return[l.td(t.id||"N/A"),l.tdDate(t.dob),l.tdDate(t.dispenseDate),l.td(e.map((t=>t.tableView)).join("<p/>"),{value:e.map((t=>t.dataView)).join("|")})]}));return this.drillData[e]=o,o};return t.length<=0?l.td(0):l.tdLink(t.length,(()=>this.drilldownAsyncRows(e,s,o)))},aggregate(t,e){return Object.values(this.cohort).reduce(((s,o)=>o[t]?[...o[t][this.indexLabel.indexOf(e)],...s]:s),[])},setTotalMaleRow(){const t=t=>this.drilldown(this.aggregate("M",t),t);this.rows.push([l.td("All"),l.td("Male"),t("Died"),t("IIT <3 mo"),t("IIT 3-5 mo"),t("IIT 6+ mo"),t("Tranferred out"),t("Refused (Stopped)")])},async setMaternalRows(){const t=this.indexLabel.reduce(((t,e)=>[...t,{indicator:e,data:this.aggregate("F",e)}]),[]),e=await this.report.getMaternalStatus(n.uniq(t.reduce(((t,e)=>[...t,...e.data]),[]).map((t=>t)))),s=e=>t.reduce(((t,s)=>s.indicator===e?[...t,...s.data]:t),[]),o=(t,o)=>this.drilldown(s(o).filter((s=>e[t].includes(s))),`All ${o} Female Pregnant`),r=e.FBf.concat(e.FP),a=t=>this.drilldown(s(t).filter((t=>!r.includes(t))),`All ${t} Female not pregnant`);this.rows.push([l.td("All"),l.td("FP"),o("FP","Died"),o("FP","IIT <3 mo"),o("FP","IIT 3-5 mo"),o("FP","IIT 6+ mo"),o("FP","Tranferred out"),o("FP","Refused (Stopped)")]),this.rows.push([l.td("All"),l.td("FNP"),a("Died"),a("IIT <3 mo"),a("IIT 3-5 mo"),a("IIT 6+ mo"),a("Tranferred out"),a("Refused (Stopped)")]),this.rows.push([l.td("All"),l.td("FBF"),o("FBf","Died"),o("FBf","IIT <3 mo"),o("FBf","IIT 3-5 mo"),o("FBf","IIT 6+ mo"),o("FBf","Tranferred out"),o("FBf","Refused (Stopped)")])},setRows(t){for(const s in d){const o=d[s],r=this.formatGender(t);try{const e=this.cohort[o][t],s=`${r}s ${o}`,a=e.map(((t,e)=>this.drilldown(t,`${s} ${this.indexLabel[e]}`)));this.rows.push([l.td(o),l.td(r),...a])}catch(e){this.rows.push([l.td(o),l.td(r),l.td(0),l.td(0),l.td(0),l.td(0),l.td(0),l.td(0)])}}}}});t("default",u(e,[["render",function(t,e,s,o,r,a){const i=c("report-template"),l=c("ion-page");return h(),p(l,null,{default:T((()=>[g(i,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,config:{showIndex:!0},reportPrefix:"PEPFAR",onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
