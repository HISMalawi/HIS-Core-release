import{d as z,a7 as R,ai as j,bW as F,a3 as G,a4 as S,b1 as U,aa as Y,af as r,a as l,c as C,w as h,b as d,E as b,J as $,G as x,K as a,a2 as c,C as J,M as w,b7 as D}from"./index-CMZASHAR.js";import{_ as K}from"./FieldMixin.vue_vue_type_script_lang-Bg-mZnL5.js";const L=z({components:{IonInput:R,IonCheckbox:j,ViewPort:F,IonRow:G,IonCol:S,IonGrid:U},mixins:[K],data:()=>({listData:[]}),mounted(){this.init()},activated(){this.init()},watch:{listData:{handler(i){const t=this.toDrugs(i).filter(s=>s.isChecked).reduce((s,n)=>{var o;return[...s,n,...(o=n.substitute)!=null&&o.concept?[n.substitute]:[]]},[]).map(s=>({label:s.name,value:s.concept.concept_id,other:this.regimenComposition}));this.$emit("onValue",t.length?t:null)},deep:!0},clear(){this.listData.forEach(i=>i.other.drugs.forEach(t=>{t.isChecked=!1,t.disabled=!1}))}},computed:{regimenComposition(){const i=[];return(this.toDrugs(this.listData).filter(s=>s.isChecked)||[]).forEach(s=>{if(Object.keys(s.substitute).length>0){const n="".concat(s.abbreviation,"/").concat(s.substitute.abbreviation),o="".concat(s.substitute.abbreviation,"/").concat(s.abbreviation);!i.includes(n)&&!i.includes(o)&&i.push(n)}else i.push(s.abbreviation)}),i.join("-")}},methods:{onCheck(i,t){var s;(s=t==null?void 0:t.substitute)!=null&&s.abbreviation&&this.listData.forEach(n=>{n.other.drugs.forEach(o=>{var u;t.abbreviation===((u=o==null?void 0:o.substitute)==null?void 0:u.abbreviation)&&(o.disabled=i.detail.checked)})})},toDrugs(i){return i.map(t=>t.other.drugs).flat(1)},async init(){this.$emit("onFieldActivated",this),this.listData=await this.options(this.fdata)}}}),M={class:"his-md-text"},O={style:{width:"100%","text-align":"left"}},P={class:"his-sm-text"},T={key:0},W={key:1},q={class:"his-sm-text"};function H(i,t,s,n,o,u){const y=r("ion-input"),p=r("ion-col"),I=r("ion-checkbox"),V=r("ion-row"),N=r("ion-grid"),E=r("view-port");return l(),C(E,null,{default:h(()=>[d(y,{value:i.regimenComposition,class:"input_display",disabled:!0},null,8,["value"]),d(N,{class:"view-port-content"},{default:h(()=>[(l(!0),b($,null,x(i.listData,(m,A)=>(l(),C(V,{key:A},{default:h(()=>[d(p,{size:"3"},{default:h(()=>[a("b",M,c(m.label),1),t[0]||(t[0]=J()),t[1]||(t[1]=a("br",null,null,-1)),a("i",null,c(m.value),1)]),_:2},1024),d(p,{size:"9"},{default:h(()=>[a("table",O,[t[2]||(t[2]=a("thead",null,[a("th"),a("th",{class:"his-sm-text"},"Drug"),a("th",{class:"his-sm-text"},"Resistant"),a("th",{class:"his-sm-text"},"Side effects"),a("th",{class:"his-sm-text"},"Alternative")],-1)),a("tbody",null,[(l(!0),b($,null,x(m.other.drugs,(e,B)=>{var f,v,k;return l(),b("tr",{key:B},[a("td",null,[d(I,{onIonChange:_=>i.onCheck(_,e),disabled:e.resistant||e.disabled,modelValue:e.isChecked,"onUpdate:modelValue":_=>e.isChecked=_},null,8,["onIonChange","disabled","modelValue","onUpdate:modelValue"])]),a("td",P,[e.disabled?(l(),b("s",T,c("".concat(e.name," (").concat(e.abbreviation,")")),1)):w("",!0),e.disabled?w("",!0):(l(),b("span",W,c("".concat(e.name," (").concat(e.abbreviation,")")),1))]),a("td",{class:D(["his-sm-text",{drug_danger:e.resistant,drug_ok:!e.resistant}])},c(e.resistant?"Yes":"No"),3),a("td",{class:D(["his-sm-text",{drug_danger:e.side_effects,drug_ok:!e.side_effects}])},c(e.side_effects?"Yes":"No"),3),a("td",q,c((f=e.substitute)!=null&&f.name?"".concat((v=e.substitute)==null?void 0:v.name," (").concat((k=e.substitute)==null?void 0:k.abbreviation,")"):"N/A"),1)])}),128))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})}const Z=Y(L,[["render",H],["__scopeId","data-v-1e1e7c97"]]);export{Z as default};
