import{bJ as i,d as l,M as o,J as u,ab as a,ac as n,a8 as d,v as p,ad as f,u as h}from"./index-B-uGcoDO.js";import{H as v}from"./HisStandardForm-DB6-tfZz.js";import{_ as m}from"./EncounterMixin.vue_vue_type_script_lang-dqSDwqYH.js";import"./encounter_guidelines-C1w2H-CO.js";import"./GuidelineEngine-D6V1_Znr.js";class b extends i{constructor(s,e){super(s,156,e)}getAssessmentValues(){return i.getConceptsByCategory("fast_track")}}const _=l({mixins:[m],components:{HisStandardForm:v},data:()=>({fields:[],fastTrack:{},options:[],values:[],gender:null}),watch:{ready:{async handler(t){t&&this.init(this.patient)},immediate:!0}},methods:{async onFinish(t){if(await this.fastTrack.createEncounter()){const e=await this.buildObs(t);if(!await this.fastTrack.saveObservationList(e))return o("Unable to save patient observations");u("Observations and encounter created!"),this.nextTask()}else return o("Unable to create fast track encounter")},async init(t){this.gender=t.getGender(),this.fastTrack=new b(t.getID(),this.providerID),this.values=await this.getYesNo(),this.options=await this.getOptions(),this.fields=this.getFields()},async buildObs(t){const s=[];return s.push(await this.fastTrack.buildValueCoded("Assess for fast track",t.ft_assessment.value)),t.ft_questions&&(await t.ft_questions.forEach(async e=>{s.push(await this.fastTrack.buildValueCoded(e.label,e.value))}),s.push(await this.fastTrack.buildValueCoded("Fast track",t.book_client.value))),s},async getOptions(){const t=this.getYesNo(),s=await this.fastTrack.getAssessmentValues("fast_track").map(e=>({label:e.name,value:"",other:{values:t}}));return this.gender==="M"?s.filter(e=>!e.label.match(/Pregnant/i)):s},getYesNo(){return[{label:"yes",value:"Yes"},{label:"no",value:"No"}]},getFields(){return[{id:"ft_assessment",helpText:"Assess client for FT",type:a.TT_SELECT,validation:t=>n.required(t),options:()=>this.getYesNo()},{id:"ft_questions",helpText:"Assess client for FT",type:a.TT_MULTIPLE_YES_NO,condition(t){return t.ft_assessment.value==="Yes"},validation:t=>n.anyEmpty(t),options:()=>this.options},{id:"book_client",helpText:"Select type of visit to book",type:a.TT_SELECT,condition(t){return t.ft_assessment.value==="Yes"},validation:t=>n.required(t),options:()=>[{label:"Fast track",value:"No"},{label:"Normal visit",value:"No"}]}]}}});function T(t,s,e,r,k,g){const c=f("his-standard-form");return h(),p(c,{fields:t.fields,onFinishAction:t.onFinish,skipSummary:!0,cancelDestinationPath:t.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}const N=d(_,[["render",T]]);export{N as default};
