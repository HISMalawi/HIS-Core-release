import{d as h,I as D,J as R,bR as w,_ as v,r as m,o as P,c as C,w as $,b as _,cm as A,K as g,N as E,af as M,O as f,t as F,q as S}from"./index-BFVcutZq.js";import{v as y}from"./TableView-CvEqt4DX.js";import{D as G}from"./ReportDateSelectionPrompt-JDliGFTi.js";import{C as H}from"./clinic_report_service-KwxKYXnw.js";import"./fuse-YdZE3OCN.js";import"./HisKeyboard-kCuG2DTL.js";const I=h({components:{v2Datatable:y,IonPage:D},props:{title:String,patients:Array,onFinish:Function},setup(){const i=R();return{ITEMS_PER_PAGE:20,columns:[[{label:"ARV Number",ref:"arv_number"},{label:"Gender",ref:"gender",value:t=>w(t.gender)},{label:"Systolic/Diastolic",ref:"diastolic",value:t=>"".concat(t.systolic,"/").concat(t.diastolic)},{label:"Action",ref:"patient_id",exportable:!1,tdClick:({data:t})=>i.push({path:"/patient/dashboard/".concat(t.patient_id)}),value:()=>"View client"}]]}}});function N(n,i,s,t,l,e){const p=m("v2Datatable"),d=m("ion-page");return P(),C(d,null,{default:$(()=>[_(p,{title:n.title,columnData:n.patients,columns:n.columns,"on-finish":n.onFinish,"icon-url":"/assets/images/folder.png",rowsPerPage:n.ITEMS_PER_PAGE},null,8,["title","columnData","columns","on-finish","rowsPerPage"])]),_:1})}const T=v(I,[["render",N]]),V=h({components:{IonPage:D,IonLoading:A,v2Datatable:y},setup(){const n=M("reports.png"),i=g([]),s=g(""),t=g(!1),l=new H,e=(a,r)=>({label:a,ref:r,toValue:o=>o.length,tdClick:o=>d("".concat(o.column.label),o.refData)}),p=[[{label:"#",ref:"index"},{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},e("Due for BP screening","due_for_screening"),e("Screened for HP","screened"),e("Normal <140/<90","normal_reading"),e("Mild 140-159/90-99","mild_reading"),e("Moderate 160-180/100-110","moderate_reading"),e("Severe >180/>110","severe_reading"),e("Hydrochlorothiazide 25mg","hydrochlorothiazide_25mg"),e("Amlodipine 5mg","amlodipine_5mg"),e("Amlodipine 10 mg","amlodipine_10mg"),e("Captopril","captopril"),e("Enalapril 5 mg","enalapril_5mg"),e("Enalapril 10mg","enalapril_10mg"),e("Atenolol 50mg","atenolol_50mg"),e("Atenolol 100mg","atenolol_100mg"),e("Nifedipine","nifedipine"),e("Total (regimen)","total_regimen")]],d=async(a,r)=>{r.length&&(await f.create({component:T,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:a,subtitle:s,patients:r,onFinish:()=>f.getTop().then(o=>o&&f.dismiss())}})).present()},u=async()=>{if(!(l.startDate&&l.endDate))return F("Start date and end date required!");t.value=!0,i.value=[];try{const a=await l.getHypertensionReport(),r=Object.keys(a).reduce((o,c)=>(o.M.push({age_group:c,gender:"Male",...a[c].M}),o.F.push({age_group:c,gender:"Female",...a[c].F}),o),{F:[],M:[]});i.value=r.F.concat(r.M).map((o,c)=>({index:c+1,...o}))}catch(a){S("Unable to generate report!"),console.error(a)}t.value=!1},b=()=>G({onFinish:(a,r,o)=>{s.value="Period (".concat(o,")"),l.startDate=a,l.endDate=r,u()}});return E(()=>b()),{logo:n,reportData:i,isLoading:t,configure:b,generate:u,columns:p,period:s}}});function k(n,i,s,t,l,e){const p=m("ion-loading"),d=m("v2Datatable"),u=m("ion-page");return P(),C(u,null,{default:$(()=>[_(p,{"is-open":n.isLoading,message:"Please wait..."},null,8,["is-open"]),_(d,{title:"Hypertension Report","icon-url":n.logo,subtitle:n.period,columns:n.columns,columnData:n.reportData,rowsPerPage:30,onConfigure:n.configure,onRefresh:()=>n.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const J=v(V,[["render",k]]);export{J as default};
