import{d as D,b9 as v,aj as w,ak as C,ai as $,d7 as V,M as N,a7 as M,K as f,c8 as I,a8 as L,_ as P,r as m,o as y,x as K,b as s,w as u,ar as g,c as A,z as O,F as R}from"./index-ChqjXh1q.js";import{H as B}from"./HisKeyboard-BFJHNqBd.js";import{N as _}from"./KbLayouts-VRA-vjeH.js";import{V as F}from"./ViewPort-DBgU2Ffk.js";import{_ as H}from"./FieldMixin.vue_vue_type_script_lang-D3l0RQJR.js";import{k as U}from"./KbHandler-BuQ4TFU6.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BaseKeyboard-pj9TNcmG.js";const E={B:0,F:1,G:2,H:3,J:4,P:5,V:6,W:7,X:8,Z:9},G=[[0,3,1,7,5,9,8,6,4,2],[7,0,9,2,1,5,4,8,6,3],[4,2,0,6,8,7,1,3,5,9],[1,7,5,0,9,8,3,4,2,6],[6,1,2,3,0,4,5,9,7,8],[3,6,7,4,2,0,9,5,8,1],[5,8,6,9,7,2,0,1,3,4],[8,9,4,5,3,6,2,0,1,7],[9,4,3,8,6,1,7,2,0,5],[2,5,8,1,4,3,6,7,9,0]];function b(e,o){const a=o-"".concat(e).length;return a<=0?"".concat(e):"".concat(Array.from({length:a}).map(()=>0).join("")).concat(e)}function z(e){e.match(/^\d+$/)||(e=e.replace(/\D/g,""));let o=0;for(let a=0;a<e.length;a++){const d=e.charAt(a);o=G[o][d]}return"".concat(o)}function j(e){const[o,a,d,i]=e.split("-");if(!(o&&a&&d&&i))return!1;const p=b(parseInt(a),3),c=b(parseInt(d),2),l=E[i.toUpperCase()],k="".concat(o,"-").concat(p,"-").concat(c);return z(k)==="".concat(l)}const J=D({components:{IonInput:v,IonRow:w,IonCol:C,IonGrid:$,HisKeyboard:B,ViewPort:F},mixins:[H],watch:{clear(){this.checkDigit.bookNo="",this.checkDigit.pageNo="",this.checkDigit.rowNo="",this.checkDigit.checkDigit="",this.activeMask="bookNo",this.showKeyboard=!0}},setup(e,{emit:o}){V(()=>o("onFieldActivated",this));const a={bookNo:5,checkDigit:1,pageNo:3,rowNo:2},d=N(()=>M().activePlatformProfile.value.keyboard==="HIS_KEYBOARD_ONLY"),i=f("bookNo"),p=f(!0),c=N(()=>{const t=[_,[["Delete"],["Clear"]]];return{bookNo:t,pageNo:t,rowNo:t,checkDigit:[[["B","F","G"],["H","J","P"],["V","W","X"],["","Z",""]],[["Delete"],["Clear"]]]}[i.value]}),l=I({bookNo:"",pageNo:"",rowNo:"",checkDigit:""});function k(t){if(i.value){const r=a[i.value]||0,n=U(t,r===1?"":"".concat(l[i.value]));(r<=1||"".concat(n).length<=r)&&(l[i.value]=n)}}function h(t){i.value=t,p.value=!0}return L(l,t=>{const r="".concat(t.bookNo,"-").concat(t.pageNo,"-").concat(t.rowNo,"-").concat(t.checkDigit);o("onValue",{label:r,value:"".concat(t.bookNo).concat(t.pageNo).concat(t.rowNo).concat(t.checkDigit),other:{isValidLinkageCode:j(r)}})},{deep:!0}),{activeMask:i,checkDigit:l,showKeyboard:p,inputIsReadOnly:d,inputLengthLimit:a,activeKeyboard:c,onClickMask:h,onKeyPress:k}}});function S(e,o,a,d,i,p){const c=m("ion-input"),l=m("ion-col"),k=m("ion-row"),h=m("ion-grid"),t=m("view-port"),r=m("his-keyboard");return y(),K(R,null,[s(t,{showFull:!1},{default:u(()=>[s(h,null,{default:u(()=>[s(k,null,{default:u(()=>[s(l,null,{default:u(()=>[s(c,{mode:"md",readonly:e.inputIsReadOnly,inputmode:"numeric",type:"number",onClick:o[0]||(o[0]=n=>e.onClickMask("bookNo")),modelValue:e.checkDigit.bookNo,"onUpdate:modelValue":o[1]||(o[1]=n=>e.checkDigit.bookNo=n),style:{textAlign:"center"},placeholder:"Book No.",class:g([{"highlighted-input":e.activeMask==="bookNo"},"input_display"])},null,8,["readonly","modelValue","class"])]),_:1}),s(l,null,{default:u(()=>[s(c,{mode:"md",readonly:e.inputIsReadOnly,type:"number",inputmode:"numeric",maxlength:e.inputLengthLimit.pageNo,onClick:o[2]||(o[2]=n=>e.onClickMask("pageNo")),modelValue:e.checkDigit.pageNo,"onUpdate:modelValue":o[3]||(o[3]=n=>e.checkDigit.pageNo=n),style:{textAlign:"center"},placeholder:"Page No.",class:g([{"highlighted-input":e.activeMask==="pageNo"},"input_display"])},null,8,["readonly","maxlength","modelValue","class"])]),_:1}),s(l,null,{default:u(()=>[s(c,{mode:"md",readonly:e.inputIsReadOnly,inputmode:"numeric",type:"number",maxlength:e.inputLengthLimit.rowNo,onClick:o[4]||(o[4]=n=>e.onClickMask("rowNo")),modelValue:e.checkDigit.rowNo,"onUpdate:modelValue":o[5]||(o[5]=n=>e.checkDigit.rowNo=n),class:g([{"highlighted-input":e.activeMask==="rowNo"},"input_display"]),style:{textAlign:"center"},placeholder:"Row No."},null,8,["readonly","maxlength","modelValue","class"])]),_:1}),s(l,null,{default:u(()=>[s(c,{mode:"md",readonly:e.inputIsReadOnly,maxlength:e.inputLengthLimit.checkDigit,onClick:o[6]||(o[6]=n=>e.onClickMask("checkDigit")),class:g([{"highlighted-input":e.activeMask==="checkDigit"},"input_display"]),modelValue:e.checkDigit.checkDigit,"onUpdate:modelValue":o[7]||(o[7]=n=>e.checkDigit.checkDigit=n),style:{textAlign:"center"},placeholder:"Check digit"},null,8,["readonly","maxlength","class","modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e.showKeyboard?(y(),A(r,{key:0,onKeyPress:e.onKeyPress,kbConfig:e.activeKeyboard},null,8,["onKeyPress","kbConfig"])):O("",!0)],64)}const ee=P(J,[["render",S],["__scopeId","data-v-8f7eef67"]]);export{ee as default};
