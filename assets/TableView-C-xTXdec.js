import{d as Z,Q as J,U as K,aZ as W,a0 as X,R as x,O as ee,a3 as te,a4 as ne,S as se,cL as oe,ap as ae,r as Y,ar as S,aI as le,cQ as re,cR as ce,cS as ue,cT as ie,cU as de,dL as he,b6 as me,al as I,bw as pe,aL as T,a8 as fe,ad as y,u as r,B as u,x as m,w as d,z as H,Y as p,G as $,a1 as c,v as O,E as f,C as b,b0 as V}from"./index-DLUr6P7m.js";import{b as _e,t as ye}from"./Export-CkPEf1jI.js";const be=Z({components:{IonToolbar:J,IonItem:K,IonIcon:W,IonLabel:X,IonTitle:x,IonHeader:ee,IonButton:te,IonFooter:ne,IonContent:se,IonButtons:oe},props:{title:{type:String,default:"Report"},subtitle:{type:String},columns:{type:Object,required:!0},columnData:{type:Array,default:()=>[]},onFinish:{type:Function},onRefresh:{type:Function},onConfigure:{type:Function},csvQuarter:{type:String},headers:{type:Array,default:()=>[]},order:{type:Array,default:()=>[]},csvSpacing:{type:Number},csvSubHeader:{type:Array,default:()=>[]}},setup(t){const D=ae(),U=Y([]),z=Y(""),A=Y("desc"),G=S(()=>t.columns.slice(0,2)),L=S(()=>{var e;const n=[];return(e=t.columnData[0])==null||e.forEach(s=>{const o=t.columns[1].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),R=S(()=>{var e;const n=[];return(e=t.columnData[1])==null||e.forEach(s=>{const o=t.columns[2].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),g=S(()=>{var e;const n=[];return(e=t.columnData[2])==null||e.forEach(s=>{const o=t.columns[3].map(a=>{let l="";try{T.isEmpty(s)?l="...":typeof a.value=="function"?l=a.value(s):l=s[a.ref]||""}catch(i){l="_ERROR_",console.error(i)}return{column:a,data:s,value:l,[a.ref||"nada"]:l}});n.push({row:o,data:s,searchIndex:[...o,o.map(a=>a.value).join(" ")]})}),n}),M=S(()=>{var e;const n=[];return(e=t.columnData[3])==null||e.forEach((s,o)=>{const a=t.columns[8+o].map(l=>{let i="";try{T.isEmpty(s)?i="...":typeof l.value=="function"?i=l.value(s):i=s[l.ref]||""}catch(_){i="_ERROR_",console.error(_)}return{column:l,data:s,value:i,[l.ref||"nada"]:i}});n.push({row:a,data:s,searchIndex:[...a,a.map(l=>l.value).join(" ")]})}),n}),F=n=>{z.value=n,A.value=A.value==="asc"?"desc":"asc"},B=()=>{typeof t.onFinish=="function"?t.onFinish():D.push("/")},j=n=>{var e,s;try{typeof((e=n.column)==null?void 0:e.tdClick)=="function"&&((s=n.column)==null||s.tdClick(n));return}catch(o){console.error(o)}},N=()=>t.columns.reduce((n,e)=>n.concat(e),[]).filter(n=>n.value||n.ref),P=()=>{var e;const n=(e=window==null?void 0:window.document)==null?void 0:e.getElementById("report-content");_e("\n                <html>\n                    <head> \n                        <style> \n                        table {\n                            border-collapse: collapse;\n                        }\n                        th, td {\n                            width: 4%;\n                            text-align: center;\n                            border: solid 1px black;\n                        }\n                        td {\n                            border-bottom: 1px solid rgb(165, 165, 165);\n                            padding: 0.6em;\n                            font-weight: 500;\n                            font-size: .8em;\n                        }\n                        </style>    \n                    </head>\n                <body> \n                 ".concat(n.innerHTML,"    \n                </body>\n                </html>\n            "))},Q=()=>{const n=_=>_.map(k=>k.map(v=>t.order.map(w=>{const C=v[w];return Array.isArray(C)?C.length:C}).filter(w=>w!==void 0)).filter(v=>v.length>0)).filter(k=>k.length>0),e=_=>_.map(E=>{const[k]=Object.keys(E),v=E[k],w=Array.isArray(v)?v.length:0,C=[k,w];for(let q=0;q<5;q++)C.push("");return C}),s=n(t.columnData),o=e(t.columnData[3]),a=s.flat();o.forEach(_=>{a.push(_)});const l="".concat(I.getLocationName()||"Unknown site","-").concat(t.title,"-").concat(t.subtitle,"-").concat(I.getSessionDate()),i=()=>{const _=[...a],E=[0,9,18,27],k=t.csvSubHeader.length;return E.forEach((v,w)=>{const C=t.csvSubHeader[w%k];_.splice(v,0,[...C])}),_};ye([t.headers],[...i(),["Date Created: ".concat(pe().format("DD/MMM/YYYY HH:MM:ss"))],["Quarter: ".concat(t.csvQuarter||t.subtitle)],["HIS-Core Version: ".concat(I.getCoreVersion())],["API Version: ".concat(I.getApiVersion())],["Site UUID: ".concat(I.getSiteUUID())],["Generated by: ".concat(I.getUserName())]],l)},h=n=>{n.forEach(e=>{const s=N().map(o=>{let a="";try{T.isEmpty(e)?a="...":typeof o.value=="function"?a=o.value(e):a=e[o.ref]||""}catch(l){a="_ERROR_",console.error(l)}return{column:o,data:e,value:a,[o.ref||"nada"]:a}});U.value.push({row:s,data:e,searchIndex:[...s,s.map(o=>o.value).join(" ")]})})};return le(()=>t.columnData,n=>{U.value=[],Array.isArray(n)&&h(n)},{immediate:!0,deep:!0}),{sortColumn:F,onClickTablecell:j,toPDF:P,toCSV:Q,finish:B,columnsMinusOne:G,sync:re,search:ce,close:ue,arrowUp:ie,arrowDown:de,document:he,calendar:me,sortOrder:A,sectionOne:L,sectionTwo:R,sectionThree:g,sectionTotals:M,columnSorted:z}}}),ke={key:0},ve={class:"his-sm-text"},Ce={id:"report-content"},ge={class:"art-report-theme"},we={class:"stick-report-header"},De=["colspan","rowspan","onClick"],Ie={colspan:7},Re={class:"his-sm-text"},Ee=["onClick"],Se={class:"his-sm-text"},Te={colspan:7},$e={class:"his-sm-text"},Ae=["onClick"],Fe={class:"his-sm-text"},He={colspan:7},Oe={class:"his-sm-text"},Ve=["onClick"],Ue={class:"his-sm-text"},ze={colspan:7},Le={class:"his-sm-text"},Me={colspan:"2"},Be={class:"his-sm-text"},je={colspan:"6"},Ne=["onClick"];function Pe(t,D,U,z,A,G){const L=y("ion-title"),R=y("ion-icon"),g=y("ion-button"),M=y("ion-buttons"),F=y("ion-toolbar"),B=y("ion-header"),j=y("ion-label"),N=y("ion-item"),P=y("ion-content"),Q=y("ion-footer");return r(),u(f,null,[m(B,null,{default:d(()=>[m(F,null,{default:d(()=>[m(L,{class:"his-md-text"},{default:d(()=>[H(p(t.title)+" ",1),t.subtitle?(r(),u("br",ke)):$("",!0),c("span",ve,p(t.subtitle),1)]),_:1}),m(M,{slot:"end"},{default:d(()=>[typeof t.onConfigure=="function"?(r(),O(g,{key:0,onClick:t.onConfigure},{default:d(()=>[m(R,{size:"large",icon:t.calendar},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0),typeof t.onRefresh=="function"?(r(),O(g,{key:1,onClick:t.onRefresh,color:"success",size:"large"},{default:d(()=>[m(R,{size:"large",icon:t.sync},null,8,["icon"])]),_:1},8,["onClick"])):$("",!0)]),_:1})]),_:1})]),_:1}),m(P,{"scroll-y":"","scroll-x":""},{default:d(()=>[c("div",Ce,[c("table",ge,[c("thead",we,[(r(!0),u(f,null,b(t.columnsMinusOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(f,null,b(h,(e,s)=>{var o,a;return r(),u("th",{key:s,colspan:((o=e==null?void 0:e.span)==null?void 0:o.thColspan)||1,rowspan:((a=e==null?void 0:e.span)==null?void 0:a.thRowspan)||1,onClick:l=>t.sortColumn(e.ref)},[m(N,{lines:"none"},{default:d(()=>[t.columnSorted&&t.columnSorted===e.ref?(r(),O(R,{key:0,icon:t.sortOrder==="asc"?t.arrowUp:t.arrowDown},null,8,["icon"])):$("",!0),n<t.columns.length-1?(r(),O(j,{key:1,class:"ion-text-center"},{default:d(()=>[c("b",null,p(e.label),1)]),_:2},1024)):$("",!0)]),_:2},1024)],8,De)}),128))]))),128))]),c("tbody",null,[c("tr",null,[c("td",Ie,[c("span",Re,p(t.columns[4][0].label),1)])]),(r(!0),u(f,null,b(t.sectionOne,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(f,null,b(h.row||[],(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("b",Se,p(e.value),1)],10,Ee)}),128))]))),128)),c("tr",null,[c("td",Te,[c("span",$e,p(t.columns[5][0].label),1)])]),(r(!0),u(f,null,b(t.sectionTwo,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(f,null,b(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",Fe,p(e.value),1)],10,Ae)}),128))]))),128)),c("tr",null,[c("td",He,[c("span",Oe,p(t.columns[6][0].label),1)])]),(r(!0),u(f,null,b(t.sectionThree,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(f,null,b(h.row,(e,s)=>{var o;return r(),u("td",{key:s,onClick:()=>t.onClickTablecell(e),class:V({"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick})},[c("span",Ue,p(e.value),1)],10,Ve)}),128))]))),128)),c("tr",null,[c("td",ze,[c("span",Le,p(t.columns[7][0].label),1)])]),(r(!0),u(f,null,b(t.sectionTotals,(h,n)=>(r(),u("tr",{key:n},[(r(!0),u(f,null,b(h.row,(e,s)=>{var o;return r(),u(f,{key:s},[c("td",Me,[c("span",Be,p(e.column.label),1)]),c("td",je,[c("span",{class:V(["his-sm-text",{"clickable-cell":(o=e==null?void 0:e.column)==null?void 0:o.tdClick}]),onClick:()=>t.onClickTablecell(e)},p(e.value),11,Ne)])],64)}),128))]))),128))])])])]),_:1}),m(Q,null,{default:d(()=>[m(F,{color:"dark"},{default:d(()=>[m(g,{onClick:D[0]||(D[0]=h=>t.toCSV()),size:"large"},{default:d(()=>[H(" CSV ")]),_:1}),m(g,{onClick:D[1]||(D[1]=h=>t.toPDF()),size:"large"},{default:d(()=>[H(" PDF ")]),_:1}),m(g,{onClick:t.finish,color:"success",size:"large",slot:"end"},{default:d(()=>[H(" Finish ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}const Ge=fe(be,[["render",Pe],["__scopeId","data-v-663672d2"]]);export{Ge as v};
