import{L as h}from"./Layout-CVFcxuWh.js";import{d as w,I as v,R as C,dM as P,N as y,ah as D,ae as u,bM as m,bO as R,bN as g,L as n,_ as S,r as f,o as L,c as _,w as c,b}from"./index-BFVcutZq.js";const E=w({components:{IonPage:v,ReportTable:C,ReportLayout:h},props:{params:{type:Object,required:!0}},setup(t){const e=P(t.params.title);function d(){e.setReportPeriod({isPeriodSelection:t.params.hasPeriodSelection||!1,isMonthlySelection:t.params.hasMonthlySelection||!1,minDate:t.params.minDate,maxDate:t.params.maxDate,prefix:t.params.prefix||"",initialSort:t.params.initialSort,generate:(s,r,i)=>{const o=t.params.data(s,r,i);return typeof t.params.period=="function"&&(e.reportData.period=t.params.period()),o}})}return y(()=>{D.isEmpty(e.reportData.data)&&(typeof t.params.prePopulate=="function"&&(e.reportData.prePopulateData=t.params.prePopulate()),d(),e.reportData.drillDownLabelPattern=t.params.drillDownLabelPattern,e.reportData.intermediateColumns=t.params.columns,e.reportData.other={activeColumns:[],activeRows:[]})}),u(()=>e.reportData.intermediateColumns,s=>{e.reportData.columns=[],s.forEach(r=>{const i=[];r.forEach(o=>{i.push(n.thTxt(o.label,{value:o.exportLabel?o.exportLabel(o.label):void 0,colspan:o.colSpan,exportable:typeof o.exportable=="boolean"?o.exportable:!0}))}),!D.isEmpty(i)&&e.reportData.columns.push(i)})},{deep:!0}),u(()=>e.reportData.data,s=>{e.reportData.rows=[],s.forEach(r=>{const i=[];e.reportData.intermediateColumns.forEach(o=>{o.forEach(a=>{let l={};const p=a.columnTypeConfig||{};if(typeof a.value=="function"){switch("".concat(a==null?void 0:a.columnType)){case"text":l=n.td(a.value(r),p);break;case"date":l=n.tdDate(a.value(r),p);break;case"drilldown":l=e.drill(a.drillDownLabelPattern?a.drillDownLabelPattern(a.label,r):e.reportData.drillDownLabelPattern?e.reportData.drillDownLabelPattern(a.label,r):a.label,a.value(r)||[]);break;case"customDrillDown":typeof a.drillParams=="function"?l=e.drillCustom(a.value(r),{...a.drillParams(r,e.reportData)},a.staticValue?a.staticValue(r):void 0):l=n.td("__MISSING_CUSTOM_DRILL_DOWN__");break;default:l=n.td(a.value(r),p);break}i.push(l)}})}),D.isEmpty(i)||e.reportData.rows.push(i)})},{deep:!0}),{configureReport:d,logo:t.params.logo,reportData:e.reportData,rows:e.rows,columns:e.columns,title:e.title,period:e.period,dateGenerated:e.dateGenerated,refresh:e.updateReportData,toPDF:()=>{const{columns:s,rows:r}=m(e.reportData.other.activeColumns,e.reportData.other.activeRows);R(s,r,e.reportDescription())},toCSV:()=>{const{columns:s,rows:r}=m(e.reportData.other.activeColumns,e.reportData.other.activeRows);g(s,e.appendReportStamp(r),e.reportDescription())}}}});function T(t,e,d,s,r,i){const o=f("report-table"),a=f("report-layout"),l=f("ion-page");return L(),_(l,null,{default:c(()=>[b(a,{logo:t.logo,title:t.title,period:t.period,toCSV:t.toCSV,toPDF:t.toPDF,dateGenerated:t.dateGenerated,refreshReport:t.refresh,configure:t.configureReport},{default:c(()=>[b(o,{rows:t.rows,columns:t.columns,config:{tableCssTheme:"art-report-theme"},onOnActiveColumns:e[0]||(e[0]=p=>t.reportData.other.activeColumns=p),onOnActiveRows:e[1]||(e[1]=p=>t.reportData.other.activeRows=p)},null,8,["rows","columns"])]),_:1},8,["logo","title","period","toCSV","toPDF","dateGenerated","refreshReport","configure"])]),_:1})}const V=S(E,[["render",T]]);export{V as H};
