System.register(["./tb_report_service-legacy-DRpzHBM9.js","./ReportMixin.vue_vue_type_script_lang-legacy-BbENRnLs.js","./TableReportTemplate-legacy-CNaIiBQW.js","./index-legacy-DR3-kJVE.js","./BasicReportTemplate-legacy-Cw6SekeY.js","./Export-legacy-CgjR0K1_.js","./index-legacy-DsW4Gcwl.js","./Pagination-legacy-BCnktxxx.js","./HisStandardForm-legacy-utPdp3kG.js","./ReportErrors-legacy-BqxfQ3m5.js"],(function(t,e){"use strict";var a,o,s,n,r,l,i,u,d,m,T,c,h,p,_,R;return{setters:[t=>{a=t.T},t=>{o=t._},t=>{s=t.R},t=>{n=t.d,r=t.I,l=t.ar,i=t.aP,u=t.aN,d=t.am,m=t.H,T=t.aa,c=t.c,h=t.w,p=t.af,_=t.a,R=t.b},null,null,null,null,null,null],execute:function(){var e=(t=>(t.WITHOUT_PROGRAM="WITHOUT PROGRAM",t.WITHOUT_TB_NUMBER="WITHOUT TB NUMBER",t.BAD_TB_NUMBER="BAD TB NUMBER",t.IN_TREATMENT_BUT_COMPLETED="IN TREATMENT BUT COMPLETED",t.WITH_DISPENSATION_ANOMALIES="WITH DISPENSATION ANOMALIES",t.WITH_UNKNOWN_OUTCOME="WITH UNKNOWN OUTCOME",t.WITH_DUPLICATE_TB_NUMBER="WITH DUPLICATE TB NUMBER",t))(e||{});class N extends a{constructor(){super()}getDataToolReport(t){return a.getJson("tb_data_cleaning_tools",this.buildRequestParams({context:t}))}}const I=n({mixins:[o],components:{ReportTemplate:s,IonPage:r},data:()=>({title:"Data cleaning report",rows:[],columns:[[l.thTxt("National ID"),l.thTxt("TB Number"),l.thTxt("Name"),l.thTxt("Gender"),l.thTxt("Birthdate"),l.thTxt("Residence"),l.thTxt("State")]],defaultIndicator:{}}),created(){this.fields=[...i({id:"start_date",helpText:"Start",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}}),...i({id:"end_date",helpText:"End",required:!0,minDate:()=>"2000-01-01",maxDate:()=>d.getSessionDate(),computeValue:t=>t,estimation:{allowUnknown:!1}})],this.defaultIndicator=u.find(this.getIndicatorOptions(),{label:this.$route.query.case})||null},methods:{async onPeriod(t,e){const a=t=>m.toStandardHisDisplayFormat(t);this.rows=[];const o=this.defaultIndicator;this.title=o.label,this.columns=o.other.columns,this.report=new N,this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=`${a(e.start_date)} - ${a(e.end_date)}`;const s=await this.report.getDataToolReport(o.value);console.log(o,s),u.isNull(s)||(this.rows=await Promise.all(s.map((t=>o.other.formatRow(t)))))},mapRow(t){return[l.td(t.identifier||"N/A"),l.td(t.tb_number||"N/A"),l.tdLink(t.name,(()=>this.$router.push({path:`/patient/dashboard/${t.patient_id}`}))),l.td(t.gender||"N/A"),l.td(t.birthdate||"N/A"),l.td(t.residence||"N/A"),l.td(t.state||"N/A")]},getIndicatorOptions(){return[{label:"without program",value:e.WITHOUT_PROGRAM,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with duplicate tb number",value:e.WITH_DUPLICATE_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with unknown outcome",value:e.WITH_UNKNOWN_OUTCOME,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"with dispensation anomalies",value:e.WITH_DISPENSATION_ANOMALIES,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"in treatment but completed",value:e.IN_TREATMENT_BUT_COMPLETED,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"bad tb number",value:e.BAD_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}},{label:"without tb number",value:e.WITHOUT_TB_NUMBER,other:{columns:this.columns,formatRow:t=>this.mapRow(t)}}]}}});t("default",T(I,[["render",function(t,e,a,o,s,n){const r=p("report-template"),l=p("ion-page");return _(),c(l,null,{default:h((()=>[R(r,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,showFilters:!0,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])])),_:1})}]]))}}}));
