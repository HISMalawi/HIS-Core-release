var c=Object.defineProperty;var l=(e,r,t)=>r in e?c(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var a=(e,r,t)=>(l(e,typeof r!="symbol"?r+"":r,t),t);import{_ as m}from"./ReportMixin.vue_vue_type_script_lang-DMKkoObU.js";import{R as u}from"./TableReportTemplate-B5j2Kf7g.js";import{bD as f,d as g,I as R,L as i,_,r as p,o as D,c as w,w as T,b}from"./index-DTBWhHAq.js";import"./MultiFieldDateHelper-BWKgkEkB.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BasicReportTemplate-C7PO5ffp.js";import"./Export-CLFPyxXu.js";import"./SIngleTouchField-0q-gpRlN.js";import"./Pagination-BGJRx45Q.js";import"./HisStandardForm-lonwENLb.js";import"./TouchScreenForm-BeJsJnwt.js";import"./ToolbarMediumCard-wr9sTFDK.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-DbAo6hHM.js";import"./ReportErrors-B2p-LfpE.js";class k extends f{constructor(){super();a(this,"regenerate");a(this,"data");a(this,"clients");this.clients=[],this.data=[],this.regenerate=!1}setRegenerate(t){this.regenerate=t}async generateReport(){this.data=[],this.clients=[];const t=await this.getReport("latest_regimen_dispensed",this.buildRequest({rebuild_outcome:this.regenerate}));if(!t)return[];for(const o in t){for(const n in t[o]){const s=t[o][n];this.data.push({identifier:s.identifier,drugName:s.name,gender:s.gender,dob:s.birthdate,dispensationDate:s.dispensation_date,packSize:s.pack_sizes[0],packSizes:s.pack_sizes.length,quantity:s.quantity})}this.clients.push(parseInt("".concat(o)))}return this.data}}const S=g({mixins:[m],components:{ReportTemplate:u,IonPage:R},data:()=>({title:"Regimen Report",rows:[],headerList:[],columns:[[i.thTxt("ARV#"),i.thTxt("Gender"),i.thTxt("DOB"),i.thTxt("Drug Name"),i.thTxt("Date"),i.thTxt("Pack size"),i.thTxt("Total pack"),i.thTxt("Total pills")]]}),created(){this.fields=this.getDateDurationFields()},methods:{async onPeriod(e,r,t=!1){this.rows=[],this.report=new k,this.report.setOccupation(r.occupation),this.report.setRegenerate(t),this.report.setStartDate(r.start_date),this.report.setEndDate(r.end_date),this.period=this.report.getDateIntervalPeriod();const o=await this.report.generateReport();this.setRows(o),this.headerList=[{label:"Total clients",value:this.report.clients.length}]},setRows(e){const r=t=>t?i.tdDate(t):i.td("N/A");this.rows=this.sortByArvNumber(e,"identifier").map(t=>[this.tdARV(t.identifier),i.td(this.formatGender(t.gender)),r(t.dob),i.td(t.drugName),r(t.dispensationDate),i.td(t.packSize),i.td(t.packSizes),i.td(t.quantity)])}}});function x(e,r,t,o,n,s){const d=p("report-template"),h=p("ion-page");return D(),w(h,null,{default:T(()=>[b(d,{reportPrefix:"MoH",title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,hasServerSideCaching:!0,headerInfoList:e.headerList,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","headerInfoList","onReportConfiguration"])]),_:1})}const H=_(S,[["render",x]]);export{H as default};
