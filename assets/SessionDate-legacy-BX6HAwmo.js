System.register(["./index-legacy-CA6M7ipO.js","./HisStandardForm-legacy-a9YJRGaH.js"],(function(e,t){"use strict";var a,s,i,o,r,n,d,c,l,u,h,D,m,f,y,p;return{setters:[e=>{a=e.d,s=e.ao,i=e.aV,o=e.ad,r=e.ae,n=e.H,d=e.aW,c=e.aw,l=e.R,u=e.W,h=e.ak,D=e.aa,m=e.c,f=e.af,y=e.a},e=>{p=e.H}],execute:function(){const t=a({components:{HisStandardForm:p},data:()=>({apiDate:"",fields:[]}),async created(){this.apiDate=await s.getApiDate(),this.fields=i({id:"session_date",helpText:"Session Date",required:!0,minDate:()=>"2000-01-01",maxDate:()=>this.apiDate,estimation:{allowUnknown:!1},computeValue:e=>e,config:{footerBtns:[{name:"Reset",slot:"end",color:"success",state:{visible:{default:()=>s.isBDE()}},onClick:async()=>{await this.resetSessionDate()}}]}}),this.fields=[...this.fields,{id:"reason_for_bde",helpText:"Please select a reason for changing session date",type:o.TT_SELECT,validation:e=>r.required(e),computedValue:e=>e.value,options:()=>[{label:"Backlog clearance",value:"Backlog clearance"},{label:"System was down",value:"System was down"},{label:"Data error correction",value:"Data error correction"}]}]},async mounted(){await this.showBdeNotice()},methods:{async showBdeNotice(){if(!s.isBDE())return;const e=n.toStandardHisDisplayFormat(s.getCachedApiDate()||""),t=n.toStandardHisDisplayFormat(s.getSessionDate()),a=await d("BDE Notice",`The system is currently in Back Data Entry Mode(BDE).                 Do you wish to reset the date to ${e}?`,`BDE Date: ${t}`,[{name:"Reset Date",slot:"start",color:"success"},{name:"Keep BDE Date",slot:"end",color:"danger"},{name:"New date",slot:"end"}]);if("Reset Date"===a)return await this.resetSessionDate();"Keep BDE Date"===a&&this.redirect()},async resetSessionDate(){try{await s.resetSessionDate(),c.invalidate("PROVIDERS"),l(`Session date has been reset to ${this.formatDate(this.apiDate)}`),this.redirect()}catch(e){u(`${e}`)}},redirect(){const e=this.$route.query.patient_dashboard_redirection_id;e?this.$router.push(`/patient/dashboard/${e}`):this.$router.back()},async onSubmit(e,t){const a=t.session_date;try{await s.setSessionDate(a,t.reason_for_bde),l(`Successfully Back dated to ${this.formatDate(a)}`);const e=this.$route?.query?.patient_id;e?h(e,this.$router):this.redirect()}catch(i){u(`${i}`)}},formatDate:e=>n.toStandardHisDisplayFormat(e)}});e("default",D(t,[["render",function(e,t,a,s,i,o){const r=f("his-standard-form");return y(),m(r,{skipSummary:!0,fields:e.fields,onOnFinish:e.onSubmit},null,8,["fields","onOnFinish"])}]]))}}}));
