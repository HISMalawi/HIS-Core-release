import{d as w,dn as b,r as h,t as R,u as F,v as M,w as P,x as S,y as g,d1 as I,a5 as k,aP as G,O as A,dC as O}from"./index-ii3Qn3XY.js";import{v as y}from"./TableView-VVZCLID7.js";import{w as B,s as T}from"./v2utils-E9_vWRTr.js";import"./Export-K1a5kYdx.js";import"./index--iKDbRto.js";const W=w({__name:"ClinicRetentionReport",setup(U){const f=G("reports.png"),a=new b,s=h([]),l=h(""),i=(t,o)=>({label:t,ref:o,toValue:e=>e.length,tdClick:e=>T({title:"".concat(e.column.label),subtitle:l.value,patientIdentifiers:e.refData.map(n=>n.patient_id)})}),C=[[{label:"Age group",ref:"age_group"},{label:"Gender",ref:"gender"},i("Initiated one month","initiated_one_month"),i("Completed one month","completed_one_month"),i("Initiated Three months","initiated_three_months"),i("Completed Three months","completed_three_months"),i("Initiated Six months","initiated_six_months"),i("Completed Six months","completed_six_months")]],m=()=>B(async()=>{var e;if(!(a.startDate&&a.endDate))return A("Start date and end date required!");s.value=[];const t=(e=await a.getClientRentention())!=null?e:{},o=[...O,"Unknown"].reduce((n,d)=>{const u=D=>{const r=(v,x)=>{var p;return(((p=t==null?void 0:t[v])==null?void 0:p[x])||[]).filter(_=>_.age_group===d&&_.gender===D)};return{initiated_one_month:r("1","all"),completed_one_month:r("1","retained"),initiated_three_months:r("3","all"),completed_three_months:r("3","retained"),initiated_six_months:r("6","all"),completed_six_months:r("6","retained")}};return n.M.push({age_group:d,gender:"Male",...u("M")}),n.F.push({age_group:d,gender:"Female",...u("F")}),n},{M:[],F:[]});s.value=[...o.F,...o.M]}),c=()=>I({onFinish:(t,o,e,n)=>{n&&a.setOccupation(n),a.startDate=t,a.endDate=o,l.value="".concat(e),m()}});return R(()=>!s.value.length&&c()),(t,o)=>(F(),M(g(k),null,{default:P(()=>[S(y,{"icon-url":g(f),title:"Clinic Retention report","report-prefix":"Clinic",subtitle:l.value,columns:C,columnData:s.value,rowsPerPage:100,onConfigure:c,onRefresh:m},null,8,["icon-url","subtitle","columnData"])]),_:1}))}});export{W as default};
