var u=Object.defineProperty;var d=(e,t,i)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var r=(e,t,i)=>(d(e,typeof t!="symbol"?t+"":t,i),i);import{_ as p}from"./EncounterMixin.vue_vue_type_script_lang-CTi-0KTN.js";import{F as n}from"./dynamic-import-helper-Bsjrd6Ro.js";import{b5 as o,ab as h,d as v,I as b,V as s,_,r as l,o as f,c as V,w as T,b as N}from"./index-DxdybAew.js";import"./encounter_guidelines-C9OjyTHu.js";import"./GuidelineEngine-D6V1_Znr.js";import"./HisStandardForm-tUhdyeHF.js";import"./TouchScreenForm-CWGDOcQm.js";import"./ToolbarMediumCard-DpQmY2Av.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-Bxq2iSVB.js";class x extends o{constructor(i,a){super(i,107,a);r(this,"lastVisitNumber");this.lastVisitNumber=0}async loadLastVisitNumber(){const i=await o.getJson("programs/".concat(this.programID,"/patients/").concat(this.patientID,"/anc_visit"));!h.isEmpty(i)&&i.visit_number.length&&(this.lastVisitNumber=i.visit_number[i.visit_number.length-1])}}const y=v({components:{IonPage:b},mixins:[p],data:()=>({service:{},helpText:"ANC Visit Number"}),watch:{ready:{async handler(e){e&&(this.service=new x(this.patientID,this.providerID),await this.service.loadLastVisitNumber(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,t){await this.service.createEncounter();const i=await this.resolveObs(t);await this.service.saveObservationList(i),this.nextTask()},getFields(){return[{id:"visit_number",helpText:this.helpText,dynamicHelpText:()=>this.service.lastVisitNumber?"".concat(this.helpText," (Last visit number: ").concat(this.service.lastVisitNumber,")"):this.helpText,defaultValue:()=>this.service.lastVisitNumber+1,type:n.TT_NUMBER,computedValue:e=>({obs:[this.service.buildValueNumber("Type of visit",e.value),this.service.buildValueCoded("Has extended ANC visits",e.value>8?"Yes":"No")]}),validation:e=>this.validateSeries([()=>s.required(e),()=>s.rangeOf(e,this.service.lastVisitNumber+1,15)])},{id:"reasons",helpText:"Provide reason for having more than 8 visits",type:n.TT_TEXT,computedValue:e=>({obs:this.service.buildValueText("Reason for extended ANC visits",e.value)}),condition:e=>e.visit_number.value>8,validation:e=>s.required(e)}]}}});function g(e,t,i,a,w,$){const c=l("his-standard-form"),m=l("ion-page");return f(),V(m,null,{default:T(()=>[N(c,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])]),_:1})}const O=_(y,[["render",g]]);export{O as default};
