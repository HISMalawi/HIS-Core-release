System.register(["./ViewPort-legacy-BdWinx1S.js","./HisKeyboard-legacy-f-J1EiOZ.js","./KbLayouts-legacy-BKvPSxzZ.js","./KbHandler-legacy-De8o5nTq.js","./index-legacy-rttSvejT.js","./HisKbConfigurations-legacy-vrLd9Pgz.js","./BaseKeyboard-legacy-CJP1DHRk.js"],(function(t,e){"use strict";var i,n,a,l,u,s,r,c,o,d,p,h,m,g,y,b,f,C,v,k,A,_,I,S,B,P,F,w,D,R,V,x,H,j;return{setters:[t=>{i=t.V},t=>{n=t.H},t=>{a=t.C},t=>{l=t.k},t=>{u=t.d,s=t._,r=t.o,c=t.x,o=t.A,d=t.u,p=t.v,h=t.ar,m=t.I,g=t.bb,y=t.f,b=t.l,f=t.aj,C=t.ak,v=t.m,k=t.j,A=t.k,_=t.ab,I=t.n,S=t.P,B=t.ba,P=t.aO,F=t.q,w=t.r,D=t.c,R=t.w,V=t.b,x=t.y,H=t.F,j=t.z},null,null],execute:function(){var e=document.createElement("style");e.textContent=".his-card[data-v-aae064fb]{padding:0;margin:3%}li[data-v-aae064fb]{padding:0;margin:0;list-style:none}.input-focused[data-v-d455bfc1]{color:#3880ff;border-bottom:3px solid #3880ff}.result-section[data-v-d455bfc1]{overflow-y:auto;height:70vh}\n",document.head.appendChild(e);const N=u({props:{patient:{type:Object,required:!0},isActive:{type:Boolean}},computed:{stateClass(){return{"active-card-color":this.isActive,"inactive-card-color":!this.isActive}}}}),K=u({components:{PatientCard:s(N,[["render",function(t,e,i,n,a,l){return r(),c("div",{class:h(["his-card clickable",t.stateClass])},[o("li",null,[o("ul",null,[d(" NPID : "),o("b",null,p(t.patient.npid),1)]),o("ul",null,[d(" Arv# : "),o("b",null,p(t.patient.arvNum),1)]),o("ul",null,[d(" Name : "),o("b",null,p(t.patient.name),1)]),o("ul",null,[d(" Birth date : "),o("b",null,p(t.patient.birthdate),1)]),o("ul",null,[d(" Gender : "),o("b",null,p(t.patient.gender),1)]),o("ul",null,[d(" Home District : "),o("b",null,p(t.patient.homeDistrict),1)]),o("ul",null,[d(" Home Village : "),o("b",null,p(t.patient.homeVillage),1)]),o("ul",null,[d(" Current District : "),o("b",null,p(t.patient.currentDistrict),1)]),o("ul",null,[d(" Current Village : "),o("b",null,p(t.patient.currentVillage),1)])])],2)}],["__scopeId","data-v-aae064fb"]]),IonPage:m,IonInput:g,IonButton:y,IonContent:b,IonRow:f,IonCol:C,IonFooter:v,IonHeader:k,ViewPort:i,HisKeyboard:n,IonTitle:A},data:()=>({inputA:"",inputB:"",isSubmitting:!1,inputFocus:"inputA",inputASearchResults:[],inputBSearchResults:[],activeInputACard:{},keyboard:[a,[["","Hide"],["Space","Delete"],["inputA","inputB"],["Search","Clear"]]]}),computed:{canMerge(){return!_.isEmpty(this.activeInputACard)&&!_.isEmpty(this.inputBSearchResults.filter((t=>t.isChecked)))}},methods:{async onMerge(){if(await I("Are you sure you want to merge selected Persons?")){try{this.isSubmitting=!0;const t=await S.mergePatients({primary:{patient_id:this.activeInputACard.id,doc_id:this.activeInputACard.docID},secondary:this.inputBSearchResults.filter((t=>t.isChecked)).map((t=>({patient_id:t.id,doc_id:t.docID})))});await new B(t.patient_id).printNidLbl(),this.inputBSearchResults=this.inputBSearchResults.filter((t=>!t.isChecked));const e=await P.getNextTaskParams(t.patient_id);this.$router.push(e.name?e:`/patient/dashboard/${t.patient_id}`)}catch(t){F(`${t}`)}this.isSubmitting=!1}},onPrimaryPatient(t){this.inputBSearchResults.forEach((e=>{e.id===t.id&&(this.inputBSearchResults[e.index].isChecked=!1)})),this.activeInputACard=t},onSecondaryPatient(t){if(t.isChecked)return this.inputBSearchResults[t.index].isChecked=!1;_.isEmpty(this.activeInputACard)||t.id==this.activeInputACard.id||(this.inputBSearchResults[t.index].isChecked=!0)},async searchPatient(t){const[e,i]=t.split(" ");return(await S.search({given_name:e,family_name:i})).map(((t,e)=>{const i=new S(t);return{index:e,id:i.getID(),name:i.getFullName(),docID:i.getDocID(),birthdate:i.getBirthdate(),arvNum:i.getArvNumber(),npid:i.getNationalID(),gender:i.getGender(),homeDistrict:i.getHomeDistrict(),homeVillage:i.getHomeVillage(),currentDistrict:i.getCurrentDistrict(),currentVillage:i.getCurrentVillage(),isChecked:!1}}))},async keypress(t){if(!this.inputFocus)return;let e=l(t,this[this.inputFocus]);e.match(/hide/i)?this.inputFocus="":e.match(/search/i)?(e=e.replace("Search",""),"inputA"===this.inputFocus?(this.inputASearchResults=await this.searchPatient(e),this.activeInputACard={}):this.inputBSearchResults=await this.searchPatient(e),this.inputFocus=""):e.match(/inputA/i)?this.inputFocus="inputA":e.match(/inputB/i)?this.inputFocus="inputB":e.match(/clear/i)?(this[this.inputFocus]="","inputA"===this.inputFocus?this.inputASearchResults=[]:this.inputBSearchResults=[]):this[this.inputFocus]=e}}}),M={class:"result-section"},E={class:"result-section"};t("default",s(K,[["render",function(t,e,i,n,a,l){const u=w("ion-title"),s=w("ion-toolbar"),p=w("ion-header"),m=w("ion-input"),g=w("ion-col"),y=w("ion-row"),b=w("patient-card"),f=w("view-port"),C=w("his-keyboard"),v=w("ion-content"),k=w("ion-button"),A=w("ion-footer"),_=w("ion-page");return r(),D(_,null,{default:R((()=>[V(p,null,{default:R((()=>[V(s,null,{default:R((()=>[V(u,{class:"his-lg-text"},{default:R((()=>[d("Merge Clients")])),_:1})])),_:1})])),_:1}),V(v,null,{default:R((()=>[V(f,null,{default:R((()=>[V(y,null,{default:R((()=>[V(g,null,{default:R((()=>[V(m,{onClick:e[0]||(e[0]=e=>t.inputFocus="inputA"),placeholder:"Primary patient",class:h(["input_display",{"input-focused":"inputA"===t.inputFocus}]),modelValue:t.inputA,"onUpdate:modelValue":e[1]||(e[1]=e=>t.inputA=e)},null,8,["modelValue","class"])])),_:1}),V(g,null,{default:R((()=>[V(m,{onClick:e[2]||(e[2]=e=>t.inputFocus="inputB"),class:h(["input_display",{"input-focused":"inputB"===t.inputFocus}]),placeholder:"Secondary patient",modelValue:t.inputB,"onUpdate:modelValue":e[3]||(e[3]=e=>t.inputB=e)},null,8,["modelValue","class"])])),_:1})])),_:1}),V(y,null,{default:R((()=>[V(g,null,{default:R((()=>[o("div",M,[(r(!0),c(H,null,x(t.inputASearchResults,((e,i)=>(r(),D(b,{onClick:i=>t.onPrimaryPatient(e),key:i,patient:e,isActive:t.activeInputACard.index===i},null,8,["onClick","patient","isActive"])))),128))])])),_:1}),V(g,null,{default:R((()=>[o("div",E,[(r(!0),c(H,null,x(t.inputBSearchResults,((e,i)=>(r(),D(b,{onClick:i=>t.onSecondaryPatient(e),key:i,patient:e,isActive:e.isChecked},null,8,["onClick","patient","isActive"])))),128))])])),_:1})])),_:1})])),_:1}),t.inputFocus?(r(),D(C,{key:0,kbConfig:t.keyboard,onKeyPress:t.keypress},null,8,["kbConfig","onKeyPress"])):j("",!0)])),_:1}),V(A,null,{default:R((()=>[V(s,{color:"dark"},{default:R((()=>[V(k,{color:"danger",size:"large","router-link":"/"},{default:R((()=>[d(" Cancel ")])),_:1}),t.canMerge?(r(),D(k,{key:0,disabled:t.isSubmitting,color:"success",size:"large",slot:"end",onClick:t.onMerge},{default:R((()=>[d(" Merge ")])),_:1},8,["disabled","onClick"])):j("",!0)])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-d455bfc1"]]))}}}));
