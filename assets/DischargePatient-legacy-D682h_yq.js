System.register(["./HisStandardForm-legacy-CGi-zolz.js","./index-legacy-pSEoxn3J.js","./commons-legacy-B7dPhjdd.js","./useEncounter-legacy-D27v7I9F.js","./isEmpty-legacy-De9HmsH6.js","./encounter_guidelines-legacy-mYSO8ZN5.js","./GuidelineEngine-legacy-KsvQuFdF.js"],(function(e,t){"use strict";var a,i,n,l,o,r,s,c,u,d,f,m,y,g,b,h,p,v,w,T;return{setters:[e=>{a=e.H},e=>{i=e.bW,n=e.d,l=e.r,o=e.an,r=e.ao,s=e.c3,c=e.aC,u=e.q,d=e.aw,f=e.y,m=e.a,y=e.w,g=e.e,b=e.f,h=e.m,p=e.b,v=e.a_},e=>{w=e.r},e=>{T=e.u},null,null,null],execute:function(){class t extends i{constructor(e,t){super(e,114,t)}}class D extends i{constructor(e,t){super(e,40,t)}}e("default",n({__name:"DischargePatient",setup(e){let i,n;const S=l([]),{goToNextTask:_,patientDashboardUrl:E}=T(((e,a)=>{n=new D(a,e),i=new t(a,e),S.value=[{id:"outcome_status",helpText:"Select Discharge Outcome",type:r.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"outcome",obs:n.buildValueCoded("outcome",e.value)}),options:()=>[{label:"Referred (Within the Facility)",value:"Patient transferred internally"},{label:"Dead",value:"Died in treatment"},{label:"Abscorded",value:"Absconded"},{label:"Alive (Discharged home)",value:"Discharged home"},{label:"Transferred (Another health facility)",value:"Discharged to another facility"}]},{id:"facility_name",helpText:"Select Facility name",type:r.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"referral",obs:i.buildValueText("Referred",e.label)}),condition:e=>"Discharged to another facility"===e.outcome_status.value,options:(e,t="")=>s(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"internal_sections",helpText:"Select Ward/internal section",type:r.TT_SELECT,validation:e=>o.required(e),computedValue:e=>({tag:"referral",obs:i.buildValueText("Specialist clinic",e.label)}),condition:e=>"Patient transferred internally"===e.outcome_status.value,options:()=>c.getInternalSections(),config:{showKeyboard:!0,footerBtns:[{name:"Add Section",slot:"end",color:"success",onClick:async(e,t,a)=>{if("string"!=typeof a.filter||a.filter.length<3)return u("Please enter a valid section name");if(a.filtered.some((e=>e.label.toLowerCase()===a.filter.toLowerCase())))return u("Section already existing");if(await d("Do you want to add internal section?")){const e=await c.createInternalSection(a.filter.toUpperCase());e?(a.filter=e.name,a.listData=[{label:e.name,value:e.id},...a.listData]):f(`Unable to add ${a.filter}`)}}}]}}]}));async function x(e,t){await n.createEncounter();const a=await w({...t},"outcome");await n.saveObservationList(a);const l=await w({...t},"referral");v.isEmpty(l)||(await i.createEncounter(),await i.saveObservationList(l)),_()}return(e,t)=>(p(),m(b(h),null,{default:y((()=>[g(a,{cancelDestinationPath:b(E),fields:S.value,onFinishAction:x,skipSummary:""},null,8,["cancelDestinationPath","fields"])])),_:1}))}}))}}}));
