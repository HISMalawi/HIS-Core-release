import{bE as br,E as Nr,cs as J,K as I,J as Gr,N as Br,T as R,p as Kr,aO as w}from"./index-BbPYANJn.js";import{i as B,a as m,b as Ar,c as hr,d as mr,_ as Ur,e as S,f as qr,g as Hr,h as zr,j as Xr}from"./isEmpty-B0Gb01o4.js";import{c as K,d as Yr,b as Zr,e as Jr,i as U,a as Qr}from"./_Set-C-WgNGgu.js";import{d as Tr,e as q,b as Wr,c as kr,f as Er,a as Vr,_ as jr}from"./_setToArray-f-WIqQF1.js";import{E as re,F as E}from"./encounter_guidelines-pgsAF1SZ.js";import{m as ee}from"./GuidelineEngine-D6V1_Znr.js";function ne(r,e){for(var n=-1,a=e.length,t=r.length;++n<a;)r[t+n]=e[n];return r}var Or=ne,Q=K,ae=B,te=m,W=Q?Q.isConcatSpreadable:void 0;function ie(r){return te(r)||ae(r)||!!(W&&r&&r[W])}var se=ie,ue=Or,fe=se;function Sr(r,e,n,a,t){var i=-1,s=r.length;for(n||(n=fe),t||(t=[]);++i<s;){var u=r[i];e>0&&n(u)?e>1?Sr(u,e-1,n,a,t):ue(t,u):a||(t[t.length]=u)}return t}var oe=Sr;function ve(r,e){for(var n=-1,a=r==null?0:r.length,t=Array(a);++n<a;)t[n]=e(r[n],n,r);return t}var Pr=ve,ce=Yr,_e=Ar,le="[object Symbol]";function pe(r){return typeof r=="symbol"||_e(r)&&ce(r)==le}var P=pe,ye=m,$e=P,ge=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,de=/^\w*$/;function be(r,e){if(ye(r))return!1;var n=typeof r;return n=="number"||n=="symbol"||n=="boolean"||r==null||$e(r)?!0:de.test(r)||!ge.test(r)||e!=null&&r in Object(e)}var H=be,Ir=Tr,Ae="Expected a function";function z(r,e){if(typeof r!="function"||e!=null&&typeof e!="function")throw new TypeError(Ae);var n=function(){var a=arguments,t=e?e.apply(this,a):a[0],i=n.cache;if(i.has(t))return i.get(t);var s=r.apply(this,a);return n.cache=i.set(t,s)||i,s};return n.cache=new(z.Cache||Ir),n}z.Cache=Ir;var he=z,me=he,Te=500;function Ee(r){var e=me(r,function(a){return n.size===Te&&n.clear(),a}),n=e.cache;return e}var Oe=Ee,Se=Oe,Pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ie=/\\(\\)?/g,we=Se(function(r){var e=[];return r.charCodeAt(0)===46&&e.push(""),r.replace(Pe,function(n,a,t,i){e.push(t?i.replace(Ie,"$1"):a||n)}),e}),Ce=we,k=K,Me=Pr,Le=m,xe=P,De=1/0,V=k?k.prototype:void 0,j=V?V.toString:void 0;function wr(r){if(typeof r=="string")return r;if(Le(r))return Me(r,wr)+"";if(xe(r))return j?j.call(r):"";var e=r+"";return e=="0"&&1/r==-De?"-0":e}var Re=wr,Fe=Re;function Ne(r){return r==null?"":Fe(r)}var Ge=Ne,Be=m,Ke=H,Ue=Ce,qe=Ge;function He(r,e){return Be(r)?r:Ke(r,e)?[r]:Ue(qe(r))}var Cr=He,ze=P,Xe=1/0;function Ye(r){if(typeof r=="string"||ze(r))return r;var e=r+"";return e=="0"&&1/r==-Xe?"-0":e}var M=Ye,Ze=Cr,Je=M;function Qe(r,e){e=Ze(e,r);for(var n=0,a=e.length;r!=null&&n<a;)r=r[Je(e[n++])];return n&&n==a?r:void 0}var X=Qe,We=q;function ke(){this.__data__=new We,this.size=0}var Ve=ke;function je(r){var e=this.__data__,n=e.delete(r);return this.size=e.size,n}var rn=je;function en(r){return this.__data__.get(r)}var nn=en;function an(r){return this.__data__.has(r)}var tn=an,sn=q,un=Zr,fn=Tr,on=200;function vn(r,e){var n=this.__data__;if(n instanceof sn){var a=n.__data__;if(!un||a.length<on-1)return a.push([r,e]),this.size=++n.size,this;n=this.__data__=new fn(a)}return n.set(r,e),this.size=n.size,this}var cn=vn,_n=q,ln=Ve,pn=rn,yn=nn,$n=tn,gn=cn;function O(r){var e=this.__data__=new _n(r);this.size=e.size}O.prototype.clear=ln;O.prototype.delete=pn;O.prototype.get=yn;O.prototype.has=$n;O.prototype.set=gn;var Mr=O;function dn(r,e){for(var n=-1,a=r==null?0:r.length;++n<a;)if(e(r[n],n,r))return!0;return!1}var bn=dn,An=Wr,hn=bn,mn=kr,Tn=1,En=2;function On(r,e,n,a,t,i){var s=n&Tn,u=r.length,f=e.length;if(u!=f&&!(s&&f>u))return!1;var o=i.get(r),y=i.get(e);if(o&&y)return o==e&&y==r;var p=-1,c=!0,d=n&En?new An:void 0;for(i.set(r,e),i.set(e,r);++p<u;){var g=r[p],v=e[p];if(a)var l=s?a(v,g,p,e,r,i):a(g,v,p,r,e,i);if(l!==void 0){if(l)continue;c=!1;break}if(d){if(!hn(e,function(_,$){if(!mn(d,$)&&(g===_||t(g,_,n,a,i)))return d.push($)})){c=!1;break}}else if(!(g===v||t(g,v,n,a,i))){c=!1;break}}return i.delete(r),i.delete(e),c}var Lr=On,Sn=Jr,Pn=Sn.Uint8Array,In=Pn;function wn(r){var e=-1,n=Array(r.size);return r.forEach(function(a,t){n[++e]=[t,a]}),n}var Cn=wn,rr=K,er=In,Mn=Er,Ln=Lr,xn=Cn,Dn=Vr,Rn=1,Fn=2,Nn="[object Boolean]",Gn="[object Date]",Bn="[object Error]",Kn="[object Map]",Un="[object Number]",qn="[object RegExp]",Hn="[object Set]",zn="[object String]",Xn="[object Symbol]",Yn="[object ArrayBuffer]",Zn="[object DataView]",nr=rr?rr.prototype:void 0,F=nr?nr.valueOf:void 0;function Jn(r,e,n,a,t,i,s){switch(n){case Zn:if(r.byteLength!=e.byteLength||r.byteOffset!=e.byteOffset)return!1;r=r.buffer,e=e.buffer;case Yn:return!(r.byteLength!=e.byteLength||!i(new er(r),new er(e)));case Nn:case Gn:case Un:return Mn(+r,+e);case Bn:return r.name==e.name&&r.message==e.message;case qn:case zn:return r==e+"";case Kn:var u=xn;case Hn:var f=a&Rn;if(u||(u=Dn),r.size!=e.size&&!f)return!1;var o=s.get(r);if(o)return o==e;a|=Fn,s.set(r,e);var y=Ln(u(r),u(e),a,t,i,s);return s.delete(r),y;case Xn:if(F)return F.call(r)==F.call(e)}return!1}var Qn=Jn,Wn=Or,kn=m;function Vn(r,e,n){var a=e(r);return kn(r)?a:Wn(a,n(r))}var jn=Vn;function ra(r,e){for(var n=-1,a=r==null?0:r.length,t=0,i=[];++n<a;){var s=r[n];e(s,n,r)&&(i[t++]=s)}return i}var ea=ra;function na(){return[]}var aa=na,ta=ea,ia=aa,sa=Object.prototype,ua=sa.propertyIsEnumerable,ar=Object.getOwnPropertySymbols,fa=ar?function(r){return r==null?[]:(r=Object(r),ta(ar(r),function(e){return ua.call(r,e)}))}:ia,oa=fa;function va(r,e){for(var n=-1,a=Array(r);++n<r;)a[n]=e(n);return a}var ca=va,_a=9007199254740991,la=/^(?:0|[1-9]\d*)$/;function pa(r,e){var n=typeof r;return e=e==null?_a:e,!!e&&(n=="number"||n!="symbol"&&la.test(r))&&r>-1&&r%1==0&&r<e}var Y=pa,ya=ca,$a=B,ga=m,da=hr,ba=Y,Aa=mr,ha=Object.prototype,ma=ha.hasOwnProperty;function Ta(r,e){var n=ga(r),a=!n&&$a(r),t=!n&&!a&&da(r),i=!n&&!a&&!t&&Aa(r),s=n||a||t||i,u=s?ya(r.length,String):[],f=u.length;for(var o in r)(e||ma.call(r,o))&&!(s&&(o=="length"||t&&(o=="offset"||o=="parent")||i&&(o=="buffer"||o=="byteLength"||o=="byteOffset")||ba(o,f)))&&u.push(o);return u}var Ea=Ta,Oa=Ea,Sa=Ur,Pa=S;function Ia(r){return Pa(r)?Oa(r):Sa(r)}var L=Ia,wa=jn,Ca=oa,Ma=L;function La(r){return wa(r,Ma,Ca)}var xa=La,tr=xa,Da=1,Ra=Object.prototype,Fa=Ra.hasOwnProperty;function Na(r,e,n,a,t,i){var s=n&Da,u=tr(r),f=u.length,o=tr(e),y=o.length;if(f!=y&&!s)return!1;for(var p=f;p--;){var c=u[p];if(!(s?c in e:Fa.call(e,c)))return!1}var d=i.get(r),g=i.get(e);if(d&&g)return d==e&&g==r;var v=!0;i.set(r,e),i.set(e,r);for(var l=s;++p<f;){c=u[p];var _=r[c],$=e[c];if(a)var A=s?a($,_,c,e,r,i):a(_,$,c,r,e,i);if(!(A===void 0?_===$||t(_,$,n,a,i):A)){v=!1;break}l||(l=c=="constructor")}if(v&&!l){var h=r.constructor,T=e.constructor;h!=T&&"constructor"in r&&"constructor"in e&&!(typeof h=="function"&&h instanceof h&&typeof T=="function"&&T instanceof T)&&(v=!1)}return i.delete(r),i.delete(e),v}var Ga=Na,N=Mr,Ba=Lr,Ka=Qn,Ua=Ga,ir=qr,sr=m,ur=hr,qa=mr,Ha=1,fr="[object Arguments]",or="[object Array]",C="[object Object]",za=Object.prototype,vr=za.hasOwnProperty;function Xa(r,e,n,a,t,i){var s=sr(r),u=sr(e),f=s?or:ir(r),o=u?or:ir(e);f=f==fr?C:f,o=o==fr?C:o;var y=f==C,p=o==C,c=f==o;if(c&&ur(r)){if(!ur(e))return!1;s=!0,y=!1}if(c&&!y)return i||(i=new N),s||qa(r)?Ba(r,e,n,a,t,i):Ka(r,e,f,n,a,t,i);if(!(n&Ha)){var d=y&&vr.call(r,"__wrapped__"),g=p&&vr.call(e,"__wrapped__");if(d||g){var v=d?r.value():r,l=g?e.value():e;return i||(i=new N),t(v,l,n,a,i)}}return c?(i||(i=new N),Ua(r,e,n,a,t,i)):!1}var Ya=Xa,Za=Ya,cr=Ar;function xr(r,e,n,a,t){return r===e?!0:r==null||e==null||!cr(r)&&!cr(e)?r!==r&&e!==e:Za(r,e,n,a,xr,t)}var Dr=xr,Ja=Mr,Qa=Dr,Wa=1,ka=2;function Va(r,e,n,a){var t=n.length,i=t,s=!a;if(r==null)return!i;for(r=Object(r);t--;){var u=n[t];if(s&&u[2]?u[1]!==r[u[0]]:!(u[0]in r))return!1}for(;++t<i;){u=n[t];var f=u[0],o=r[f],y=u[1];if(s&&u[2]){if(o===void 0&&!(f in r))return!1}else{var p=new Ja;if(a)var c=a(o,y,f,r,e,p);if(!(c===void 0?Qa(y,o,Wa|ka,a,p):c))return!1}}return!0}var ja=Va,rt=U;function et(r){return r===r&&!rt(r)}var Rr=et,nt=Rr,at=L;function tt(r){for(var e=at(r),n=e.length;n--;){var a=e[n],t=r[a];e[n]=[a,t,nt(t)]}return e}var it=tt;function st(r,e){return function(n){return n==null?!1:n[r]===e&&(e!==void 0||r in Object(n))}}var Fr=st,ut=ja,ft=it,ot=Fr;function vt(r){var e=ft(r);return e.length==1&&e[0][2]?ot(e[0][0],e[0][1]):function(n){return n===r||ut(n,r,e)}}var ct=vt,_t=X;function lt(r,e,n){var a=r==null?void 0:_t(r,e);return a===void 0?n:a}var pt=lt;function yt(r,e){return r!=null&&e in Object(r)}var $t=yt,gt=Cr,dt=B,bt=m,At=Y,ht=Hr,mt=M;function Tt(r,e,n){e=gt(e,r);for(var a=-1,t=e.length,i=!1;++a<t;){var s=mt(e[a]);if(!(i=r!=null&&n(r,s)))break;r=r[s]}return i||++a!=t?i:(t=r==null?0:r.length,!!t&&ht(t)&&At(s,t)&&(bt(r)||dt(r)))}var Et=Tt,Ot=$t,St=Et;function Pt(r,e){return r!=null&&St(r,e,Ot)}var It=Pt,wt=Dr,Ct=pt,Mt=It,Lt=H,xt=Rr,Dt=Fr,Rt=M,Ft=1,Nt=2;function Gt(r,e){return Lt(r)&&xt(e)?Dt(Rt(r),e):function(n){var a=Ct(n,r);return a===void 0&&a===e?Mt(n,r):wt(e,a,Ft|Nt)}}var Bt=Gt;function Kt(r){return r}var x=Kt;function Ut(r){return function(e){return e==null?void 0:e[r]}}var qt=Ut,Ht=X;function zt(r){return function(e){return Ht(e,r)}}var Xt=zt,Yt=qt,Zt=Xt,Jt=H,Qt=M;function Wt(r){return Jt(r)?Yt(Qt(r)):Zt(r)}var kt=Wt,Vt=ct,jt=Bt,ri=x,ei=m,ni=kt;function ai(r){return typeof r=="function"?r:r==null?ri:typeof r=="object"?ei(r)?jt(r[0],r[1]):Vt(r):ni(r)}var Z=ai;function ti(r){return function(e,n,a){for(var t=-1,i=Object(e),s=a(e),u=s.length;u--;){var f=s[r?u:++t];if(n(i[f],f,i)===!1)break}return e}}var ii=ti,si=ii,ui=si(),fi=ui,oi=fi,vi=L;function ci(r,e){return r&&oi(r,e,vi)}var _i=ci,li=S;function pi(r,e){return function(n,a){if(n==null)return n;if(!li(n))return r(n,a);for(var t=n.length,i=e?t:-1,s=Object(n);(e?i--:++i<t)&&a(s[i],i,s)!==!1;);return n}}var yi=pi,$i=_i,gi=yi,di=gi($i),bi=di,Ai=bi,hi=S;function mi(r,e){var n=-1,a=hi(r)?Array(r.length):[];return Ai(r,function(t,i,s){a[++n]=e(t,i,s)}),a}var Ti=mi;function Ei(r,e){var n=r.length;for(r.sort(e);n--;)r[n]=r[n].value;return r}var Oi=Ei,_r=P;function Si(r,e){if(r!==e){var n=r!==void 0,a=r===null,t=r===r,i=_r(r),s=e!==void 0,u=e===null,f=e===e,o=_r(e);if(!u&&!o&&!i&&r>e||i&&s&&f&&!u&&!o||a&&s&&f||!n&&f||!t)return 1;if(!a&&!i&&!o&&r<e||o&&n&&t&&!a&&!i||u&&n&&t||!s&&t||!f)return-1}return 0}var Pi=Si,Ii=Pi;function wi(r,e,n){for(var a=-1,t=r.criteria,i=e.criteria,s=t.length,u=n.length;++a<s;){var f=Ii(t[a],i[a]);if(f){if(a>=u)return f;var o=n[a];return f*(o=="desc"?-1:1)}}return r.index-e.index}var Ci=wi,G=Pr,Mi=X,Li=Z,xi=Ti,Di=Oi,Ri=zr,Fi=Ci,Ni=x,Gi=m;function Bi(r,e,n){e.length?e=G(e,function(i){return Gi(i)?function(s){return Mi(s,i.length===1?i[0]:i)}:i}):e=[Ni];var a=-1;e=G(e,Ri(Li));var t=xi(r,function(i,s,u){var f=G(e,function(o){return o(i)});return{criteria:f,index:++a,value:i}});return Di(t,function(i,s){return Fi(i,s,n)})}var Ki=Bi;function Ui(r,e,n){switch(n.length){case 0:return r.call(e);case 1:return r.call(e,n[0]);case 2:return r.call(e,n[0],n[1]);case 3:return r.call(e,n[0],n[1],n[2])}return r.apply(e,n)}var qi=Ui,Hi=qi,lr=Math.max;function zi(r,e,n){return e=lr(e===void 0?r.length-1:e,0),function(){for(var a=arguments,t=-1,i=lr(a.length-e,0),s=Array(i);++t<i;)s[t]=a[e+t];t=-1;for(var u=Array(e+1);++t<e;)u[t]=a[t];return u[e]=n(s),Hi(r,this,u)}}var Xi=zi;function Yi(r){return function(){return r}}var Zi=Yi,Ji=Qr,Qi=function(){try{var r=Ji(Object,"defineProperty");return r({},"",{}),r}catch(e){}}(),Wi=Qi,ki=Zi,pr=Wi,Vi=x,ji=pr?function(r,e){return pr(r,"toString",{configurable:!0,enumerable:!1,value:ki(e),writable:!0})}:Vi,rs=ji,es=800,ns=16,as=Date.now;function ts(r){var e=0,n=0;return function(){var a=as(),t=ns-(a-n);if(n=a,t>0){if(++e>=es)return arguments[0]}else e=0;return r.apply(void 0,arguments)}}var is=ts,ss=rs,us=is,fs=us(ss),os=fs,vs=x,cs=Xi,_s=os;function ls(r,e){return _s(cs(r,e,vs),r+"")}var ps=ls,ys=Er,$s=S,gs=Y,ds=U;function bs(r,e,n){if(!ds(n))return!1;var a=typeof e;return(a=="number"?$s(n)&&gs(e,n.length):a=="string"&&e in n)?ys(n[e],r):!1}var As=bs,hs=oe,ms=Ki,Ts=ps,yr=As,Es=Ts(function(r,e){if(r==null)return[];var n=e.length;return n>1&&yr(r,e[0],e[1])?e=[]:n>2&&yr(e[0],e[1],e[2])&&(e=[e[0]]),ms(r,hs(e,1),[])}),Os=Es;const Ss=br(Os);var Ps=Z,Is=S,ws=L;function Cs(r){return function(e,n,a){var t=Object(e);if(!Is(e)){var i=Ps(n);e=ws(e),n=function(u){return i(t[u],u,t)}}var s=r(e,n,a);return s>-1?t[i?e[s]:s]:void 0}}var Ms=Cs,Ls=/\s/;function xs(r){for(var e=r.length;e--&&Ls.test(r.charAt(e)););return e}var Ds=xs,Rs=Ds,Fs=/^\s+/;function Ns(r){return r&&r.slice(0,Rs(r)+1).replace(Fs,"")}var Gs=Ns,Bs=Gs,$r=U,Ks=P,gr=NaN,Us=/^[-+]0x[0-9a-f]+$/i,qs=/^0b[01]+$/i,Hs=/^0o[0-7]+$/i,zs=parseInt;function Xs(r){if(typeof r=="number")return r;if(Ks(r))return gr;if($r(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=$r(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Bs(r);var n=qs.test(r);return n||Hs.test(r)?zs(r.slice(2),n?2:8):Us.test(r)?gr:+r}var Ys=Xs,Zs=Ys,dr=1/0,Js=17976931348623157e292;function Qs(r){if(!r)return r===0?r:0;if(r=Zs(r),r===dr||r===-dr){var e=r<0?-1:1;return e*Js}return r===r?r:0}var Ws=Qs,ks=Ws;function Vs(r){var e=ks(r),n=e%1;return e===e?n?e-n:e:0}var js=Vs,ru=jr,eu=Z,nu=js,au=Math.max;function tu(r,e,n){var a=r==null?0:r.length;if(!a)return-1;var t=n==null?0:nu(n);return t<0&&(t=au(a+t,0)),ru(r,eu(e),t)}var iu=tu,su=Ms,uu=iu,fu=su(uu),ou=fu;const vu=br(ou);function gu(r){const e=Nr();let n=J({});const a=I(-1),t=J({}),i=I(-1),s=I([]),u=Gr(),f=I(""),o=()=>Kr(n.getID(),u),y=()=>u.push(f.value),p=()=>Ss(s.value,({username:v})=>v).map(v=>{var _,$;let l="".concat(v.username);if(!Xr((_=v==null?void 0:v.person)==null?void 0:_.names)){const[A]=(($=v.person)==null?void 0:$.names)||[];l+=" (".concat(A.given_name," ").concat(A.family_name,")")}return l}),c=async(v="N/A")=>{const l=await R.get("PATIENT_PROGRAM",{patientID:n.getID()});t.outcome=l.outcome,t.outcomeStartDate=l.startDate,t.sessionDate=w.getSessionDate(),t.apiDate=w.getCachedApiDate(),t.isBdeMode=w.isBDE(),t.birthDate=n.getBirthdate(),t.encounterName=v.toUpperCase(),w.isBDE()&&(s.value=await R.get("PROVIDERS"),t.providers=p())},d=(v,l=null)=>{const _={};if(_[E.SET_PROVIDER]=$=>{var h,T;const[A]=$.split(" ");return i.value=(T=(h=vu(s.value,{username:A}))==null?void 0:h.person_id)!=null?T:-1,E.CONTINUE},_[E.CHANGE_SESSION_DATE]=()=>(u.push("/session/date?patient_dashboard_redirection_id=".concat(n.getID())),E.EXIT),_[E.CHANGE_PATIENT_OUTCOME]=()=>(u.push("/patient/programs/".concat(n.getID())),E.EXIT),_[E.GO_TO_PATIENT_DASHBOARD]=()=>(y(),E.EXIT),v in _)return _[v](l)},g=async v=>{var _,$,A,h;const l=ee(v,re);for(const T in l){const b=l[T];if((_=b==null?void 0:b.actions)!=null&&_.alert&&d(await(($=b==null?void 0:b.actions)==null?void 0:$.alert(v)))===E.EXIT)return;if((A=b==null?void 0:b.actions)!=null&&A.selection){const D=await((h=b==null?void 0:b.actions)==null?void 0:h.selection(v));d(D.flowState,D.value)}}};return Br(async()=>{try{a.value=parseInt(e.params.patient_id),f.value="/patient/dashboard/".concat(a.value),n=await R.get("ACTIVE_PATIENT",{patientID:a.value}),await c(e.name),await g(t),typeof r=="function"&&r(i.value,a.value,n)}catch(v){console.error("Error in useEncounter hook:",v)}}),{patient:n,patientId:a,provider:i,providers:s,facts:t,patientDashboardUrl:f,goToPatientDashboard:y,goToNextTask:o}}export{gu as u};
