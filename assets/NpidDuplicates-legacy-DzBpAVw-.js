System.register(["./index-legacy-DDADMnop.js"],(function(e,t){"use strict";var i,n,a,s,d,o,l,r,c,u,h,m,p,g,f,I,k,C,D,b,w,y,N,_,A,$,E,V,x,P,z;return{setters:[e=>{i=e.d,n=e.a5,a=e.ae,s=e.a3,d=e.$,o=e.U,l=e.Q,r=e.O,c=e.R,u=e.S,h=e.a4,m=e.af,p=e.M,g=e.ag,f=e.ah,I=e.ai,k=e.aj,C=e.ak,D=e.a8,b=e.v,w=e.w,y=e.ad,N=e.u,_=e.x,A=e.z,$=e.Y,E=e.B,V=e.C,x=e.E,P=e.G,z=e.a1}],execute:function(){const t=i({components:{IonPage:n,IonCheckbox:a,IonButton:s,IonList:d,IonItem:o,IonToolbar:l,IonHeader:r,IonTitle:c,IonContent:u,IonFooter:h},data:()=>({dde:{},ddeEnabled:!1,items:[],title:"",npid:""}),watch:{$route:{handler({params:e}){e&&(this.npid=e.npid,this.title=`Duplicates for NPID (${this.npid})`,this.init(this.npid))},deep:!0,immediate:!0}},computed:{itemsChecked(){return this.items.filter((e=>e.isChecked))}},methods:{async onAction(e,t="proceed"){if(await m(`\n                Are you sure you want to ${t}?\n            `))try{await e()}catch(i){p(`${i}`),console.error(i)}},async mergeSelected(){if(!this.itemsChecked.every((e=>e.isComplete)))return p("One or more patients have missing data. Please update them before merging.",5e3);await this.dde.postMerge(this.itemsChecked)&&(await this.dde.printNpid(this.dde.patientID),g(this.dde.patientID,this.$router))},async reassignIdentifier(e){if(!e.isComplete&&this.ddeEnabled){if(await m("Do you want to update missing information?",{header:"Incomplete Demographics"})){let t=`edit_person=${e.patientID}`;t+="&dde_reassign=true",t+=`&doc_id=${e.docID}`,this.$router.push(`/patient/registration?${t}`)}}else this.onAction((async()=>{this.ddeEnabled?await this.dde.reassignNpid(e.docID,e.patientID)&&await this.dde.printNpid(e.patientID):"function"==typeof e.assignLocalNpidAndPrint&&await e.assignLocalNpidAndPrint(),g(e.patientID,this.$router)}),"Reassign")},buildItems:e=>e.map((e=>{try{const t=new f(e);return{isChecked:!1,patientID:t.getID(),name:t.getFullName(),gender:t.getGender(),birthdate:I.toStandardHisDisplayFormat(t.getBirthdate()),curDistrict:t.getCurrentDistrict(),homeVillage:t.getHomeVillage(),docID:t.getPatientIdentifier(27),isComplete:t.patientIsComplete(),assignLocalNpidAndPrint:async()=>{await t.assignNpid(),await t.printNationalID()}}}catch(t){k("An error has occured while building data"),console.error(t)}return{isChecked:!1,patientID:"N/A",name:"N/A",gender:"N/A",birthdate:"N/A",curDistrict:"N/A",homeVillage:"N/A",docID:"N/A",isComplete:!1}})),clear(){this.items=this.items.map((e=>(e.isChecked=!1,e)))},async init(e){try{if(this.dde=new C,await this.dde.loadDDEStatus(),this.ddeEnabled=this.dde.isEnabled(),this.ddeEnabled){const{locals:t,remotes:i}=await this.dde.findNpid(e);this.items=[...this.buildItems(t),...this.buildItems(i)]}else{const t=await f.findByNpid(e);t&&(this.items=this.buildItems(t))}}catch(t){k(`${t}`,5e3)}}}}),S=z("br",null,null,-1);e("default",D(t,[["render",function(e,t,i,n,a,s){const d=y("ion-title"),o=y("ion-toolbar"),l=y("ion-header"),r=y("ion-checkbox"),c=y("ion-label"),u=y("ion-button"),h=y("ion-item"),m=y("ion-list"),p=y("ion-content"),g=y("ion-footer"),f=y("ion-page");return N(),b(f,null,{default:w((()=>[_(l,null,{default:w((()=>[_(o,null,{default:w((()=>[_(d,{class:"his-lg-text"},{default:w((()=>[A($(e.title),1)])),_:1})])),_:1})])),_:1}),_(p,null,{default:w((()=>[_(m,null,{default:w((()=>[(N(!0),E(x,null,V(e.items,((t,i)=>(N(),b(h,{class:"his-md-text",key:i},{default:w((()=>[e.ddeEnabled?(N(),b(r,{key:0,slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e},null,8,["modelValue","onUpdate:modelValue"])):P("",!0),_(c,{color:t.isComplete?"":"danger"},{default:w((()=>[A($(t.name)+" ("+$(t.gender)+") "+$(t.birthdate)+" ",1),S,A(" Current District: "),z("b",null,$(t.curDistrict||"Unknown"),1),A(" Home Village: "),z("b",null,$(t.homeVillage||"Unknown"),1)])),_:2},1032,["color"]),_(u,{size:"medium",onClick:()=>e.reassignIdentifier(t)},{default:w((()=>[A(" Re-Assign ")])),_:2},1032,["onClick"]),t.isComplete?P("",!0):(N(),b(u,{key:1,size:"medium",color:"warning","router-link":`/patient/registration?edit_person=${t.patientID}`},{default:w((()=>[A(" Update Missing Data ")])),_:2},1032,["router-link"]))])),_:2},1024)))),128))])),_:1})])),_:1}),_(g,null,{default:w((()=>[_(o,{color:"dark"},{default:w((()=>[_(u,{"router-link":"/",color:"danger",slot:"start",size:"large"},{default:w((()=>[A(" Cancel ")])),_:1}),e.itemsChecked.length>0?(N(),b(u,{key:0,onClick:e.clear,color:"warning",slot:"end",size:"large"},{default:w((()=>[A(" Clear ")])),_:1},8,["onClick"])):P("",!0),e.itemsChecked.length>1?(N(),b(u,{key:1,onClick:t[0]||(t[0]=t=>e.onAction(e.mergeSelected,"merge")),color:"primary",size:"large",slot:"end"},{default:w((()=>[A(" Merge ("+$(e.itemsChecked.length)+") ",1)])),_:1})):P("",!0)])),_:1})])),_:1})])),_:1})}]]))}}}));
