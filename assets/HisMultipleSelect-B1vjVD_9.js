import K from"./SelectMixin-R7ZTpSOT.js";import{d as x,e as F,B,an as O,h as S,g as N,C as U,ao as y,ab as H,cb as L,_ as M,r as i,o,x as c,b as a,w as l,c as h,z as d,F as u,y as k,u as C,v as m,A as b}from"./index-DTBWhHAq.js";import{k as T}from"./KbHandler-BuQ4TFU6.js";import{F as A}from"./fuse-YdZE3OCN.js";import"./HisKeyboard-DQi-3Zd4.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./KbLayouts-VRA-vjeH.js";import"./BaseKeyboard-Ck5oXEIk.js";import"./BaseTextInput-CVsfQrYm.js";import"./ViewPort-DbAo6hHM.js";import"./FieldMixin.vue_vue_type_script_lang-CcBr82Cv.js";const P=x({components:{IonCheckbox:F,IonText:B,IonChip:O,IonItem:S,IonList:N,IonLabel:U,IonIcon:y},data:()=>({listData:[],filter:""}),name:"HisMultipleSelect",mixins:[K],methods:{async init(){this.$emit("onFieldActivated",this),!(!H.isEmpty(this.listData)&&this.config.buildOptionsOnce)&&(this.listData=await this.options(this.fdata,this.getChecked(this.listData),this.cdata,this.listData),this.$emit("onValue",this.getChecked(this.listData)))},async onselect(e){var t;if(setTimeout(()=>this.filter="",30),typeof((t=e==null?void 0:e.other)==null?void 0:t.onEvent)=="function"&&await e.other.onEvent(e.isChecked),this.onValue&&e.isChecked&&!await this.onValue(e,this.fdata,this.cdata)){e.isChecked=!1;return}this.onValueUpdate&&(this.listData=await this.onValueUpdate([...this.listData],e,this.fdata,this.cdata)),this.$emit("onValue",this.getChecked(this.listData))},onKbValue(e){this.filter=e},keypress(e){this.filter=T(e,this.filter)},uncheck(e){this.listData.forEach(t=>{t.label===e&&!t.disabled&&(t.isChecked=!1)})},getChecked(e){return e.filter(t=>t.isChecked)},isDescription(e,t=!1){return e?e!=null&&e.show?e.show==="onChecked"&&t||e.show==="always":!0:!1}},computed:{closeIcon:()=>L,listValues(){return this.filter?new A(this.listData,{threshold:.3,keys:["label"],useExtendedSearch:!0}).search(this.filter).map(t=>t.item):this.listData},checkedItems(){return this.getChecked(this.listData)}},watch:{clear(){this.listData.forEach(e=>e.isChecked=!1)},footerButtonEvent:{async handler(e){var t,n;e&&typeof((t=e.onClickComponentEvents)==null?void 0:t.refreshOptions)=="function"&&(this.listData=await((n=e.onClickComponentEvents)==null?void 0:n.refreshOptions(e,this.listData,this.fdata,this.cdata)),this.$emit("onValue",this.getChecked(this.listData)))},deep:!0,immediate:!0}},mounted(){this.init()},activated(){this.init()}});function z(e,t,n,j,q,G){const _=i("his-text-input"),w=i("ion-icon"),D=i("ion-chip"),V=i("ion-checkbox"),f=i("ion-text"),g=i("ion-label"),I=i("ion-item"),v=i("ion-list"),E=i("view-port"),$=i("his-keyboard");return o(),c(u,null,[a(E,{showFull:!e.showKeyboard},{default:l(()=>[e.showKeyboard?(o(),h(_,{key:0,value:e.filter,onOnValue:t[0]||(t[0]=s=>e.onKbValue(s,e.showKeyboard)),disabled:!1},null,8,["value"])):d("",!0),(o(!0),c(u,null,k(e.checkedItems,(s,r)=>(o(),c("span",{key:r},[a(D,{class:"his-md-text",color:"primary",onClick:p=>e.uncheck(s.label)},{default:l(()=>[C(m(s.label)+" ",1),a(w,{icon:e.closeIcon},null,8,["icon"])]),_:2},1032,["onClick"])]))),128)),a(v,{class:"view-port-content"},{default:l(()=>[(o(!0),c(u,null,k(e.listValues,(s,r)=>(o(),h(I,{onClick:()=>e.onselect(s),key:r,color:s.isChecked?"lightblue":"",lines:s.isChecked?"none":""},{default:l(()=>[a(V,{slot:"start",modelValue:s.isChecked,"onUpdate:modelValue":p=>s.isChecked=p,disabled:s==null?void 0:s.disabled},null,8,["modelValue","onUpdate:modelValue","disabled"]),a(g,null,{default:l(()=>[a(f,{class:"his-md-text"},{default:l(()=>[C(m(s.label),1)]),_:2},1024),e.isDescription(s.description,s.isChecked)?(o(),h(f,{key:0,color:s.description.color},{default:l(()=>[b("p",null,[b("i",null,m(s.description.text),1)])]),_:2},1032,["color"])):d("",!0)]),_:2},1024)]),_:2},1032,["onClick","color","lines"]))),128))]),_:1})]),_:1},8,["showFull"]),e.showKeyboard?(o(),h($,{key:0,kbConfig:e.keyboard,onKeyPress:e.keypress},null,8,["kbConfig","onKeyPress"])):d("",!0)],64)}const oe=M(P,[["render",z]]);export{oe as default};
