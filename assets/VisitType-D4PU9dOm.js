var d=Object.defineProperty;var h=(e,t,i)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var n=(e,t,i)=>h(e,typeof t!="symbol"?t+"":t,i);import{_ as m}from"./EncounterMixin.vue_vue_type_script_lang-CvuVzfKO.js";import{bJ as r,aL as p,d as v,a5 as b,ab as o,ac as s,a8 as _,ad as l,u as f,v as V,w as T,x as N}from"./index-Cpa1Vu_O.js";import"./encounter_guidelines-Cl074Os2.js";import"./GuidelineEngine-D6V1_Znr.js";import"./HisStandardForm-XdnY6fvn.js";class x extends r{constructor(i,a){super(i,107,a);n(this,"lastVisitNumber");this.lastVisitNumber=0}async loadLastVisitNumber(){const i=await r.getJson("programs/".concat(this.programID,"/patients/").concat(this.patientID,"/anc_visit"));!p.isEmpty(i)&&i.visit_number.length&&(this.lastVisitNumber=i.visit_number[i.visit_number.length-1])}}const y=v({components:{IonPage:b},mixins:[m],data:()=>({service:{},helpText:"ANC Visit Number"}),watch:{ready:{async handler(e){e&&(this.service=new x(this.patientID,this.providerID),await this.service.loadLastVisitNumber(),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,t){await this.service.createEncounter();const i=await this.resolveObs(t);await this.service.saveObservationList(i),this.nextTask()},getFields(){return[{id:"visit_number",helpText:this.helpText,dynamicHelpText:()=>this.service.lastVisitNumber?"".concat(this.helpText," (Last visit number: ").concat(this.service.lastVisitNumber,")"):this.helpText,defaultValue:()=>this.service.lastVisitNumber+1,type:o.TT_NUMBER,computedValue:e=>({obs:[this.service.buildValueNumber("Type of visit",e.value),this.service.buildValueCoded("Has extended ANC visits",e.value>8?"Yes":"No")]}),validation:e=>this.validateSeries([()=>s.required(e),()=>s.rangeOf(e,this.service.lastVisitNumber+1,15)])},{id:"reasons",helpText:"Provide reason for having more than 8 visits",type:o.TT_TEXT,computedValue:e=>({obs:this.service.buildValueText("Reason for extended ANC visits",e.value)}),condition:e=>e.visit_number.value>8,validation:e=>s.required(e)}]}}});function g(e,t,i,a,w,$){const c=l("his-standard-form"),u=l("ion-page");return f(),V(u,null,{default:T(()=>[N(c,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])]),_:1})}const L=_(y,[["render",g]]);export{L as default};
