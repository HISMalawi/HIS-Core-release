import{d as v,I as _,cg as C,K as m,N as h,ac as w,O as d,t as b,q as S,_ as L,r as g,o as P,c as R,w as V,b as D}from"./index-C-Wf7IuL.js";import{v as $}from"./TableView-D3Avejt1.js";import{D as k}from"./ReportDateSelectionPrompt-CrlqSABS.js";import{C as y}from"./clinic_report_service-Dy0JTsCU.js";import{A as q}from"./ArtDrilldown-CPxJ_UjE.js";import"./Export-DKDjU6pH.js";const A=v({components:{IonPage:_,IonLoading:C,v2Datatable:$},setup(){const e=w("reports.png"),s=m([]),l=m(""),i=m(!1),t=new y,r=(n,a)=>({label:n,ref:a,toValue:o=>o.length,tdClick:o=>u("".concat(o.column.label),o.refData)}),p=[[{label:"Regimen",ref:"regimen"},r("Due for VL","due_for_vl"),r("Sample drawn","drawn"),r("High vl (>=1000 copies))","high_vl"),r("Low vl (<1000 copies))","low_vl")]],u=async(n,a)=>{a.length&&(await d.create({component:q,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:n,subtitle:l,patientIdentifiers:a,onFinish:()=>d.getTop().then(o=>o&&d.dismiss())}})).present()},c=async()=>{if(!(t.startDate&&t.endDate))return b("Start date and end date required!");i.value=!0,s.value=[];try{s.value=await t.getVlSuppressionReport()}catch(n){S("Unable to generate report!"),console.error(n)}i.value=!1},f=()=>k({onFinish:(n,a,o)=>{l.value="Period (".concat(o,")"),t.startDate=n,t.endDate=a,c()}});return h(()=>f()),{logo:e,reportData:s,isLoading:i,configure:f,generate:c,columns:p,period:l}}});function B(e,s,l,i,t,r){const p=g("ion-loading"),u=g("v2Datatable"),c=g("ion-page");return P(),R(c,null,{default:V(()=>[D(p,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),D(u,{title:"Clinic VL Suppression Report","icon-url":e.logo,subtitle:e.period,columns:e.columns,columnData:e.reportData,rowsPerPage:30,onConfigure:e.configure,onRefresh:()=>e.generate(),"report-prefix":"Clinic"},null,8,["icon-url","subtitle","columns","columnData","onConfigure","onRefresh"])]),_:1})}const O=L(A,[["render",B]]);export{O as default};
