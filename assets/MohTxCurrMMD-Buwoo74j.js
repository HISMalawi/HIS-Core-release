import{_ as m}from"./ReportMixin.vue_vue_type_script_lang-Ce5B9pzq.js";import{T as c}from"./tx_report_service-VJGfRFjn.js";import{R as f}from"./TableReportTemplate-Dty_HdC-.js";import{d as u,I as w,L as o,cz as l,_ as M,r as d,o as R,c as _,w as v,b as C}from"./index-BFG-WECc.js";import{M as g}from"./moh_cohort_service-DYwZKUTC.js";import"./MultiFieldDateHelper-CAg9Dfet.js";import"./dynamic-import-helper-Bsjrd6Ro.js";import"./KbLayouts-VRA-vjeH.js";import"./HisKbConfigurations-GhFQZvlg.js";import"./BasicReportTemplate-SATK8Q6M.js";import"./Export-CRv3Yrt4.js";import"./SIngleTouchField-OvqCQtJi.js";import"./Pagination-wn9n5xfa.js";import"./HisStandardForm-B3aw5EdY.js";import"./TouchScreenForm-DiI3Xfhg.js";import"./ToolbarMediumCard-C3iotOe-.js";import"./Transformers-BPPLlH12.js";import"./ViewPort-0kHLdkku.js";import"./ReportErrors-DZ7hHT6a.js";const A=u({mixins:[m],components:{ReportTemplate:f,IonPage:w},data:()=>({title:"Moh TX CURR MMD Report",cohort:{},rows:[],headerInfoList:[],totals:new Set,mohCohort:{},errors:[],showStatus:!1,columns:[[o.thTxt("Age group"),o.thTxt("Gender"),o.thNum("# of clients on <3 months of ARVs"),o.thNum("# of clients on 3 - 5 months of ARVs"),o.thNum("# of clients on >= 6 months of ARVs")]],canValidate:!1}),created(){this.fields=this.getDateDurationFields()},watch:{async canValidate(t){t&&await this.validateReport()}},methods:{async onPeriod(t,e){this.canValidate=!1,this.rows=[],this.errors=[],this.showStatus=!1,this.report=new c,this.mohCohort=new g,this.mohCohort.setStartDate(e.start_date),this.mohCohort.setEndDate(e.end_date),this.mohCohort.setOccupation(e.occupation),this.report.setOrg("moh"),this.report.setOccupation(e.occupation),this.report.setStartDate(e.start_date),this.report.setEndDate(e.end_date),this.period=this.report.getDateIntervalPeriod(),await this.setRows(),this.setHeaderInfoList(),this.canValidate=!0,this.showStatus=!0},setHeaderInfoList(){this.headerInfoList=[{label:"Total clients",value:this.totals.size,other:{onclick:()=>this.runTableDrill(Array.from(this.totals),"Total Clients")}}]},getValues(t,e){const r=[],i=[],h=[];for(const s in t){const a=t[s].prescribed_days;this.totals.add(s),a<90&&r.push(s),a>=90&&a<=150&&i.push(s),a>150&&h.push(s)}return[this.drill(r,"".concat(e," < 3 months of Arvs")),this.drill(i,"".concat(e," 3-5 months of Arvs")),this.drill(h,"".concat(e," > 6 months months of Arvs"))]},async setRows(){let t=0,e=0;const r=[],i=[];for(const h in l){const s=l[h];if(s==="<1 year")t=0,e=0;else if(s==="90 plus years")t=90,e=1e4;else{const[a,p]=s.split("-");t=parseInt(a),e=parseInt(p)}const n=await this.report.getTxCurrMMDReport(t,e);this.report.initArvRefillPeriod(!1),n?(i.push([o.td(s),o.td("Female"),...this.getValues(n.Female,"".concat(s," (F)"))]),r.push([o.td(s),o.td("Male"),...this.getValues(n.Male,"".concat(s," (M)"))])):(i.push([o.td(s),o.td("Female"),o.td(0),o.td(0),o.td(0)]),r.push([o.td(s),o.td("Male"),o.td(0),o.td(0),o.td(0)])),this.rows=[...i,...r]}},validateReport(){const t={total_alive_and_on_art:{param:this.totals.size,check:(r,i)=>r!=i,error:(r,i)=>"\n                        MoH cohort Alive and on ART clients <b>(".concat(r,")</b> is not\n                        matching with total TX MMD clients <b(").concat(i,").</b>\n                    ")}};this.mohCohort.validateIndicators(t,r=>this.errors=r)===-1&&(this.errors=["Report not validated. Run the MoH cohort report for similar reporting period and then run this report"])}}});function I(t,e,r,i,h,s){const n=d("report-template"),a=d("ion-page");return R(),_(a,null,{default:v(()=>[C(n,{title:t.title,period:t.period,rows:t.rows,fields:t.fields,columns:t.columns,reportPrefix:"MoH",config:{showIndex:!0},validationErrors:t.errors,showValidationStatus:t.showStatus,headerInfoList:t.headerInfoList,onReportConfiguration:t.onPeriod},null,8,["title","period","rows","fields","columns","validationErrors","showValidationStatus","headerInfoList","onReportConfiguration"])]),_:1})}const U=M(A,[["render",I]]);export{U as default};
