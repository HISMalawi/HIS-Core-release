import{bU as h,d as P,r as d,bc as o,al as k,am as D,a as y,f as O,b as T,s as c,q as x}from"./index-y6JY22M4.js";import{H as E}from"./HisStandardForm-CXnAooxi.js";import{u as F}from"./useEncounter-A_jZetx1.js";import"./isEmpty-Dx6_cSDk.js";import"./encounter_guidelines-nb8Q8sEZ.js";import"./GuidelineEngine-D6V1_Znr.js";class U extends h{constructor(e,n){super(e,184,n)}}const V=P({__name:"CxCaOutcome",setup(p){let e,n;const i=d([]),l=d([]),u=o.getProgramID(),f=o.getLocationName(),v=o.getSessionDate(),{patientDashboardUrl:_,goToNextTask:b}=F(async(t,r)=>{n=r,e=new U(r,t),o.getProgramWorkflows(u).then(a=>{l.value=a}),i.value=g()});async function w(t){if(!await e.createEncounter())return c("Unable to create encounter");const a=t.select_referral_outcome.value,m=l.value.flatMap(s=>s.states).find(s=>s.concept.concept_names.some(S=>S.name===a));if(!m)return c("Unable to find workflow state for outcome: ".concat(a));if(!await o.createState(n,u,{state:m.program_workflow_state_id,location_id:f,date:v}))return c("Unable to update state");const C=await e.buildValueCoded("Outcome",a);await e.saveObservationList([C]),x("Observations and encounter created!"),b()}function g(){return[{id:"select_referral_outcome",helpText:"Referral outcome",type:D.TT_SELECT,validation:t=>k.required(t),options:()=>[{label:"Continue follow-up",value:"Continue follow-up"},{label:"No Dysplasia/Cancer",value:"No Dysplasia/Cancer"},{label:"Palliative Care",value:"Palliative Care"},{label:"Patient died",value:"Patient died"}]}]}return(t,r)=>(T(),y(E,{fields:i.value,onFinishAction:w,skipSummary:!0,cancelDestinationPath:O(_)},null,8,["fields","cancelDestinationPath"]))}});export{V as default};
