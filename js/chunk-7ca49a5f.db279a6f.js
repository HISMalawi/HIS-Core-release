(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ca49a5f"],{"5e8a":function(e,t,n){"use strict";n.r(t);var r=n("7a23");function a(e,t,n,a,i,o){var u=Object(r["resolveComponent"])("his-standard-form");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{key:e.formKey,fields:e.fields,skipSummary:!0,activeField:e.fieldComponent,onOnIndex:t[1]||(t[1]=function(t){return e.fieldComponent=""}),onFinishAction:e.onFinish},null,8,["fields","activeField","onFinishAction"])}var i=n("1da1"),o=(n("96cf"),n("caad"),n("d81d"),n("4de4"),n("d3b7"),n("2532"),n("ac1f"),n("1276"),n("25f0"),n("99af"),n("a15b"),n("d95e")),u=n("7920"),c=n("2706"),s=n("c1e4"),d=n("d10e"),l=n("9283"),p=n("b5e4"),f=n("1c74"),m=n("2ef0"),v=n("8e8b"),h=Object(r["defineComponent"])({components:{HisStandardForm:u["a"]},data:function(){return{formKey:0,fields:[],activity:"",presets:{},programs:{},userData:{},fieldComponent:"",isSessionPasswordChange:!1,activeField:"",form:{}}},watch:{$route:{handler:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:if(r=e.query,["edit","add"].includes(r.activity)?t.activity=r.activity:t.activity="add",!r.update_password){n.next=13;break}return n.t0=t,n.next=8,s["a"].getCurrentUser();case 8:n.t1=n.sent,t.userData=n.t0.toUserData.call(n.t0,n.t1),t.isSessionPasswordChange=!0,t.activeField="new_password",t.fieldComponent=t.activeField;case 13:t.programs=s["a"].getAvailableApps(),t.fields=t.getFields();case 15:case"end":return n.stop()}}),n)})))()},immediate:!0,deep:!0}},methods:{onFinish:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,e.t0=n.activity,e.next="add"===e.t0?4:"edit"===e.t0?8:12;break;case 4:return e.next=6,n.create(t);case 6:return n.activity="edit",e.abrupt("break",12);case 8:return e.next=10,n.update(t);case 10:return n.isSessionPasswordChange&&n.$router.push("/"),e.abrupt("break",12);case 12:v["a"].invalidate("PROVIDERS"),n.activeField="user_info",n.$nextTick((function(){return n.fieldComponent=n.activeField})),n.formKey+=1,e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](0),e.t1 instanceof f["d"]&&!Object(m["isEmpty"])(e.t1.errors)?Object(p["e"])(e.t1.errors):Object(p["c"])("".concat(e.t1));case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()},create:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,s["a"].createUser(e);case 2:if(r=n.sent,a=r.user,!a){n.next=6;break}return n.abrupt("return",t.userData=t.toUserData(a));case 6:throw"Unable to create new user, Possibly the user already exists or incorrect info was entered";case 7:case"end":return n.stop()}}),n)})))()},update:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,s["a"].updateUser(t.userData.id,e);case 2:if(r=n.sent,!r){n.next=5;break}return n.abrupt("return",t.userData=t.toUserData(r));case 5:throw"Unable to update user, possibly server error or incorrect information entered";case 6:case"end":return n.stop()}}),n)})))()},getProgramName:function(e){var t=Object(m["find"])(this.programs,{programID:e});return t?t.applicationName:""},mapToOption:function(e){return e.map((function(e){return{label:e,value:e}}))},getRoles:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,s["a"].getAllRoles();case 2:return t.abrupt("return",t.sent.filter((function(t){try{return!e.userData.role.split(",").includes(t.role)}catch(n){return!0}})).map((function(e){return{label:e.role,value:e.role,other:e}})));case 3:case"end":return t.stop()}}),t)})))()},toUserData:function(e){var t=e.person.names[0];return{id:e.user_id,given_name:t.given_name,family_name:t.family_name,username:e.username,role:e.roles.map((function(e){return e.role})),created:l["c"].toStandardHisDisplayFormat(e.date_created),status:e.deactivated_on?"Inactive":"Active",programs:e.programs.map((function(e){return e["program_id"]}))}},editConditionCheck:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"edit"!==this.activity||e.includes(this.activeField)},toLcase:function(e){return e.value.toString().toLowerCase()},getFields:function(){var e=this;return[{id:"select_user",helpText:"Select Username",type:o["b"].TT_SELECT,condition:function(){return"edit"===e.activity&&s["a"].isAdmin()},validation:function(e){return c["a"].required(e)},unload:function(t){var n=t.other;return e.userData=e.toUserData(n)},options:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s["a"].getAllUsers();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{label:e.username,value:e.user_id,other:e}})));case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),config:{showKeyboard:!0}},{id:"user_info",helpText:"User information",type:o["b"].TT_TABLE_VIEWER,dynamicHelpText:function(){return"User: ".concat(e.userData.username," | Added On: ").concat(e.userData.created)},condition:function(){return"edit"===e.activity&&s["a"].isAdmin()},options:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n,r,a){var o,u,c,d,l,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=3,u=["Attributes","Values","Actions"],c=function t(n){return{name:"Active"===n?"Deactivate":"Activate",type:"button",style:{width:"65%",fontWeight:"bold"},color:"Active"===n?"danger":"success",action:function(){var r=Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,"Active"!==n){r.next=6;break}return r.next=4,s["a"].deactivateUser(e.userData.id);case 4:e.userData.status="Inactive",a.rows[o]=["Status","Inactive",t("Inactive")],Object(p["d"])("User has been deactivated",400);case 6:if("Inactive"!==n){r.next=11;break}return r.next=9,s["a"].activateUser(e.userData.id);case 9:e.userData.status="Active",a.rows[o]=["Status","Active",t("Active")],Object(p["d"])("User has been activated",400);case 11:r.next=16;break;case 13:r.prev=13,r.t0=r["catch"](0),Object(p["e"])(r.t0);case 16:case"end":return r.stop()}}),r,null,[[0,13]])})));function u(){return r.apply(this,arguments)}return u}()}},d=function(t,n){return{name:t,type:"button",color:"light",style:{fontWeight:"bold",width:"65%"},action:function(){e.activeField=n,e.fieldComponent=e.activeField}}},l=[d("Add/Append Role","roles")],e.userData.role.length>1&&l.push(d("Remove Role","remove_roles")),f=[["<b>Name</b>","".concat(e.userData.given_name," ").concat(e.userData.family_name),d("Edit Name","given_name"),""],["<b>Password</b>","*******",d("Change password","new_password"),""],["<b>Role</b>",e.userData.role.join("<br/>")].concat(l),["<b>Status</b>",e.userData.status,c(e.userData.status),""],["<b>Programs</b>",e.userData.programs.map((function(t){return e.getProgramName(t)})).join("<br/>"),d("Edit Program","programs"),""]],t.abrupt("return",[{label:"",value:"",other:{columns:u,rows:f}}]);case 8:case"end":return t.stop()}}),t)})));function n(e,n,r){return t.apply(this,arguments)}return n}(),config:{hiddenFooterBtns:["Clear"],overrideDefaultFooterBtns:{nextBtn:{name:"Finish",onClick:function(){return e.$router.back()}}}}},{id:"given_name",helpText:"First name",type:o["b"].TT_TEXT,computedValue:function(e){return e.value},defaultValue:function(){return e.userData.given_name},condition:function(){return e.editConditionCheck(["given_name"])&&s["a"].isAdmin()},validation:function(e){return c["a"].isName(e)},options:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.given_name&&null!==n.given_name.value){t.next=2;break}return t.abrupt("return",[]);case 2:return t.next=4,d["a"].searchGivenName(n.given_name.value);case 4:return r=t.sent,t.abrupt("return",e.mapToOption(r));case 6:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()},{id:"family_name",helpText:"Last name",type:o["b"].TT_TEXT,computedValue:function(e){return e.value},defaultValue:function(){return e.userData.family_name},validation:function(e){return c["a"].isName(e)},condition:function(){return e.editConditionCheck(["given_name"])&&s["a"].isAdmin()},options:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.family_name&&null!==n.family_name.value){t.next=2;break}return t.abrupt("return",[]);case 2:return t.next=4,d["a"].searchFamilyName(n.family_name.value);case 4:return r=t.sent,t.abrupt("return",e.mapToOption(r));case 6:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()},{id:"roles",helpText:"Role",type:o["b"].TT_SELECT,computedValue:function(e){return[e.value]},condition:function(){return e.editConditionCheck(["roles"])&&s["a"].isAdmin()},validation:function(e){return c["a"].required(e)},options:function(){return e.getRoles()},config:{showKeyboard:!0}},{id:"remove_roles",helpText:"Remove Roles",proxyID:"roles",type:o["b"].TT_SELECT,validation:function(e){return c["a"].required(e)},condition:function(){return e.editConditionCheck(["remove_roles"])&&s["a"].isAdmin()&&"edit"===e.activity},computedValue:function(t){return e.userData.role.filter((function(e){return e!=t.label}))},options:function(){return e.mapToOption(e.userData.role)},config:{showKeyboard:!0}},{id:"must_append_roles",helpText:"Would you like to append role?",type:o["b"].TT_SELECT,computedValue:function(e){return"Yes"===e.label},condition:function(){return"edit"===e.activity&&e.editConditionCheck(["roles"])&&s["a"].isAdmin()},defaultComputedOutput:function(){return!1},validation:function(e){return c["a"].required(e)},options:function(){return[{label:"Yes",value:"true"},{label:"No",value:"false"}]}},{id:"programs",helpText:"Select Apps",type:o["b"].TT_MULTIPLE_SELECT,condition:function(){return s["a"].isAdmin()&&e.editConditionCheck(["programs"])},validation:function(e){return c["a"].required(e)},computedValue:function(e){return e.map((function(e){return e.value}))},options:function(){return e.programs.map((function(t){var n=!1;return"edit"===e.activity&&(n=e.userData.programs.includes(t.programID)),{label:t.applicationName,value:t.programID,isChecked:n}}))}},{id:"username",helpText:"Username",type:o["b"].TT_TEXT,condition:function(){return e.editConditionCheck(["nothing to see here"])&&s["a"].isAdmin()},computedValue:function(t){return e.toLcase(t)},validation:function(e){return c["a"].validateSeries([function(){return c["a"].required(e)},function(){return c["a"].hasLengthRangeOf(e,4,15)}])},config:{casing:"lowercase"}},{id:"new_password",proxyID:"password",helpText:"New Password",type:o["b"].TT_TEXT,computedValue:function(t){return e.toLcase(t)},condition:function(){return e.editConditionCheck(["new_password"])},validation:function(e){return c["a"].validateSeries([function(){return c["a"].required(e)},function(){return c["a"].hasLengthRangeOf(e,4,15)}])},config:{inputType:"password"}},{id:"verify_password",proxyID:"password",helpText:"Confirm Password",type:o["b"].TT_TEXT,computedValue:function(t){return e.toLcase(t)},condition:function(){return e.editConditionCheck(["new_password"])},validation:function(t,n){return c["a"].validateSeries([function(){return c["a"].required(t)},function(){if(e.toLcase(n.verify_password)!=e.toLcase(n.new_password))return["New password does not match current password"]}])},config:{inputType:"password"}}]}}}),b=n("d959"),g=n.n(b);const y=g()(h,[["render",a]]);t["default"]=y},7920:function(e,t,n){"use strict";var r=n("7a23");function a(e,t,n,a,i,o){return Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.formType),{fields:e.fields,skipSummary:e.skipSummary,activeField:e.activeField,cancelDestinationPath:e.cancelDestinationPath,onOnFinish:e.onFinish,onFinish:e.onFinishAction,onOnIndex:e.onIndex},null,8,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var i=n("9441"),o=Object(r["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:i["a"]},emits:["onFinish","onIndex"],data:function(){return{formType:"touch-screen-form"}},props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish:function(e,t){this.$emit("onFinish",e,t)},onIndex:function(e){this.$emit("onIndex",e)}}}),u=n("d959"),c=n.n(u);const s=c()(o,[["render",a]]);t["a"]=s},d10e:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("1da1"),a=n("5530"),i=n("d4ec"),o=n("bee2"),u=n("45eb"),c=n("7e84"),s=n("262e"),d=n("2caf"),l=(n("96cf"),n("1c74")),p=function(e){Object(s["a"])(n,e);var t=Object(d["a"])(n);function n(e){var r;return Object(i["a"])(this,n),r=t.call(this),r.person=e,r}return Object(o["a"])(n,[{key:"create",value:function(){return l["e"].postJson("/people",this.person)}},{key:"update",value:function(e){return l["e"].putJson("people/".concat(e),Object(a["a"])(Object(a["a"])({},this.person),{},{program_id:l["e"].getProgramID()}))}}],[{key:"searchFamilyName",value:function(e){return Object(u["a"])(Object(c["a"])(n),"getJson",this).call(this,"/search/family_name",{search_string:e})}},{key:"searchGivenName",value:function(e){return Object(u["a"])(Object(c["a"])(n),"getJson",this).call(this,"/search/given_name",{search_string:e})}},{key:"getPersonFullName",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["a"])(Object(c["a"])(n),"getJson",this).call(this,"/people/".concat(t,"/names"));case 2:return r=e.sent,e.abrupt("return",r&&r.length?r[0].given_name+" "+r[0].family_name:"");case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(l["e"])}}]);
//# sourceMappingURL=chunk-7ca49a5f.db279a6f.js.map