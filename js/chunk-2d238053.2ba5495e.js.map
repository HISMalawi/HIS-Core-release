{"version":3,"sources":["webpack:///./node_modules/vue-loader-v16/dist/templateLoader.js","webpack:///./node_modules/cache-loader/dist/cjs.js","webpack:///./src/apps/ART/views/reports/inconsistencies/PatientVisitStats.vue"],"names":["_hoisted_1","_createTextVNode","_hoisted_2","class","_hoisted_3","render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_component_ion_title","_component_ion_toolbar","_component_ion_header","_component_apexchart","_component_view_port","_component_ion_content","_component_ion_button","_component_ion_footer","_component_ion_page","_openBlock","_createBlock","_Fragment","_withDirectives","_createVNode","onOnFinish","onPeriod","skipSummary","fields","_vShow","canShowReport","key","default","_withCtx","_","width","height","type","chartType","options","chartOptions","series","onClick","pointSelection","color","slot","size","_createCommentVNode","defineComponent","components","IonPage","IonHeader","IonTitle","IonToolbar","IonContent","IonFooter","IonButton","ViewPort","HisStandardForm","mixins","ReportMixin","data","report","patientPresent","guardianPresent","bothPresent","title","text","yaxis","plotAreaHeight","xaxis","created","this","getDateDurationFields","methods","conf","presentLoading","PatientReportService","setStartDate","start_date","setEndDate","end_date","res","getPatientVisitTypes","buildSeries","loadingController","dismiss","loading","create","message","backdropDismiss","present","e","c","config","dataPointIndex","seriesIndex","sIndex","runTableDrill","raw","visitDates","uniq","Object","keys","setValueGroup","date","group","comparator","values","entries","filter","v","patient_present","guardian_present","map","patient","sortSeries","valueGroup","Date","getTime","length","sortData","guardian","name","__exports__"],"mappings":"uIAEA,MAAMA,EAA0BC,6BAAiB,0BAC3CC,EAAa,CAAEC,MAAO,qBACtBC,EAA0BH,6BAAiB,YAE3C,SAAUI,EAAOC,EAAMC,EAAQC,EAAQC,EAAQC,EAAOC,GAC1D,MAAMC,EAA+BC,8BAAkB,qBACjDC,EAAuBD,8BAAkB,aACzCE,EAAyBF,8BAAkB,eAC3CG,EAAwBH,8BAAkB,cAC1CI,EAAuBJ,8BAAkB,aACzCK,EAAuBL,8BAAkB,aACzCM,EAAyBN,8BAAkB,eAC3CO,EAAwBP,8BAAkB,cAC1CQ,EAAwBR,8BAAkB,cAC1CS,EAAsBT,8BAAkB,YAE9C,OAAQU,yBAAcC,yBAAaC,cAAW,KAAM,CAClDC,4BAAgBC,yBAAaf,EAA8B,CACzDgB,WAAYtB,EAAKuB,SACjBC,aAAa,EACbC,OAAQzB,EAAKyB,QACZ,KAAM,EAAG,CAAC,aAAc,WAAY,CACrC,CAACC,YAAS1B,EAAK2B,iBAEhB3B,EAAK2B,eACDV,yBAAcC,yBAAaF,EAAqB,CAAEY,IAAK,GAAK,CAC3DC,QAASC,qBAAS,IAAM,CACtBT,yBAAaX,EAAuB,KAAM,CACxCmB,QAASC,qBAAS,IAAM,CACtBT,yBAAaZ,EAAwB,KAAM,CACzCoB,QAASC,qBAAS,IAAM,CACtBT,yBAAab,EAAsB,KAAM,CACvCqB,QAASC,qBAAS,IAAM,CACtBpC,IAEFqC,EAAG,MAGPA,EAAG,MAGPA,EAAG,IAELV,yBAAaR,EAAwB,KAAM,CACzCgB,QAASC,qBAAS,IAAM,CACtBT,yBAAaT,EAAsB,KAAM,CACvCiB,QAASC,qBAAS,IAAM,CACtBT,yBAAa,MAAOzB,EAAY,CAC9ByB,yBAAaV,EAAsB,CACjCqB,MAAOhC,EAAKgC,MACZC,OAAQjC,EAAKiC,OACbC,KAAMlC,EAAKmC,UACXC,QAASpC,EAAKqC,aACdC,OAAQtC,EAAKsC,OACbC,QAASvC,EAAKwC,gBACb,KAAM,EAAG,CAAC,QAAS,SAAU,OAAQ,UAAW,SAAU,gBAGjET,EAAG,MAGPA,EAAG,IAELV,yBAAaN,EAAuB,KAAM,CACxCc,QAASC,qBAAS,IAAM,CACtBT,yBAAaZ,EAAwB,CAAEgC,MAAO,QAAU,CACtDZ,QAASC,qBAAS,IAAM,CACtBT,yBAAaP,EAAuB,CAClC4B,KAAM,MACNC,KAAM,QACN,cAAe,IACfF,MAAO,WACN,CACDZ,QAASC,qBAAS,IAAM,CACtBhC,IAEFiC,EAAG,MAGPA,EAAG,MAGPA,EAAG,MAGPA,EAAG,KAELa,gCAAoB,IAAI,IAC3B,I,4ECxEUC,+BAAgB,CAC3BC,WAAY,CACRC,eACAC,iBACAC,gBACAC,kBACAC,kBACAC,iBACAC,iBACAC,gBACAC,wBAEJC,OAAQ,CAACC,QACTC,KAAM,KAAM,CACRvB,UAAW,OACXF,OAAQ,OACRD,MAAO,OACPL,eAAe,EACfgC,OAAQ,GACRrB,OAAQ,GACRsB,eAAgB,GAChBC,gBAAiB,GACjBC,YAAa,GACbzB,aAAc,CACV0B,MAAQ,CACJC,KAAM,4BAEVC,MAAO,CACHF,MAAO,CACHC,KAAM,qBAEVE,eAAgB,KAEpBC,MAAO,CACHjC,KAAM,eAIlBkC,UACIC,KAAK5C,OAAS4C,KAAKC,yBAEvBC,QAAS,CACL,eAAexC,EAAQyC,SACbH,KAAKI,iBACXJ,KAAK1C,eAAgB,EACrB0C,KAAKV,OAAS,IAAIe,OAClBL,KAAKV,OAAOgB,aAAaH,EAAKI,YAC9BP,KAAKV,OAAOkB,WAAWL,EAAKM,UAC5B,MAAMC,QAAYV,KAAKV,OAAOqB,uBAC9BX,KAAK/B,OAAS+B,KAAKY,YAAYF,GAC/BG,OAAkBC,WAEtB,uBACI,MAAMC,QAAgBF,OACjBG,OAAO,CACJC,QAAS,iBACTC,iBAAiB,UAEnBH,EAAQI,WAElBhD,eAAeiD,EAAQC,EAAQC,GAC3B,IACI,MAAM,eAAEC,EAAF,YAAkBC,GAAgBF,EAClCG,EAASD,GAAe,EAAI,EAAIA,EACtCxB,KAAK0B,cAAc1B,KAAK/B,OAAOwD,GAAQE,IAAIJ,IAC7C,MAAOH,MAIbR,YAAYvB,GACR,MAAMuC,EAAuBC,kBAAKC,OAAOC,KAAK1C,IACxC2C,EAAgB,CAClBC,EACAC,EACAC,KAEMF,KAAQC,IAAQA,EAAMD,GAAQ,IAEpC,MAAMG,EAASN,OAAOO,QAAQhD,EAAK4C,IAC9BK,OAAO,EAAE5E,EAAG6E,KAAYJ,EACrBI,EAAEC,gBACFD,EAAEE,mBAELC,IAAI,EAAEC,KAAaA,GAGxB,OADAT,EAAMD,GAAQ,IAAIC,EAAMD,MAAUG,GAC3BF,GAGLU,EAAcC,GACTjB,EAAWc,IAAKT,GAAiB,CACpC,IAAIa,KAAKb,GAAMc,UACfF,EAAWZ,GAAMe,SAInBC,EAAYJ,GAAoBjB,EAAWc,IAAKT,GAAiBY,EAAWZ,IAElF,IAAI,MAAMA,KAAQ5C,EACd2C,EAAcC,EAAMjC,KAAKT,eAAgB,CAACoD,EAAcO,IAC7CP,IAAYO,GAEvBlB,EAAcC,EAAMjC,KAAKR,gBAAiB,CAACmD,EAAcO,KAC7CP,GAAWO,GAEvBlB,EAAcC,EAAMjC,KAAKP,YAAa,CAACkD,EAAcO,IAC1CP,GAAWO,GAI1B,MAAO,CACH,CACIC,KAAM,kBACNxB,IAAKsB,EAASjD,KAAKT,gBACnBF,KAAMuD,EAAW5C,KAAKT,iBAE1B,CACI4D,KAAM,mBACNxB,IAAKsB,EAASjD,KAAKR,iBACnBH,KAAMuD,EAAW5C,KAAKR,kBAE1B,CACI2D,KAAM,oCACNxB,IAAKsB,EAASjD,KAAKP,aACnBJ,KAAMuD,EAAW5C,KAAKP,mB,qBCzI1C,MAAM2D,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS1H,KAErD","file":"js/chunk-2d238053.2ba5495e.js","sourcesContent":["import { resolveComponent as _resolveComponent, vShow as _vShow, createVNode as _createVNode, withDirectives as _withDirectives, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\" Patient visit report \")\nconst _hoisted_2 = { class: \"view-port-content\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" Finish \")\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_title = _resolveComponent(\"ion-title\")\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")\n  const _component_ion_header = _resolveComponent(\"ion-header\")\n  const _component_apexchart = _resolveComponent(\"apexchart\")\n  const _component_view_port = _resolveComponent(\"view-port\")\n  const _component_ion_content = _resolveComponent(\"ion-content\")\n  const _component_ion_button = _resolveComponent(\"ion-button\")\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_Fragment, null, [\n    _withDirectives(_createVNode(_component_his_standard_form, {\n      onOnFinish: _ctx.onPeriod,\n      skipSummary: true,\n      fields: _ctx.fields\n    }, null, 8, [\"onOnFinish\", \"fields\"]), [\n      [_vShow, !_ctx.canShowReport]\n    ]),\n    (_ctx.canShowReport)\n      ? (_openBlock(), _createBlock(_component_ion_page, { key: 0 }, {\n          default: _withCtx(() => [\n            _createVNode(_component_ion_header, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_ion_toolbar, null, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_title, null, {\n                      default: _withCtx(() => [\n                        _hoisted_1\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_ion_content, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_view_port, null, {\n                  default: _withCtx(() => [\n                    _createVNode(\"div\", _hoisted_2, [\n                      _createVNode(_component_apexchart, {\n                        width: _ctx.width,\n                        height: _ctx.height,\n                        type: _ctx.chartType,\n                        options: _ctx.chartOptions,\n                        series: _ctx.series,\n                        onClick: _ctx.pointSelection\n                      }, null, 8, [\"width\", \"height\", \"type\", \"options\", \"series\", \"onClick\"])\n                    ])\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            }),\n            _createVNode(_component_ion_footer, null, {\n              default: _withCtx(() => [\n                _createVNode(_component_ion_toolbar, { color: \"dark\" }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_button, {\n                      slot: \"end\",\n                      size: \"large\",\n                      \"router-link\": \"/\",\n                      color: \"success\"\n                    }, {\n                      default: _withCtx(() => [\n                        _hoisted_3\n                      ]),\n                      _: 1\n                    })\n                  ]),\n                  _: 1\n                })\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        }))\n      : _createCommentVNode(\"\", true)\n  ], 64 /* STABLE_FRAGMENT */))\n}","\nimport { defineComponent } from 'vue'\nimport {\n    IonPage,\n    IonHeader,\n    IonTitle,\n    IonToolbar,\n    IonContent,\n    IonFooter,\n    IonButton,\n    loadingController\n} from \"@ionic/vue\"\nimport ViewPort from \"@/components/DataViews/ViewPort.vue\"\nimport { PatientReportService } from \"@/apps/ART/services/reports/patient_report_service\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport ReportMixin from \"@/apps/ART/views/reports/ReportMixin.vue\"\nimport { uniq } from 'lodash';\n\nexport default defineComponent({\n    components: {\n        IonPage,\n        IonHeader,\n        IonTitle,\n        IonToolbar,\n        IonContent,\n        IonFooter,\n        IonButton,\n        ViewPort,\n        HisStandardForm\n    },\n    mixins: [ReportMixin],\n    data: () => ({\n        chartType: 'area',\n        height: '100%',\n        width: '100%',\n        canShowReport: false,\n        report: {} as any,\n        series: [] as any,\n        patientPresent: {} as any,\n        guardianPresent: {} as any,\n        bothPresent: {} as any,\n        chartOptions: {\n            title : {\n                text: \"HIV Reception encounters\"\n            },\n            yaxis: {\n                title: { \n                    text: \"Number of clients\"\n                },\n                plotAreaHeight: 800,\n            },\n            xaxis: {\n                type: 'datetime'\n            }\n        } as any\n    }),\n    created() {\n        this.fields = this.getDateDurationFields()\n    },\n    methods: {\n        async onPeriod(_: any, conf: any) {\n            await this.presentLoading()\n            this.canShowReport = true\n            this.report = new PatientReportService()\n            this.report.setStartDate(conf.start_date)\n            this.report.setEndDate(conf.end_date)\n            const res = await this.report.getPatientVisitTypes()\n            this.series = this.buildSeries(res)\n            loadingController.dismiss()\n        },\n        async presentLoading() {\n            const loading = await loadingController\n                .create({\n                    message: 'Please wait...',\n                    backdropDismiss: false\n                })\n            await loading.present()\n        },\n        pointSelection(e: any, c: any, config: any) {\n            try {\n                const { dataPointIndex, seriesIndex } = config\n                const sIndex = seriesIndex <= 0 ? 0 : seriesIndex\n                this.runTableDrill(this.series[sIndex].raw[dataPointIndex])\n            } catch (e) {\n                //TODO\n            }\n        },\n        buildSeries(data: any) {\n            const visitDates: string[] = uniq(Object.keys(data))\n            const setValueGroup = (\n                date: string,\n                group: Record<string, any>,\n                comparator: any) => {\n\n                if (!(date in group)) group[date] = []\n\n                const values = Object.entries(data[date])\n                    .filter(([_, v]: any) => comparator(\n                        v.patient_present,\n                        v.guardian_present\n                    ))\n                    .map(([patient]) => patient)\n\n                group[date] = [...group[date], ...values]\n                return group\n            }\n\n            const sortSeries = (valueGroup: any) => {\n                return visitDates.map((date: string) => [\n                    new Date(date).getTime(), \n                    valueGroup[date].length\n                ])\n            }\n\n            const sortData = (valueGroup: any) => visitDates.map((date: string) => valueGroup[date])\n    \n            for(const date in data) {\n                setValueGroup(date, this.patientPresent, (patient: any, guardian: any) => {\n                    return patient && !guardian\n                })\n                setValueGroup(date, this.guardianPresent, (patient: any, guardian: any) => {\n                    return !patient && guardian\n                })\n                setValueGroup(date, this.bothPresent, (patient: any, guardian: any) => {\n                    return patient && guardian\n                })\n            }\n\n            return [\n                {\n                    name: 'Patient present',\n                    raw: sortData(this.patientPresent),\n                    data: sortSeries(this.patientPresent)\n                },\n                {\n                    name: 'Guardian present',\n                    raw: sortData(this.guardianPresent),\n                    data: sortSeries(this.guardianPresent)\n                },\n                {\n                    name: 'Both patient and guardian present',\n                    raw: sortData(this.bothPresent),\n                    data: sortSeries(this.bothPresent)\n                }\n            ]\n        }\n    }\n})\n","import { render } from \"./PatientVisitStats.vue?vue&type=template&id=5f54bf6b&ts=true\"\nimport script from \"./PatientVisitStats.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientVisitStats.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}