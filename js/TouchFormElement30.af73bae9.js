(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TouchFormElement30","TouchFormElement38","TouchFormElement8"],{"04a0":function(e,t,o){},"0a79":function(e,t,o){"use strict";var c=o("7a23");const n=Object(c["withScopeId"])("data-v-7c293cad"),a=n((function(e,t,o,n,a,s){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{id:"view-port",class:e.showFull?"":"half"},[Object(c["renderSlot"])(e.$slots,"default")],2)}));var s=Object(c["defineComponent"])({name:"ViewPort",props:{showFull:{type:Boolean,default:()=>!0}}}),r=(o("a4d3"),o("d959")),l=o.n(r);const i=l()(s,[["render",a],["__scopeId","data-v-7c293cad"]]);t["a"]=i},"0cb1":function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var c=o("cc6f");class n extends c["a"]{constructor(e,t){super(e,57,t)}}},"51c8":function(e,t,o){"use strict";o.r(t);var c=o("7a23"),n=Object(c["defineComponent"])({emits:["onValue","onFieldActivated"],props:{config:{type:Object,default:()=>({})},preset:{type:Object,default:()=>({label:"",value:""})},defaultValue:{type:Function},fdata:{type:Object,required:!0},cdata:{type:Object,required:!0},clear:{type:Number,required:!0},options:{type:Function,default:()=>[]},activationState:{type:String,default:""},onValue:{type:Function},onValueUpdate:{type:Function},footerButtonEvent:{type:Object}}});const a=n;t["default"]=a},"6dc9":function(e,t,o){"use strict";o("c17f")},a4d3:function(e,t,o){"use strict";o("04a0")},bc14:function(e,t,o){"use strict";o("d717")},c17f:function(e,t,o){},c4e4:function(e,t,o){"use strict";var c=o("7a23");const n=Object(c["withScopeId"])("data-v-9adaf5e2");Object(c["pushScopeId"])("data-v-9adaf5e2");const a=Object(c["createTextVNode"])("Lab orders"),s={class:"ion-margin-bottom"},r=Object(c["createVNode"])("div",{class:"his-md-text side-title"}," Select specimen ",-1),l=Object(c["createVNode"])("div",{class:"his-md-text side-title"}," Main test(s) reason ",-1),i={style:{background:"lightyellow",height:"34vh"}},d={class:"his-sm-text"},b=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",null,"Test"),Object(c["createVNode"])("th",null,"Specimen"),Object(c["createVNode"])("th",null,"Reason"),Object(c["createVNode"])("th",null,"Action")])],-1),u=Object(c["createTextVNode"])("X"),p=Object(c["createTextVNode"])(" Place orders "),O=Object(c["createTextVNode"])(" Close ");Object(c["popScopeId"])();const j=n((function(e,t,o,j,m,h){const v=Object(c["resolveComponent"])("ion-title"),f=Object(c["resolveComponent"])("ion-toolbar"),y=Object(c["resolveComponent"])("ion-header"),V=Object(c["resolveComponent"])("ion-label"),N=Object(c["resolveComponent"])("ion-checkbox"),k=Object(c["resolveComponent"])("ion-item"),g=Object(c["resolveComponent"])("ion-list"),I=Object(c["resolveComponent"])("ion-col"),C=Object(c["resolveComponent"])("ion-radio"),_=Object(c["resolveComponent"])("ion-radio-group"),x=Object(c["resolveComponent"])("ion-button"),w=Object(c["resolveComponent"])("ion-row"),T=Object(c["resolveComponent"])("ion-grid"),B=Object(c["resolveComponent"])("ion-content"),S=Object(c["resolveComponent"])("ion-footer");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[Object(c["createVNode"])(y,null,{default:n(()=>[Object(c["createVNode"])(f,null,{default:n(()=>[Object(c["createVNode"])(v,{class:"his-lg-text"},{default:n(()=>[a]),_:1})]),_:1})]),_:1}),Object(c["createVNode"])(B,{style:{overflow:"hidden",background:"grey",height:"70vh"}},{default:n(()=>[Object(c["createVNode"])(T,null,{default:n(()=>[Object(c["createVNode"])(w,null,{default:n(()=>[Object(c["createVNode"])(I,{size:"6"},{default:n(()=>[Object(c["createVNode"])(g,{style:{overflowY:"auto",height:"75vh"}},{default:n(()=>[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.testTypes,(t,o)=>(Object(c["openBlock"])(),Object(c["createBlock"])(k,{class:"his-sm-text",key:t,disabled:null!==e.activeIndex&&e.activeIndex!==o&&!e.isOrderComplete,detail:""},{default:n(()=>[Object(c["createVNode"])(V,{"text-wrap":""},{default:n(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t.name),1)]),_:2},1024),Object(c["createVNode"])(N,{modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e,slot:"start",onIonChange:c=>e.onSelectTest(t.name,o,c)},null,8,["modelValue","onUpdate:modelValue","onIonChange"])]),_:2},1032,["disabled"]))),128))]),_:1})]),_:1}),null!=e.activeIndex&&e.selectedOrders.length>0?(Object(c["openBlock"])(),Object(c["createBlock"])(I,{key:0,style:{overflowY:"auto",height:"79vh"}},{default:n(()=>[Object(c["createVNode"])("div",s,[e.extendedLabsEnabled?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])(g,{key:0},{default:n(()=>[Object(c["createVNode"])(_,{modelValue:e.testTypes[e.activeIndex]["specimen"],"onUpdate:modelValue":t[1]||(t[1]=t=>e.testTypes[e.activeIndex]["specimen"]=t)},{default:n(()=>[r,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.specimens,t=>(Object(c["openBlock"])(),Object(c["createBlock"])(k,{key:t},{default:n(()=>[Object(c["createVNode"])(V,null,{default:n(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t.name),1)]),_:2},1024),Object(c["createVNode"])(C,{slot:"start",value:t.name,onClick:o=>e.addSpecimen(t)},null,8,["value","onClick"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})),Object(c["createVNode"])(_,{modelValue:e.testTypes[e.activeIndex]["reason"],"onUpdate:modelValue":t[2]||(t[2]=t=>e.testTypes[e.activeIndex]["reason"]=t)},{default:n(()=>[l,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.reasons,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(k,{class:"his-sm-text",key:e},{default:n(()=>[Object(c["createVNode"])(V,null,{default:n(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e),1)]),_:2},1024),Object(c["createVNode"])(C,{slot:"start",value:e},null,8,["value"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),Object(c["createVNode"])("div",i,[Object(c["createVNode"])("table",d,[b,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.finalOrders,(t,o)=>(Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:o},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.name),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.specimen||"N/A"),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.reason),1),Object(c["createVNode"])("td",null,[Object(c["createVNode"])(x,{onClick:o=>e.removeOrder(t.currentIndex),slot:"end",color:"danger"},{default:n(()=>[u]),_:1},8,["onClick"])])]))),128))])])])]),_:1})):Object(c["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1}),Object(c["createVNode"])(S,null,{default:n(()=>[Object(c["createVNode"])(f,null,{default:n(()=>[Object(c["createVNode"])(x,{onClick:e.postActivities,size:"large",slot:"end",disabled:0===e.finalOrders.length},{default:n(()=>[p]),_:1},8,["onClick","disabled"]),Object(c["createVNode"])(x,{onClick:t[3]||(t[3]=t=>e.closeModal([])),size:"large",slot:"start",color:"danger"},{default:n(()=>[O]),_:1})]),_:1})]),_:1})],64)}));var m=o("8a30"),h=o("b5e4"),v=o("9b7c"),f=o("0cb1"),y=o("b89f"),V=o("d1ca"),N=o("8e8b"),k=Object(c["defineComponent"])({name:"Modal",props:{activities:{type:Object,required:!0},testFilters:{type:Array},title:{type:String,default:""}},watch:{activities:{handler(e){e&&(this.appActivities=[...e],this.getActivities())},immediate:!0}},async created(){this.extendedLabsEnabled=await V["b"].extendedLabEnabled()},methods:{async onSelectTest(e,t,o){this.$nextTick(async()=>{this.testTypes[t]["isChecked"]=o.target.checked,this.testTypes[t]["isChecked"]?(this.specimens=await v["a"].getSpecimens(e),this.testTypes[t]["currentIndex"]=t,this.activeIndex=t):this.removeOrder(t)})},async getActivities(){const e=await v["a"].getTestTypes();this.testTypes=e.map((e,t)=>(e.index="HIV viral load"===e.name?e.index=0:e.index=t+1,e)).sort((e,t)=>e.index<t.index?0:1).filter(e=>!Array.isArray(this.testFilters)||this.testFilters.includes(e.name))},removeOrder(e){this.testTypes[e]["isChecked"]=!1,this.testTypes[e]["reason"]=null,this.testTypes[e]["specimen"]=null,this.testTypes[e]["specimenConcept"]=null,this.activeIndex=null,this.specimens=[]},addSpecimen(e){this.testTypes[this.activeIndex]["specimenConcept"]=e.concept_id},async postActivities(){const e=""+this.$route.params.patient_id,t=new f["a"](parseInt(e),-1),o=await t.createEncounter();if(o){const e=await v["a"].buildLabOrders(o,this.finalOrders),t=await v["a"].saveOrdersArray(o.encounter_id,e);if(!t)return Object(h["e"])("Unable to save lab orders");N["a"].invalidate("PATIENT_LAB_ORDERS");const c=await Object(h["a"])("Lab orders and encounter created!, print out your last orders?",{confirmBtnLabel:"Yes",cancelBtnLabel:"No"});c?await this.printOrders(t):await this.closeModal(t)}},async closeModal(e){await m["modalController"].dismiss(e)},async printOrders(e){const t=new y["a"];await e.forEach(async e=>{const o="lab/labels/order?order_id="+e.order_id;await t.printLbl(o)}),await m["modalController"].dismiss(e)}},computed:{isOrderComplete(){return this.extendedLabsEnabled?!!this.testTypes[this.activeIndex]["reason"]:(this.testTypes[this.activeIndex]["specimenConcept"]||this.testTypes[this.activeIndex]["specimen"])&&this.testTypes[this.activeIndex]["reason"]},selectedOrders(){return this.testTypes.filter(e=>!0===e.isChecked)},finalOrders(){return this.selectedOrders.filter(e=>e.reason&&(e.specimen&&!this.extendedLabsEnabled||this.extendedLabsEnabled))}},mounted(){this.getActivities()},data(){return{content:"Content",extendedLabsEnabled:!1,appActivities:[],testTypes:[],specimens:[],reasons:["Routine","Targeted","Confirmatory","Stat","Repeat / Missing"],activeIndex:null}},components:{IonButton:m["IonButton"],IonContent:m["IonContent"],IonHeader:m["IonHeader"],IonTitle:m["IonTitle"],IonToolbar:m["IonToolbar"],IonLabel:m["IonLabel"],IonList:m["IonList"],IonItem:m["IonItem"],IonCheckbox:m["IonCheckbox"],IonRadioGroup:m["IonRadioGroup"],IonRow:m["IonRow"]}}),g=(o("6dc9"),o("d959")),I=o.n(g);const C=I()(k,[["render",j],["__scopeId","data-v-9adaf5e2"]]);t["a"]=C},d717:function(e,t,o){},e614:function(e,t,o){"use strict";o.r(t);var c=o("7a23");const n=Object(c["withScopeId"])("data-v-356b70ce");Object(c["pushScopeId"])("data-v-356b70ce");const a={class:"view-port-content"},s={class:"his-sm-text"},r=Object(c["createVNode"])("tr",null,[Object(c["createVNode"])("th",null,"Accession #"),Object(c["createVNode"])("th",null,"Test Name"),Object(c["createVNode"])("th",null,"Specimen"),Object(c["createVNode"])("th",null,"Ordered"),Object(c["createVNode"])("th",null,"Result"),Object(c["createVNode"])("th",null,"Released"),Object(c["createVNode"])("th",null,"Given")],-1),l=Object(c["createVNode"])("br",null,null,-1);Object(c["popScopeId"])();const i=n((function(e,t,o,i,d,b){const u=Object(c["resolveComponent"])("ion-button"),p=Object(c["resolveComponent"])("view-port");return Object(c["openBlock"])(),Object(c["createBlock"])(p,null,{default:n(()=>[Object(c["createVNode"])("div",a,[Object(c["createVNode"])("table",s,[r,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.rows,(t,o)=>(Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:o},[Object(c["createVNode"])("td",null,[Object(c["createVNode"])(u,{color:"light",fill:"none",onClick:o=>e.printOrder(t)},{default:n(()=>[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t.accession_number),1)]),_:2},1032,["onClick"])]),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.test_name),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.specimen),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.ordered),1),Object(c["createVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(t.result,(e,t)=>(Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:t},[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e)+" ",1),l]))),128))]),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.released),1),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("span",{style:"color: "+("Yes"===t.result_given?"green;":"black;")},Object(c["toDisplayString"])(t.result_given),5)])]))),128))])])]),_:1})}));var d=o("0a79"),b=o("8a30"),u=o("c4e4"),p=o("2ef0"),O=o("51c8"),j=o("9283"),m=o("b5e4"),h=Object(c["defineComponent"])({components:{ViewPort:d["a"],IonButton:b["IonButton"]},mixins:[O["default"]],data:()=>({HisDate:j["c"],rows:[]}),methods:{async init(){this.$emit("onFieldActivated",this);const e=await this.options(this.fdata),t=e[0].other.values;this.rows=t.map(e=>(e.id=e.order_id,e.ordered&&(e.ordered=j["c"].toStandardHisDisplayFormat(e.ordered)),e.released&&(e.released=j["c"].toStandardHisDisplayFormat(e.released)),e))},async printOrder(e){var t;if("function"===typeof(null===(t=this.config)||void 0===t?void 0:t.printOrder)){const t=await Object(m["a"])(`Do you want to print order with accession number ${e.accession_number}?`);t&&this.config.printOrder(e.id)}},formatOrders(e){return e.map(e=>({id:e.order_id,encounter_id:e.encounter_id,result_given:e.result_given,accession_number:e.accession_number,test_name:e.tests[0].name,specimen:e.specimen.name,ordered:j["c"].toStandardHisDisplayFormat(e.order_date),result:[],release:""}))},async launchOrderSelection(e=null){const t=await b["modalController"].create({component:u["a"],backdropDismiss:!1,cssClass:"large-modal",componentProps:{testFilters:e}});t.present();const{data:o}=await t.onDidDismiss();Object(p["isEmpty"])(o)||(this.rows=[...this.formatOrders(o),...this.rows])}},mounted(){this.init()},activated(){this.init()}}),v=(o("bc14"),o("d959")),f=o.n(v);const y=f()(h,[["render",i],["__scopeId","data-v-356b70ce"]]);t["default"]=y}}]);
//# sourceMappingURL=TouchFormElement30.af73bae9.js.map