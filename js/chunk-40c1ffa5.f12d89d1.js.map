{"version":3,"sources":["webpack:///./src/apps/OPD/views/encounters/Complaints.vue?3254","webpack:///./src/apps/OPD/views/encounters/Complaints.vue?e920","webpack:///./src/apps/OPD/views/encounters/Complaints.vue","webpack:///./src/apps/OPD/views/encounters/Complaints.vue?e7d2"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","cancelDestinationPath","cancelDestination","fields","onFinishAction","onSubmit","skipSummary","_","defineComponent","components","HisStandardForm","IonPage","mixins","EncounterMixinVue","data","complaintsService","todaysDate","ObservationService","getSessionDate","presentingComplaints","watch","ready","handler","isReady","PatientComplaintsService","patientID","providerID","getFields","immediate","deep","methods","computedData","Promise","all","complaints","createEncounter","saveObservationList","nextTask","launchOrderSelection","modalController","create","component","LabOrderModal","backdropDismiss","cssClass","modal","present","onDidDismiss","getTriagePresentingComplaints","fetchLatestTriageEncounter","length","EncounterService","getEncounters","encounters","todayPresentingComplaints","filter","el","type","name","HisDate","toStandardHisFormat","encounter_datetime","observations","buildResults","columns","group","rows","this","map","item","obs_group_id","value_text","undefined","label","value","other","id","helpText","condition","FieldType","TT_TABLE_VIEWER","options","d","config","hiddenFooterBtns","TT_COMPLAINTS_PICKER","validation","Validation","required","computedValue","option","buildValueCoded","parent","buildValueCodedFromConceptId","concept_id","child","footerBtns","size","slot","color","visible","onClick","visibleOnStateChange","state","index","TT_SUMMARY","b","buildSummaryResults","OPDComplaint","triageComplaint","concat","__exports__"],"mappings":"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","file":"js/chunk-40c1ffa5.f12d89d1.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Complaints.vue?vue&type=style&index=0&id=4c5e1fda&lang=css\"","import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_his_standard_form, {\n        cancelDestinationPath: _ctx.cancelDestination,\n        fields: _ctx.fields,\n        onFinishAction: _ctx.onSubmit,\n        skipSummary: true\n      }, null, 8, [\"cancelDestinationPath\", \"fields\", \"onFinishAction\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from 'vue'\nimport HisStandardForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport EncounterMixinVue from '@/views/EncounterMixin.vue';\nimport { PatientComplaintsService } from \"@/apps/OPD/services/patient_complaints_service\";\nimport LabOrderModal from \"@/components/DataViews/LabOrderModal.vue\"\nimport Validation from '@/components/Forms/validations/StandardValidations';\nimport { Field, Option } from '@/components/Forms/FieldInterface';\nimport { FieldType } from '@/components/Forms/BaseFormElements';\nimport { modalController, IonPage } from '@ionic/vue';\nimport { ObservationService } from \"@/services/observation_service\"\nimport { EncounterService } from '@/services/encounter_service'\nimport HisDate from \"@/utils/Date\"\n\nexport default defineComponent({\n  components: { HisStandardForm, IonPage },\n  mixins: [EncounterMixinVue],\n  data: () => ({\n    complaintsService: {} as any,\n    todaysDate: ObservationService.getSessionDate(),\n    presentingComplaints: \"\" as any,\n  }),\n  watch: {\n    ready: {\n      async handler(isReady: boolean) {\n        if(isReady){\n          this.complaintsService = new PatientComplaintsService(this.patientID, this.providerID)\n          this.fields = this.getFields()\n        }\n      },\n      immediate: true,\n      deep: true\n    }\n  },\n  methods: {\n    async onSubmit(_: any, computedData: any){     \n      const data = await Promise.all(computedData.complaints)   \n      await this.complaintsService.createEncounter()    \n      await this.complaintsService.saveObservationList(data)\n      this.nextTask()        \n    },\n    async launchOrderSelection() {\n      const modal = await modalController.create({\n        component: LabOrderModal,\n        backdropDismiss: false,\n        cssClass: 'large-modal'\n      })\n      modal.present()\n      await modal.onDidDismiss()\n    },\n    async getTriagePresentingComplaints(){\n      const data =  await this.complaintsService.fetchLatestTriageEncounter();\n      if(!(data.length > 0)){ return false;}\n\n      const encounters = await EncounterService.getEncounters(this.patientID, this.todaysDate)\n      const todayPresentingComplaints = encounters.filter(function (el: any){\n        return el.type.name == \"TRIAGE PRESENTING COMPLAINTS\" &&\n        HisDate.toStandardHisFormat(el.encounter_datetime) == ObservationService.getSessionDate() \n      });\n      if(!(todayPresentingComplaints.length > 0)) {return false;}\n\n      this.presentingComplaints =   todayPresentingComplaints[0].observations;\n      return true;\n    },\n    buildResults() {\n      const columns = [ 'Group','Presenting complaints'];\n      let group = \"\";\n      let rows =this.presentingComplaints.map((item: any) =>{\n        if(item.obs_group_id != null)\n          return [group,item.value_text]\n\n        group = item.value_text;\n      });\n      rows = rows.filter((el: any) =>{\n        return el != undefined\n      })\n      this.presentingComplaints = rows;\n      return [\n        {\n          label: '',\n          value: '',\n          other: { columns, rows},\n        },\n      ];\n    },\n\n    getFields(): Array<Field>{\n      return [\n        {\n          id: \"triage_complaints\",\n          helpText: \"Triaging Complaints\",\n          condition: () => this.getTriagePresentingComplaints(),\n          type: FieldType.TT_TABLE_VIEWER,\n          options: (d: any) => this.buildResults(),\n          config: {\n            hiddenFooterBtns: [\"Clear\"],\n          },\n        },\n        {\n          id: 'complaints',\n          helpText: 'Presenting Complaints',\n          type: FieldType.TT_COMPLAINTS_PICKER,\n          validation: (data: any) => Validation.required(data),\n          computedValue: (options: Option[]) => {\n            return options.map(async (option)=> ({\n              ...(await this.complaintsService.buildValueCoded('Presenting complaint', option.other.parent)),\n              child: (await this.complaintsService.buildValueCodedFromConceptId(option.other.parent, option.other.concept_id))\n            }))\n          },\n          config: {\n            footerBtns: [\n              {\n                name: \"Lab Order\",\n                size: \"large\",\n                slot: \"end\",\n                color: \"primary\",\n                visible: true,\n                onClick: async () => await this.launchOrderSelection(),\n                visibleOnStateChange: (state: Record<string, any>) => {\n                  return state.index === 1;\n                },\n              },\n            ],\n          }\n        },\n        {\n          id: \"all_presenting_complaints\",\n          helpText: \"Summary\",\n          condition: () => this.presentingComplaints.length > 0,\n          type: FieldType.TT_SUMMARY,\n          options: (d: any, b: any) => this.buildSummaryResults(d),\n          config: {\n            hiddenFooterBtns: [\"Clear\"],\n          },\n        },\n      ]\n    },\n    buildSummaryResults(data: any) {\n      const OPDComplaint = data.complaints.map((value: any)=>{\n        return {\n          'label': \"OPD Complaints\",\n          'value': value.label,\n        };\n      })\n      const triageComplaint = this.presentingComplaints.map((value: any)=>{\n        return {\n          'label': 'Triaging Complaints',\n          'value': value[1],\n        };\n      })\n      return OPDComplaint.concat(triageComplaint);\n    }\n  }\n})\n","import { render } from \"./Complaints.vue?vue&type=template&id=4c5e1fda&ts=true\"\nimport script from \"./Complaints.vue?vue&type=script&lang=ts\"\nexport * from \"./Complaints.vue?vue&type=script&lang=ts\"\n\nimport \"./Complaints.vue?vue&type=style&index=0&id=4c5e1fda&lang=css\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}