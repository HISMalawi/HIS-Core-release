(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-81e27120"],{"2d5a":function(e,t,o){},"810f":function(e,t,o){"use strict";o("2d5a")},"857e":function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c={class:"his-card"};function i(e,t,o,i,r,n){const l=Object(a["resolveComponent"])("ion-title"),s=Object(a["resolveComponent"])("ion-toolbar"),b=Object(a["resolveComponent"])("barcode-input"),u=Object(a["resolveComponent"])("ion-header"),d=Object(a["resolveComponent"])("ion-label"),O=Object(a["resolveComponent"])("ion-item"),j=Object(a["resolveComponent"])("ion-col"),p=Object(a["resolveComponent"])("ion-text"),x=Object(a["resolveComponent"])("ion-row"),N=Object(a["resolveComponent"])("ion-grid"),v=Object(a["resolveComponent"])("ion-content"),f=Object(a["resolveComponent"])("ion-button"),h=Object(a["resolveComponent"])("ion-footer"),y=Object(a["resolveComponent"])("ion-page");return Object(a["openBlock"])(),Object(a["createBlock"])(y,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(u,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{color:"light"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(l,{class:"ion-text-center his-md-text"},{default:Object(a["withCtx"])(()=>{var t;return[Object(a["createElementVNode"])("b",null,Object(a["toDisplayString"])((null===(t=e.kits[e.activeIndex])||void 0===t?void 0:t.kitName)||"-"),1)]}),_:1})]),_:1}),Object(a["createVNode"])(s,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{style:{margin:"0px auto",width:"90%"},onOnScan:e.onScan},null,8,["onOnScan"])]),_:1})]),_:1}),Object(a["createVNode"])(v,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(N,null,{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.kits,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])(x,{onClick:()=>e.activeIndex=o,class:Object(a["normalizeClass"])(e.activeIndex===o?"his-card active":""),key:o},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(j,{size:"4"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",c,[Object(a["createVNode"])(O,{lines:"none"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Kit name ")]),_:1}),Object(a["createVNode"])(d,{slot:"end"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("b",null,Object(a["toDisplayString"])(t.kitName),1)]),_:2},1024)]),_:2},1024)])]),_:2},1024),Object(a["createVNode"])(j,{size:"4"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])(["his-card",t.expiryDate&&!t.lotNo?"error":""])},[Object(a["createVNode"])(O,{onClick:t=>e.updateLot(o),lines:"none"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Lot No. ")]),_:1}),Object(a["createVNode"])(d,{slot:"end"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("b",null,Object(a["toDisplayString"])(t.lotNo),1)]),_:2},1024)]),_:2},1032,["onClick"])],2)]),_:2},1024),Object(a["createVNode"])(j,{size:"4"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])(["his-card",!t.expiryDate&&t.lotNo?"error":""])},[Object(a["createVNode"])(O,{onClick:t=>e.updateExpiryDate(o),lines:"none"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Expiry Date ")]),_:1}),Object(a["createVNode"])(d,{color:t.expiryDateError?"danger":"",slot:"end"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("b",null,Object(a["toDisplayString"])(t.expiryDate),1)]),_:2},1032,["color"])]),_:2},1032,["onClick"]),t.expiryDateError?(Object(a["openBlock"])(),Object(a["createBlock"])(p,{key:0,color:"danger",class:"ion-text-center"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.expiryDateError),1)]),_:2},1024)):Object(a["createCommentVNode"])("",!0)],2)]),_:2},1024)]),_:2},1032,["onClick","class"]))),128))]),_:1})]),_:1}),Object(a["createVNode"])(h,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{color:"light"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(f,{onClick:e.clear,slot:"end",color:"warning",size:"large"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Clear ")]),_:1},8,["onClick"]),Object(a["createVNode"])(f,{onClick:e.save,disabled:!e.canFinish||e.hasErrors,slot:"end",color:"success",size:"large"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Finish ")]),_:1},8,["onClick","disabled"])]),_:1})]),_:1})]),_:1})}var r=o("d867"),n=o("efaf"),l=o("c731"),s=o("d95e"),b=o("b5e4"),u=o("afbc"),d=o("cd10"),O=o("1c74"),j=Object(a["defineComponent"])({components:{IonGrid:r["p"],IonCol:r["m"],IonRow:r["I"],IonPage:r["D"],IonTitle:r["S"],IonHeader:r["q"],IonToolbar:r["T"],IonContent:r["n"],IonFooter:r["o"],IonButton:r["d"],BarcodeInput:n["a"],IonItem:r["w"],IonLabel:r["x"],IonText:r["P"]},setup(){const{kits:e,initKits:t,saveKits:o}=Object(d["b"])(),c=Object(a["ref"])(),i=Object(a["ref"])(!1),r=Object(a["computed"])(()=>e.value.some(t=>!t.lotNo&&t.expiryDate||!t.expiryDate&&t.lotNo||e.value.some(e=>e.expiryDateError))),n=()=>{e.value.forEach(e=>(e.expiryDate&&new Date(e.expiryDate)<=new Date(O["e"].getSessionDate())?e.expiryDateError="Kit has expired!!":e.expiryDateError="",e))};function j(t){Object(l["b"])({id:"lot",helpText:e.value[t].kitName+" Lot No.",type:s["b"].TT_TEXT,defaultValue:()=>e.value[t].lotNo},o=>{const a=(null===o||void 0===o?void 0:o.value)||"";e.value[t].lotNo=a})}function p(t){Object(l["b"])({id:"expiry",helpText:e.value[t].kitName+" Expiry Date",type:s["b"].TT_FULL_DATE,defaultValue:()=>e.value[t].expiryDate},o=>{const a=(null===o||void 0===o?void 0:o.value)||"";e.value[t].expiryDate=a,n()})}function x(t){e.value[c.value].lotNo=t,e.value[c.value].expiryDate||p(c.value)}async function N(){await Object(b["a"])("Are you sure you want to clear everything?")&&(e.value.forEach(e=>{e.expiryDate="",e.lotNo="",e.expiryDateError=""}),c.value=null)}async function v(){if(n(),r.value)return Object(b["e"])("Some kits have errors! please fix them below");if(!e.value.every(e=>!(e.lotNo&&e.expiryDate))||await Object(b["a"])("Do you want to continue without updating test kits?")){i.value=!1;try{return await o(),Object(b["d"])("Testkits updated!"),u["a"].back()}catch(t){console.error(""+t),Object(b["c"])("General error has occured!")}i.value=!0}}return Object(a["onMounted"])(()=>t().then(()=>{n(),i.value=!0})),{kits:e,activeIndex:c,hasErrors:r,canFinish:i,save:v,onScan:x,updateLot:j,updateExpiryDate:p,clear:N}}}),p=(o("810f"),o("6b0d")),x=o.n(p);const N=x()(j,[["render",i],["__scopeId","data-v-432125f4"]]);t["default"]=N},cd10:function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"b",(function(){return l}));var a,c=o("1c74"),i=o("2ef0"),r=o("7a23"),n=o("85d6");function l(){const e=Object(r["ref"])([]),{getUserProp:t,setUserProp:o}=Object(n["a"])(),l=async()=>{try{const e=await t("HTS_PROGRAMS");return(""+(e||"")).split(",").map(e=>e.trim())}catch(e){console.error(""+e)}return[]},s=async()=>{const o=[{kitName:a.UNIGOLD,lotNo:"",expiryDate:"",testGroup:"profession_hiv_kit",visible:!0,userProp:"HIV Test"},{kitName:a.DETERMINE,lotNo:"",expiryDate:"",testGroup:"profession_hiv_kit",visible:!0,userProp:"HIV Test"},{kitName:a.BIOLINE,lotNo:"",expiryDate:"",testGroup:"profession_hiv_kit",visible:!0,userProp:"HIV Test"},{kitName:a.HIV_SELF_KIT,lotNo:"",expiryDate:"",visible:!0},{kitName:a.SYPHILIS,lotNo:"",expiryDate:"",visible:!0,userProp:"Syphilis Test"},{kitName:a.HEPATITIS,lotNo:"",expiryDate:"",visible:!0,userProp:"Hepatitis B Test"}];try{const c=await l(),r=await t(a.TEST_KIT_USER_PROPERTY),n=JSON.parse(r||"");o.forEach(e=>{e.userProp&&!Object(i["isEmpty"])(c)&&(e.visible=c.includes(e.userProp));const t=Object(i["find"])(n,{kitName:e.kitName});t&&(e.lotNo=t.lotNo,e.expiryDate=t.expiryDate)}),e.value=o.filter(e=>e.visible)}catch(c){e.value=o,console.error(""+c)}},b=t=>{const o=Object(i["find"])(e.value,{kitName:t});return o?new Date(o.expiryDate)<=new Date(c["e"].getSessionDate())?"":o.lotNo:""},u=t=>{const o=Object(i["find"])(e.value,{kitName:t});return o?new Date(o.expiryDate)<=new Date(c["e"].getSessionDate())?"":o.expiryDate:""},d=()=>o(a.TEST_KIT_USER_PROPERTY,JSON.stringify(e.value));return{kits:e,initKits:s,saveKits:d,getLotNo:b,getExpiryDate:u}}(function(e){e["TEST_KIT_USER_PROPERTY"]="hts_user_assigned_kits",e["HIV_SELF_KIT"]="HIV self-kit",e["SYPHILIS"]="Syphilis",e["HEPATITIS"]="Hepatitis B",e["BIOLINE"]="Bioline",e["DETERMINE"]="Determine",e["UNIGOLD"]="Unigold"})(a||(a={}))}}]);
//# sourceMappingURL=chunk-81e27120.2323824f.js.map