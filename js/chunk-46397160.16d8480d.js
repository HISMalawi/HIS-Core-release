(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46397160"],{7920:function(e,t,o){"use strict";var i=o("7a23");function n(e,t,o,n,s,a){return Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(e.formType),{fields:e.fields,skipSummary:e.skipSummary,activeField:e.activeField,cancelDestinationPath:e.cancelDestinationPath,onOnFinish:e.onFinish,onFinish:e.onFinishAction,onOnIndex:e.onIndex},null,40,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var s=o("9441"),a=Object(i["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:s["a"]},emits:["onFinish","onIndex"],data:()=>({formType:"touch-screen-form"}),props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish(e,t){this.$emit("onFinish",e,t)},onIndex(e){this.$emit("onIndex",e)}}}),r=o("6b0d"),c=o.n(r);const l=c()(a,[["render",n]]);t["a"]=l},f49b:function(e,t,o){"use strict";o.r(t);var i=o("7a23");function n(e,t,o,n,s,a){const r=Object(i["resolveComponent"])("his-standard-form");return Object(i["openBlock"])(),Object(i["createBlock"])(r,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0},null,8,["fields","onFinishAction"])}o("13d5");var s=o("d95e"),a=o("7920"),r=o("2706"),c=o("3800"),l=o("156d"),u=o("7f35"),d=o("b5e4"),p=o("d867");const h="network_presets";var m=Object(i["defineComponent"])({components:{HisStandardForm:a["a"]},methods:{onFinish(){this.$router.back()},usingCustomIp(e){var t,o;return null===(t=e.presets)||void 0===t||!t.value||/custom/i.test(""+(null===(o=e.presets)||void 0===o?void 0:o.value))},uniqueNetworkPresets(e){const t=e.reduce((e,t)=>({...e,[(""+t.site).trim().toUpperCase()]:t}),{});return Object.keys(t).map(e=>t[e])},async runHealthCheck(e,t,o){const i=await p["Y"].create({message:"Please wait...",backdropDismiss:!1});await i.present(),l["b"].setLocalStorage(e,t,o);const n=await l["b"].healthCheck();if(p["Y"].dismiss(),!n||200!==n.status||!n){try{const e=await l["b"].expandPath("_health");Object(d["e"])("Unable to connect to: "+e)}catch(s){console.warn(s)}return this.clearLocalStorage(),!1}return!0},getFields(){this.fields=[{id:"presets",helpText:"Network sites",type:s["b"].TT_SELECT,init:async()=>{this.networkSites=JSON.parse(localStorage.getItem(h)||"[]");try{const e=await fetch("/config.json");if(e.ok){const t=await e.json();this.networkSites=this.uniqueNetworkPresets(((null===t||void 0===t?void 0:t.networkSites)||[]).concat(this.networkSites))}}catch(e){console.error(e)}return!0},beforeNext:async e=>{if("custom"!=e.value){const{protocol:t,ip:o,port:i}=e.other;return await this.runHealthCheck(t,o,i)}return!0},isRequired:()=>!0,condition:()=>this.networkSites.length,options:()=>[...this.networkSites.map(e=>({label:e.site,value:e.ip,other:e})),{label:"Custom Configuration",value:"custom"}]},{id:"protocol",helpText:"Select Protocol",type:s["b"].TT_SELECT,requireNext:!1,validation:e=>r["a"].required(e),condition:e=>this.usingCustomIp(e),options:()=>[{label:"HTTP",value:"http"},{label:"HTTPS",value:"https"}]},{id:"ip_address",helpText:"Enter IP Address",type:s["b"].TT_IP_ADDRESS,condition:e=>this.usingCustomIp(e),validation:e=>r["a"].required(e)||r["a"].isIPAddress(e)},{id:"port",helpText:"Enter Port",beforeNext:async(e,t)=>{const o=t.protocol.value,i=t.ip_address.value,n=t.port.value;return await this.runHealthCheck(o,i,n)},condition:e=>this.usingCustomIp(e),validation:e=>r["a"].required(e),type:s["b"].TT_TEXT,config:{customKeyboard:[c["j"],[["Delete"]]]}},{id:"to_save_host",helpText:"Host preset",type:s["b"].TT_YES_NO,isRequired:()=>!0,condition:e=>this.usingCustomIp(e),options:()=>[{label:"Do you want to save this configuration preset?",values:[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]}]},{id:"configuration_name",helpText:"Configuration name",type:s["b"].TT_TEXT,condition:e=>"Yes"===e.to_save_host,isRequired:()=>!0,beforeNext:(e,t)=>{const o=this.networkSites.concat([{site:e.label,ip:t.ip_address.value,protocol:t.protocol.value,port:t.port.value}]);return localStorage.setItem(h,JSON.stringify(this.uniqueNetworkPresets(o))),!0}}]},async showConfigNotice(){if(this.isUsingLocalStorage()){const e=await Object(u["a"])("Config notice","The system is currently using user specified configurations.                 Do you wish to reset back to server configurations?","",[{name:"Reset configurations",slot:"start",color:"success"},{name:"New configurations",slot:"end"}]);"Reset configurations"===e&&(this.clearLocalStorage(),this.$router.back())}},isUsingLocalStorage(){return"true"===localStorage.getItem("useLocalStorage")},clearLocalStorage(){const e=["useLocalStorage","apiURL","apiPort","apiProtocol"];l["b"].removeOnly(e)}},data(){return{networkSites:[],fields:[]}},async mounted(){await this.showConfigNotice(),this.getFields()}}),f=o("6b0d"),b=o.n(f);const g=b()(m,[["render",n]]);t["default"]=g}}]);
//# sourceMappingURL=chunk-46397160.16d8480d.js.map