{"version":3,"sources":["webpack:///./src/apps/ART/services/reports/disaggregated_service.ts","webpack:///./src/apps/ART/services/reports/patient_report_service.ts","webpack:///./src/apps/ART/services/reports/moh_cohort_service.ts","webpack:///./src/apps/ART/views/reports/pepfar/disaggregated.vue?9226","webpack:///./src/apps/ART/views/reports/pepfar/disaggregated.vue","webpack:///./src/apps/ART/views/reports/pepfar/disaggregated.vue?c084"],"names":["DisaggregatedReportService","ArtReportService","constructor","super","this","gender","ageGroup","AGE_GROUPS","initialize","rebuildOutcome","req","getCohort","temp_disaggregated","setAgeGroup","setInitialization","isInit","setRebuildOutcome","isRebuild","setGender","getGender","getReport","getTxIpt","getTxCurrTB","getRegimenDistribution","PatientReportService","getBookedAppointments","date","getJson","programID","getViralLoadResults","range","getOtherOutcome","outcome","getPatientVisitTypes","getClientsDueForVl","getClientRentention","getExternalConsultationClients","getMissedAppointments","getPregnantWomen","getArchivingCandidates","CohortVar","MohCohortReportService","regenerate","cohortUrl","setRegenerate","getCohortDrillDown","resourceId","id","requestCohort","params","ajxGet","qaurterRequestParams","name","quarter","datePeriodRequestParams","startDate","endDate","getCachedCohortValues","cache","sessionStorage","getItem","MOH_CACHE","conf","JSON","parse","start_date","end_date","data","cacheCohort","values","setItem","stringify","validateIndicators","validations","callback","cachedValues","errors","Object","keys","reduce","key","indicator","find","validation","indicatorValue","contents","param","condition","check","parseInt","push","error","render","_ctx","_cache","$props","$setup","$data","$options","_component_report_template","_resolveComponent","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","title","period","rows","fields","columns","reportPrefix","config","showIndex","validationErrors","showValidationStatus","canValidate","hasServerSideCaching","headerInfoList","headerList","onReportConfiguration","onPeriod","_","defineComponent","mixins","ReportMixin","components","ReportTemplate","IonPage","table","thTxt","thNum","REGIMENS","map","r","rowDataRefs","dataRefLabels","aggregations","mohCohort","maleFemaleAgeGroupData","sortIndexes","initiated","created","getDateDurationFields","computed","sort","a","b","i","concat","watch","doIt","validateReport","methods","rebuildCache","report","setQuarter","setStartDate","setEndDate","getDateIntervalPeriod","init","toastWarning","setTableRows","setHeaderInfoList","getTotals","compareFunction","filter","items","item","addAggregation","col","group","totals","row","distribution","refs","forEach","drill","totalAlive","match","label","value","length","other","onclick","runTableDrill","setFemaleRows","setMaleRows","setTotalMalesRow","setFemalePregnantRows","setFemaleBreastFeedingRows","setFemaleNotPregnantRows","getColumnLabel","prop","res","sortIndex","maleTD","column","columnDescription","accum","cur","columnName","td","isPregnant","patientID","includes","fnpTD","setRows","category","ageGroups","otherAgeGroup","txNew","txCurr","txGivenIpt","txScreenTB","cohort","isEmpty","getValue","formatGender","getRegimenRows","p","s","__exports__"],"mappings":"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","file":"js/chunk-3526ee86.0cb8193d.js","sourcesContent":["import { ArtReportService } from \"./art_report_service\";\nimport { AGE_GROUPS } from \"./patient_report_service\";\n\nexport class DisaggregatedReportService extends ArtReportService {\n    gender: string;\n    ageGroup: string;\n    initialize: boolean;\n    rebuildOutcome: boolean;\n\n    constructor() {\n        super()\n        this.gender = ''\n        this.ageGroup = AGE_GROUPS[0]\n        this.initialize = true\n        this.rebuildOutcome = true\n    }\n\n    async init() {\n        this.initialize = true\n        const req = await this.getCohort()\n        if (req && req.temp_disaggregated === 'created') {\n            this.initialize = false\n            return true\n        }\n        return false\n    }\n\n    setAgeGroup(ageGroup: string) {\n        this.ageGroup = ageGroup\n    }\n\n    setInitialization(isInit: boolean) {\n        this.initialize = isInit\n    }\n\n    setRebuildOutcome(isRebuild: boolean) {\n        this.rebuildOutcome = isRebuild\n    }\n\n    setGender(gender: string) {\n        this.gender = gender\n    }\n\n    getGender() {\n        return this.gender\n    }\n\n    getCohort() {\n        return this.getReport('cohort_disaggregated', {\n            'age_group': `${this.ageGroup}`,\n            'rebuild_outcome': `${this.rebuildOutcome}`,\n            'initialize': `${this.initialize}`\n        })\n    }\n\n    getTxIpt() {\n        return this.getReport('clients_given_ipt', { \n            'gender': this.gender, 'age_group': `${this.ageGroup}` \n        })\n    }\n\n    getTxCurrTB() {\n        return this.getReport('screened_for_tb', { \n            'gender': this.gender, 'age_group': `${this.ageGroup}` \n        })\n    }\n\n    getRegimenDistribution() {\n        return this.getReport('disaggregated_regimen_distribution', {\n            'gender': `${this.gender}`, 'age_group': `${this.ageGroup}`\n        })\n    }\n}\n","import { ArtReportService } from \"./art_report_service\";\n\nexport const AGE_GROUPS = [\n    '<1 year',\n    '1-4 years', \n    '5-9 years', \n    '10-14 years', \n    '15-19 years', \n    '20-24 years', \n    '25-29 years', \n    '30-34 years', \n    '35-39 years', \n    '40-44 years', \n    '45-49 years', \n    '50-54 years',\n    '55-59 years',\n    '60-64 years',\n    '65-69 years',\n    '70-74 years',\n    '75-79 years',\n    '80-84 years',\n    '85-89 years',\n    '90 plus years'\n]\n\nexport class PatientReportService extends ArtReportService {\n    constructor() {\n        super()\n    }\n    \n    getBookedAppointments(date: string) {\n        return ArtReportService.getJson(`programs/${this.programID}/scheduled_appointments`, { date })\n    }\n\n    getViralLoadResults(range: string) {\n        return this.getReport(`/programs/${this.programID}/reports/high_vl_patients`, { range })\n    }\n\n    getOtherOutcome(outcome: string) {\n        return this.getReport('patient_outcome_list', { outcome })\n    }\n\n    getPatientVisitTypes() {\n        return this.getReport('patient_visit_types')\n    }\n\n    getClientsDueForVl() {\n        return this.getReport('clients_due_vl')\n    }\n\n    getClientRentention() {\n        return this.getReport(`/programs/${this.programID}/reports/retention`)\n    }\n\n    getExternalConsultationClients() {\n        return this.getReport(`${this.programID}/external_consultation_clients`)\n    }\n\n    getMissedAppointments() {\n        return this.getReport('missed_appointments')\n    }\n\n    getPregnantWomen() {\n        return this.getReport(`/programs/${this.programID}/reports/pregnant_patients`)\n    }\n\n    getArchivingCandidates() {\n        return ArtReportService.getJson(`programs/${this.programID}/reports/archiving_candidates`, { \n            'start_date': this.date\n        })\n    }\n}\n","import { find } from \"lodash\";\nimport { ArtReportService } from \"./art_report_service\";\n\nexport enum CohortVar {\n    MOH_CACHE = 'mohCache'\n}\n\nexport interface CohortValidationInterface {\n    param: number | string;\n    error: (indicator: number, param: number) => string;\n    check: (indicator: number, param: number) => boolean;\n}\n\nexport class MohCohortReportService extends ArtReportService {\n    regenerate: boolean;\n    constructor() {\n        super()\n        this.regenerate = false\n    }\n\n    private cohortUrl() {\n        return `programs/${this.programID}/reports/cohort`\n    }\n\n    setRegenerate(regenerate: boolean) {\n        this.regenerate = regenerate\n    }\n\n    getCohortDrillDown(resourceId: string) {\n        return ArtReportService.getJson('cohort_report_drill_down', {\n            id: resourceId,\n            date: this.date,\n            'program_id': this.programID\n        })\n    }\n\n    requestCohort(params: any) {\n        return ArtReportService.ajxGet(\n            this.cohortUrl(), params\n        )\n    }\n\n    qaurterRequestParams() {\n        return { \n            name: this.quarter, \n            regenerate: this.regenerate \n        }\n    }\n\n    datePeriodRequestParams() {\n        return {\n            name: `Cohort-${this.startDate}-${this.endDate}`,\n            'start_date': this.startDate,\n            'end_date': this.endDate,\n            regenerate: this.regenerate\n        }\n    }\n\n    getCachedCohortValues() {\n        const cache = sessionStorage.getItem(CohortVar.MOH_CACHE)\n        if (cache) {\n            const conf = JSON.parse(cache)\n            if (conf.start_date === this.startDate \n                && conf.end_date === this.endDate\n                || conf.quarter === this.quarter) {\n                return conf.data\n            }\n        }\n    }\n\n    cacheCohort(values: any) {\n        sessionStorage.setItem(\n            CohortVar.MOH_CACHE, \n            JSON.stringify({\n                'start_date': this.startDate,\n                'end_date': this.endDate,\n                'quarter': this.quarter,\n                'data': values\n        }))\n    }\n\n    validateIndicators(validations: Record<string, CohortValidationInterface>, callback: Function) {\n        const cachedValues = this.getCachedCohortValues()\n        if (cachedValues) {\n            const errors = Object.keys(validations)\n                .reduce((errors: Array<any>, key: string) => {\n                    const indicator: any = find(cachedValues, { name: key })\n                    const validation: any = validations[key]\n                    const indicatorValue: any = indicator ? indicator.contents : null\n                    const param = validation.param as number\n                    const condition = validation.check(parseInt(indicatorValue), param)\n                    if (condition) errors.push(\n                        validation.error(indicatorValue, param)\n                    )\n                    return errors\n                }, [])\n            return callback(errors)\n        }\n        return -1\n    }\n}\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_report_template = _resolveComponent(\"report-template\")!\n  const _component_ion_page = _resolveComponent(\"ion-page\")!\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_report_template, {\n        title: _ctx.title,\n        period: _ctx.period,\n        rows: _ctx.rows,\n        fields: _ctx.fields,\n        columns: _ctx.columns,\n        reportPrefix: \"PEPFAR\",\n        config: {\n                showIndex: true\n            },\n        validationErrors: _ctx.errors,\n        showValidationStatus: _ctx.canValidate,\n        hasServerSideCaching: true,\n        headerInfoList: _ctx.headerList,\n        onReportConfiguration: _ctx.onPeriod\n      }, null, 8, [\"title\", \"period\", \"rows\", \"fields\", \"columns\", \"validationErrors\", \"showValidationStatus\", \"headerInfoList\", \"onReportConfiguration\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from 'vue'\nimport ReportMixin from \"@/apps/ART/views/reports/ReportMixin.vue\"\nimport ReportTemplate from \"@/apps/ART/views/reports/TableReportTemplate.vue\"\nimport table from \"@/components/DataViews/tables/ReportDataTable\"\nimport { isEmpty } from \"lodash\"\nimport { Option } from '@/components/Forms/FieldInterface'\nimport { IonPage } from \"@ionic/vue\"\nimport { AGE_GROUPS } from \"@/apps/ART/services/reports/patient_report_service\"\nimport { toastWarning } from '@/utils/Alerts'\nimport { MohCohortReportService } from \"@/apps/ART/services/reports/moh_cohort_service\"\nimport { DisaggregatedReportService } from \"@/apps/ART/services/reports/disaggregated_service\"\nimport { REGIMENS } from \"@/apps/ART/services/reports/regimen_report_service\"\n\nexport default defineComponent({\n    mixins: [ReportMixin],\n    components: { ReportTemplate, IonPage },\n    data: () => ({\n        title: 'PEPFAR Disaggregated Report',\n        headerList: [] as Option[],\n        errors: [] as string[],\n        columns: [\n            [\n                table.thTxt('Age group'),\n                table.thTxt('Gender'),\n                table.thNum('Tx new (new on ART)'),\n                table.thNum('TX curr (receiving ART)'),\n                table.thNum('TX curr (received IPT)'),\n                table.thNum('TX curr (screened for TB)'),\n                ...(REGIMENS.map(r => table.thNum(r))),\n                table.thNum('Unknown'),\n                table.thNum('Total (regimen)')\n            ]\n        ],\n        rowDataRefs: [\n            'txNew', \n            'txCurr', \n            'txGivenIpt', \n            'txScreenTB', \n            ...REGIMENS,\n            'N/A', \n            'regimenTotals'\n        ],\n        dataRefLabels: {\n           'txNew': 'Tx new (new on ART)',\n           'txCurr': 'Tx curr (receiving ART)',\n           'txGivenIpt': 'TX curr (received IPT)',\n           'txScreenTB': 'TX curr (screened for TB)',\n           'N/A': 'Unknown',\n           'regimenTotals': 'Regimen Totals'\n        } as any,\n        aggregations: [] as Array<any>,\n        mohCohort: {} as any,\n        maleFemaleAgeGroupData: {} as any,\n        canValidate: false as boolean,\n        sortIndexes: {} as Record<string | number, Array<any>>,\n        initiated: false as boolean\n    }),\n    created() {\n        this.fields = this.getDateDurationFields()\n    },\n    computed: {\n        rows(): Array<any> {\n            return Object.keys(this.sortIndexes)\n                .sort((a, b) => parseInt(a) - parseInt(b))\n                .reduce((r: any, i: any) => r.concat(this.sortIndexes[i]), [])\n        }\n    },\n    watch: {\n        async canValidate(doIt: boolean) {\n            if (doIt) await this.validateReport()\n        }\n    },\n    methods: {\n        async onPeriod(_: any, config: any, rebuildCache=true) {\n            this.errors = []\n            this.maleFemaleAgeGroupData = {}\n            this.sortIndexes = {}\n            this.aggregations = []\n            this.canValidate = false\n            this.report = new DisaggregatedReportService()\n            this.mohCohort = new MohCohortReportService()\n            this.report.setQuarter('pepfar')\n            this.report.setStartDate(config.start_date)\n            this.report.setEndDate(config.end_date)\n            this.mohCohort.setStartDate(config.start_date)\n            this.mohCohort.setEndDate(config.end_date)\n            this.period = this.report.getDateIntervalPeriod()\n            this.report.setRebuildOutcome(!this.initiated || rebuildCache)\n            const isInit = await this.report.init()\n            if (!isInit) {\n                return toastWarning('Unable to initialise report')\n            }\n            await this.setTableRows()\n            this.setHeaderInfoList()\n            this.canValidate = true\n            this.initiated = true\n        },\n        getTotals(compareFunction: Function){\n            return this.aggregations\n                .filter(i => compareFunction(i))\n                .reduce((items, item) => items.concat(item.data), [])\n        },\n        addAggregation(col: string, gender: string, data = []) {\n            this.aggregations.push({ col, gender, data })\n        },\n        async getRegimenRows(group: string, gender: string) {\n            let totals: any = []\n            const row: any = []\n            const distribution = await this.report.getRegimenDistribution()\n            const refs = [...REGIMENS, 'N/A']\n            refs.forEach((i: any) => {\n                if (distribution[i]) totals = totals.concat(distribution[i])\n                row.push(this.drill(distribution[i], `Regimen ${i} | ${group} | ${gender}`))\n                this.addAggregation(i, gender, distribution[i])\n            })\n            row.push(this.drill(totals, `Regimen Totals | ${group} | ${gender}`))\n            this.addAggregation('regimenTotals', gender, totals)\n            return row\n        },\n        setHeaderInfoList() {\n            const totalAlive = this.getTotals((i: any) => i.col === 'txCurr' && i.gender.match(/male|female/i))\n            this.headerList = [\n                { \n                    label: 'Total Alive and on ART', \n                    value: totalAlive.length,\n                    other: {\n                        onclick: () => this.runTableDrill(totalAlive, 'Total Alive and on ART')\n                    }\n                }\n            ]\n        },\n        async setTableRows() {\n            await this.setFemaleRows(1)\n            await this.setMaleRows(2)\n            await this.setTotalMalesRow(3)\n            await this.setFemalePregnantRows(4)\n            await this.setFemaleBreastFeedingRows(6)\n            await this.setFemaleNotPregnantRows(5)\n        },\n        getColumnLabel(col: string) {\n            return col in this.dataRefLabels ? this.dataRefLabels[col] : col\n        },\n        async getValue(prop: string, gender: string, data: any) {\n            let res: any = []\n            switch(prop) {\n                case 'tx_given_ipt':\n                    res = await this.report.getTxIpt()\n                    break;\n                case 'tx_screened_for_tb':\n                    res = await this.report.getTxCurrTB()\n                    break;\n                default:\n                    res = gender in data ? data[gender][prop] : []\n                    break;\n            }\n            return res\n        },\n        setTotalMalesRow(sortIndex: number) {\n            const maleTD = (column: string, columnDescription: string) => {\n                const data = this.aggregations.filter((a: any) => a.gender === 'Male' && a.col === column)\n                    .reduce((accum: any, cur: any) => accum.concat(cur.data), []) \n                return this.drill(data, columnDescription)\n            }\n            const rows: any = this.rowDataRefs.map(columnName => \n                maleTD(columnName, `${this.getColumnLabel(columnName)} | All Male`)\n            )\n            this.sortIndexes[sortIndex] = [[table.td('All'), table.td('Male'), ...rows]]\n        },\n        setFemaleNotPregnantRows(sortIndex: number) {\n            // Gets all pregnant females from a particular column and checks if given patient ID \n            // Is in the list\n            const isPregnant = (patientID: number, column: string) => this.aggregations\n                .filter((a: any) => a.gender.match(/fp|fbf/i) && a.col === column)\n                .reduce((accum: any, cur: any) => accum.concat(cur.data || []), [])\n                .includes(patientID)\n            // Get total sum of all females by a particular column\n            const fnpTD = (column: string, columnDescription: string) => {\n                const data = this.aggregations.filter((a: any) => a.gender === 'Female' && a.col === column)\n                    .reduce((accum: any, cur: any) => accum.concat(cur.data.filter((i: any) => !isPregnant(i, column))), [])\n                return this.drill(data, columnDescription)\n            }\n            const rows: any = this.rowDataRefs.map(column => \n                fnpTD(column, `${this.getColumnLabel(column)} | FNP`)\n            )\n            this.sortIndexes[sortIndex] = [[table.td('All'), table.td('FNP'), ...rows]]\n        },\n        setFemaleRows(sortIndex: number) {\n            this.report.setGender('female')\n            return this.setRows(sortIndex, 'F', AGE_GROUPS, 'Female')\n        },\n        setMaleRows(sortIndex: number) {\n            this.report.setGender('male')\n            return this.setRows(sortIndex, 'M', AGE_GROUPS, 'Male')\n        },\n        setFemalePregnantRows(sortIndex: number) {\n            this.report.setGender('pregnant')\n            return this.setRows(sortIndex, 'F', ['All'], 'FP', 'Pregnant')\n        },\n        setFemaleBreastFeedingRows(sortIndex: number) {\n            this.report.setGender('breastfeeding')\n            return this.setRows(sortIndex, 'F', ['All'], 'FBf', 'Breastfeeding')\n        },\n        async setRows(sortIndex: number, category: string, ageGroups: string[], gender: string, otherAgeGroup='') {\n            for(const i in ageGroups) {\n                let txNew = []\n                let txCurr= []\n                let txGivenIpt = []\n                let txScreenTB = []\n\n                const group = otherAgeGroup || ageGroups[i]\n\n                this.report.setAgeGroup(group)\n\n                if (!(group in this.maleFemaleAgeGroupData)) {\n                    const cohort = await this.report.getCohort()\n                    this.report.setRebuildOutcome(false)\n                    this.maleFemaleAgeGroupData[group] = !isEmpty(cohort) ? cohort[group] : {}\n                }\n\n                if (!isEmpty(this.maleFemaleAgeGroupData[group])) {\n                    const value = (prop: string) => this.getValue(\n                        prop, category, this.maleFemaleAgeGroupData[group]\n                    )\n                    txNew = await value('tx_new')\n                    txCurr= await value('tx_curr')\n                    txGivenIpt = await value('tx_given_ipt')\n                    txScreenTB = await value('tx_screened_for_tb')\n                    this.addAggregation('txNew', gender, txNew)\n                    this.addAggregation('txCurr',gender, txCurr)\n                    this.addAggregation('txGivenIpt',gender, txGivenIpt)\n                    this.addAggregation('txScreenTB',gender, txScreenTB)\n                }\n\n                if (!this.sortIndexes[sortIndex]) this.sortIndexes[sortIndex] = []\n\n                this.sortIndexes[sortIndex].push([\n                    table.td(ageGroups[i]),\n                    table.td(this.formatGender(gender)),\n                    this.drill(txNew, `Tx new (new on ART) | ${group} | ${gender}`),\n                    this.drill(txCurr, `Tx curr (receiving ART) | ${group} | ${gender}`),\n                    this.drill(txGivenIpt, `TX curr (received IPT) | ${group} | ${gender}`),\n                    this.drill(txScreenTB, `TX curr (screened for TB) | ${group} | ${gender}`),\n                    ...(await this.getRegimenRows(group, gender))\n                ])\n            }\n        },\n        validateReport() {\n            const validations: any = {\n                'initiated_on_art_first_time': {\n                    param: this.getTotals((i: any) => i.col === 'txNew' && i.gender.match(/male|female/i)).length,\n                    check: (i: number, p: number) => i != p,\n                    error: (i: number, p: number) => `\n                        MOH cohort initiated on ART first time <b>(${i})</b> is not matching Tx New <b>(${p})</b>\n                    `\n                },\n                'initial_pregnant_females_all_ages': {\n                    param: this.getTotals((i: any) => i.col === 'txNew' && i.gender === 'FP').length,\n                    check: (i: number, p: number) => i != p,\n                    error: (i: number, p: number) => `\n                        MOH cohort initial pregnant females all ages \n                        <b>(${i})</b> is not matching with TX new Pregnant women <b>${p}</b>\n                    `\n                },\n                'males_initiated_on_art_first_time': {\n                    param: this.getTotals((i: any) => i.col === 'txNew' && i.gender === 'Male').length,\n                    check: (i: number, p: number) => i != p,\n                    error: (i: number, p: number) => `\n                        MoH Cohort males initiated on ART first time <b>(${i})</b>\n                        is not matching with TX new All male <b>(${p})</b>\n                    `\n                }\n            }\n            const s = this.mohCohort.validateIndicators(validations, (errors: string[]) => this.errors = errors)\n            if (s === -1) this.errors = ['Report not validated. Run the MoH cohort report for similar reporting period and then run this report']\n        }\n    }\n})\n","import { render } from \"./disaggregated.vue?vue&type=template&id=c8e82cb8&ts=true\"\nimport script from \"./disaggregated.vue?vue&type=script&lang=ts\"\nexport * from \"./disaggregated.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}