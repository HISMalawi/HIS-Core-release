{"version":3,"sources":["webpack:///./src/apps/ART/views/reports/moh/MohDisaggregatedReport.vue?210c","webpack:///./src/apps/ART/views/reports/moh/MohDisaggregatedReport.vue","webpack:///./src/apps/ART/views/reports/moh/MohDisaggregatedReport.vue?2e58","webpack:///./src/apps/ART/services/reports/disaggregated_service.ts","webpack:///./src/apps/ART/services/reports/moh_cohort_service.ts"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_report_template","_resolveComponent","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","title","period","rows","columns","headerInfoList","headerList","reportPrefix","config","showIndex","validationErrors","errors","showValidationStatus","canValidate","hasServerSideCaching","enabledPDFHorizontalPageBreak","onReportConfiguration","onPeriod","onDefaultConfiguration","onLoadDefault","_","defineComponent","mixins","ReportMixin","components","ReportTemplate","IonPage","data","table","thTxt","thNum","REGIMENS","map","r","showStatus","rowDataRefs","dataRefLabels","aggregations","mohCohort","maleFemaleAgeGroupData","sortIndexes","query","this","$route","start_date","end_date","quarter","label","other","start","end","occupation","watch","doIt","validateReport","computed","Object","keys","sort","a","b","parseInt","reduce","i","concat","methods","form","rebuildCache","report","DisaggregatedReportService","MohCohortReportService","setOccupation","setQuarter","setStartDate","setEndDate","getDateIntervalPeriod","setRebuildOutcome","isInit","init","toastWarning","setTableRows","setFemaleRows","setMaleRows","setTotalMalesRow","setFemalePregnantRows","setFemaleBreastFeedingRows","setFemaleNotPregnantRows","getColumnLabel","col","getTotals","compareFunction","filter","accum","cur","addAggregation","gender","push","group","totals","row","distribution","getRegimenDistribution","refs","forEach","drill","getValue","prop","getTxIpt","getTxCurrTB","sortIndex","maleTD","column","columnDescription","columnName","td","isPregnant","patientID","match","includes","fnpTD","setGender","setRows","AGE_GROUPS","category","ageGroups","otherAgeGroup","txNew","txCurr","txGivenIpt","txScreenTB","setAgeGroup","cohort","getCohort","isEmpty","value","async","getGender","formatGender","getRegimenRows","setHeaderInfoList","totalAlive","length","onclick","runTableDrill","validations","param","check","p","error","s","validateIndicators","__exports__","ArtReportService","constructor","super","_defineProperty","ageGroup","initialize","rebuildOutcome","req","temp_disaggregated","setInitialization","isRebuild","getReport","CohortVar","regenerate","cohortUrl","programID","setRegenerate","getCohortDrillDown","resourceId","getJson","id","date","requestCohort","params","ajxGet","qaurterRequestParams","name","datePeriodRequestParams","startDate","endDate","getCachedCohortValues","cache","sessionStorage","getItem","MOH_CACHE","conf","JSON","parse","cacheCohort","values","setItem","stringify","callback","cachedValues","key","indicator","find","validation","indicatorValue","contents","condition"],"mappings":"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","file":"js/chunk-448a8a34.f29695a1.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_report_template = _resolveComponent(\"report-template\")!\n  const _component_ion_page = _resolveComponent(\"ion-page\")!\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_report_template, {\n        title: _ctx.title,\n        period: _ctx.period,\n        rows: _ctx.rows,\n        columns: _ctx.columns,\n        headerInfoList: _ctx.headerList,\n        reportPrefix: \"MoH\",\n        config: {\n                showIndex: true\n            },\n        validationErrors: _ctx.errors,\n        showValidationStatus: _ctx.canValidate,\n        hasServerSideCaching: true,\n        enabledPDFHorizontalPageBreak: true,\n        onReportConfiguration: _ctx.onPeriod,\n        onDefaultConfiguration: _ctx.onLoadDefault\n      }, null, 8, [\"title\", \"period\", \"rows\", \"columns\", \"headerInfoList\", \"validationErrors\", \"showValidationStatus\", \"onReportConfiguration\", \"onDefaultConfiguration\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from 'vue'\nimport ReportMixin from \"@/apps/ART/views/reports/ReportMixin.vue\"\nimport { DisaggregatedReportService } from \"@/apps/ART/services/reports/disaggregated_service\"\nimport { REGIMENS } from \"@/apps/ART/services/reports/regimen_report_service\"\nimport { toastWarning } from '@/utils/Alerts'\nimport { isEmpty } from \"lodash\"\nimport ReportTemplate from \"@/apps/ART/views/reports/TableReportTemplate.vue\"\nimport table from \"@/components/DataViews/tables/ReportDataTable\"\nimport { IonPage } from \"@ionic/vue\"\nimport { MohCohortReportService } from \"@/apps/ART/services/reports/moh_cohort_service\"\nimport { Option } from '@/components/Forms/FieldInterface'\nimport { AGE_GROUPS } from \"@/apps/ART/services/reports/patient_report_service\"\n\nexport default defineComponent({\n    mixins: [ReportMixin],\n    components: { ReportTemplate, IonPage },\n    data: () => ({\n        title: 'Disaggregated report',\n        columns: [\n            [\n                table.thTxt('Age group'),\n                table.thTxt('Gender'),\n                table.thNum('Tx new (new on ART)'),\n                table.thNum('TX curr (receiving ART)'),\n                table.thNum('TX curr (received IPT)'),\n                table.thNum('TX curr (screened for TB)'),\n                ...(REGIMENS.map(r => table.thNum(r))),\n                table.thNum('Unknown'),\n                table.thNum('Total (regimen)')\n            ]\n        ],\n        errors: [] as string[],\n        showStatus: false as boolean,\n        rowDataRefs: [\n            'txNew', \n            'txCurr', \n            'txGivenIpt', \n            'txScreenTB', \n            ...REGIMENS,\n            'N/A', \n            'regimenTotals'\n        ],\n        dataRefLabels: {\n           'txNew': 'Tx new (new on ART)',\n           'txCurr': 'Tx curr (receiving ART)',\n           'txGivenIpt': 'TX curr (received IPT)',\n           'txScreenTB': 'TX curr (screened for TB)',\n           'N/A': 'Unknown',\n           'regimenTotals': 'Regimen Totals'\n        } as any,\n        aggregations: [] as any,\n        mohCohort: {} as any,\n        maleFemaleAgeGroupData: {} as any,\n        headerList: [] as Array<Option>,\n        canValidate: false as boolean,\n        onLoadDefault: null as any,\n        sortIndexes: {} as Record<string | number, Array<any>>\n    }),\n    async created() {\n        const { query }  = this.$route\n        /** Check for default url params for this report */\n        if (query.start_date && query.end_date && query.quarter) {\n            this.onLoadDefault = () =>\n                this.onPeriod({\n                    quarter: {\n                        label: query.quarter,\n                        other: {\n                            start: query.start_date,\n                            end: query.end_date,\n                            occupation: query.occupation\n                        }\n                    }\n                },{})\n        }\n    },\n    watch: {\n        async canValidate(doIt: boolean) {\n            if (doIt) await this.validateReport()\n        }\n    },\n    computed: {\n        rows(): any {\n            return Object.keys(this.sortIndexes)\n                .sort((a, b) => parseInt(a) - parseInt(b))\n                .reduce((r: any, i: any) => r.concat(this.sortIndexes[i]), [])\n        }\n    },\n    methods: {\n        async onPeriod(form: any, config: any, rebuildCache=false) {\n            this.canValidate = false\n            this.maleFemaleAgeGroupData = {}\n            this.aggregations = []\n            this.sortIndexes = {}\n            this.errors = []\n            this.report = new DisaggregatedReportService()\n            this.mohCohort = new MohCohortReportService()\n            if (form.quarter) {\n                this.mohCohort.setOccupation(form.quarter.other.occupation)\n                this.mohCohort.setQuarter(form.quarter.label)\n                this.mohCohort.setStartDate(form.quarter.other.start)\n                this.mohCohort.setEndDate(form.quarter.other.end)\n                this.report.setQuarter(form.quarter.label)\n                this.report.setOccupation(form.quarter.other.occupation)\n                this.report.setStartDate(form.quarter.other.start)\n                this.report.setEndDate(form.quarter.other.end)\n                this.period = form.quarter.label === 'Custom'\n                    ? this.report.getDateIntervalPeriod()\n                    : form.quarter.label\n            } else {\n                this.report.setOccupation(config.occupation)\n                this.mohCohort.setOccupation(config.occupation)\n                this.mohCohort.setStartDate(config.start_date)\n                this.mohCohort.setEndDate(config.end_date)\n                this.report.setStartDate(config.start_date)\n                this.report.setEndDate(config.end_date)\n                this.period = this.report.getDateIntervalPeriod()\n            }\n            this.report.setRebuildOutcome(rebuildCache)\n            const isInit = await this.report.init()\n            if (!isInit) {\n                return toastWarning('Unable to initialise report')\n            }\n            await this.setTableRows()\n            this.canValidate = true\n        },\n        async setTableRows() {\n            await this.setFemaleRows(1)\n            await this.setMaleRows(2)\n            await this.setTotalMalesRow(3)\n            await this.setFemalePregnantRows(4)\n            await this.setFemaleBreastFeedingRows(6)\n            await this.setFemaleNotPregnantRows(5)\n        },\n        getColumnLabel(col: string) {\n            return col in this.dataRefLabels ? this.dataRefLabels[col] : col\n        },\n        getTotals(compareFunction: (value: any) => boolean){\n            return this.aggregations\n                .filter((i: any) => compareFunction(i))\n                .reduce((accum: any, cur: any) => accum.concat(cur.data), [])\n        },\n        addAggregation(col: string, gender: string, data = []) {\n            this.aggregations.push({ col, gender, data })\n        },\n        async getRegimenRows(group: string, gender: string) {\n            let totals: any = []\n            const row: any = []\n            const distribution = await this.report.getRegimenDistribution()\n            const refs = [...REGIMENS, 'N/A']\n            refs.forEach((i: any) => {\n                if (distribution[i]) totals = totals.concat(distribution[i])\n                row.push(this.drill(distribution[i], `Regimen ${i} | ${group} | ${gender}`))\n                this.addAggregation(i, gender, distribution[i])\n            })\n            row.push(this.drill(totals, `Regimen Totals | ${group} | ${gender}`))\n            this.addAggregation('regimenTotals', gender, totals)\n            return row\n        },\n        getValue(prop: string, gender: string, data: any) {\n            switch(prop) {\n                case 'tx_given_ipt':\n                    return this.report.getTxIpt()\n                case 'tx_screened_for_tb':\n                    return this.report.getTxCurrTB()\n                default:\n                    return gender in data ? data[gender][prop] : []\n            }\n        },\n        setTotalMalesRow(sortIndex: number) {\n            const maleTD = (column: string, columnDescription: string) => {\n                const data = this.aggregations.filter((a: any) => a.gender === 'Male' && a.col === column)\n                    .reduce((accum: any, cur: any) => accum.concat(cur.data), []) \n                return this.drill(data, columnDescription)\n            }\n            const rows: any = this.rowDataRefs.map(columnName => \n                maleTD(columnName, `${this.getColumnLabel(columnName)} | All Male`)\n            )\n            this.sortIndexes[sortIndex] = [[table.td('All'), table.td('Male'), ...rows]]\n        },\n        setFemaleNotPregnantRows(sortIndex: number) {\n            // Gets all pregnant females from a particular column and checks if given patient ID \n            // Is in the list\n            const isPregnant = (patientID: number, column: string) => this.aggregations\n                .filter((a: any) => a.gender.match(/fp|fbf/i) && a.col === column)\n                .reduce((accum: any, cur: any) => accum.concat(cur.data || []), [])\n                .includes(patientID)\n            // Get total sum of all females by a particular column\n            const fnpTD = (column: string, columnDescription: string) => {\n                const data = this.aggregations.filter((a: any) => a.gender === 'Female' && a.col === column)\n                    .reduce((accum: any, cur: any) => accum.concat(cur.data.filter((i: any) => !isPregnant(i, column))), [])\n                return this.drill(data, columnDescription)\n            }\n            const rows: any = this.rowDataRefs.map(column => \n                fnpTD(column, `${this.getColumnLabel(column)} | FNP`)\n            )\n            this.sortIndexes[sortIndex] = [[table.td('All'), table.td('FNP'), ...rows]]\n        },\n        setFemaleRows(sortIndex: number) {\n            this.report.setGender('female')\n            return this.setRows(sortIndex, 'F', AGE_GROUPS, 'Female')\n        },\n        setMaleRows(sortIndex: number) {\n            this.report.setGender('male')\n            return this.setRows(sortIndex, 'M', AGE_GROUPS, 'Male')\n        },\n        setFemalePregnantRows(sortIndex: number) {\n            this.report.setGender('pregnant')\n            return this.setRows(sortIndex, 'F', ['All'], 'FP', 'Pregnant')\n        },\n        setFemaleBreastFeedingRows(sortIndex: number) {\n            this.report.setGender('breastfeeding')\n            return this.setRows(sortIndex, 'F', ['All'], 'FBf', 'Breastfeeding')\n        },\n        async setRows(sortIndex: number, category: string, ageGroups: string[], gender: string, otherAgeGroup='') {\n            for(const i in ageGroups) {\n                let txNew = []\n                let txCurr= []\n                let txGivenIpt = []\n                let txScreenTB = []\n                const group = otherAgeGroup || ageGroups[i]\n                this.report.setAgeGroup(group)\n\n                if (!(group in this.maleFemaleAgeGroupData)) {\n                    const cohort = await this.report.getCohort()\n                    this.report.setRebuildOutcome(false)\n                    this.maleFemaleAgeGroupData[group] = !isEmpty(cohort) ? cohort[group] : {}\n                }\n\n                if (!isEmpty(this.maleFemaleAgeGroupData[group])) {\n                    const value = async (prop: string) => this.getValue(\n                        prop, category, this.maleFemaleAgeGroupData[group]\n                    )\n                    txNew = await value('tx_new')\n                    txCurr= await value('tx_curr')\n                    txGivenIpt = await value('tx_given_ipt')\n                    txScreenTB = await value('tx_screened_for_tb')\n                    this.addAggregation('txNew', gender, txNew)\n                    this.addAggregation('txCurr', gender, txCurr)\n                    this.addAggregation('txGivenIpt', gender, txGivenIpt)    \n                    this.addAggregation('txScreenTB', gender, txScreenTB)\n                }\n\n                switch(this.report.getGender()) {\n                    case 'breastfeeding':\n                        this.report.setAgeGroup('All')\n                        this.report.setGender('Fbf')\n                        break\n                    case 'pregnant':\n                        this.report.setAgeGroup('All')\n                        this.report.setGender('FP')\n                        break\n                }\n\n                if (!this.sortIndexes[sortIndex]) this.sortIndexes[sortIndex] = []\n\n                this.sortIndexes[sortIndex].push([\n                    table.td(ageGroups[i]),\n                    table.td(this.formatGender(gender)),\n                    this.drill(txNew, `Tx new (new on ART) | ${group} | ${gender}`),\n                    this.drill(txCurr, `Tx curr (receiving ART) | ${group} | ${gender}`),\n                    this.drill(txGivenIpt, `TX curr (received IPT) | ${group} | ${gender}`),\n                    this.drill(txScreenTB, `TX curr (screened for TB) | ${group} | ${gender}`),\n                    ...(await this.getRegimenRows(group, gender))\n                ])\n            }\n        },\n        setHeaderInfoList(totalAlive: Array<any>) {\n            this.headerList = [\n                { \n                    label: 'Total Alive and on ART', \n                    value: totalAlive.length,\n                    other: {\n                        onclick: () => this.runTableDrill(totalAlive, 'Total Alive on ART')\n                    }\n                }\n            ]\n        },\n        async validateReport() {\n            const totalAlive = this.getTotals((i: any) => i.col === 'txCurr' && i.gender.match(/male|female/i))\n            this.setHeaderInfoList(totalAlive)\n            const validations: any = {\n                'total_alive_and_on_art' : {\n                    param: totalAlive.length,\n                    check: (i: number, p: number) => i != p,\n                    error: (i: number, p: number) => `\n                        Total alive of <b>${p}</b>\n                        Does not match total alive of <b>${i}</b> on MOH report\n                    `\n                }\n            }\n            const s = this.mohCohort.validateIndicators(validations, (errors: string[]) => this.errors = errors)\n            if (s === -1) this.errors = ['Report not validated. Run the MoH cohort report for similar reporting period and then run this report']\n        }\n    }\n})\n","import { render } from \"./MohDisaggregatedReport.vue?vue&type=template&id=dcf7a478&ts=true\"\nimport script from \"./MohDisaggregatedReport.vue?vue&type=script&lang=ts\"\nexport * from \"./MohDisaggregatedReport.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { ArtReportService } from \"./art_report_service\";\nimport { AGE_GROUPS } from \"./patient_report_service\";\n\nexport class DisaggregatedReportService extends ArtReportService {\n    gender: string;\n    ageGroup: string;\n    initialize: boolean;\n    rebuildOutcome: boolean;\n\n    constructor() {\n        super()\n        this.gender = ''\n        this.ageGroup = AGE_GROUPS[0]\n        this.initialize = true\n        this.rebuildOutcome = true\n    }\n\n    async init() {\n        this.initialize = true\n        const req = await this.getCohort()\n        if (req && req.temp_disaggregated === 'created') {\n            this.initialize = false\n            return true\n        }\n        return false\n    }\n\n    setAgeGroup(ageGroup: string) {\n        this.ageGroup = ageGroup\n    }\n\n    setInitialization(isInit: boolean) {\n        this.initialize = isInit\n    }\n\n    setRebuildOutcome(isRebuild: boolean) {\n        this.rebuildOutcome = isRebuild\n    }\n\n    setGender(gender: string) {\n        this.gender = gender\n    }\n\n    getGender() {\n        return this.gender\n    }\n\n    getCohort() {\n        return this.getReport('cohort_disaggregated', {\n            'age_group': `${this.ageGroup}`,\n            'rebuild_outcome': `${this.rebuildOutcome}`,\n            'initialize': `${this.initialize}`\n        })\n    }\n\n    getTxIpt() {\n        return this.getReport('clients_given_ipt', { \n            'gender': this.gender, 'age_group': `${this.ageGroup}` \n        })\n    }\n\n    getTxCurrTB() {\n        return this.getReport('screened_for_tb', { \n            'gender': this.gender, 'age_group': `${this.ageGroup}` \n        })\n    }\n\n    getRegimenDistribution() {\n        return this.getReport('disaggregated_regimen_distribution', {\n            'gender': `${this.gender}`, 'age_group': `${this.ageGroup}`\n        })\n    }\n}\n","import { find } from \"lodash\";\nimport { ArtReportService } from \"./art_report_service\";\n\nexport enum CohortVar {\n    MOH_CACHE = 'mohCache'\n}\n\nexport interface CohortValidationInterface {\n    param: number | string;\n    error: (indicator: number, param: number) => string;\n    check: (indicator: number, param: number) => boolean;\n}\n\nexport class MohCohortReportService extends ArtReportService {\n    regenerate: boolean;\n    constructor() {\n        super()\n        this.regenerate = false\n    }\n\n    private cohortUrl() {\n        return `programs/${this.programID}/reports/cohort`\n    }\n\n    setRegenerate(regenerate: boolean) {\n        this.regenerate = regenerate\n    }\n\n    getCohortDrillDown(resourceId: string) {\n        return ArtReportService.getJson('cohort_report_drill_down', {\n            id: resourceId,\n            date: this.date,\n            'program_id': this.programID\n        })\n    }\n\n    requestCohort(params: any) {\n        return ArtReportService.ajxGet(\n            this.cohortUrl(), params\n        )\n    }\n\n    qaurterRequestParams() {\n        const data: any =  { \n            name: this.quarter,\n            regenerate: this.regenerate \n        }\n        if (this.occupation) {\n            data['occupation'] = this.occupation\n        }\n        return data\n    }\n\n    datePeriodRequestParams() {\n        const data: any = {\n            name: `Cohort-${this.startDate}-${this.endDate}`,\n            'start_date': this.startDate,\n            'end_date': this.endDate,\n            regenerate: this.regenerate\n        }\n        if (this.occupation) {\n            data['occupation'] = this.occupation\n        }\n        return data\n    }\n\n    getCachedCohortValues() {\n        const cache = sessionStorage.getItem(CohortVar.MOH_CACHE)\n        if (cache) {\n            const conf = JSON.parse(cache)\n            if (conf.start_date === this.startDate \n                && conf.end_date === this.endDate\n                || conf.quarter === this.quarter) {\n                return conf.data\n            }\n        }\n    }\n\n    cacheCohort(values: any) {\n        sessionStorage.setItem(\n            CohortVar.MOH_CACHE, \n            JSON.stringify({\n                'start_date': this.startDate,\n                'end_date': this.endDate,\n                'quarter': this.quarter,\n                'data': values\n        }))\n    }\n\n    validateIndicators(validations: Record<string, CohortValidationInterface>, callback: (errors: Array<any>) => any) {\n        const cachedValues = this.getCachedCohortValues()\n        if (cachedValues) {\n            const errors = Object.keys(validations)\n                .reduce((errors: Array<any>, key: string) => {\n                    const indicator: any = find(cachedValues, { name: key })\n                    const validation: any = validations[key]\n                    const indicatorValue: any = indicator ? indicator.contents : null\n                    const param = validation.param as number\n                    const condition = validation.check(parseInt(indicatorValue), param)\n                    if (condition) errors.push(\n                        validation.error(indicatorValue, param)\n                    )\n                    return errors\n                }, [])\n            return callback(errors)\n        }\n        return -1\n    }\n}\n"],"sourceRoot":""}