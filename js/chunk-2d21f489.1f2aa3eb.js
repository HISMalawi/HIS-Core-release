(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21f489"],{d8ba:function(e,t,n){"use strict";n.r(t);var i=n("7a23");function r(e,t,n,r,u,a){var s=Object(i["resolveComponent"])("his-standard-form"),o=Object(i["resolveComponent"])("ion-page");return Object(i["openBlock"])(),Object(i["createBlock"])(o,null,{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(s,{fields:e.formFields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])]})),_:1})}var u,a=n("2909"),s=n("1da1"),o=(n("99af"),n("d81d"),n("caad"),n("2532"),n("96cf"),n("7365")),c=n("d95e"),l=n("d4ec"),v=n("bee2"),d=n("262e"),p=n("2caf"),f=(n("ac1f"),n("466d"),n("cc6f")),b=n("1c74"),h=n("b89f"),m=function(e){Object(d["a"])(n,e);var t=Object(p["a"])(n);function n(e,i){var r;return Object(l["a"])(this,n),r=t.call(this,e,32,i),r.hivStatus="",r.artStatus="",r.arvNumber="",r.arvStartDate="",r.isPregnancyTestDone=!1,r.isSubsequentVisit=!1,r}return Object(v["a"])(n,[{key:"getHivStatus",value:function(){return this.hivStatus}},{key:"getArtStatus",value:function(){return this.artStatus}},{key:"getArvNumber",value:function(){return this.arvNumber}},{key:"getArvStartDate",value:function(){return this.arvStartDate}},{key:"isHivPositive",value:function(){return!!this.hivStatus.match(/positive/i)}},{key:"isAtRiskOfPreEclampsia",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f["a"].getFirstValueNumber(this.patientID,"Systolic blood pressure");case 2:return t=e.sent,e.next=5,f["a"].getFirstValueNumber(this.patientID,"Diastolic blood pressure");case 5:return n=e.sent,e.abrupt("return",t&&n&&t>=140&&n>=90);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"loadSubsequentVisit",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["e"].getJson("programs/".concat(this.programID,"/patients/").concat(this.patientID,"/subsequent_visit"));case 2:if(t=e.sent,!t){e.next=12;break}if(this.hivStatus=t["hiv_status"],this.hivStatus){e.next=10;break}return e.next=8,this.getFirstValueCoded("HIV status");case 8:n=e.sent,this.hivStatus="".concat(n).match(/positive/i)?"Positive":"";case 10:this.isSubsequentVisit=t["subsequent_visit"],this.isPregnancyTestDone=t["pregnancy_test"];case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"printLabResults",value:function(){return(new h["a"]).printLbl("/programs/".concat(this.programID,"/patients/").concat(this.patientID,"/labels/lab_results?date=").concat(this.date))}},{key:"loadArtStatus",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b["e"].getJson("programs/".concat(this.programID,"/patients/").concat(this.patientID,"/art_hiv_status"));case 2:t=e.sent,t&&(this.hivStatus=t["hiv_status"]||this.hivStatus,this.artStatus=t["art_status"]||"",this.arvNumber=t["arv_number"]||"",this.arvStartDate=t["arv_start_date"]||"");case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(f["a"]),T=n("2706"),_=n("8a30"),y=n("b446"),S=n("9283"),O=n("ad49");function V(){return O["a"].isProp("".concat(u.RECENCY_ESSAY_ACTIVATED,"=Yes"))}(function(e){e["RECENCY_ESSAY_ACTIVATED"]="recency_essay_activated"})(u||(u={}));var g={recencyEssayActivated:V},N=n("b5e4"),x=n("2ef0"),E=Object(i["defineComponent"])({components:{IonPage:_["D"]},mixins:[o["a"]],data:function(){return{formFields:[],arvNumber:"",hivStatus:"",artStatus:"",arvStartDate:"",recencyEssayActivated:!1,riskOfPreclampsia:null,service:{}}},watch:{ready:{handler:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=10;break}return t.service=new m(t.patientID,t.providerID),n.next=4,t.service.loadSubsequentVisit();case 4:return n.next=6,t.service.loadArtStatus();case 6:return n.next=8,g.recencyEssayActivated();case 8:t.recencyEssayActivated=n.sent,t.formFields=t.getFields();case 10:case"end":return n.stop()}}),n)})))()},immediate:!0}},methods:{onFinish:function(e,t){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.resolveObs(t);case 2:return i=e.sent,e.next=5,n.service.createEncounter();case 5:return e.next=7,n.service.saveObservationList(i);case 7:return e.next=9,n.service.printLabResults();case 9:n.nextTask();case 10:case"end":return e.stop()}}),e)})))()},getFields:function(){var e=this;return[{id:"art_summary",helpText:"ART Summary",type:c["b"].TT_SUMMARY,condition:function(){return e.service.isHivPositive()},options:function(){return[{label:"HIV Status",value:'\n                                <b style="color:'.concat(e.service.isHivPositive()?"red":"green",'">\n                                    ').concat(e.service.getHivStatus(),"\n                                </b>\n                            ")},{label:"On Art",value:e.service.getArtStatus()||"N/A"},{label:"Art Start date",value:S["b"].toStandardHisDisplayFormat(e.service.getArvStartDate())||"N/A"},{label:"ARV Number",value:e.service.getArvNumber()||"N/A"}]}},{id:"lab_results",helpText:"Lab Results",type:c["b"].TT_MULTIPLE_YES_NO,condition:function(){return!e.service.isPregnancyTestDone&&!e.hivStatus},options:function(t){if(t.lab_results)return t.lab_results;var n=[];return e.service.isPrengnacyTestDone||n.push(e.toYesNoOption("Pregnancy test done",{concept:"B-HCG"})),e.service.hivStatus||n.push(e.toYesNoOption("Previous HIV test done",{concept:"Previous HIV test done"})),n},validation:function(e){return T["a"].required(e)},computedValue:function(t){return t.map((function(t){return e.service.buildValueCoded(t.other.concept,t.value)}))}},{id:"prev_hiv_test_result",helpText:"Previous HIV test results",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(t){return e.inArray(t.lab_results,(function(e){return"Previous HIV test done"===e.label&&"Yes"===e.value}))},options:function(){return e.mapStrToOptions(["Negative","Positive","Inconclusive","Unknown"])},computedValue:function(t){return e.service.buildValueCoded("Previous HIV Test Results",t.value)}}].concat(Object(a["a"])(Object(y["b"])({id:"prev_hiv_test_date",helpText:"Previous HIV test",required:!0,minDate:function(){return e.patient.getBirthdate()},maxDate:function(){return e.service.getDate()},estimation:{allowUnknown:!1},condition:function(e){var t;return!(null===(t=e.prev_hiv_test_result)||void 0===t||!t.value)},computeValue:function(t){return e.service.buildValueDate("Previous HIV Test Date",t)}})),[{id:"on_art",helpText:"Patient on ART",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return e.service.buildValueCoded("On Art",t.value)},condition:function(e){return"Positive"===e.prev_hiv_test_result.value},options:function(){return e.yesNoOptions()}},{id:"arv_number",helpText:"ARV Number",type:c["b"].TT_TEXT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return e.service.buildValueText("Art number",t.value)},condition:function(e){return"Yes"===e.on_art.value}},{id:"recency_essay",helpText:"Rapid Recency Essay - Asante Results",type:c["b"].TT_MULTIPLE_YES_NO,condition:function(t){return"Positive"===t.prev_hiv_test_result.value&&e.recencyEssayActivated},computedValue:function(t){return t?t.map((function(t){return e.service.buildValueCoded(t.label,t.value)})):null},options:function(t){return t.recency_essay?t.recency_essay:[e.toYesNoOption("Line 1. Control Line Present"),e.toYesNoOption("Line 2. Positive Verification Line Present"),e.toYesNoOption("Line 3. Long-Term Line Present")]}},{id:"available_test_results",helpText:"Available Lab Tests",type:c["b"].TT_MULTIPLE_SELECT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return Object(x["find"])(t,{label:"None"})?e.service.buildValueCoded("Lab test done","No"):null},onValueUpdate:function(e,t){return e.map((function(e){return"None"===t.value&&"None"!=e.value&&(e.isChecked=!1),"None"!=t.value&&t.isChecked&&"None"===e.value&&(e.isChecked=!1),e}))},options:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var i,r,u,a,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=[],u=!!e.service.isHivPositive()||"Positive"===(null===(i=n.prev_hiv_test_result)||void 0===i?void 0:i.value),u||r.push(e.toOption("HIV")),r.push(e.toOption("HB")),r.push(e.toOption("Syphilis")),r.push(e.toOption("Malaria")),r.push(e.toOption("Blood Group")),a={label:"Urine",value:"Urine",isChecked:!1},null!==e.riskOfPreclampsia){t.next=17;break}return t.next=11,e.service.isAtRiskOfPreEclampsia();case 11:if(e.riskOfPreclampsia=t.sent,!e.riskOfPreclampsia){t.next=17;break}return t.next=15,Object(N["a"])("Select urine test to conduct urine protein test",{header:"Client is at risk of pre-eclampsia.",cancelBtnLabel:"Remind later",confirmBtnLabel:"Select Urine Test"});case 15:s=t.sent,a.isChecked=s;case 17:return t.abrupt("return",[].concat(r,[a,e.toOption("None")]));case 18:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),config:{footerBtns:[{name:"None",slot:"end",onClickComponentEvents:{refreshOptions:function(e,t){return t.map((function(e){return e.isChecked="None"===e.label,e}))}},onClick:function(){return"None"}}]},exitsForm:function(e){return Object(x["find"])(e.available_test_results,{label:"None"})}},{id:"hiv_status",helpText:"HIV Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("HIV")},computedValue:function(t){return e.service.buildValueCoded("HIV status",t.value)},options:function(){return e.mapStrToOptions(["Negative","Positive","Inconclusive"])}},{id:"on_art_1",helpText:"Patient on ART",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return"Positive"===e.hiv_status.value},computedValue:function(t){return e.service.buildValueCoded("On Art",t.value)},options:function(){return e.yesNoOptions()}},{id:"arv_number_1",helpText:"ARV Number",type:c["b"].TT_TEXT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return e.service.buildValueText("Art number",t.value)},condition:function(e){return"Yes"===e.on_art_1.value}},{id:"recency_essay_1",helpText:"Rapid Recency Essay - Asante Results",type:c["b"].TT_MULTIPLE_YES_NO,condition:function(t){return"Positive"===t.hiv_status.value&&e.recencyEssayActivated},computedValue:function(t){return t?t.map((function(t){return e.service.buildValueCoded(t.label,t.value)})):null},options:function(){return[e.toYesNoOption("Line 1. Control Line Present"),e.toYesNoOption("Line 2. Positive Verification Line Present"),e.toYesNoOption("Line 3. Long-term Line Present")]}},{id:"hb_result",helpText:"HB Test Result (g/dl)",type:c["b"].TT_NUMBER,validation:function(t){return e.validateSeries([function(){return T["a"].required(t)},function(){return T["a"].rangeOf(t,2,16)}])},computedValue:function(t){return e.service.buildValueNumber("HB Test Result",t.value)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("HB")}},{id:"syphilis",helpText:"Syphilis Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return e.service.buildValueCoded("Syphilis Test Result",t.value)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("Syphilis")},options:function(){return e.mapStrToOptions(["Negative","Positive"])}},{id:"malaria",helpText:"Malaria Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("Malaria")},computedValue:function(t){return e.service.buildValueCoded("Malaria Test Result",t.value)},options:function(){return e.mapStrToOptions(["Negative","Positive"])}},{id:"blood_group",helpText:"Blood Group Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("Blood Group")},computedValue:function(t){return e.service.buildValueText("Blood group",t.value)},options:function(){return e.mapStrToOptions(["A+","A-","B+","B-","AB+","AB-","O+","O-"])}},{id:"available_urine_tests",helpText:"Available Urine Tests Results",type:c["b"].TT_MULTIPLE_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_test_results.map((function(e){return e.value})).includes("Urine")},options:function(){return e.mapStrToOptions(["Protein","Glucose","WBC","RBC","Nitrate"])},config:{buildOptionsOnce:!0}},{id:"protein",helpText:"Urine Protein Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_urine_tests.map((function(e){return e.value})).includes("Protein")},computedValue:function(t){return e.service.buildValueText("Urine protein",t.value)},options:function(){return e.mapStrToOptions(["Negative","(+)","+","++","+++","++++"])}},{id:"glucose",helpText:"Glucose Test Result (mg/dl)",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},condition:function(e){return e.available_urine_tests.map((function(e){return e.value})).includes("Glucose")},computedValue:function(t){return e.service.buildValueText("Blood glucose",t.value)},options:function(){return e.mapStrToOptions(["Normal","+","++","+++"])}},{id:"wbc",helpText:"White Blood Cells Test Result (cmm)",type:c["b"].TT_NUMBER,validation:function(t){return e.validateSeries([function(){return T["a"].required(t)},function(){return T["a"].rangeOf(t,1,1e6)}])},computedValue:function(t){return e.service.buildValueNumber("White blood cells",t.value)},condition:function(e){return e.available_urine_tests.map((function(e){return e.value})).includes("WBC")}},{id:"rbc",helpText:"Red Blood Cells Test Result (cmm)",type:c["b"].TT_NUMBER,validation:function(t){return e.validateSeries([function(){return T["a"].required(t)},function(){return T["a"].rangeOf(t,1,1e6)}])},computedValue:function(t){return e.service.buildValueNumber("Red blood cells",t.value)},condition:function(e){return e.available_urine_tests.map((function(e){return e.value})).includes("RBC")}},{id:"nitrate",helpText:"Nitrate Test Result",type:c["b"].TT_SELECT,validation:function(e){return T["a"].required(e)},computedValue:function(t){return e.service.buildValueCoded("Urine Nitrate Test",t.value)},condition:function(e){return e.available_urine_tests.map((function(e){return e.value})).includes("Nitrate")},options:function(){return e.mapStrToOptions(["Negative","Trace","Positive"])}}])}}}),P=n("6b0d"),R=n.n(P);const C=R()(E,[["render",r]]);t["default"]=C}}]);
//# sourceMappingURL=chunk-2d21f489.1f2aa3eb.js.map