{"version":3,"sources":["webpack:///./node_modules/eslint-loader/index.js","webpack:///./node_modules/cache-loader/dist/cjs.js","webpack:///./src/views/EncounterMixin.vue","webpack:///./node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/templateLoader.js","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/apps/ART/views/encounters/Vitals.vue"],"names":["FlowState","dformat","d","HisDate","toStandardHisDisplayFormat","ENCOUNTER_GUIDELINES","priority","actions","alert","outcomeStartDate","action","infoActionSheet","name","slot","color","GO_TO_PATIENT_DASHBOARD","CHANGE_PATIENT_OUTCOME","CONTINUE","conditions","outcome","startDate","sessionDate","birthDate","CHANGE_SESSION_DATE","selection","providers","encounterName","apiDate","modal","optionsActionSheet","role","value","flowState","SET_PROVIDER","isBdeMode","isBDE","defineComponent","components","HisStandardForm","data","patient","fields","patientID","providerID","facts","isEnrolledInProgam","formLabel","ready","watch","handler","route","params","patient_id","toUpperCase","parseInt","Store","get","then","patientData","setEncounterFacts","checkEncounterGuidelines","immediate","deep","computed","cancelDestination","patientDashboardUrl","methods","runflowState","state","states","username","split","provider","find","person_id","$router","push","EXIT","gotoPatientDashboard","findings","matchToGuidelines","index","finding","status","program","programID","ProgramService","getProgramID","e","console","error","toastDanger","getSessionDate","getCachedApiDate","getBirthdate","$route","toString","sort","a","b","usernameA","usernameB","map","p","isEmpty","person","names","latestName","given_name","family_name","toOption","label","other","mapStrToOptions","items","i","path","loadingController","create","backdropDismiss","message","present","nextTask","getTop","v","dismiss","yesNoOptions","toYesNoOption","values","mapOptions","options","option","toConditionalOptions","final","yesNoUnknownOptions","resolveObs","obs","tag","Object","filter","reduce","accum","cur","Array","isArray","concat","Promise","all","inArray","arr","expression","length","validateSeries","condition","__exports__","render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createBlock","_resolveDynamicComponent","formType","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onFinishAction","onOnIndex","onIndex","TouchScreenForm","emits","props","type","Function","Boolean","default","String","required","formData","computedData","$emit","_component_his_standard_form","_resolveComponent","onOnskip","$event","mixins","EncounterMixinVue","app","HisApp","getActiveApp","age","gender","hasBPinfo","finalHeightValue","recentHeight","recentHeightObsID","HTNEnabled","optionWhiteList","hasHTNObs","vitals","weightForHeight","medianWeightandHeight","canEditHeight","patientAgeAtPrevRecordedHeight","this","init","VitalsService","getAge","getGender","getFields","getOptions","modifier","icon","visible","o","includes","canCheckWeightHeight","canCheckBp","encounter","createEncounter","toastWarning","buildObs","observations","saveObservationList","toastSuccess","mapObs","sanitizeVitals","element","on_htn_medication","buildValueText","splitBP","forEach","bpSystolic","bpDiastolic","getBMI","weight","getVal","height","currentWeightPercentile","parseFloat","toFixed","currentHeightPercentile","currentHeightRounded","Math","floor","medianWeightHeight","weightForHeightPercentile","isNaN","BMI","BMIService","calculateBMI","val","key","j","async","buildValueNumber","validateVitals","l","checkRequiredVitals","validateAll","id","helpText","FieldType","TT_SELECT","applicationName","getAll","validation","Validation","TT_VITALS_ENTRY","query","vital_options","lastHeight","getRecentHeightObs","dayjs","diff","getMedianWeightHeight","getWeightForHeightValues","beforeNext","heightOption","enteredHeight","prevHeight","prevHeightBtnTxt","newHeightBtnTxt","alertConfirmation","voidObs","config","hiddenFooterBtns","onUpdateAlertStatus","weightOption","result","onChangeOption","activeItem","errs","validator","AppEncounterService","constructor","isNotEmptyandNumber","vital","match","isNotEmptyandFloat","checkMinMax","min","max","mergeErrors","errors","holder","isValidBPReading","isValidBP","emptyErrors","minErrors","isCondition","ignored","undefined","prop","every","sortByPriority","sortByWeight","guidelines","target","targetEvent","sortBy","matches","guidelineIndex","targetValidations","some","title","description","text","info"],"mappings":"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","file":"js/chunk-25532402.d42dc3d1.js","sourcesContent":["/**\n * Compares patient facts against a predefined guideline Object.\n*/\nexport interface DescriptionInterface {\n    color?: 'primary' | 'secondary' | 'danger' | 'warning';\n    info: Function;\n    text?: string;\n    show: 'onChecked' | 'always';\n}\n\nexport interface GuideLineInterface {\n    title?: string;\n    concept?: string;\n    weight?: number;\n    priority?: number;\n    conditions: Record<string, Function>;\n    actions?: Record<string, any>; //TODO: should <key, Function>\n    data?: Record<string, any>;\n    description?: DescriptionInterface;\n    target?: string;\n    targetEvent?: string;\n}\n\n/**\n * Match the facts with guidelines\n * @param facts \n * @param conditions \n * @returns \n */\nfunction isCondition(facts: Record<string, any>, conditions: Record<string, Function>): boolean {\n    const state = [] \n    const ignored = [-1, '', null, undefined]\n\n    for(const prop in conditions) {\n        if (!(prop in facts)) \n            continue\n        \n        const value = facts[prop]\n        if (ignored.includes(value)) {\n            state.push(false)\n            continue\n        }\n\n        state.push(conditions[prop](value, facts))\n    }\n    return state.every(Boolean)\n}\n\n/**\n * Sort guidelines in the order of importance/relevance\n * @param findings \n * @returns \n */\nfunction sortByPriority(findings: GuideLineInterface[]) {\n    return findings.sort((a, b) => (a.priority && b.priority) && a.priority < b.priority ? -1 : 1)\n}\n\nfunction sortByWeight(findings: GuideLineInterface[]) {\n    return findings.sort((a, b) => (a.weight && b.weight) && a.weight > b.weight ? -1 : 1)\n}\n\nexport function logFindingsByWeight(guidelines: Record<string, GuideLineInterface>) {\n    const findings: any = Object.keys(guidelines).map(i => ({ name: i, weight: guidelines[i].weight}))\n    console.log(sortByWeight(findings).map((i: any) => `${i.weight} -> ${i.name}`))\n}\n\n/**\n * Check the guideline for matching facts and return matching object \n * @param facts: key value pair for used for searching in guidelines\n * @param guidelines: A dictionary containing fixed rules/validations that conforms to GuideLineInterface\n * @param target: Used for matching a target defined in a guidlines before executing conditions\n * @param targetEvent: used for matching a target event in a guideline before executing conditions\n * @returns\n */\nexport function matchToGuidelines(\n    facts: Record<string, any>, \n    guidelines: Record<string, GuideLineInterface>,\n    target='', \n    targetEvent='',\n    sortBy='priority' as 'priority' | 'weight'): Array<GuideLineInterface> {\n    const matches = []\n    for(const guidelineIndex in guidelines) {\n        const data: GuideLineInterface = guidelines[guidelineIndex]\n        const targetValidations = [\n            (data.target && target && data.target != target),\n            (data.targetEvent && targetEvent \n                && data.targetEvent != targetEvent)\n        ]\n\n        if (targetValidations.some(Boolean)) {\n            continue\n        }\n\n        if (isCondition(facts, data.conditions)) {\n            data.title = guidelineIndex\n            if (data.description) {\n                data.description.text = data.description.info(facts)\n            }\n            matches.push(data)\n        }\n    }\n    return sortBy === 'priority' ? sortByPriority(matches) : sortByWeight(matches)\n}\n","\nimport { defineComponent } from \"vue\";\nimport { Field, Option } from \"@/components/Forms/FieldInterface\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\";\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport Validation from \"@/components/Forms/validations/StandardValidations\";\nimport { VitalsService } from \"@/apps/ART/services/vitals_service\";\nimport { alertConfirmation, toastSuccess, toastWarning } from \"@/utils/Alerts\";\nimport EncounterMixinVue from \"../../../../views/EncounterMixin.vue\";\nimport { BMIService } from \"@/services/bmi_service\";\nimport { ProgramService } from \"@/services/program_service\";\nimport { find, isEmpty } from \"lodash\";\nimport HisApp from \"@/apps/app_lib\"\nimport { infoActionSheet } from \"@/utils/ActionSheets\"\nimport dayjs from \"dayjs\";\nimport Store from \"@/composables/ApiStore\"\n\nexport default defineComponent({\n  mixins: [EncounterMixinVue],\n  components: { HisStandardForm },\n  data: () => ({\n    app: HisApp.getActiveApp() as any,\n    activeField: \"\",\n    age: null as any,\n    gender: null as any,\n    hasBPinfo: false,\n    finalHeightValue: null as number | null,\n    recentHeight: null,\n    recentHeightObsID: -1,\n    HTNEnabled: false,\n    optionWhiteList: [] as string[],\n    hasHTNObs: false,\n    vitals: {} as any,\n    weightForHeight: {} as any,\n    medianWeightandHeight: {} as any,\n    canEditHeight: false as boolean,\n    patientAgeAtPrevRecordedHeight: -1 as number\n  }),\n  watch: {\n    ready: {\n      handler(ready) {\n        if (ready) this.init()\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    init() {\n      this.vitals = new VitalsService(this.patientID, this.providerID);\n      this.age = this.patient.getAge();\n      this.gender = this.patient.getGender();\n      this.fields = this.getFields();\n    },\n    getOptions() {\n      let recentHeight = ''\n      if (this.recentHeight) {\n        if (this.age > 18 || this.patientAgeAtPrevRecordedHeight >= 18 ) {\n          recentHeight = this.recentHeight || ''\n        }\n      }\n      const options = [\n        {\n          label: \"Weight\",\n          value: \"\",\n          other: {\n            modifier: \"KG\",\n            icon: \"weight\",\n            required: true,\n          },\n        },\n        {\n          label: \"Height\",\n          value: `${recentHeight}`,\n          other: {\n            modifier: \"CM\",\n            icon: \"height\",\n            recentHeight: this.recentHeight,\n            visible: this.canEditHeight,\n            required: this.canEditHeight\n          },\n        },\n        { label: \"BP\", value: \"\", other: { modifier: \"mmHG\", icon: \"bp\" } },\n        {\n          label: \"Temp\",\n          value: \"\",\n          other: { modifier: \"Â°C\", icon: \"temp\" },\n        },\n        {\n          label: \"SP02\",\n          value: \"\",\n          other: { modifier: \"%\", icon: \"spo2\" },\n        },\n        {\n          label: \"Pulse\",\n          value: \"\",\n          other: { modifier: \"BPM\", icon: \"pulse-rate\" },\n        },\n        {\n          label: \"Age\",\n          value: this.age,\n          other: { modifier: \"Years old\", icon: \"\", visible: false },\n        }\n      ]\n\n      if (!isEmpty(this.optionWhiteList)) {\n        return options.filter((o: any) => this.optionWhiteList.includes(o.label))\n          .map((o: any) => {\n            o.other.required = true\n            return o\n          })\n      }\n      return options\n    },\n    canCheckWeightHeight() {\n      return isEmpty(this.optionWhiteList) || this.optionWhiteList.includes('Height') \n        && this.optionWhiteList.includes('Weight')\n    },\n    canCheckBp() {\n      return isEmpty(this.optionWhiteList) || this.optionWhiteList.includes('BP')\n    },\n    async onFinish(formData: any) {\n      const encounter = await this.vitals.createEncounter();\n\n      if (!encounter) return toastWarning(\"Unable to create treatment encounter\");\n\n      const obs = await this.buildObs(formData);\n      const observations = await this.vitals.saveObservationList(obs);\n\n      if (!observations) return toastWarning(\"Unable to save patient observations\");\n\n      toastSuccess(\"Observations and encounter created!\");\n\n      this.nextTask();\n    },\n    async buildObs(formData: any) {\n      const observations: any = await this.mapObs(\n        this.sanitizeVitals(formData.vitals).filter(\n          (element) => element.label !== \"BP\"\n        ).map((e: any) => {\n          if (e.label === 'Height' && e.other.visible && this.finalHeightValue) {\n            e.value = this.finalHeightValue\n          }\n          return e\n        })\n      );\n      if (this.HTNEnabled && !this.hasHTNObs && formData.on_htn_medication) {\n        const obs = await this.vitals.buildValueText(\n          \"Treatment status\",\n          formData.on_htn_medication.value\n        );\n        observations.push(obs);\n      }\n      return observations;\n    },\n    splitBP(formData: Option[]) {\n      const p: Option[] = [];\n      formData.forEach((element) => {\n        if (element.label === \"BP\") {\n          const value = `${element.value}`.split(\"/\");\n          const bpSystolic = value[0];\n          const bpDiastolic = value[1];\n\n          p.push({ label: \"Systolic\", value: bpSystolic });\n          p.push({ label: \"Diastolic\", value: bpDiastolic });\n        }\n      });\n      return p;\n    },\n    getBMI(formData: Option[]) {\n      const weight = this.getVal(formData, \"Weight\");\n      const height = this.getVal(formData, \"Height\");\n      const obs: any = [];\n      if (this.age <= 14) {\n        const currentWeightPercentile = (\n          (weight / parseFloat(this.medianWeightandHeight[\"weight\"])) *\n          100\n        ).toFixed(0);\n        const currentHeightPercentile = (\n          (height / parseFloat(this.medianWeightandHeight[\"height\"])) *\n          100\n        ).toFixed(0);\n        const currentHeightRounded =\n          (height % Math.floor(height) < 0.5 ? 0 : 0.5) + Math.floor(height);\n        const medianWeightHeight =\n          this.weightForHeight[currentHeightRounded.toFixed(1)];\n        const weightForHeightPercentile = (\n          (weight / medianWeightHeight) *\n          100\n        ).toFixed(0);\n        if(!isNaN(parseFloat(weightForHeightPercentile))) {\n          obs.push({\n            label: \"Weight for height percent of median\",\n            value: weightForHeightPercentile,\n          });\n        }\n        obs.push({\n          label: \"Weight for age percent of median\",\n          value: currentWeightPercentile,\n        });\n        obs.push({\n          label: \"Height for age percent of median\",\n          value: currentHeightPercentile,\n        });\n      } else {\n        const BMI = BMIService.calculateBMI(weight, height);\n        obs.push({ label: \"BMI\", value: BMI });\n      }\n      return obs;\n    },\n    getVal(formData: Option[], val: string): number {\n      const value = formData.filter((key: any) => key.label === val);\n      return value[0].value === \"\" ? 0 : parseFloat(`${value[0].value}`);\n    },\n    async mapObs(vitals: any) {\n      const j = vitals.map(async (element: any) => {\n        const obs = await this.vitals.buildValueNumber(\n          element.label,\n          element.value\n        );\n        return obs;\n      });\n      return Promise.all(j);\n    },\n    validateVitals(vitals: any) {\n      const l = this.checkRequiredVitals(vitals);\n      if (l.length > 0) {\n        return l.map((val) => {\n          return [`${val.label} can not be empty`];\n        });\n      }\n      const v = this.sanitizeVitals(vitals);\n      return this.vitals.validateAll(v);\n    },\n    sanitizeVitals(vitals: Array<Option>) {\n      let p = vitals.filter((element) => {\n        if (element.label === \"Height\" && element.other.required == false) {\n          return false;\n        }\n        return element.value !== \"\" && element.label !== \"Age\";\n      })\n      if (this.canCheckBp()) {\n        p = p.concat(this.splitBP(p))\n      }\n      if (this.canCheckWeightHeight()){\n        p = p.concat(this.getBMI(vitals))\n      }\n      return p\n    },\n    checkRequiredVitals(vitals: Array<Option>) {\n      return vitals.filter((element) => {\n        return element.value === \"\" && element.other.required === true;\n      });\n    },\n    getFields(): Array<Field> {\n      return [\n        {\n          id: \"on_htn_medication\",\n          helpText: \"Already taking drugs for blood pressure?\",\n          type: FieldType.TT_SELECT,\n          init: async () => {\n            if (this.app?.applicationName === 'ART') {\n              this.HTNEnabled = await Store.get('IS_ART_HTN_ENABLED')\n              if (this.HTNEnabled) {\n                await VitalsService.getAll(this.patientID, \"Treatment status\").then(\n                  (data: any) => {\n                    this.hasHTNObs = data && data.length > 0;\n                  }\n                )\n              }\n            }\n            return true\n          },\n          validation: (val: any) => Validation.required(val),\n          condition: () => {\n            return this.HTNEnabled && !this.hasHTNObs;\n          },\n          options: () => [\n            {\n              label: \"Yes\",\n              value: \"BP Drugs started\",\n            },\n            {\n              label: \"No\",\n              value: \"Not on BP Drugs\",\n            },\n          ],\n        },\n        {\n          id: \"vitals\",\n          helpText: \"Vitals entry\",\n          type: FieldType.TT_VITALS_ENTRY,\n          init: async () => {\n            const optionWhiteList = this.$route.query.vital_options as string\n            if (optionWhiteList) this.optionWhiteList = optionWhiteList.split(',')\n            if (this.canCheckWeightHeight()) {\n              const lastHeight = await this.patient.getRecentHeightObs();\n              if (!isEmpty(lastHeight)) {\n                this.patientAgeAtPrevRecordedHeight = dayjs(lastHeight['obs_datetime'])\n                  .diff(this.patient.getBirthdate(), 'year')\n                this.recentHeight = lastHeight['value_numeric'];\n                this.recentHeightObsID = lastHeight['obs_id'];\n                /**\n                 * For a scenario where a patient's height was last updated when they were a minor\n                 * and they return as an adult, provide an option to update their height.\n                 */\n                this.canEditHeight = this.patientAgeAtPrevRecordedHeight < 18 || this.age < 18\n              } else {\n                this.canEditHeight = true\n              }\n              if (this.age <= 14) {\n                this.medianWeightandHeight = await this.patient.getMedianWeightHeight();\n                this.weightForHeight = await ProgramService.getWeightForHeightValues();\n              }\n            }\n            return true\n          },\n          validation: (value: any) => this.validateVitals(value),\n          beforeNext: async (val: Option[]) => {\n            const heightOption = find(val, { label: \"Height\" });\n            if (heightOption && this.recentHeight && heightOption.other.visible) {\n              const enteredHeight = parseInt(`${heightOption.value || 0}`);\n              const prevHeight = parseInt(`${this.recentHeight || 0}`);\n\n              /** Warn if inconsistent height is detected */\n              if (enteredHeight < prevHeight) {\n                const prevHeightBtnTxt = `Use ${prevHeight} CM`\n                const newHeightBtnTxt = `Use ${enteredHeight} CM`\n                const action = await infoActionSheet(\n                  `Previous Height \"${prevHeight} CM\"`,\n                  `Current Height \"${enteredHeight} CM\"`,\n                  `Inconsistent Height Reading (Height can not be lower than previous height of \" ${this.recentHeight} \"CM. Please SELECT the correct height.)`,\n                  [\n                    {\n                      name: prevHeightBtnTxt,\n                      slot: 'start',\n                      color: 'success'\n                    },\n                    {\n                      name: newHeightBtnTxt,\n                      slot: 'end',\n                      color: 'danger'\n                    }\n                  ]\n                )\n                if (action === newHeightBtnTxt && this.recentHeightObsID) {\n                  if ((await alertConfirmation(\n                    `Do you want to void height observation for ${prevHeight}`\n                  ))) {\n                    await VitalsService.voidObs(this.recentHeightObsID)\n                  }\n                } else {\n                  this.finalHeightValue = prevHeight\n                }\n              }\n            }\n            return true\n          },\n          config: {\n            hiddenFooterBtns : [\n              'Clear'\n            ],\n            onUpdateAlertStatus: async (params: Option[]) => {\n              const weightOption = find(params, { label: 'Weight'})\n              const heightOption = find(params, { label: 'Height'})\n\n              if (!(weightOption && heightOption)) return\n\n              const weight = parseFloat(weightOption.value as string)\n              const height = parseFloat(heightOption.value as string)\n\n              if (weight <= 0 || height <=0) return { \n                label: 'BMI',\n                value: 'N/A',\n                color: '', \n                status: ''\n              }\n\n              const BMI = await BMIService.getBMI(weight, height, this.gender, this.age);\n\n              return {\n                label: 'BMI',\n                value: BMI.index,\n                color: BMI.color, \n                status: BMI.result\n              }\n            },\n            onChangeOption: (activeItem: any) => {\n              if (!activeItem.value && activeItem.other.required) {\n                throw `Value for ${activeItem.label} is required`\n              }else if (activeItem.value) {\n                const errs = this.vitals.validator(activeItem)\n                if(errs && errs.length) throw errs\n              }\n            }\n          },\n          options: () => this.getOptions(),\n        },\n      ];\n    },\n  },\n});\n","import script from \"./EncounterMixin.vue?vue&type=script&lang=ts\"\nexport * from \"./EncounterMixin.vue?vue&type=script&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    fields: _ctx.fields,\n    activeField: _ctx.activeField,\n    onOnskip: _cache[1] || (_cache[1] = $event => (_ctx.activeField = '')),\n    onFinishAction: _ctx.onFinish,\n    skipSummary: true,\n    cancelDestinationPath: _ctx.cancelDestination\n  }, null, 8, [\"fields\", \"activeField\", \"onFinishAction\", \"cancelDestinationPath\"]))\n}","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Vitals.vue?vue&type=template&id=0953bc40&ts=true\"\nimport script from \"./Vitals.vue?vue&type=script&lang=ts\"\nexport * from \"./Vitals.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}