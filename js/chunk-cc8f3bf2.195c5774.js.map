{"version":3,"sources":["webpack:///./src/services/person_attributes_service.ts","webpack:///./src/services/patient_registration_service.ts","webpack:///./src/components/Forms/HisStandardForm.vue?f008","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/components/Forms/HisStandardForm.vue?6820","webpack:///./src/utils/HisFormHelpers/PersonFieldHelper.ts","webpack:///./src/views/PatientRegistration.vue?4ce2","webpack:///./src/views/PatientRegistration.vue","webpack:///./src/views/PatientRegistration.vue?ad61","webpack:///./src/services/person_service.ts","webpack:///./src/utils/HisFormHelpers/LocationFieldOptions.ts"],"names":["PersonAttributeService","Service","constructor","super","attributes","postJson","PatientRegistrationService","this","personId","getPersonID","setPersonID","personID","person","personAttributes","createPerson","createPersonAttributes","patient","createPatient","printPatient","updatePerson","PersonService","update","data","create","person_id","ProgramService","index","PatientPrintoutService","printNidLbl","render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createBlock","_resolveDynamicComponent","formType","fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onFinishAction","onOnIndex","onIndex","defineComponent","name","components","TouchScreenForm","emits","props","type","Function","Boolean","default","String","Object","required","methods","formData","computedData","$emit","i","__exports__","mapToOption","listOptions","map","item","label","value","resolvePerson","computedForm","attr","values","isPlainObject","getGivenNameField","id","helpText","FieldType","TT_TEXT","computedValue","val","validation","Validation","isName","options","async","form","given_name","names","searchGivenName","getFamilyNameField","family_name","searchFamilyName","getGenderField","customOptions","TT_SELECT","isEmpty","getDobConfig","includeHelpText","summaryLabel","minDate","HisDate","estimateDateFromAge","maxDate","getSessionDate","estimation","allowUnknown","allowUnknownMonthDay","estimationFieldType","EstimationFieldType","AGE_ESTIMATE_FIELD","computeValue","date","isEstimate","birthdate","getHomeRegionField","group","requireNext","getRegions","getHomeDistrictField","dynamicHelpText","f","home_region","match","getDistricts","addCustomLocationBtnForTAorVillage","BtnName","formParentAddressRef","slot","color","onClick","c","field","filter","length","toastWarning","filtered","ok","alertConfirmation","address","LocationService","createAddress","toUpperCase","getHomeTaField","config","showKeyboard","isFilterDataViaApi","footerBtns","defaultOutput","defaultComputedOutput","getTraditionalAuthorities","home_district","getHomeVillageField","getVillages","home_traditional_authority","getCurrentRegionField","test","home_village","onClickComponentEvents","setValue","getCurrentDistrictField","current_region","getCurrentTAfield","current_district","getCurrentVillageField","current_traditional_authority","getCellNumberField","number","split","isMWPhoneNumber","customKeyboard","getLandmarkFields","proxyID","appearInSummary","default_landmarks","TT_NOTE","condition","v","getFacilityLocationField","_","getFacilities","getPersonNameFromPersonObj","personObj","getAttrFromPersonObj","Array","isArray","person_attributes","reduce","getAddressFromPersonObj","addresses","addressMap","mapPersonData","givenName","familyName","homeDistrict","homeVillage","homeTA","gender","birthdate_estimated","getPersonAttributeOptions","Patientservice","prop","getPatientInfoString","getID","getNationalID","other","npid","show","getProgramName","_component_his_standard_form","_resolveComponent","_component_ion_page","_withCtx","_createVNode","formLabel","$event","fieldComponent","HisStandardForm","IonPage","app","App","getActiveApp","ddeInstance","ddeDocID","ddeIsReassign","currentAddressAttributes","homeAddressAttributes","hasIncompleteData","editPersonData","editPerson","personAttribute","isMilitarySite","presets","registrationSummary","ddeEnabled","watch","query","PatientDemographicsExchangeService","edit_person","dde_reassign","doc_id","setPatientID","person_attribute","initEditMode","getFields","immediate","deep","push","personIndexField","hasScannedNationalID","concat","hiddenFieldsForScannedNationalID","givenNameField","familyNameField","genderField","searchResultField","dobFields","homeRegionField","homeDistrictField","homeTAField","homeVillageField","currentRegionField","currentDistrictField","currentTAField","currentVillage","landmarkFields","cellPhoneField","patientTypeField","facilityLocationField","occupationField","regimentField","dateJoinedMilitaryFields","rankField","relationshipField","possibleDuplicatesField","isEditMode","nationalIDStatus","Store","get","patientID","parseInt","ancestryDistrict","ancestryTA","ancestryVillage","currentDistrict","currentTA","getAddresses","getGivenName","getFamilyName","getGender","getBirthdate","getPhoneNumber","getClosestLandmark","PersonField","resolvePersonAttributes","registration","registerPatient","set","updateMWNationalId","malawiNationalID","onRegisterPatient","exit","$router","$route","relationship","nextTask","invalidate","back","editConditionCheck","includes","getDocID","assignNpid","printNationalID","delayPromise","e","toastDanger","d","console","error","TT_HIDDEN","defaultValue","toLowerCase","findByID","IS_ANC_APP","applicationName","IS_CXCA","beforeNext","newGender","oldGender","action","infoActionSheet","dobConfig","sdate","childBearingAgeInYrs","dayjs","subtract","format","STANDARD_DATE_FORMAT","generateDateFields","region","district","currentRegion","summaryMapValue","current_village","cellPhone","cell_phone_number","facility","patient_type","landmarks","PatientTypeService","getPatientTypes","init","GLOBAL_PROP","militarySiteEnabled","occupation","WorkflowService","IS_HTS","OPD","Registration","TT_PERSON_RESULT_VIEW","payload","patients","searchDemographics","itemData","search","hiddenFooterBtns","state","disabled","onValue","results","createdPerson","duplicatePatients","TT_PERSON_MATCH_VIEW","checkPotentialDuplicates","toDate","toStandardHisDisplayFormat","score","patient_id","newPerson","foundPerson","comparisons","visible","possible_duplicates","TT_TABLE_VIEWER","editButton","attribute","columns","rows","landmark","emptySets","indexes","class","forEach","r","isValueEmpty","rowColors","onload","reassignNpid","printNpid","confirmPatient","putJson","getProgramID","getJson","facilities","trim","location_id","getLabFacilities","getLabs","getFacilityWards","wards","tag","ward","getSpecialistClinics","clinics","clinic","regions","region_id","regionID","districts","district_id","districtID","TAs","TA","traditional_authority_id","traditionalAuthorityID","villages","village","village_id"],"mappings":"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","file":"js/chunk-cc8f3bf2.195c5774.js","sourcesContent":["import { Service } from \"./service\"\n\nexport interface NewAttribute {\n    person_id: number;\n    person_attribute_type_id: number;\n    value: number | string;\n}\n\nexport class PersonAttributeService extends Service { \n    constructor() {\n        super()\n    }\n\n    static create(attributes: Array<NewAttribute>) { \n        return super.postJson('/person_attributes', attributes) \n    }\n}\n","import { Service } from \"./service\"\nimport { ProgramService } from \"@/services/program_service\";\nimport { Person } from \"@/interfaces/person\"\nimport { PersonService } from \"@/services/person_service\"\nimport { PersonAttributeService } from '@/services/person_attributes_service'\nimport { PatientPrintoutService } from \"@/services/patient_printout_service\";\n\nexport class PatientRegistrationService extends Service {\n    personId: number\n    constructor() {\n        super()\n        this.personId = 0\n    }\n\n    getPersonID() {\n        return this.personId\n    }\n\n    setPersonID(personID: number) {\n        this.personId = personID\n    }\n\n    async registerPatient(person: any, personAttributes: any) {\n        await this.createPerson(person)\n        await this.createPersonAttributes(personAttributes)\n        const patient = await this.createPatient()\n        await this.printPatient()\n        return patient\n    }\n\n    async registerBasicPatient(person: any) {\n        await this.createPerson(person)\n        return this.createPatient()\n    }\n\n    async registerGuardian(person: any) {\n        return this.createPerson(person)\n    }\n\n    updatePerson(person: any) {\n       return new PersonService(person).update(this.personId)\n    }\n\n    async createPerson(person: any) {\n        const data: Person = await new PersonService(person).create()\n        this.personId = data.person_id\n        return data\n    }\n\n    createPatient() {\n        return ProgramService.createPatient(this.personId)\n    }\n\n    async createPersonAttributes(attributes: Array<any>) {\n        for(const index in attributes) {\n            await PersonAttributeService.create({\n                ...attributes[index],\n                'person_id': this.personId\n            })\n        }\n    }\n\n    printPatient() {\n        return new PatientPrintoutService(this.personId).printNidLbl()\n    }\n}\n","import { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.formType), {\n    fields: _ctx.fields,\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.activeField,\n    cancelDestinationPath: _ctx.cancelDestinationPath,\n    onOnFinish: _ctx.onFinish,\n    onFinish: _ctx.onFinishAction,\n    onOnIndex: _ctx.onIndex\n  }, null, 40, [\"fields\", \"skipSummary\", \"activeField\", \"cancelDestinationPath\", \"onOnFinish\", \"onFinish\", \"onOnIndex\"]))\n}","\nimport TouchScreenForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport { defineComponent, PropType } from \"vue\";\nimport { Field } from \"./FieldInterface\";\n\nexport default defineComponent({\n    name: \"HisStandardForm\",\n    components: { TouchScreenForm },\n    emits: [\n        'onFinish',\n        'onIndex'\n    ],\n    data: () => ({\n        formType: 'touch-screen-form' as string\n    }),\n    props: {\n        onFinishAction: {\n            type: Function\n        },\n        skipSummary: {\n            type: Boolean,\n            default: false\n        },\n        activeField: {\n            type: String\n        },\n        fields: {\n            type: Object as PropType<Field[]>,\n            required: true\n        },\n        cancelDestinationPath: {\n            type: String,\n            required: false,\n        }\n    },\n    methods: {\n        onFinish(formData: any, computedData: any) {\n            this.$emit('onFinish', formData, computedData)\n        },\n        onIndex(i: number) {\n            this.$emit('onIndex', i)\n        }\n    }\n})\n","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {\n    getFacilities,\n    getRegions,\n    getDistricts,\n    getTraditionalAuthorities,\n    getVillages\n} from '@/utils/HisFormHelpers/LocationFieldOptions'\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport {PersonService} from \"@/services/person_service\"\nimport { EstimationFieldType } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport HisDate from \"@/utils/Date\"\nimport { DateFieldInterface } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport { alertConfirmation, toastWarning } from '../Alerts'\nimport { LocationService } from '@/services/location_service'\nimport { Service } from '@/services/service'\n\nfunction mapToOption(listOptions: Array<string>): Array<Option> {\n    return listOptions.map((item: any) => ({ \n        label: item, value: item \n    })) \n}\nexport default {\n    resolvePerson(computedForm: any) {\n        let data: any = {}\n        for(const attr in computedForm) {\n            const values = computedForm[attr]\n            if (isPlainObject(values) && 'person' in values) {\n                if (isPlainObject(values.person)) {\n                    data = {...data, ...values.person}\n                } else {\n                    data[attr] = values['person']\n                }\n            }\n        }\n        return data   \n    },\n    getGivenNameField(): Field {\n        return {\n            id: 'given_name',\n            helpText: 'First name',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.given_name) {\n                    const names = await PersonService.searchGivenName(form.given_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getFamilyNameField(): Field {\n        return {\n            id: 'family_name',\n            helpText: \"Last name\",\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.family_name) {\n                    const names = await PersonService.searchFamilyName(form.family_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getGenderField(customOptions?: Option[]): Field {\n        return  {\n            id: 'gender',\n            helpText: 'Sex',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.required(val),\n            options: () => !isEmpty(customOptions)\n                ? customOptions as Option[]\n                : ([\n                    {\n                        label: 'Female',\n                        value: 'F'\n                    },\n                    { \n                        label: 'Male',\n                        value: 'M'\n                    }\n                ])\n        }\n    },\n    getDobConfig(includeHelpText = true): DateFieldInterface {\n        return  {\n            id: 'birth_date',\n            summaryLabel: 'Date of Birth',\n            helpText: includeHelpText ? 'Birth' : '',\n            required: true,\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => PersonService.getSessionDate(),\n            estimation: {\n                allowUnknown: true,\n                allowUnknownMonthDay: true,\n                estimationFieldType: EstimationFieldType.AGE_ESTIMATE_FIELD\n            },\n            computeValue: (date: string, isEstimate: boolean) => {\n                return {\n                    date,\n                    isEstimate,\n                    person: {\n                        birthdate: date,\n                        'birthdate_estimated': isEstimate\n                    }\n                }\n            }\n        }\n    },\n    getHomeRegionField(): Field {\n        return {\n            id: 'home_region',\n            helpText: 'Region of origin',\n            type: FieldType.TT_SELECT,\n            group: 'person',\n            requireNext: false,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions()\n        }\n    },\n    getHomeDistrictField() {\n        return  {\n            id: 'home_district',\n            helpText: 'District of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            dynamicHelpText: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return 'Home Country'\n                }\n                return 'District of origin'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            options: (form: any) => getDistricts(form.home_region.value)\n        }\n    },\n    addCustomLocationBtnForTAorVillage(BtnName: string, formParentAddressRef: string) {\n        return {\n            name: `Add ${BtnName}`,\n            slot: \"end\",\n            color: \"success\",\n            onClick: async (f: any, c: any, field: any) => {\n                 if (typeof field.filter != 'string' || field.filter.length < 3) {\n                    return toastWarning(`Please enter a valid ${BtnName}`)\n                 }\n                 if (!isEmpty(field.filtered)) {\n                    return toastWarning(`Can't add existing ${BtnName}`)\n                 } \n                 const ok = await alertConfirmation(`Do you want to add ${BtnName} ${field.filter}?`)\n\n                 if (!ok) return\n\n                 const address = await LocationService.createAddress(BtnName, field.filter, f[formParentAddressRef].value)\n                 if (address) {\n                    // Hack to force the list to reload the list with new data\n                    field.filter = field.filter.toUpperCase() \n                 } else {\n                    return toastWarning(`Unable to add ${BtnName}`)\n                 }\n            }\n         }\n    },\n    getHomeTaField() {\n        return  {\n            id: 'home_traditional_authority',\n            helpText: 'TA of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'home_district')\n                ]\n            },\n            defaultOutput: () => ({label: 'N/A', value: 'N/A'}),\n            defaultComputedOutput: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.home_district.value, filter)\n        }\n    },\n    getHomeVillageField() {\n        return {\n            id: 'home_village',\n            helpText: 'Village of origin',\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'home_traditional_authority')\n                ]\n            },\n            requireNext: false,\n            defaultOutput: () => ({ label: 'N/A', value: 'N/A' }),\n            defaultComputedOutput: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.home_traditional_authority.value, filter)\n        }\n    },\n    getCurrentRegionField() {\n        return {\n            id: 'current_region',\n            helpText: 'Current Region of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option, f: any) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_region': f.home_region.label,\n                            'current_district': f.home_district.label,\n                            'current_traditional_authority': f.home_traditional_authority.label,\n                            'current_village': f.home_village.label \n                        }\n                    }\n                }\n                return { person: val.label }\n            },\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions(),\n            config: {\n                footerBtns: [\n                  {\n                    name: \"Same as origin\",\n                    slot: \"end\",\n                    onClickComponentEvents: {\n                      setValue: () => 'Use Home Address'\n                    },\n                    onClick: () => \"Use Home Address\"\n                  }\n                ]\n            }\n        }\n    },\n    getCurrentDistrictField() {\n        return {\n            id: 'current_district',\n            helpText: 'District',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            dynamicHelpText: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return 'Current Country'\n                }\n                return 'Current District of Residence'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any) => getDistricts(form.current_region.value),\n        }\n    },\n    getCurrentTAfield() {\n        return    {\n            id: 'current_traditional_authority',\n            helpText: 'Current TA of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'current_district')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            defaultComputedOutput: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.current_district.value, filter)\n        }\n    },\n    getCurrentVillageField() {\n        return {\n            id: 'current_village',\n            helpText: 'Current Village of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'current_traditional_authority')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            defaultComputedOutput: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.current_traditional_authority.value, filter)\n        }\n    },\n    getCellNumberField() {\n        return   {\n            id: 'cell_phone_number',\n            helpText: 'Cell phone number',\n            group: 'person',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => {\n                if (val) {\n                    if (val.value.match(/Unknown|n\\/a/i)) {\n                        return null\n                    }\n                    for(const number of `${val.value}`.split('/')) {\n                        if (Validation.isMWPhoneNumber({label: number, value: number})) {\n                            return [`\"${number}\" is not a valid phone number`]\n                        }\n                    }\n                    return null\n                }\n                return ['Phone number cannot be empty']\n            },\n            config: {\n                customKeyboard: [\n                    [\n                        ['1', '2', '3'],\n                        ['4', '5', '6'],\n                        ['7', '8', '9'],\n                        ['',  '0', '']\n                    ],\n                    [ \n                        [ '+265', '/'],\n                        [ 'Unknown', 'N/A' ],\n                        [ 'Delete' ]\n                    ]\n                ]\n            }\n        }\n    },\n    getLandmarkFields(): Field[] {\n        return [\n            {\n                id: 'default_landmarks',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_SELECT,\n                appearInSummary: (f: any) => f.default_landmarks.value != 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (val: any) => Validation.required(val),\n                options: () => mapToOption([\n                    'Catholic Church',\n                    'CCAP',\n                    'Seventh Day',\n                    'Mosque',\n                    'Primary School',\n                    'Borehole',\n                    'Secondary School',\n                    'College',\n                    'Market',\n                    'Football Ground',\n                    'Other'\n                ])\n            },\n            {\n                id: 'other_landmark',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_NOTE,\n                appearInSummary: (f: any) => f.default_landmarks.value === 'Other',\n                condition: (f: any) => f.default_landmarks.value === 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (v: Option) => Validation.required(v)\n            }\n        ]\n    },\n    getFacilityLocationField() {\n        return  {\n            id: 'location',\n            helpText: 'Please select facility name',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (_: any, filter='') => getFacilities(filter),\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true\n            }\n        }\n    },\n    getPersonNameFromPersonObj(personObj: any, type: 'given_name' | 'family_name') {\n        if (personObj.names.length) {\n            return personObj.names[0][type]\n        }\n        return ''\n    },\n    getAttrFromPersonObj(personObj: any, type: 'Landmark Or Plot Number' | 'Cell Phone Number') {\n        if (Array.isArray(personObj.person_attributes) && personObj.person_attributes.length) {\n            return personObj.person_attributes.reduce((v: string, c: any) => {\n                if (c.type.name === type) {\n                    return c.value\n                }\n                return v\n            }, '')\n        }\n        return ''\n    },\n    getAddressFromPersonObj(personObj: any, \n        type: 'home_region' | \n        'home_district' | \n        'home_region' | \n        'home_village' | \n        'home_traditional_authority' | \n        'current_region' |\n        'current_traditional_authority' | \n        'current_district') {\n        if (Array.isArray(personObj.addresses) && personObj.addresses.length) {\n            const address: any = personObj.addresses[0]\n            const addressMap: Record<string, string> = {\n                'home_district': 'address2', \n                'home_village': 'neighborhood_cell',\n                'home_traditional_authority': 'county_district', \n                'current_village': 'city_village',\n                'current_traditional_authority' : 'township_division',\n                'current_district': 'state_province'\n            }\n            return address[addressMap[type]]\n        }\n        return ''\n    },\n    mapPersonData(personObj: any) {\n        const givenName = this.getPersonNameFromPersonObj(personObj, 'given_name')\n        const familyName = this.getPersonNameFromPersonObj(personObj, 'family_name')\n        const homeDistrict = this.getAddressFromPersonObj(personObj, 'home_district')\n        const homeVillage = this.getAddressFromPersonObj(personObj, 'home_village')\n        const homeTA = this.getAddressFromPersonObj(personObj, 'home_traditional_authority')\n        return {\n            'id': personObj.person_id,\n            'name': `${givenName} ${familyName}`,\n            'given_name': givenName,\n            'family_name': familyName,\n            'gender': personObj.gender,\n            'birth_date': personObj.birthdate,\n            'birthdate_estimated': personObj.birthdate_estimated,\n            'home_district': homeDistrict,\n            'home_village': homeVillage,\n            'home_traditional_authority': homeTA,\n            'home_address': `${homeDistrict} ${homeVillage}`,\n            'current_district': this.getAddressFromPersonObj(personObj, 'current_district'),\n            'current_traditional_authority': this.getAddressFromPersonObj(personObj, 'current_traditional_authority'),\n            'cell_phone_number': this.getAttrFromPersonObj(personObj, 'Cell Phone Number'),\n            'landmark': this.getAttrFromPersonObj(personObj, 'Landmark Or Plot Number')\n        }\n    },\n    getPersonAttributeOptions(person: any) {\n        const patient = new Patientservice(person);\n        const prop = (patient: any, prop: string) => prop in patient ? patient[prop]() : '-'\n        return {\n            label: patient.getPatientInfoString(),\n            value: patient.getID() || patient.getNationalID(),\n            other: {\n                npid: patient.getNationalID(),\n                person,\n                options: [\n                    {\n                        label: \"National ID\",\n                        value: prop(patient, 'getNationalID')\n                    },\n                    {\n                        label: 'ARV Number',\n                        value: prop(patient, 'getArvNumber'),\n                        other: {\n                            show: () => Service.getProgramName() === \"ART\" \n                        }\n                    },\n                    {\n                        label: \"Name\",\n                        value: prop(patient, 'getFullName'),\n                    },\n                    {\n                        label: \"Sex\",\n                        value: prop(patient, 'getGender'),\n                    },\n                    {\n                        label: \"Birthdate\",\n                        value: prop(patient, 'getBirthdate'),\n                    },\n                    {\n                        label: \"Home District\",\n                        value: prop(patient, 'getHomeDistrict'),\n                    },\n                    {\n                        label: \"Home Village\",\n                        value: prop(patient, 'getHomeVillage'),\n                    },\n                    {\n                        label: \"Current District\",\n                        value: prop(patient, 'getCurrentDistrict'),\n                    },\n                    {\n                        label: \"Current T/A\",\n                        value: prop(patient, 'getCurrentTA'),\n                    },\n                    {\n                        label: 'Cellphone',\n                        value: prop(patient, 'getPhoneNumber')\n                    }\n                ]\n            }\n        }    \n    }\n}\n","import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")!\n  const _component_ion_page = _resolveComponent(\"ion-page\")!\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_his_standard_form, {\n        formLabel: _ctx.formLabel,\n        onOnIndex: _cache[0] || (_cache[0] = ($event: any) => (_ctx.fieldComponent='')),\n        skipSummary: _ctx.skipSummary,\n        activeField: _ctx.fieldComponent,\n        fields: _ctx.fields,\n        onFinishAction: _ctx.onFinish\n      }, null, 8, [\"formLabel\", \"skipSummary\", \"activeField\", \"fields\", \"onFinishAction\"])\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from \"vue\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport { generateDateFields } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport HisDate from \"@/utils/Date\"\nimport { STANDARD_DATE_FORMAT } from \"@/utils/Date\"\nimport { WorkflowService } from \"@/services/workflow_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport PersonField from \"@/utils/HisFormHelpers/PersonFieldHelper\"\nimport { PatientRegistrationService } from \"@/services/patient_registration_service\"\nimport App from \"@/apps/app_lib\"\nimport { AppInterface } from \"@/apps/interfaces/AppInterface\"\nimport { nextTask } from \"@/utils/WorkflowTaskHelper\"\nimport { isValueEmpty } from \"@/utils/Strs\"\nimport { PatientDemographicsExchangeService } from \"@/services/patient_demographics_exchange_service\"\nimport { toastDanger, toastWarning } from \"@/utils/Alerts\"\nimport { PatientTypeService } from \"@/apps/ART/services/patient_type_service\";\nimport { IonPage } from \"@ionic/vue\"\nimport { infoActionSheet } from \"@/utils/ActionSheets\"\nimport GLOBAL_PROP from \"@/apps/GLOBAL_APP/global_prop\";\nimport dayjs from \"dayjs\";\nimport { delayPromise } from \"@/utils/Timers\";\nimport Store from \"@/composables/ApiStore\"\n\nexport default defineComponent({\n  components: { HisStandardForm, IonPage },\n  data: () => ({\n    formLabel: 'Find / Register',\n    app: App.getActiveApp() as AppInterface,\n    ddeInstance: {} as any,\n    ddeDocID: '' as string,\n    ddeIsReassign: false as boolean,\n    skipSummary: false as boolean,\n    currentAddressAttributes: [\n        'current_region',\n        'current_district',\n        'current_village',\n        'current_traditional_authority'\n    ] as string[],\n    homeAddressAttributes: [\n        'home_region',\n        'home_district',\n        'home_traditional_authority',\n        'home_village'\n    ] as string[],\n    hasIncompleteData: false as boolean,\n    patient: {} as any,\n    editPersonData: {} as any,\n    editPerson: -1 as number,\n    personAttribute: '' as string,\n    activeField: '' as string,\n    fieldComponent: '' as string,\n    fields: [] as Array<Field>,\n    isMilitarySite: false,\n    presets: {} as any,\n    registrationSummary: {} as any,\n    form: {} as Record<string, Option> | Record<string, null>,\n    ddeEnabled: false as boolean,\n  }),\n  watch: {\n    '$route': {\n        async handler({query}: any) {\n           this.ddeInstance = new PatientDemographicsExchangeService()\n           if (query.edit_person) {\n                this.ddeIsReassign = query.dde_reassign\n                this.ddeDocID = query.doc_id\n                this.ddeInstance.setPatientID(query.edit_person)\n                if(query.person_attribute) this.personAttribute = query.person_attribute\n                await this.initEditMode(query.edit_person)\n            } else {\n                this.presets = query\n            }\n            this.fields = this.getFields()\n        },\n        immediate: true,\n        deep: true\n    }\n  },\n  methods: {\n    getFields(): Array<Field> {\n        let fields: Array<Field> = []\n        fields.push(this.personIndexField())\n        if (this.hasScannedNationalID()) {\n            fields = fields.concat(this.hiddenFieldsForScannedNationalID())\n        } else {\n            fields.push(this.givenNameField())\n            fields.push(this.familyNameField())\n            fields.push(this.genderField())\n        }\n        fields.push(this.searchResultField())\n        if (!this.hasScannedNationalID()) {\n            fields = fields.concat(this.dobFields())\n        }\n        fields.push(this.homeRegionField())\n        fields.push(this.homeDistrictField())\n        fields.push(this.homeTAField())\n        fields.push(this.homeVillageField())\n        fields.push(this.currentRegionField())\n        fields.push(this.currentDistrictField())\n        fields.push(this.currentTAField())\n        fields.push(this.currentVillage())\n        fields = fields.concat(this.landmarkFields())\n        fields.push(this.cellPhoneField())\n        fields.push(this.patientTypeField())\n        fields.push(this.facilityLocationField())\n        fields.push(this.occupationField())\n        fields.push(this.regimentField())\n        fields = fields.concat(this.dateJoinedMilitaryFields())\n        fields.push(this.rankField())\n        fields.push(this.relationshipField())\n        fields.push(this.possibleDuplicatesField())\n        return fields\n    },\n    isEditMode() {\n        return this.editPerson >= 1\n    },\n    hasScannedNationalID() {\n        return this.presets.nationalIDStatus === 'true'\n    },\n    async initEditMode(personId: number) {\n        this.editPerson = personId\n        this.patient = await Store.get('ACTIVE_PATIENT', { patientID: parseInt(`${this.editPerson}`)})\n        const {\n            ancestryDistrict,\n            ancestryTA,\n            ancestryVillage,\n            currentDistrict,\n            currentVillage,\n            currentTA\n        } = this.patient.getAddresses()\n        this.editPersonData = {\n            'given_name': this.patient.getGivenName(),\n            'family_name': this.patient.getFamilyName(),\n            'gender': this.patient.getGender(),\n            'birthdate': this.patient.getBirthdate(),\n            'home_district': ancestryDistrict,\n            'home_traditional_authority': ancestryTA,\n            'home_village': ancestryVillage,\n            'current_district': currentDistrict,\n            'current_village': currentVillage,\n            'current_traditional_authority': currentTA,\n            'cell_phone_number': this.patient.getPhoneNumber(),\n            'landmark': this.patient.getClosestLandmark()\n        }\n        this.presets = this.editPersonData\n        this.skipSummary = true\n        if(this.personAttribute) {\n            this.activeField = this.personAttribute\n            this.fieldComponent = this.activeField\n        }\n    },\n    async onFinish(form: Record<string, Option> | Record<string, null>, computedData: any) {\n        if (!this.isEditMode()) {\n            return this.create(form, computedData)\n        } else {\n            return this.update(computedData)\n        }\n    },\n    async create(_: any, computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const registration: any = new PatientRegistrationService()\n        const patient = new Patientservice((await registration.registerPatient(person, attributes)))\n        const patientID = registration.getPersonID()\n\n        Store.set('ACTIVE_PATIENT', patient) // update patient store\n \n        if(this.presets.nationalIDStatus == \"true\"){ \n            this.patient = patient\n            await this.patient.updateMWNationalId(this.presets.malawiNationalID)\n        }\n\n        if (this.app.onRegisterPatient) {\n            const exit = await this.app.onRegisterPatient(\n                patientID, person, attributes, this.$router, this.$route,\n                computedData\n            )\n            if (exit) return\n        }\n        if (person.relationship === 'Yes') {\n            return this.$router.push(`/guardian/registration/${patientID}`)\n        }\n        await nextTask(patientID, this.$router)\n    },\n    async update(computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const update = new PatientRegistrationService()\n\n        update.setPersonID(this.editPerson)\n        await update.updatePerson(person)\n        for(const attr in person) {\n            if (attr in this.editPersonData) {\n                this.editPersonData[attr] = person[attr]\n            }\n        }\n        Store.invalidate('ACTIVE_PATIENT')\n        if(!this.personAttribute) return this.fieldComponent = 'edit_user'\n        this.$router.back()\n    },\n    editConditionCheck(attributes=[] as Array<string>): boolean {\n        if (this.isEditMode() && !attributes.includes(this.activeField)) {\n            return false\n        }\n        return true\n    },\n    async confirmPatient() {\n        // Attempt to assign or reassign a patient's NPID if they dont have a valid one\n        if (this.ddeEnabled && (!this.patient.getDocID() \n            || (this.patient.getDocID() && this.patient.getNationalID().match(/unknown/i)))) {\n                try {\n                    await this.patient.assignNpid()\n                    await this.patient.printNationalID()\n                    await delayPromise(300)\n               } catch (e) {\n                    toastDanger(`Failed to assign new NPID: ${e}`)\n                }\n        }\n        this.$router.push(`/patients/confirm?person_id=${this.patient.getID()}`)\n    },\n    resolvePersonAttributes(form: Record<string, Option> | Record<string, null>) {\n        return Object.values(form)\n                    .filter((d: any) => isPlainObject(d) && 'personAttributes' in d)\n                    .map(({personAttributes}: any) => personAttributes)\n    },\n    async resolveOnRegistrationCallbacks(patientID: number, computedData: any) {\n        for (const i of Object.values(computedData)) {\n            const item: any = i\n            if (typeof item.onRegisterPatient === 'function') {\n                try {\n                    await item.onRegisterPatient(patientID)\n                } catch (e) {\n                    console.error(`${e}`)\n                    toastDanger(`${e}`)\n                }\n            }\n        }\n    },\n    mapToOption(listOptions: Array<string>): Array<Option> {\n        return listOptions.map((item: any) => ({ label: item, value: item }))\n    },\n    hiddenFieldsForScannedNationalID(): Field[] {\n        const d = (val: string | boolean) => ({label: val, value: val})\n        return [\n            {\n                id: 'given_name',\n                helpText: 'First name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.given_name),\n                computedValue: () => ({person : this.presets.given_name})\n            },\n            {\n                id: 'family_name',\n                helpText: 'Last name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.family_name),\n                computedValue: () => ({person : this.presets.family_name})\n            },\n            {\n                id: 'gender',\n                helpText: 'Gender',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => ({\n                    label: this.presets.gender,\n                    value: this.presets.gender.toLowerCase() === 'male'\n                        ? 'M'\n                        : this.presets.gender.toLowerCase() === 'female'\n                        ? 'F'\n                        : 'N/A'\n                }),\n                computedValue: () => ({person : this.presets.gender})\n            },\n            {\n                id: 'scanned_birthdate',\n                helpText: 'Birth date',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.birthdate),\n                computedValue: () => ({\n                    person : {\n                        'birthdate': this.presets.birthdate,\n                        'birthdate_estimated': false\n                    }\n                })\n            },\n            {\n                id: 'scanned_national_id',\n                helpText: 'Scanned National ID',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.malawiNationalID),\n                computedValue: () => ({\n                    onRegisterPatient : async (patientID: number) => {\n                        const patient = await Patientservice.findByID(patientID)\n                        this.patient = new Patientservice(patient)\n                        this.patient.updateMWNationalId(this.presets.malawiNationalID)\n                    }\n                })\n            }\n        ]\n    },\n    givenNameField(): Field {\n        const name: Field = PersonField.getGivenNameField()\n        name.condition = () => this.editConditionCheck(['given_name'])\n        name.defaultValue = () => this.presets.given_name\n        return name\n    },\n    familyNameField(): Field {\n        const name: Field = PersonField.getFamilyNameField()\n        name.condition = () => this.editConditionCheck(['family_name'])\n        name.defaultValue = () => this.presets.family_name\n        return name\n    },\n    genderField(): Field {\n        const IS_ANC_APP = this.app.applicationName === 'ANC'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const gender: Field = PersonField.getGenderField()\n        gender.requireNext = this.isEditMode()\n        gender.defaultValue = () => this.presets.gender\n        gender.condition = () => {\n            if (!this.isEditMode() && (IS_ANC_APP || IS_CXCA)) {\n                return false\n            }\n            return this.editConditionCheck(['gender'])\n        }\n        if ((IS_ANC_APP || IS_CXCA) && !this.isEditMode()) {\n            gender.defaultOutput = () => ({ label: 'Female', value: 'F' })\n            gender.defaultComputedOutput = () => ({ person: 'F' })\n        } \n\n        gender.beforeNext = async (data: Option) => {\n            /**\n             * Provide warning when changing gender in edit mode\n            */\n            const newGender = data.value\n            const oldGender = this.presets.gender\n            if (this.isEditMode() && newGender != oldGender) {\n                const action = await infoActionSheet(\n                    'Warning',\n                    `Changing gender from ${oldGender} to ${newGender}`,\n                    \"This change will cause data inconsistency and will affect alot of Reports.\",\n                    [\n                        {\n                            name: 'Cancel', slot: 'start'\n                        },\n                        {\n                            name: 'Change gender', slot: 'end', color: 'danger'\n                        }\n                    ]\n                )\n                return action === 'Change gender'\n            }\n            return true\n        }\n        return gender\n    },\n    dobFields(): Array<Field> {\n        const dobConfig = PersonField.getDobConfig()\n        dobConfig.defaultValue = () => this.presets.birthdate\n        dobConfig.condition = () => this.editConditionCheck([\n            'year_birth_date', 'month_birth_date', 'day_birth_date'\n        ])\n        // ANC validation to ensure that we are not registering\n        // Non child bearing youngsters\n        if (this.app.applicationName === 'ANC') {\n            const sdate = Patientservice.getSessionDate()\n            const childBearingAgeInYrs = 12\n            dobConfig.maxDate = () => dayjs(sdate)\n                .subtract(childBearingAgeInYrs, 'years')\n                .format(STANDARD_DATE_FORMAT)\n        }\n        return generateDateFields(dobConfig)\n    },\n    homeRegionField(): Field {\n        const region: Field = PersonField.getHomeRegionField()\n        region.condition = () => this.editConditionCheck(this.homeAddressAttributes)\n        return region\n    },\n    homeDistrictField(): Field {\n        const district: Field = PersonField.getHomeDistrictField()\n        district.condition = () => this.editConditionCheck(this.homeAddressAttributes)\n        return district\n    },\n    homeTAField(): Field {\n        const homeTA: Field = PersonField.getHomeTaField()\n        homeTA.condition = (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n            && !form.home_region.label.match(/foreign/i)\n        return homeTA\n    },\n    homeVillageField(): Field {\n        const homeVillage: Field = PersonField.getHomeVillageField()\n        homeVillage.condition = (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n            && !form.home_region.label.match(/foreign/i)\n        return homeVillage\n    },\n    currentRegionField(): Field {\n        const currentRegion: Field = PersonField.getCurrentRegionField()\n        currentRegion.summaryMapValue = (v: Option, f: any, computedData: any) => {\n            if (/use home/i.test(`${v.value}`)) {\n                return [\n                    { label: 'Current region', value: computedData.person?.current_region},\n                    { label: 'Current District/Country', value: computedData.person?.current_district },\n                    { label: 'Current Traditional Authority', value: computedData.person?.current_traditional_authority },\n                    { label: 'Current village', value: computedData.person?.current_village}\n                ]\n            }\n            return { label: 'Current Region', value: v.label }\n        }\n        if (this.isEditMode()) {\n            currentRegion.computedValue = (val: Option) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_district': this.editPersonData.home_district,\n                            'current_traditional_authority': this.editPersonData.home_traditional_authority,\n                            'current_village': this.editPersonData.home_village\n                        }\n                    }\n                }\n            }\n        }\n        currentRegion.condition = () => this.editConditionCheck(this.currentAddressAttributes)\n        return currentRegion\n    },\n    currentDistrictField(): Field {\n        const currentDistrict: Field = PersonField.getCurrentDistrictField()\n        currentDistrict.condition = (f: any) => !/use home/i.test(f.current_region.label) &&\n             this.editConditionCheck(this.currentAddressAttributes)\n        return currentDistrict\n    },\n    currentTAField(): Field {\n        const currentTA: Field = PersonField.getCurrentTAfield()\n        currentTA.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentTA\n    },\n    currentVillage(): Field {\n        const currentVillage: Field = PersonField.getCurrentVillageField()\n        currentVillage.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentVillage\n    },\n    cellPhoneField(): Field {\n        const cellPhone: Field = PersonField.getCellNumberField()\n        cellPhone.condition = () => this.editConditionCheck(['cell_phone_number'])\n        cellPhone.defaultValue = () => this.presets.cell_phone_number\n        return cellPhone\n    },\n    facilityLocationField(): Field {\n       const facility: Field = PersonField.getFacilityLocationField()\n       facility.condition = (form: any) => [\n           'Drug Refill',\n           'External consultation'\n       ].includes(form.patient_type.value)\n       return facility\n    },\n    landmarkFields(): Field[] {\n        const landmarks: Field[] = PersonField.getLandmarkFields()\n        landmarks[0].condition = () => this.editConditionCheck(['default_landmarks'])\n        return landmarks\n    },\n    patientTypeField(): Field {\n        return {\n            id: 'patient_type',\n            helpText: 'Type of patient',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['patient_type'])\n                && this.app.applicationName === 'ART',\n            validation: (val: any) => Validation.required(val),\n            options: () => PatientTypeService.getPatientTypes()\n        }\n    },\n    occupationField(): Field {\n        return {\n            id: 'occupation',\n            helpText: 'Occupation',\n            type: FieldType.TT_SELECT,\n            init: async () => {\n               this.isMilitarySite = await GLOBAL_PROP.militarySiteEnabled()\n               return true \n            },\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['occupation']) && this.isMilitarySite,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption([\n                'Military',\n                'Civilian'\n            ])\n        }\n    },\n    regimentField(): Field {\n        return {\n            id: 'person_regiment_id',\n            helpText: 'Regiment ID',\n            type: FieldType.TT_TEXT,\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 35,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['person_regiment_id']) && form.occupation && form.occupation.value.match(/Military/i),\n            validation: (val: any) => Validation.required(val)\n        }\n    },\n    rankField(): Field {\n        return {\n            id: 'rank',\n            helpText: 'Rank',\n            type: FieldType.TT_SELECT,\n            validation: (val: any) => Validation.required(val),\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 36,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['rank']) && form.occupation && form.occupation.value.match(/Military/i),\n            options: () => this.mapToOption([\n                'First Lieutenant',\n                'Captain',\n                'Major',\n                'Lieutenant Colonel',\n                'Colonel',\n                'Brigadier General',\n                'Lieutenant General',\n                'General',\n                'Private',\n                'Corporal',\n                'Lance Corporal',\n                'Seargent',\n                'Staff Seargent',\n                'Warrant Officer class 1',\n                'Warrant Officer class 2'\n            ])\n        }\n    },\n    dateJoinedMilitaryFields(): Array<Field> {\n        return generateDateFields({\n            id: 'person_date_joined_military',\n            helpText: 'Joined Military',\n            required: true,\n            condition: (form: any) =>  this.editConditionCheck([\n                'year_person_date_joined_military',\n                'month_person_date_joined_military',\n                'day_person_date_joined_military'\n            ]) && form.occupation && form.occupation.value.match(/Military/i),\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => WorkflowService.getSessionDate(),\n            estimation: {\n                allowUnknown: false\n            },\n            computeValue: (date: string) => ({\n                date,\n                personAttributes : {\n                    'person_attribute_type_id': 37, 'value': date\n                }\n            })\n        })\n    },\n    relationshipField(): Field {\n        const IS_HTS = this.app.applicationName === 'ITS'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const OPD = this.app.applicationName === 'OPD'\n        const Registration = this.app.applicationName === 'Registration'\n        return {\n            id: 'relationship',\n            helpText: 'Register guardian?',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['relationship']) && !IS_CXCA && !OPD && !Registration && !IS_HTS,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption(['Yes', 'No'])\n        }\n    },\n    searchResultField(): Field {\n        return {\n            id: 'results',\n            helpText: 'Search results',\n            type: FieldType.TT_PERSON_RESULT_VIEW,\n            init: async () => {\n                if (!this.isEditMode()) { \n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                }\n                return true\n            },\n            dynamicHelpText: (form: any) => {\n                return `Search results for \"${form.given_name.value} ${form.family_name.value} | ${form.gender.label}\"`;\n            },\n            appearInSummary: () => false,\n            condition: () => !this.isEditMode(),\n            options: async (form: any) => {\n                const payload = {\n                    'given_name': form.given_name.value,\n                    'family_name': form.family_name.value,\n                    'gender': form.gender.value\n                }\n                // DDE enabled search\n                if (this.ddeEnabled) {\n                    const patients = await this.ddeInstance.searchDemographics(payload)\n                    return patients.map((item: any) => {\n                        const itemData = PersonField.getPersonAttributeOptions(item)\n                        itemData.other.options.push({\n                            label: 'Patient Type',\n                            value: item.patient_type\n                        })\n                        itemData.other.options.push({\n                            label: 'Doc ID',\n                            value: item.doc_id\n                        })\n                        return itemData\n                    })\n                }\n                // Regular search\n                const patients = await Patientservice.search(payload);\n                return patients.map((item: any) => PersonField.getPersonAttributeOptions(item))\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next',\n                    'Back'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Edit Search',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = 'given_name'\n                        },\n                        state: {\n                            disabled: {\n                                default: () => this.hasScannedNationalID()\n                            }\n                        }\n                        \n                    },\n                    {\n                        name: 'New Client',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Continue',\n                        color: 'success',\n                        slot: 'end',\n                        state: {\n                            disabled: {\n                                default: () => true,\n                                onValue(_: any,form: any) {\n                                    return isEmpty(form.results)\n                                }\n                            }\n                        },\n                        onClick: (form: any) => {\n                            return this.$router.push(`/patients/confirm?person_id=${form.results.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    possibleDuplicatesField(): Field {\n        let createdPerson: any = {}\n        let duplicatePatients: any = {}\n        return {\n            id: 'possible_duplicates',\n            helpText: 'Possible Duplicate(s)',\n            type: FieldType.TT_PERSON_MATCH_VIEW,\n            condition: async (_: any, c: any) => {\n                if (this.ddeEnabled && this.editPerson <= 0) {\n                    createdPerson = PersonField.resolvePerson(c)\n                    duplicatePatients = await this.ddeInstance\n                        .checkPotentialDuplicates(createdPerson)\n                    return duplicatePatients.length >= 1\n                }\n                return false\n            },\n            options: async () => {\n                const toDate = (date: string) => HisDate.toStandardHisDisplayFormat(date)\n                return duplicatePatients.map(({ score, person }: any) => {\n                    const name = `${person.given_name} ${person.family_name}`\n                    return {\n                        label: name,\n                        value: person.patient_id,\n                        other: {\n                            score: `${score * 100}%`,\n                            newPerson: createdPerson,\n                            foundPerson: person,\n                            comparisons: [\n                                [\n                                    'Name',\n                                    `${createdPerson.given_name} ${createdPerson.family_name}`,\n                                    `${person.given_name} ${person.family_name}`\n                                ],\n                                [\n                                    'Gender',\n                                    createdPerson.gender,\n                                    person.gender\n                                ],\n                                [\n                                    'Birthdate',\n                                    toDate(createdPerson.birthdate),\n                                    toDate(person.birthdate)\n                                ],\n                                [\n                                    'Home District',\n                                    createdPerson.home_district,\n                                    person.home_district\n                                ],\n                                [\n                                    'Home TA',\n                                    createdPerson.home_traditional_authority,\n                                    person.home_traditional_authority\n                                ]\n                            ]\n                        }\n                    }\n                })\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Not Duplicate',\n                        slot: 'start',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: (form: any) => {\n                            this.$router.push(`/patients/confirm?person_id=${form.possible_duplicates.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    personIndexField(): Field {\n        return {\n            id: 'edit_user',\n            helpText: 'Edit Demographics',\n            type: FieldType.TT_TABLE_VIEWER,\n            init: async () => {\n                if (this.isEditMode()) {\n                    this.formLabel = 'View / Edit'\n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                }\n                return true\n            },\n            condition: () => this.isEditMode(),\n            options: async () => {\n                const editButton = (attribute: string) => ({\n                    name: 'Edit',\n                    type: 'button',\n                    action: () => {\n                        this.activeField = attribute\n                        this.fieldComponent = this.activeField\n                    }\n                })\n                const columns = ['Attributes', 'Values', 'Edit']\n                const rows = [\n                    ['Given Name', this.editPersonData.given_name, editButton('given_name')],\n                    ['Family Name', this.editPersonData.family_name, editButton('family_name')],\n                    ['Gender', this.editPersonData.gender,  editButton('gender')],\n                    ['Birthdate', HisDate.toStandardHisDisplayFormat(this.editPersonData.birthdate),  editButton('year_birth_date')],\n                    ['Cell Phone Number', this.editPersonData.cell_phone_number, editButton('cell_phone_number')],\n                    ['Home District', this.editPersonData.home_district, editButton('home_region')],\n                    ['Home TA', this.editPersonData.home_traditional_authority,  editButton('home_region')],\n                    ['Home Village', this.editPersonData.home_village,  editButton('home_region')],\n                    ['Current district',this.editPersonData.current_district, editButton('current_region')],\n                    ['Current Village',this.editPersonData.current_village, editButton('current_region')],\n                    ['Current T/A', this.editPersonData.current_traditional_authority, editButton('current_region')],\n                    ['Landmark', this.editPersonData.landmark, editButton('default_landmarks')],\n                ]\n                // Tag rows with empty values\n                const emptySets: any = {indexes: [], class: 'his-empty-set-color'}\n                rows.forEach((r: any, i: number) => {\n                    if (isValueEmpty(r[1])) \n                        emptySets.indexes.push(i)\n                })\n                this.hasIncompleteData = emptySets.indexes.length >= 1\n                return [{\n                    label: '', \n                    value: '',\n                    other: {\n                        rows,\n                        columns,\n                        rowColors: [emptySets]\n                    }\n                }]\n            },\n            config: {\n                footerBtns: [\n                    /**\n                     * Custom button that Appears when DDE wants to\n                     * Reassign a patient with incomplete data\n                    */\n                    {\n                        name: 'Reassign',\n                        slot: 'end',\n                        color: 'success',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onload: () => (\n                                    this.ddeEnabled\n                                    && this.ddeIsReassign\n                                    && !this.hasIncompleteData\n                                )\n                            }\n                        },\n                        onClick: async () => {\n                            try {\n                                await this.ddeInstance.reassignNpid(this.ddeDocID, this.editPerson)\n                                await this.ddeInstance.printNpid()\n                                this.$router.push(`/patients/confirm?person_id=${this.editPerson}`)\n                            } catch(e) {\n                                toastWarning(`${e}`)\n                            }\n                        }\n                    },\n                    /**\n                     * Custom button that redirects to patient confirmation page\n                     */\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                onload: () => !this.ddeIsReassign && !this.hasIncompleteData\n                            }\n                        },\n                        onClick: async () => this.confirmPatient()\n                    }\n                ],\n                hiddenFooterBtns: ['Clear', 'Next']\n            }\n        }\n    }\n  }\n})\n","import { render } from \"./PatientRegistration.vue?vue&type=template&id=93ab5484&ts=true\"\nimport script from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { Person } from \"@/interfaces/person\"\nimport { Service } from \"./service\"\n\nexport interface NewPerson {\n    person_id?: number;\n    given_name: string;\n    family_name: string;\n    gender: string;\n    birthdate: string;\n    birthdate_estimated: boolean;\n    home_district: string;\n    home_traditional_authority: string;\n    home_village: string;\n    current_district: string;\n    current_traditional_authority: string;\n    current_village: string;\n    landmark: string;\n    cell_phone_number: string;\n    occupation: string;\n    facility_name: string;\n    patient_type?: string;\n    relationship?: string;\n}\n\nexport class PersonService extends Service{\n    person: Person | NewPerson\n    constructor(person: NewPerson | Person){\n        super()\n        this.person = person\n    }\n\n    create() { return Service.postJson('/people', this.person) }\n\n    update(id: number) { return Service.putJson(`people/${id}`, {\n        ...this.person, 'program_id': Service.getProgramID()\n    })}\n\n    static searchFamilyName(name: string) {\n        return super.getJson('/search/family_name', {'search_string': name})\n    }\n\n    static searchGivenName(name: string) {\n        return super.getJson('/search/given_name', {'search_string': name})\n    }\n\n    static async getPersonFullName(personId: string | number) {\n        const names = await super.getJson(`/people/${personId}/names`)\n        return names && names.length ? names[0].given_name + ' ' + names[0].family_name : ''\n    }\n}\n","import {LocationService} from \"@/services/location_service\"\nimport { Option } from \"@/components/Forms/FieldInterface\"\nimport { isEmpty } from \"lodash\"\n\nexport async function getFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getFacilities({name: filter})\n    return facilities.filter((f: any) => !isEmpty(f) && f.name.trim() !='')\n        .map((facility: any) => ({\n            label: facility.name,\n            value: facility.location_id,\n            other: facility\n        }))\n}\n\nexport async function getLabFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getLabs({'search_name': filter})\n    return facilities.map((facility: any) => ({\n            label: facility,\n            value: facility\n        }))\n}\n\nexport async function getFacilityWards(filter=''): Promise<Option[]> {\n    const wards = await LocationService.getFacilities({\n        name: filter,\n        tag: 'Facility adult sections'\n    })\n\n    return wards.map((ward: any) => ({\n        label: ward.name,\n        value: ward.name,\n        other: ward\n    }))\n}\n\nexport async function getSpecialistClinics(): Promise<Option[]> {\n    const clinics = await LocationService.getSpecialistClinics()\n    return clinics.map((clinic: any) => ({\n        label: clinic.name,\n        value: clinic.name,\n        other: clinic\n    }))\n}\n\nexport async function getRegions(): Promise<Option[]> {\n    const regions = await LocationService.getRegions()\n    return regions.map((region: any) => ({\n        label: region.name,\n        value: region.region_id,\n        other: region\n    }))\n}\n\nexport async function getDistricts(regionID: number): Promise<Option[]> {\n    const districts = await LocationService.getDistricts(regionID)\n    return districts.map((district: any) => ({\n        label: district.name,\n        value: district.district_id,\n        other: district\n    }))\n}\n\nexport async function getTraditionalAuthorities(districtID: number, name=''): Promise<Option[]> {\n    const TAs = await LocationService.getTraditionalAuthorities(districtID, name)\n    return TAs.map((TA: any) => ({\n        label: TA.name,\n        value: TA.traditional_authority_id,\n        other: TA\n    }))\n}\n\nexport async function getVillages(traditionalAuthorityID: number, name=''): Promise<Option[]> {\n    const villages = await LocationService.getVillages(traditionalAuthorityID, name)\n    return villages.map((village: any) => ({\n        label: village.name,\n        value: village.village_id,\n        other: village\n    }))\n}\n"],"sourceRoot":""}