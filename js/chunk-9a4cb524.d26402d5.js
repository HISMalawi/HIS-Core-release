(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9a4cb524"],{"062e":function(e,t,n){},"12f0":function(e,t,n){"use strict";n.r(t);var a=n("7a23");function r(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("information-header"),u=Object(a["resolveComponent"])("report-table"),l=Object(a["resolveComponent"])("preloader"),s=Object(a["resolveComponent"])("pagination"),d=Object(a["resolveComponent"])("ion-content"),b=Object(a["resolveComponent"])("his-footer"),p=Object(a["resolveComponent"])("ion-page");return Object(a["openBlock"])(),Object(a["createBlock"])(p,{style:{background:"#fff"}},{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,{items:e.patientCardInfo,numberOfColumns:4,onAddGuardian:e.addGuardian,onUpdate:e.updateDemographics,onUpdateARVNumber:e.updateARVNumber},null,8,["items","onAddGuardian","onUpdate","onUpdateARVNumber"]),Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(u,{paginated:!0,rows:e.rows,columns:e.columns,rowsPerPage:e.itemsPerPage,newPage:e.currentPage,asyncRowParser:e.onNewRow,onOnPagination:t[1]||(t[1]=function(t){return e.totalPages=t.length})},null,8,["rows","columns","rowsPerPage","newPage","asyncRowParser"]),e.visitDatesInitialised?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(l,{key:0,itemCount:5})),Object(a["createVNode"])(s,{perPage:e.itemsPerPage,maxVisibleButtons:20,totalPages:e.totalPages,onOnChangePage:t[2]||(t[2]=function(t){return e.currentPage=t})},null,8,["perPage","totalPages"])]})),_:1}),Object(a["createVNode"])(b,{btns:e.btns},null,8,["btns"])]})),_:1})}var o=n("2909"),i=n("3835"),c=n("b85c"),u=n("1da1"),l=(n("96cf"),n("d81d"),n("3ca3"),n("ddb0"),n("a15b"),n("99af"),n("b0c0"),n("ac1f"),n("466d"),n("caad"),n("2532"),n("d3b7"),n("25f0"),n("9283")),s=n("23e6"),d=n("7957"),b=Object(a["withScopeId"])("data-v-94355f20");Object(a["pushScopeId"])("data-v-94355f20");var p={style:{padding:".1rem"}},f={style:{width:"100%",display:"flex",justifyContent:"space-between",fontSize:"12px",margin:0,padding:0}};Object(a["popScopeId"])();var m=b((function(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("ion-item"),u=Object(a["resolveComponent"])("ion-list"),l=Object(a["resolveComponent"])("multi-column-view");return Object(a["openBlock"])(),Object(a["createBlock"])("div",p,[Object(a["createVNode"])(l,{items:e.items,numberOfColumns:e.numberOfColumns},{default:b((function(t){var n=t.entries;return[Object(a["createVNode"])(u,null,{default:b((function(){return[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(n,(function(t){return Object(a["openBlock"])(),Object(a["createBlock"])(c,{key:t.label,style:{padding:"0 !important",margin:"0 !important"}},{default:b((function(){return[Object(a["createVNode"])("div",f,[Object(a["createVNode"])("span",null,Object(a["toDisplayString"])(t.label)+": ",1),t.other&&t.other.editable?(Object(a["openBlock"])(),Object(a["createBlock"])("span",{key:0,onClick:function(n){return e.onClick(t)}},[Object(a["createVNode"])("a",null,[Object(a["createVNode"])("b",null,Object(a["toDisplayString"])(t.value),1)])],8,["onClick"])):(Object(a["openBlock"])(),Object(a["createBlock"])("b",{key:1,innerHTML:t.value||"N/A"},null,8,["innerHTML"]))])]})),_:2},1024)})),128))]})),_:2},1024)]})),_:1},8,["items","numberOfColumns"])])})),g=(n("a9e3"),n("92c1")),v=Object(a["defineComponent"])({name:"InformationHeader",components:{MultiColumnView:g["a"]},props:{icon:{required:!1},items:{type:Object,required:!0},numberOfColumns:{type:Number,default:2}},emits:["update","updateARVNumber","addGuardian"],setup:function(e,t){var n=t.emit,a=function(e){return"demographics"===e.other.category?n("update",e.other.attribute):"arv_number"===e.other.category?n("updateARVNumber"):n("addGuardian")};return{onClick:a}}}),h=(n("8945"),n("d959")),O=n.n(h);const j=O()(v,[["render",m],["__scopeId","data-v-94355f20"]]);var V=j,C=n("0f25"),y=n("2ef0"),w=n("8a30"),I=n("7def"),P=n("b5e4"),k=n("ad60"),x=n("4db7"),N=n("8e8b"),T=n("80e3"),B=n("9ceb"),R=n("1799"),_=n("ded6"),D=Object(a["createTextVNode"])(" Close ");function S(e,t,n,r,o,i){var c=Object(a["resolveComponent"])("ion-title"),u=Object(a["resolveComponent"])("ion-toolbar"),l=Object(a["resolveComponent"])("ion-header"),s=Object(a["resolveComponent"])("information-header"),d=Object(a["resolveComponent"])("ion-content"),b=Object(a["resolveComponent"])("ion-button"),p=Object(a["resolveComponent"])("ion-footer");return Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],null,[Object(a["createVNode"])(l,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(u,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.title),1)]})),_:1})]})),_:1})]})),_:1}),Object(a["createVNode"])(d,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(s,{items:e.visitData},null,8,["items"])]})),_:1}),Object(a["createVNode"])(p,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(u,null,{default:Object(a["withCtx"])((function(){return[Object(a["createVNode"])(b,{onClick:e.closeModal,slot:"end"},{default:Object(a["withCtx"])((function(){return[D]})),_:1},8,["onClick"])]})),_:1})]})),_:1})],64)}var A=Object(a["defineComponent"])({components:{InformationHeader:V},props:{title:{type:String,required:!0},visitData:{type:Object,required:!0}},methods:{closeModal:function(){return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w["modalController"].dismiss({});case 2:case"end":return e.stop()}}),e)})))()}}});const F=O()(A,[["render",S]]);var H=F,E=Object(a["defineComponent"])({components:{Preloader:_["a"],Pagination:R["a"],IonPage:w["IonPage"],ReportTable:T["a"],IonContent:w["IonContent"],HisFooter:C["a"],InformationHeader:V},data:function(){return{patientId:0,patient:{},patientCardInfo:[],btns:[],itemsPerPage:10,currentPage:0,totalPages:0,pages:[],visitDates:[],tbStats:[],visitDatesInitialised:!1,columns:[[B["a"].thTxt("VISIT DATE"),B["a"].thTxt("WEIGHT (Kg)"),B["a"].thTxt("REG"),B["a"].thTxt("VIRAL LOAD"),B["a"].thTxt("TB STATUS"),B["a"].thTxt("OUTCOME"),B["a"].thTxt("PILLS DISPENSED"),B["a"].thTxt("ACTIONS")]],rows:[]}},created:function(){var e=this;this.setPatientCards(),this.patientId=parseInt("".concat(this.$route.params.patient_id)),s["a"].getPatientVisits(this.patientId,!0).then((function(t){e.visitDatesInitialised=!0,e.visitDates=t,e.rows=t.map((function(t){return[B["a"].tdBtn(l["c"].toStandardHisDisplayFormat(t),(function(){return new x["a"](e.patientId).printVisitSummaryLbl(t)})),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("..."),B["a"].td("...")]}))})).catch((function(t){e.visitDatesInitialised=!0,Object(P["c"])("".concat(t)),console.error(t)})),this.btns.push({name:"Finish",color:"success",size:"large",slot:"end",visible:!0,onClick:function(){Object(P["a"])("Are you sure you want to exit?").then((function(t){if(t)return e.$router.push("/patient/dashboard/".concat(e.patientId))}))}})},mounted:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.patientId){t.next=17;break}n=Object(c["a"])(e.patientCardInfo),t.prev=2,r=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.value,"function"!==typeof t.init){e.next=4;break}return e.next=4,t.init();case 4:"function"===typeof t.asyncValue?t.asyncValue(t).then((function(e){return t.value=e||""})):"function"===typeof t.staticValue&&(t.value=t.staticValue());case 5:case"end":return e.stop()}}),e)})),n.s();case 5:if((a=n.n()).done){t.next=9;break}return t.delegateYield(r(),"t0",7);case 7:t.next=5;break;case 9:t.next=14;break;case 11:t.prev=11,t.t1=t["catch"](2),n.e(t.t1);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[2,11,14,17]])})))()},methods:{setPatientCards:function(){var e=this;this.patientCardInfo=[{label:"ARV Number",value:"...",staticValue:function(){return e.patient.getArvNumber()},init:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,N["a"].get("ACTIVE_PATIENT",{patientID:e.patientId});case 2:e.patient=t.sent;case 3:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),other:{editable:!0,category:"arv_number"}},{label:"National Patient ID",value:"...",staticValue:function(){return e.patient.getNationalID()}},{label:"Given Name",value:"...",staticValue:function(){return e.patient.getGivenName()},other:{editable:!0,attribute:"given_name",category:"demographics"}},{label:"Family Name",value:"...",staticValue:function(){return e.patient.getFamilyName()},other:{editable:!0,attribute:"family_name",category:"demographics"}},{label:"Age",value:"...",staticValue:function(){return e.patient.getAge()},other:{editable:!0,attribute:"year_birth_date",category:"demographics"}},{label:"Sex",value:"...",staticValue:function(){return e.patient.getGender()},other:{editable:!0,attribute:"gender",category:"demographics"}},{label:"Location",value:"...",staticValue:function(){return e.patient.getCurrentVillage()},other:{editable:!0,attribute:"home_region",category:"demographics"}},{label:"Landmark",value:"...",staticValue:function(){return e.patient.getAttribute(19)}},{label:"Guardian",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,I["a"].getGuardianDetails(e.patientId);case 2:if(a=t.sent,!Object(y["isEmpty"])(a)){t.next=6;break}return n.other.editable=!0,t.abrupt("return","add");case 6:return t.abrupt("return",a.map((function(e){return" ".concat(e.name," (").concat(e.relationshipType,")")})).join(" "));case 7:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),other:{editable:!1,attribute:"",category:"guardian"}},{label:"Init W(KG)",value:"...",asyncValue:function(){return e.patient.getInitialWeight()}},{label:"Init H(CM)",value:"...",asyncValue:function(){return e.patient.getInitialHeight()}},{label:"Init BMI",value:"...",asyncValue:function(){return e.patient.getInitialBMI()}},{label:"TI",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Ever received ART")}},{label:"Agrees to follow up",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Agrees to followup")}},{label:"Reason for starting ART",value:"...",asyncValue:function(){return d["a"].getFirstValueCoded(e.patientId,"Reason for ART eligibility")}},{label:"HIV test date",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getFirstValueDatetime(e.patientId,"Confirmatory HIV test date");case 2:return n=t.sent,t.abrupt("return",n?l["c"].toStandardHisDisplayFormat(n):"");case 4:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{label:"HIV test place",value:"...",asyncValue:function(){return d["a"].getFirstValueText(e.patientId,"Confirmatory HIV test location")}},{label:"Date of starting first line ART",value:"...",asyncValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getFirstValueDatetime(e.patientId,"Date ART started");case 2:return n=t.sent,t.abrupt("return",n?l["c"].toStandardHisDisplayFormat(n):"");case 4:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{label:"Pulmonary TB within the last 2 years",value:"...",init:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d["a"].getAllValueCoded(e.patientId,"Who stages criteria present");case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0=[];case 5:e.tbStats=t.t0;case 6:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),staticValue:function(){return e.hasTbStat("Tuberculosis (PTB or EPTB) within the last 2 years")}},{label:"Extra pulmonary TB (EPTB)",value:"...",staticValue:function(){return e.hasTbStat("Extrapulmonary tuberculosis (EPTB)")}},{label:"Pulmonary TB (current)",value:"...",staticValue:function(){return e.hasTbStat("Pulmonary tuberculosis (current)")}},{label:"Kaposis sarcoma",value:"...",staticValue:function(){return e.hasTbStat("Kaposis sarcoma")}}]},buildDetails:function(e){var t=function(e){return e.map((function(e){var t=Object(i["a"])(e,2),n=t[0],a=t[1];return"".concat(n," (").concat(a,")")})).join("/")};return[{label:"Outcome",value:e.outcome},{label:"Outcome Date",value:e.outcome_date},{label:"Side effects",value:e.side_effects},{label:"Viral load",value:e.viral_load},{label:"Pills Brought",value:t(e.pills_brought)},{label:"Pills dispensed",value:t(e.pills_dispensed)},{label:"Visit by",value:e.visit_by},{label:"Regimen",value:e.regimen},{label:"Adherence",value:t(e.adherence)},{label:"TB Status",value:e.tb_status},{label:"Height (cm)",value:e.height},{label:"Weight (Kg)",value:e.weight},{label:"BMI",value:e.bmi}]},onNewRow:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var a,r,i,c,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=Object(o["a"])(e),!a[1]||"..."==a[1].td){n.next=3;break}return n.abrupt("return",a);case 3:return r=a[0].td,n.next=6,k["a"].getCurrentProgramInformation(t.patientId,r);case 6:return i=n.sent,n.next=9,k["a"].getMastercardDrugInformation(t.patientId,r);case 9:return c=n.sent,l=((null===c||void 0===c?void 0:c.pills_given)||[]).map((function(e){return"".concat(e["short_name"]||e["name"]," <b>(").concat(e.quantity||"?",")</b>")})).join("<br/>"),a[1]=B["a"].td(i.weight),a[2]=B["a"].td(i.regimen),a[3]=B["a"].td(i.viral_load),a[4]=B["a"].td(i.tb_status),a[5]=B["a"].td(i.outcome.match(/Unk/i)?"Unknown":i.outcome),a[6]=B["a"].td(l),a[7]=B["a"].tdBtn("More",Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,w["modalController"].create({component:H,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:r,visitData:t.buildDetails(i)}});case 2:e.sent.present();case 3:case"end":return e.stop()}}),e)})))),n.abrupt("return",a);case 19:case"end":return n.stop()}}),n)})))()},hasTbStat:function(e){return this.tbStats.includes(e)?"Yes":"No"},updateDemographics:function(e){this.$router.push({path:"/patient/registration",query:{edit_person:this.patientId,person_attribute:e}})},addGuardian:function(){var e;this.$router.push({path:"/guardian/registration/".concat(this.patientId),query:{source:null===(e=this.$route.name)||void 0===e?void 0:e.toString()}})},updateARVNumber:function(){this.$router.push({name:"Edit ARV Number"})}}});const L=O()(E,[["render",r]]);t["default"]=L},1799:function(e,t,n){"use strict";n("b0c0");var a=n("7a23"),r=Object(a["withScopeId"])("data-v-04a5a269");Object(a["pushScopeId"])("data-v-04a5a269");var o={class:"pagination"},i={class:"btn-group"},c=Object(a["createTextVNode"])(" First "),u=Object(a["createTextVNode"])(" Last ");Object(a["popScopeId"])();var l=r((function(e,t,n,l,s,d){var b=Object(a["resolveComponent"])("ion-button"),p=Object(a["resolveComponent"])("ion-icon");return Object(a["openBlock"])(),Object(a["createBlock"])("div",o,[Object(a["createVNode"])("div",i,[Object(a["createVNode"])(b,{color:"light",onClick:e.setFirstPage,disabled:e.isInFirstPage},{default:r((function(){return[c]})),_:1},8,["onClick","disabled"]),Object(a["createVNode"])(b,{color:"light",onClick:e.prevPage},{default:r((function(){return[Object(a["createVNode"])(p,{icon:e.caretBack},null,8,["icon"])]})),_:1},8,["onClick"]),(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(e.pages,(function(e){return Object(a["openBlock"])(),Object(a["createBlock"])(b,{onClick:function(t){return e.show()},color:e.isActive?"primary":"light",key:e.index},{default:r((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.name),1)]})),_:2},1032,["onClick","color"])})),128)),Object(a["createVNode"])(b,{color:"light",onClick:e.nextPage},{default:r((function(){return[Object(a["createVNode"])(p,{icon:e.caretForward},null,8,["icon"])]})),_:1},8,["onClick"]),Object(a["createVNode"])(b,{color:"light",onClick:e.setLastPage,disabled:e.isInLastPage},{default:r((function(){return[u]})),_:1},8,["onClick","disabled"])]),Object(a["createVNode"])("h6",null,"Page "+Object(a["toDisplayString"])(e.currentPage+1)+" of "+Object(a["toDisplayString"])(e.totalPages),1)])})),s=(n("a9e3"),n("ff79")),d=n("8a30"),b=Object(a["defineComponent"])({components:{IonIcon:d["IonIcon"],IonButton:d["IonButton"]},props:{maxVisibleButtons:{type:Number,required:!1,default:3},totalPages:{type:Number,required:!0}},emits:["onChangePage"],setup:function(e,t){var n=t.emit,r=Object(a["ref"])(0),o=Object(a["computed"])((function(){return 0===r.value})),i=Object(a["computed"])((function(){return r.value===e.totalPages})),c=Object(a["computed"])((function(){return 0===r.value?0:r.value===e.totalPages?e.totalPages-e.maxVisibleButtons:r.value-1})),u=function(e){return n("onChangePage",e)},l=Object(a["computed"])((function(){for(var t=[],n=function(e){t.push({index:e,name:e+1,show:function(){return r.value=e},isActive:e===r.value})},a=c.value;a<=Math.min(c.value+e.maxVisibleButtons-1,e.totalPages-1);a++)n(a);return t}));Object(a["watch"])(e,(function(e){var t=e.totalPages;"number"===typeof t&&(r.value=0)}),{immediate:!0,deep:!0}),Object(a["watch"])(r,(function(e){return u(e)}));var d=function(){return r.value=0},b=function(){return r.value=e.totalPages-1},p=function(){r.value>0&&(r.value-=1)},f=function(){r.value+1<e.totalPages&&(r.value+=1)};return{currentPage:r,caretBack:s["caretBack"],caretForward:s["caretForward"],startPage:c,pages:l,isInFirstPage:o,isInLastPage:i,nextPage:f,prevPage:p,setPage:u,setFirstPage:d,setLastPage:b}}}),p=(n("f099"),n("d959")),f=n.n(p);const m=f()(b,[["render",l],["__scopeId","data-v-04a5a269"]]);t["a"]=m},8945:function(e,t,n){"use strict";n("d0f1")},d0f1:function(e,t,n){},f099:function(e,t,n){"use strict";n("062e")}}]);
//# sourceMappingURL=chunk-9a4cb524.d26402d5.js.map