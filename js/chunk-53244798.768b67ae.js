(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53244798"],{"1afa":function(t,e,n){},"1b47":function(t,e,n){"use strict";var o=n("7a23");const a=Object(o["withScopeId"])("data-v-23709ba4"),i=a((function(t,e,n,i,s,c){const r=Object(o["resolveComponent"])("action-header"),l=Object(o["resolveComponent"])("ion-radio"),u=Object(o["resolveComponent"])("ion-label"),d=Object(o["resolveComponent"])("ion-item"),p=Object(o["resolveComponent"])("ion-radio-group"),b=Object(o["resolveComponent"])("ion-list"),m=Object(o["resolveComponent"])("ion-content"),h=Object(o["resolveComponent"])("action-footer");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(r,{title:t.title,subtitle:t.subtitle,color:t.color},null,8,["title","subtitle","color"]),Object(o["createVNode"])(m,{class:"ion-text-center"},{default:a(()=>[Object(o["createVNode"])(b,null,{default:a(()=>[Object(o["createVNode"])(p,{value:t.activeLabel},{default:a(()=>[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(t.list,(e,n)=>(Object(o["openBlock"])(),Object(o["createBlock"])(d,{class:"his-md-text",onClick:n=>t.onclick(e),key:n},{default:a(()=>[Object(o["createVNode"])(l,{slot:"start",value:e},null,8,["value"]),Object(o["createVNode"])(u,null,{default:a(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),Object(o["createVNode"])(h,{buttons:t.buttons},null,8,["buttons"])],64)}));var s=n("8efc"),c=n("8a30"),r=n("b5e4"),l=Object(o["defineComponent"])({components:{IonList:c["y"],IonItem:c["w"],IonContent:c["n"],IonRadio:c["E"],IonRadioGroup:c["F"]},mixins:[s["a"]],data:()=>({activeLabel:""}),props:{list:{type:Object,required:!0}},methods:{onclick(t){this.activeLabel=t}},computed:{buttons(){return this.actionButtons.map(t=>({...t,onClick:async()=>t.role&&t.role.match(/default/i)?c["X"].dismiss({action:t.name}):t.role&&t.role.match(/action/i)&&!this.activeLabel?Object(r["e"])("Please select one of the options"):void await c["X"].dismiss({selection:this.activeLabel,action:t.name})}))}}}),u=(n("bdcb"),n("6b0d")),d=n.n(u);const p=d()(l,[["render",i],["__scopeId","data-v-23709ba4"]]);e["a"]=p},"4cf3":function(t,e,n){"use strict";n("1afa")},"55ff":function(t,e,n){"use strict";n("f085")},"69c8":function(t,e,n){},7365:function(t,e,n){"use strict";n("13d5");var o,a=n("7a23"),i=n("ad60"),s=n("2ef0"),c=n("0fa1"),r=n("7f35"),l=n("9283");(function(t){t["SET_PROVIDER"]="SET_PROVIDER",t["CHANGE_SESSION_DATE"]="change_session_date",t["GO_TO_PATIENT_DASHBOARD"]="go_to_patient_dashboard",t["CHANGE_PATIENT_OUTCOME"]="change_outcome",t["CONTINUE"]="continue",t["EXIT"]="exit"})(o||(o={}));const u=t=>l["b"].toStandardHisDisplayFormat(t),d={"Warn if attempting to create new encounters for a deceased patient":{priority:1,actions:{alert:async({outcomeStartDate:t})=>{const e=await Object(r["a"])("Data Integrity Issue Found","Patient died on "+u(t),"Proceeding with this outcome might affect accuracy of some reports",[{name:"Cancel",slot:"end",color:"primary"},{name:"Change outcome",slot:"end",color:"primary"},{name:"Continue Anyway",slot:"end",color:"danger"}]);return"Cancel"===e?o.GO_TO_PATIENT_DASHBOARD:"Change outcome"===e?o.CHANGE_PATIENT_OUTCOME:o.CONTINUE}},conditions:{outcome(t){return"Patient died"===t},outcomeStartDate(t,{sessionDate:e}){return e>=t}}},"A patient's date of birth must not be less than Session Date":{priority:2,actions:{alert:async({birthDate:t,sessionDate:e})=>{const n=await Object(r["a"])("Data integrity issue found","",`Session date ${u(e)} is less than birth date of ${u(t)}`,[{name:"Cancel",slot:"end",color:"danger"},{name:"Change session date",slot:"end",color:"success"}]);return"Change session date"===n?o.CHANGE_SESSION_DATE:o.GO_TO_PATIENT_DASHBOARD}},conditions:{birthDate(t,{sessionDate:e}){return e<t}}},"Select Encounter provider when in back data entry":{priority:3,actions:{selection:async({providers:t,encounterName:e,sessionDate:n,apiDate:a})=>{const i=await Object(r["c"])("Please select a provider for "+e,`BDE: ${u(n)} | Current: ${u(a)}`,t,[{name:"Cancel",color:"danger",slot:"start",role:"default"},{name:"Confirm",slot:"end",role:"action"}]);return"Cancel"===i.action?{value:-1,flowState:o.GO_TO_PATIENT_DASHBOARD}:{value:i.selection,flowState:o.SET_PROVIDER}}},conditions:{isBdeMode(t){return t}}}};var p=n("c21d"),b=n("7920"),m=n("b5e4"),h=n("8e8b"),O=Object(a["defineComponent"])({components:{HisStandardForm:b["a"]},data:()=>({patient:{},fields:[],patientID:"",providerID:-1,providers:[],facts:{sessionDate:"",apiDate:"",encounterName:"N/A",providers:[],isBdeMode:!1,birthDate:"",outcome:"",outcomeStartDate:""},ready:!1}),watch:{$route:{handler(t){t.params.patient_id&&this.patientID!=t.params.patient_id&&(this.patientID=parseInt(t.params.patient_id),h["a"].get("ACTIVE_PATIENT",{patientID:this.patientID}).then(t=>{this.patient=t,this.setEncounterFacts().then(()=>{this.checkEncounterGuidelines().then(()=>{this.ready=!0})})}))},immediate:!0,deep:!0}},computed:{cancelDestination(){return this.patientDashboardUrl()}},methods:{runflowState(t,e=null){const n={};if(n[o.SET_PROVIDER]=t=>{const[e]=t.split(" "),n=Object(s["find"])(this.providers,{username:e});return n&&(this.providerID=n.person_id),o.CONTINUE},n[o.CHANGE_SESSION_DATE]=()=>(this.$router.push("/session/date?patient_dashboard_redirection_id="+this.patientID),o.EXIT),n[o.CHANGE_PATIENT_OUTCOME]=()=>(this.$router.push("/patient/programs/"+this.patientID),o.EXIT),n[o.GO_TO_PATIENT_DASHBOARD]=()=>(this.gotoPatientDashboard(),o.EXIT),t in n)return n[t](e)},async checkEncounterGuidelines(){const t=Object(p["a"])(this.facts,d);for(const s in t){var e,n;const c=t[s];if(null!==c&&void 0!==c&&null!==(e=c.actions)&&void 0!==e&&e.alert){var a;const t=this.runflowState(await(null===c||void 0===c||null===(a=c.actions)||void 0===a?void 0:a.alert(this.facts)));if(t===o.EXIT)return}if(null!==c&&void 0!==c&&null!==(n=c.actions)&&void 0!==n&&n.selection){var i;const t=await(null===c||void 0===c||null===(i=c.actions)||void 0===i?void 0:i.selection(this.facts));this.runflowState(t.flowState,t.value)}}},async setEncounterFacts(){try{const t=await h["a"].get("PATIENT_PROGRAM",{patientID:this.patientID});this.facts.outcome=t.outcome,this.facts.outcomeStartDate=t.startDate}catch(t){console.error(t),Object(m["c"])(""+t)}this.facts.sessionDate=i["a"].getSessionDate(),this.facts.apiDate=i["a"].getCachedApiDate(),this.facts.isBdeMode=i["a"].isBDE(),this.facts.birthDate=this.patient.getBirthdate(),this.facts.encounterName=this.$route.name?this.$route.name.toString().toUpperCase():"N/A",i["a"].isBDE()&&(this.providers=await h["a"].get("PROVIDERS"),this.facts.providers=this.providers.sort((t,e)=>{const n=t.username.toUpperCase(),o=e.username.toUpperCase();return n<o?-1:n>o?1:0}).map(t=>{var e;let n=""+t.username;if(!Object(s["isEmpty"])(null===t||void 0===t||null===(e=t.person)||void 0===e?void 0:e.names)){var o;const[e]=(null===(o=t.person)||void 0===o?void 0:o.names)||[];n+=` (${e.given_name} ${e.family_name})`}return n}))},toOption(t,e={}){return{label:t,value:t,other:e}},mapStrToOptions(t){return t.map(t=>({label:t,value:t}))},patientDashboardUrl(){return"/patient/dashboard/"+this.patientID},gotoPatientDashboard(){return this.$router.push({path:this.patientDashboardUrl()})},nextTask(){return Object(c["b"])(this.patientID,this.$router)},yesNoOptions(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},toYesNoOption(t,e={}){return{label:t,value:"",other:{...e,values:this.yesNoOptions()}}},mapOptions(t){return t.map(t=>({label:t,value:t}))},yesNoUnknownOptions(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"},{label:"Unknown",value:"Unknown"}]},resolveObs(t,e=""){const n=Object.values(t).filter(t=>t&&(t.tag===e||""===e)).reduce((t,e)=>{const n=e.obs?e.obs:e;return Array.isArray(n)?t=t.concat(n):"function"===typeof n?t.push(n()):t.push(n),t},[]);return Promise.all(n)},inArray(t,e){try{return t.filter(t=>e(t)).length>0}catch(n){return!1}},validateSeries(t){try{for(const e in t){const n=t[e]();if(n)return n}}catch(e){return[e]}}}});const f=O;e["a"]=f},7920:function(t,e,n){"use strict";var o=n("7a23");function a(t,e,n,a,i,s){return Object(o["openBlock"])(),Object(o["createBlock"])(Object(o["resolveDynamicComponent"])(t.formType),{fields:t.fields,skipSummary:t.skipSummary,activeField:t.activeField,cancelDestinationPath:t.cancelDestinationPath,onOnFinish:t.onFinish,onFinish:t.onFinishAction,onOnIndex:t.onIndex},null,8,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var i=n("9441"),s=Object(o["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:i["a"]},emits:["onFinish","onIndex"],data:()=>({formType:"touch-screen-form"}),props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish(t,e){this.$emit("onFinish",t,e)},onIndex(t){this.$emit("onIndex",t)}}}),c=n("6b0d"),r=n.n(c);const l=r()(s,[["render",a]]);e["a"]=l},"7f35":function(t,e,n){"use strict";n.d(e,"d",(function(){return _})),n.d(e,"b",(function(){return E})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return w}));var o=n("7a23");function a(t,e,n,a,i,s){const c=Object(o["resolveComponent"])("action-header"),r=Object(o["resolveComponent"])("his-table"),l=Object(o["resolveComponent"])("ion-content"),u=Object(o["resolveComponent"])("action-footer");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(c,{title:t.title,subtitle:t.subtitle,color:t.color},null,8,["title","subtitle","color"]),Object(o["createVNode"])(l,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(r,{columns:t.columns,rowColors:t.rowColors,rows:t.rows},null,8,["columns","rowColors","rows"])]),_:1}),Object(o["createVNode"])(u,{buttons:t.actionButtons},null,8,["buttons"])],64)}var i=n("a3a5"),s=n("8efc"),c=Object(o["defineComponent"])({mixins:[s["a"]],components:{HisTable:i["a"]},props:{rowColors:{type:Object},columns:{type:Object,required:!0},rows:{type:Object,required:!0}}}),r=n("6b0d"),l=n.n(r);const u=l()(c,[["render",a]]);var d=u;const p=Object(o["withScopeId"])("data-v-1c798292");Object(o["pushScopeId"])("data-v-1c798292");const b={class:"info-content his-md-text"};Object(o["popScopeId"])();const m=p((function(t,e,n,a,i,s){const c=Object(o["resolveComponent"])("action-header"),r=Object(o["resolveComponent"])("ion-content"),l=Object(o["resolveComponent"])("action-footer");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(c,{title:t.title,subtitle:t.subtitle,color:t.color},null,8,["title","subtitle","color"]),Object(o["createVNode"])(r,null,{default:p(()=>[Object(o["createVNode"])("div",b,[Object(o["createVNode"])("h2",{class:t.color},Object(o["toDisplayString"])(t.bodyTitle),3),Object(o["createVNode"])("p",{class:"description",innerHTML:t.bodyText},null,8,["innerHTML"])])]),_:1}),Object(o["createVNode"])(l,{buttons:t.actionButtons},null,8,["buttons"])],64)}));var h=Object(o["defineComponent"])({mixins:[s["a"]],props:{bodyTitle:{type:String,required:!0},bodyText:{type:String,required:!1}}});n("55ff");const O=l()(h,[["render",m],["__scopeId","data-v-1c798292"]]);var f=O,v=n("1b47");const j=Object(o["withScopeId"])("data-v-d609962e"),D=j((function(t,e,n,a,i,s){const c=Object(o["resolveComponent"])("action-header"),r=Object(o["resolveComponent"])("ion-content"),l=Object(o["resolveComponent"])("action-footer");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(c,{title:t.title,subtitle:t.subtitle,color:t.color},null,8,["title","subtitle","color"]),Object(o["createVNode"])(r,null,{default:j(()=>[Object(o["createVNode"])("ul",null,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(t.list,(t,e)=>(Object(o["openBlock"])(),Object(o["createBlock"])("li",{key:e},[Object(o["createVNode"])("span",{class:"his-md-text",innerHTML:t},null,8,["innerHTML"])]))),128))])]),_:1}),Object(o["createVNode"])(l,{buttons:t.actionButtons},null,8,["buttons"])],64)}));var y=Object(o["defineComponent"])({mixins:[s["a"]],props:{list:{type:Array,required:!0}}});n("4cf3");const C=l()(y,[["render",D],["__scopeId","data-v-d609962e"]]);var N=C,T=n("8a30");function I(){const t=(e,n)=>{setTimeout(()=>{const o=document.getElementsByClassName("modal-wrapper");if(o.length){const a=o[0],i=a.getElementsByTagName("ion-header");i.length>=2?i[1].remove():e<20&&t(e+1,n+100);const s=a.getElementsByTagName("ion-content");s.length>=2&&s[1].remove();const c=a.getElementsByTagName("ion-footer");c.length>=2&&c[1].parentElement&&c[1].parentElement.remove()}else e<5&&t(e+1,n+100)},n)};t(0,0)}async function _(t,e,n,o,a,i="",s=[]){const c=await T["X"].create({component:d,backdropDismiss:!1,cssClass:"action-sheet-modal",componentProps:{title:t,subtitle:e,columns:n,rows:o,rowColors:s,actionButtons:a,color:i}});await c.present(),I();const{data:r}=await c.onDidDismiss();return r.action}async function E(t,e,n,o,a=""){const i=await T["X"].create({component:N,backdropDismiss:!1,cssClass:"action-sheet-modal",componentProps:{title:t,subtitle:e,actionButtons:o,list:n,color:a}});await i.present(),I();const{data:s}=await i.onDidDismiss();return s.action}async function g(t,e,n,o,a=""){const i=await T["X"].create({component:f,backdropDismiss:!1,cssClass:"action-sheet-modal",componentProps:{title:t,bodyTitle:e,bodyText:n,actionButtons:o,color:a}});await i.present(),I();const{data:s}=await i.onDidDismiss();return s.action}async function w(t,e,n,o,a="darkred",i="action-sheet-modal"){const s=await T["X"].create({component:v["a"],backdropDismiss:!1,cssClass:i,componentProps:{title:t,subtitle:e,color:a,list:n,actionButtons:o}});await s.present(),I();const{data:c}=await s.onDidDismiss();return c}},bdcb:function(t,e,n){"use strict";n("69c8")},c21d:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));n("caad");function o(t,e){const n=[],o=[-1,"",null,void 0];for(const a in e){if(!(a in t))continue;const i=t[a];o.includes(i)?n.push(!1):n.push(e[a](i,t))}return n.every(Boolean)}function a(t){return t.sort((t,e)=>t.priority<e.priority?-1:1)}function i(t,e,n="",i=""){const s=[];for(const a in e){const c=e[a],r=[c.target&&n&&c.target!=n,c.targetEvent&&i&&c.targetEvent!=i];r.some(Boolean)||o(t,c.conditions)&&(c.title=a,c.description&&(c.description.text=c.description.info(t)),s.push(c))}return a(s)}},f085:function(t,e,n){}}]);
//# sourceMappingURL=chunk-53244798.768b67ae.js.map