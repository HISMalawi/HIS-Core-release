(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TouchFormElement13"],{"39ac":function(t,e,a){},"83af":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var i=a("cc6f");class n extends i["a"]{constructor(t,e){super(t,7,e)}async getNextAppointment(){const t=i["a"].getProgramID();return i["a"].getJson(`/programs/${t}/patients/${this.patientID}/next_appointment_date`,{date:this.date})}static async getDailiyAppointments(t){const e=i["a"].getProgramID();return i["a"].getJson(`/programs/${e}/booked_appointments`,{date:t,paginate:!1})}}},b2eb:function(t,e,a){"use strict";a.r(e);var i=a("7a23");const n={class:"view-port-content"},s={key:0,class:"appointments"},c=Object(i["createVNode"])("b",null,"Medication Run out Date",-1),o=Object(i["createVNode"])("p",null,null,-1),l=Object(i["createVNode"])("b",null,"User set appointment date",-1),r=Object(i["createVNode"])("p",null,null,-1),d=Object(i["createVNode"])("b",null,"Appointment(s)",-1),p=Object(i["createVNode"])("p",null,null,-1),u=Object(i["createVNode"])("b",null,"Appointment limit (per/day)",-1),b=Object(i["createVNode"])("p",null,null,-1);function h(t,e,a,h,m,O){const D=Object(i["resolveComponent"])("Calendar"),j=Object(i["resolveComponent"])("ion-col"),w=Object(i["resolveComponent"])("ion-label"),y=Object(i["resolveComponent"])("ion-item"),g=Object(i["resolveComponent"])("ion-list"),f=Object(i["resolveComponent"])("ion-row"),C=Object(i["resolveComponent"])("ion-grid"),N=Object(i["resolveComponent"])("view-port");return Object(i["openBlock"])(),Object(i["createBlock"])(N,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])("div",n,[Object(i["createVNode"])(C,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(f,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(j,{size:"8"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(D,{color:"blue",ref:"calendar","is-expanded":"",class:"custom-calendar","min-date":t.sessionDate,"max-date":t.runOutDate,attributes:t.attributes,masks:t.masks,"disable-page-swipe":""},{"day-content":Object(i["withCtx"])(({day:e})=>[Object(i["createVNode"])("div",{onClick:a=>t.dayClicked(e),class:{selected:e.id===t.cDate,isDisabled:e.isDisabled}},[Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(e.day),1),e.id===t.cDate?(Object(i["openBlock"])(),Object(i["createBlock"])("sup",s,Object(i["toDisplayString"])(t.appointments.length),1)):Object(i["createCommentVNode"])("",!0)],10,["onClick"])]),_:1},8,["min-date","max-date","attributes","masks"])]),_:1}),Object(i["createVNode"])(j,{size:"4",class:"his-card"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(g,null,{default:Object(i["withCtx"])(()=>[t.showMedicationRunoutDate&&t.rDate?(Object(i["openBlock"])(),Object(i["createBlock"])(y,{key:0,class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(w,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[c,o,Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(t.rDate),1)]),_:1})]),_:1})):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(y,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(w,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[l,r,Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(t.aDate),1)]),_:1})]),_:1}),Object(i["createVNode"])(y,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(w,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[d,p,Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(t.appointments.length),1)]),_:1})]),_:1}),Object(i["createVNode"])(y,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(w,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[u,b,Object(i["createVNode"])("span",null,Object(i["toDisplayString"])(t.appointmentLimit),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})}var m=a("0a79"),O=a("8a30"),D=a("7b37"),j=a("9283"),w=a("83af"),y=a("51c8"),g=a("d1ca"),f=a("b5e4"),C=a("5a0c"),N=a.n(C),V=Object(i["defineComponent"])({components:{ViewPort:m["a"],Calendar:D["a"],IonGrid:O["IonGrid"],IonCol:O["IonCol"],IonRow:O["IonRow"]},mixins:[y["default"]],watch:{startDate:{async handler(t){const e=t||j["c"].toStandardHisDisplayFormat(this.sessionDate);this.$emit("onValue",{label:"",value:e})},immediate:!0}},data:()=>({rows:[],startDate:null,runOutDate:null,appointments:[],clinicHolidays:[],clinicDays:[],patientAge:0,appointmentLimit:0,sessionDate:null,masks:{weekdays:"WWW"}}),mounted(){this.$emit("onFieldActivated",this)},activated(){this.$emit("onFieldActivated",this)},async created(){this.patientAge=this.config.patientAge||0,await this.getAppointmentLimit(),await this.getClinicHolidays(),await this.getClinicDays();const t=await this.options(this.fdata);this.sessionDate=w["a"].getSessionDate();const e=t[0].other.appointmentDate;this.appointments=await this.getAppointments(e),this.setDate(e),this.runOutDate=t[0].other.runOutDate?new Date(t[0].other.runOutDate):null},methods:{getAppointments(t){return w["a"].getDailiyAppointments(j["c"].toStandardHisFormat(t))},async getAppointmentLimit(){const t=await g["b"].appointmentLimit();t&&(this.appointmentLimit=t)},async getClinicHolidays(){const t=await g["b"].clinicHolidays();t&&(this.clinicHolidays=t.split(","))},async getClinicDays(){let t="";t=this.patientAge>=18?await g["b"].adultClinicDays():await g["b"].peadsClinicDays(),t&&(this.clinicDays=t.split(","))},async isDateAvalaible(t){const e=await this.getAppointments(t);if(0!==e.length&&e.length>=this.appointmentLimit){const e=await Object(f["a"])("Appointment limit reached for the selected date "+j["c"].toStandardHisDisplayFormat(t),{header:"APPOINTMENT LIMIT REACHED",cancelBtnLabel:"Proceed with Selected Date",confirmBtnLabel:"Select Another Date"});if(e)return!1}if(this.clinicHolidays.includes(j["c"].toStandardHisFormat(t))){const t=await Object(f["a"])("Selected date is a clinic holiday, do you want to set an appointment?");if(!t)return!1}const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=a[N()(t).day()];if(!this.clinicDays.includes(i)){const e=await Object(f["a"])(`The selected date ${j["c"].toStandardHisDisplayFormat(t)} is not a clinic day. Do you want to proceed with this date?`);if(!e)return!1}return this.appointments=e,!0},async setDate(t){this.startDate=new Date(t);const e=this.$refs.calendar;await e.move(this.startDate),await e.focusDate(this.startDate)},async dayClicked(t){!t.isDisabled&&await this.isDateAvalaible(t.id)&&this.setDate(t.id)}},computed:{showMedicationRunoutDate(){var t,e;return"boolean"!==typeof(null===(t=this.config)||void 0===t?void 0:t.hideRunoutDate)||!(null!==(e=this.config)&&void 0!==e&&e.hideRunoutDate)},aDate(){return j["c"].toStandardHisDisplayFormat(this.startDate)},rDate(){return j["c"].toStandardHisDisplayFormat(this.runOutDate)},cDate(){return j["c"].toStandardHisFormat(this.startDate)},attributes(){return[{highlight:!0,dates:this.aDate}]}}}),x=(a("d09b"),a("d959")),v=a.n(x);const A=v()(V,[["render",h]]);e["default"]=A},d09b:function(t,e,a){"use strict";a("39ac")}}]);
//# sourceMappingURL=TouchFormElement13.9f2807e5.js.map