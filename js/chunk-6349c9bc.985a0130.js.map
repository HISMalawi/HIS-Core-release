{"version":3,"sources":["webpack:///./src/components/Forms/HisStandardForm.vue?f008","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/components/Forms/HisStandardForm.vue?6820","webpack:///./src/utils/HisFormHelpers/PersonFieldHelper.ts","webpack:///./src/views/PatientRegistration.vue?1f52","webpack:///./src/views/PatientRegistration.vue","webpack:///./src/views/PatientRegistration.vue?ad61","webpack:///./src/utils/HisFormHelpers/LocationFieldOptions.ts"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createBlock","_resolveDynamicComponent","formType","fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onFinishAction","onOnIndex","onIndex","defineComponent","name","components","TouchScreenForm","emits","data","props","type","Function","Boolean","default","String","Object","required","methods","formData","computedData","this","$emit","i","__exports__","mapToOption","listOptions","map","item","label","value","resolvePerson","computedForm","attr","values","isPlainObject","person","getGivenNameField","id","helpText","FieldType","TT_TEXT","computedValue","val","validation","Validation","isName","options","async","form","given_name","names","PersonService","searchGivenName","getFamilyNameField","family_name","searchFamilyName","getGenderField","customOptions","TT_SELECT","isEmpty","getDobConfig","includeHelpText","summaryLabel","minDate","HisDate","estimateDateFromAge","maxDate","getSessionDate","estimation","allowUnknown","allowUnknownMonthDay","estimationFieldType","EstimationFieldType","AGE_ESTIMATE_FIELD","computeValue","date","isEstimate","birthdate","getHomeRegionField","group","requireNext","getRegions","getHomeDistrictField","summaryMapValue","v","f","test","home_region","dynamicHelpText","getDistricts","addCustomLocationBtnForTAorVillage","BtnName","formParentAddressRef","slot","color","onClick","c","field","filter","length","toastWarning","filtered","ok","alertConfirmation","address","LocationService","createAddress","toUpperCase","getHomeTaField","config","showKeyboard","isFilterDataViaApi","footerBtns","defaultOutput","getTraditionalAuthorities","home_district","getHomeVillageField","getVillages","home_traditional_authority","getCurrentRegionField","home_village","onClickComponentEvents","setValue","getCurrentDistrictField","current_region","match","getCurrentTAfield","current_district","getCurrentVillageField","current_traditional_authority","getCellNumberField","number","split","isMWPhoneNumber","customKeyboard","getLandmarkFields","proxyID","appearInSummary","default_landmarks","TT_NOTE","condition","getFacilityLocationField","_","getFacilities","getPersonNameFromPersonObj","personObj","getAttrFromPersonObj","Array","isArray","person_attributes","reduce","getAddressFromPersonObj","addresses","addressMap","mapPersonData","givenName","familyName","homeDistrict","homeVillage","homeTA","person_id","gender","birthdate_estimated","getPersonAttributeOptions","patient","Patientservice","prop","getPatientInfoString","getID","getNationalID","other","patientID","npid","show","Service","getProgramName","_component_his_standard_form","_resolveComponent","formLabel","$event","fieldComponent","HisStandardForm","app","App","getActiveApp","ddeInstance","ddeDocID","ddeIsReassign","currentAddressAttributes","homeAddressAttributes","hasIncompleteData","editPersonData","editPerson","personAttribute","isMilitarySite","presets","registrationSummary","ddeEnabled","watch","query","PatientDemographicsExchangeService","edit_person","dde_reassign","doc_id","setPatientID","person_attribute","initEditMode","getFields","immediate","deep","push","personIndexField","hasScannedNationalID","concat","hiddenFieldsForScannedNationalID","givenNameField","familyNameField","genderField","searchResultField","hasNpidField","scanNpid","dobFields","homeRegionField","homeDistrictField","homeTAField","homeVillageField","currentRegionField","currentDistrictField","currentTAField","currentVillage","landmarkFields","cellPhoneField","patientTypeField","facilityLocationField","occupationField","relationshipField","possibleDuplicatesField","isEditMode","nationalIDStatus","personId","Store","get","parseInt","ancestryDistrict","ancestryTA","ancestryVillage","currentDistrict","currentTA","getAddresses","getGivenName","getFamilyName","getGender","getBirthdate","getPhoneNumber","getClosestLandmark","getOccupation","isOnline","update","create","isOfflineMode","createOffline","savePersonOffline","Offline","PersonField","attributes","resolvePersonAttributes","offlineID","nextTask","$router","registration","PatientRegistrationService","registerPatient","getPersonID","set","updateMWNationalId","malawiNationalID","onRegisterPatient","exit","$route","relationship","setPersonID","updatePerson","invalidate","back","editConditionCheck","includes","getDocID","assignNpid","printNationalID","delayPromise","e","toastDanger","d","personAttributes","console","error","TT_HIDDEN","defaultValue","toLowerCase","findByID","IS_ANC_APP","applicationName","IS_CXCA","defaultComputedOutput","beforeNext","newGender","oldGender","action","infoActionSheet","dobConfig","sdate","childBearingAgeInYrs","dayjs","subtract","format","STANDARD_DATE_FORMAT","generateDateFields","TT_YES_NO","isRequired","TT_BARCODE","has_npid","hiddenFooterBtns","currentRegion","current_village","cellPhone","cell_phone_number","facility","patient_type","landmarks","PatientTypeService","getPatientTypes","init","regimentField","occupation","rankField","dateJoinedMilitaryFields","WorkflowService","IS_HTS","OPD","Registration","TT_PERSON_RESULT_VIEW","payload","patients","searchDemographics","itemData","search","state","disabled","onValue","results","createdPerson","duplicatePatients","TT_PERSON_MATCH_VIEW","checkPotentialDuplicates","toDate","toStandardHisDisplayFormat","score","patient_id","newPerson","foundPerson","docID","comparisons","visible","possible_duplicates","importPatient","then","result","catch","TT_TABLE_VIEWER","editButton","attribute","columns","rows","landmark","emptySets","indexes","class","forEach","r","isValueEmpty","rowColors","onload","reassignNpid","printNpid","confirmPatient","facilities","trim","location_id","getLabFacilities","getLabs","getFacilityWards","wards","tag","ward","getSpecialistClinics","clinics","clinic","regions","region","region_id","regionID","districts","district","district_id","districtID","TAs","TA","traditional_authority_id","traditionalAuthorityID","villages","village","village_id"],"mappings":"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","file":"js/chunk-6349c9bc.985a0130.js","sourcesContent":["import { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.formType), {\n    fields: _ctx.fields,\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.activeField,\n    cancelDestinationPath: _ctx.cancelDestinationPath,\n    onOnFinish: _ctx.onFinish,\n    onFinish: _ctx.onFinishAction,\n    onOnIndex: _ctx.onIndex\n  }, null, 40, [\"fields\", \"skipSummary\", \"activeField\", \"cancelDestinationPath\", \"onOnFinish\", \"onFinish\", \"onOnIndex\"]))\n}","\nimport TouchScreenForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport { defineComponent, PropType } from \"vue\";\nimport { Field } from \"./FieldInterface\";\n\nexport default defineComponent({\n    name: \"HisStandardForm\",\n    components: { TouchScreenForm },\n    emits: [\n        'onFinish',\n        'onIndex'\n    ],\n    data: () => ({\n        formType: 'touch-screen-form' as string\n    }),\n    props: {\n        onFinishAction: {\n            type: Function\n        },\n        skipSummary: {\n            type: Boolean,\n            default: false\n        },\n        activeField: {\n            type: String\n        },\n        fields: {\n            type: Object as PropType<Field[]>,\n            required: true\n        },\n        cancelDestinationPath: {\n            type: String,\n            required: false,\n        }\n    },\n    methods: {\n        onFinish(formData: any, computedData: any) {\n            this.$emit('onFinish', formData, computedData)\n        },\n        onIndex(i: number) {\n            this.$emit('onIndex', i)\n        }\n    }\n})\n","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {\n    getFacilities,\n    getRegions,\n    getDistricts,\n    getTraditionalAuthorities,\n    getVillages\n} from '@/utils/HisFormHelpers/LocationFieldOptions'\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport {PersonService} from \"@/services/person_service\"\nimport { EstimationFieldType } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport HisDate from \"@/utils/Date\"\nimport { DateFieldInterface } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport { alertConfirmation, toastWarning } from '../Alerts'\nimport { LocationService } from '@/services/location_service'\nimport { Service } from '@/services/service'\n\nfunction mapToOption(listOptions: Array<string>): Array<Option> {\n    return listOptions.map((item: any) => ({ \n        label: item, value: item \n    })) \n}\nexport default {\n    resolvePerson(computedForm: any) {\n        let data: any = {}\n        for(const attr in computedForm) {\n            const values = computedForm[attr]\n            if (isPlainObject(values) && 'person' in values) {\n                if (isPlainObject(values.person)) {\n                    data = {...data, ...values.person}\n                } else {\n                    data[attr] = values['person']\n                }\n            }\n        }\n        return data   \n    },\n    getGivenNameField(): Field {\n        return {\n            id: 'given_name',\n            helpText: 'First name',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.given_name) {\n                    const names = await PersonService.searchGivenName(form.given_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getFamilyNameField(): Field {\n        return {\n            id: 'family_name',\n            helpText: \"Last name\",\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.family_name) {\n                    const names = await PersonService.searchFamilyName(form.family_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getGenderField(customOptions?: Option[]): Field {\n        return  {\n            id: 'gender',\n            helpText: 'Sex',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.required(val),\n            options: () => !isEmpty(customOptions)\n                ? customOptions as Option[]\n                : ([\n                    {\n                        label: 'Female',\n                        value: 'F'\n                    },\n                    { \n                        label: 'Male',\n                        value: 'M'\n                    }\n                ])\n        }\n    },\n    getDobConfig(includeHelpText = true): DateFieldInterface {\n        return  {\n            id: 'birth_date',\n            summaryLabel: 'Date of Birth',\n            helpText: includeHelpText ? 'Birth' : '',\n            required: true,\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => PersonService.getSessionDate(),\n            estimation: {\n                allowUnknown: true,\n                allowUnknownMonthDay: true,\n                estimationFieldType: EstimationFieldType.AGE_ESTIMATE_FIELD\n            },\n            computeValue: (date: string, isEstimate: boolean) => {\n                return {\n                    date,\n                    isEstimate,\n                    person: {\n                        birthdate: date,\n                        'birthdate_estimated': isEstimate\n                    }\n                }\n            }\n        }\n    },\n    getHomeRegionField(): Field {\n        return {\n            id: 'home_region',\n            helpText: 'Region of origin',\n            type: FieldType.TT_SELECT,\n            group: 'person',\n            requireNext: false,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions()\n        }\n    },\n    getHomeDistrictField() {\n        return  {\n            id: 'home_district',\n            helpText: 'District of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            summaryMapValue: (v: Option, f: any) => {\n                return {\n                    label: /foreign/i.test(`${f?.home_region?.label}`)\n                        ? 'Home Country' \n                        : 'District of origin',\n                    value: v.label\n                }\n            },\n            dynamicHelpText: (f: any) => {\n                if (/foreign/i.test(`${f?.home_region?.label}`)) {\n                    return 'Home Country'\n                }\n                return 'District of origin'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            options: (form: any) => getDistricts(form.home_region.value)\n        }\n    },\n    addCustomLocationBtnForTAorVillage(BtnName: string, formParentAddressRef: string) {\n        return {\n            name: `Add ${BtnName}`,\n            slot: \"end\",\n            color: \"success\",\n            onClick: async (f: any, c: any, field: any) => {\n                 if (typeof field.filter != 'string' || field.filter.length < 3) {\n                    return toastWarning(`Please enter a valid ${BtnName}`)\n                 }\n                 if (!isEmpty(field.filtered)) {\n                    return toastWarning(`Can't add existing ${BtnName}`)\n                 } \n                 const ok = await alertConfirmation(`Do you want to add ${BtnName} ${field.filter}?`)\n\n                 if (!ok) return\n\n                 const address = await LocationService.createAddress(BtnName, field.filter, f[formParentAddressRef].value)\n                 if (address) {\n                    // Hack to force the list to reload the list with new data\n                    field.filter = field.filter.toUpperCase() \n                 } else {\n                    return toastWarning(`Unable to add ${BtnName}`)\n                 }\n            }\n         }\n    },\n    getHomeTaField() {\n        return  {\n            id: 'home_traditional_authority',\n            helpText: 'TA of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'home_district')\n                ]\n            },\n            defaultOutput: () => ({label: 'N/A', value: 'N/A'}),\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.home_district.value, filter)\n        }\n    },\n    getHomeVillageField() {\n        return {\n            id: 'home_village',\n            helpText: 'Village of origin',\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'home_traditional_authority')\n                ]\n            },\n            requireNext: false,\n            defaultOutput: () => ({ label: 'N/A', value: 'N/A' }),\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.home_traditional_authority.value, filter)\n        }\n    },\n    getCurrentRegionField() {\n        return {\n            id: 'current_region',\n            helpText: 'Current Region of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option, f: any) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_region': f.home_region.label,\n                            'current_district': f.home_district.label,\n                            'current_traditional_authority': f.home_traditional_authority.label,\n                            'current_village': f.home_village.label \n                        }\n                    }\n                }\n                return { person: val.label }\n            },\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions(),\n            config: {\n                footerBtns: [\n                  {\n                    name: \"Same as origin\",\n                    slot: \"end\",\n                    onClickComponentEvents: {\n                      setValue: () => 'Use Home Address'\n                    },\n                    onClick: () => \"Use Home Address\"\n                  }\n                ]\n            }\n        }\n    },\n    getCurrentDistrictField() {\n        return {\n            id: 'current_district',\n            helpText: 'District',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            summaryMapValue: (v: Option, f: any) => {\n                return {\n                    label: /foreign/i.test(`${f?.home_region?.label}`)\n                        ? 'Current Country' \n                        : 'Current District of Residence',\n                    value: v.label\n                }\n            },\n            dynamicHelpText: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return 'Current Country'\n                }\n                return 'Current District of Residence'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any) => getDistricts(form.current_region.value),\n        }\n    },\n    getCurrentTAfield() {\n        return    {\n            id: 'current_traditional_authority',\n            helpText: 'Current TA of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'current_district')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.current_district.value, filter)\n        }\n    },\n    getCurrentVillageField() {\n        return {\n            id: 'current_village',\n            helpText: 'Current Village of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'current_traditional_authority')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.current_traditional_authority.value, filter)\n        }\n    },\n    getCellNumberField() {\n        return   {\n            id: 'cell_phone_number',\n            helpText: 'Cell phone number',\n            group: 'person',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => {\n                if (val) {\n                    if (val.value.match(/Unknown|n\\/a/i)) {\n                        return null\n                    }\n                    for(const number of `${val.value}`.split('/')) {\n                        if (Validation.isMWPhoneNumber({label: number, value: number})) {\n                            return [`\"${number}\" is not a valid phone number`]\n                        }\n                    }\n                    return null\n                }\n                return ['Phone number cannot be empty']\n            },\n            config: {\n                customKeyboard: [\n                    [\n                        ['1', '2', '3'],\n                        ['4', '5', '6'],\n                        ['7', '8', '9'],\n                        ['',  '0', '']\n                    ],\n                    [ \n                        [ '+265', '/'],\n                        [ 'Unknown', 'N/A' ],\n                        [ 'Delete' ]\n                    ]\n                ]\n            }\n        }\n    },\n    getLandmarkFields(): Field[] {\n        return [\n            {\n                id: 'default_landmarks',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_SELECT,\n                appearInSummary: (f: any) => f.default_landmarks.value != 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (val: any) => Validation.required(val),\n                options: () => mapToOption([\n                    'Catholic Church',\n                    'CCAP',\n                    'Seventh Day',\n                    'Mosque',\n                    'Primary School',\n                    'Borehole',\n                    'Secondary School',\n                    'College',\n                    'Market',\n                    'Football Ground',\n                    'Other'\n                ])\n            },\n            {\n                id: 'other_landmark',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_NOTE,\n                appearInSummary: (f: any) => f.default_landmarks.value === 'Other',\n                condition: (f: any) => f.default_landmarks.value === 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (v: Option) => Validation.required(v)\n            }\n        ]\n    },\n    getFacilityLocationField() {\n        return  {\n            id: 'location',\n            helpText: 'Please select facility name',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (_: any, filter='') => getFacilities(filter),\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true\n            }\n        }\n    },\n    getPersonNameFromPersonObj(personObj: any, type: 'given_name' | 'family_name') {\n        if (personObj.names.length) {\n            return personObj.names[0][type]\n        }\n        return ''\n    },\n    getAttrFromPersonObj(personObj: any, type: 'Landmark Or Plot Number' | 'Cell Phone Number') {\n        if (Array.isArray(personObj.person_attributes) && personObj.person_attributes.length) {\n            return personObj.person_attributes.reduce((v: string, c: any) => {\n                if (c.type.name === type) {\n                    return c.value\n                }\n                return v\n            }, '')\n        }\n        return ''\n    },\n    getAddressFromPersonObj(personObj: any, \n        type: 'home_region' | \n        'home_district' | \n        'home_region' | \n        'home_village' | \n        'home_traditional_authority' | \n        'current_region' |\n        'current_traditional_authority' | \n        'current_district') {\n        if (Array.isArray(personObj.addresses) && personObj.addresses.length) {\n            const address: any = personObj.addresses[0]\n            const addressMap: Record<string, string> = {\n                'home_district': 'address2', \n                'home_village': 'neighborhood_cell',\n                'home_traditional_authority': 'county_district', \n                'current_village': 'city_village',\n                'current_traditional_authority' : 'township_division',\n                'current_district': 'state_province'\n            }\n            return address[addressMap[type]]\n        }\n        return ''\n    },\n    mapPersonData(personObj: any) {\n        const givenName = this.getPersonNameFromPersonObj(personObj, 'given_name')\n        const familyName = this.getPersonNameFromPersonObj(personObj, 'family_name')\n        const homeDistrict = this.getAddressFromPersonObj(personObj, 'home_district')\n        const homeVillage = this.getAddressFromPersonObj(personObj, 'home_village')\n        const homeTA = this.getAddressFromPersonObj(personObj, 'home_traditional_authority')\n        return {\n            'id': personObj.person_id,\n            'name': `${givenName} ${familyName}`,\n            'given_name': givenName,\n            'family_name': familyName,\n            'gender': personObj.gender,\n            'birth_date': personObj.birthdate,\n            'birthdate_estimated': personObj.birthdate_estimated,\n            'home_district': homeDistrict,\n            'home_village': homeVillage,\n            'home_traditional_authority': homeTA,\n            'home_address': `${homeDistrict} ${homeVillage}`,\n            'current_district': this.getAddressFromPersonObj(personObj, 'current_district'),\n            'current_traditional_authority': this.getAddressFromPersonObj(personObj, 'current_traditional_authority'),\n            'cell_phone_number': this.getAttrFromPersonObj(personObj, 'Cell Phone Number'),\n            'landmark': this.getAttrFromPersonObj(personObj, 'Landmark Or Plot Number')\n        }\n    },\n    getPersonAttributeOptions(person: any) {\n        const patient = new Patientservice(person);\n        const prop = (patient: any, prop: string) => prop in patient ? patient[prop]() : '-'\n        return {\n            label: patient.getPatientInfoString(),\n            value: patient.getID() || patient.getNationalID(),\n            other: {\n                patientID: patient.getID(),\n                npid: patient.getNationalID(),\n                person,\n                options: [\n                    {\n                        label: \"National ID\",\n                        value: prop(patient, 'getNationalID')\n                    },\n                    {\n                        label: 'ARV Number',\n                        value: prop(patient, 'getArvNumber'),\n                        other: {\n                            show: () => Service.getProgramName() === \"ART\" \n                        }\n                    },\n                    {\n                        label: \"Name\",\n                        value: prop(patient, 'getFullName'),\n                    },\n                    {\n                        label: \"Sex\",\n                        value: prop(patient, 'getGender'),\n                    },\n                    {\n                        label: \"Birthdate\",\n                        value: prop(patient, 'getBirthdate'),\n                    },\n                    {\n                        label: \"Home District\",\n                        value: prop(patient, 'getHomeDistrict'),\n                    },\n                    {\n                        label: \"Home Village\",\n                        value: prop(patient, 'getHomeVillage'),\n                    },\n                    {\n                        label: \"Current District\",\n                        value: prop(patient, 'getCurrentDistrict'),\n                    },\n                    {\n                        label: \"Current T/A\",\n                        value: prop(patient, 'getCurrentTA'),\n                    },\n                    {\n                        label: 'Cellphone',\n                        value: prop(patient, 'getPhoneNumber')\n                    }\n                ]\n            }\n        }    \n    }\n}\n","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")!\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    formLabel: _ctx.formLabel,\n    onOnIndex: _cache[0] || (_cache[0] = ($event: any) => (_ctx.fieldComponent='')),\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.fieldComponent,\n    fields: _ctx.fields,\n    onFinishAction: _ctx.onFinish\n  }, null, 8, [\"formLabel\", \"skipSummary\", \"activeField\", \"fields\", \"onFinishAction\"]))\n}","\nimport { defineComponent } from \"vue\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport { generateDateFields } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport HisDate from \"@/utils/Date\"\nimport { STANDARD_DATE_FORMAT } from \"@/utils/Date\"\nimport { WorkflowService } from \"@/services/workflow_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport PersonField from \"@/utils/HisFormHelpers/PersonFieldHelper\"\nimport { PatientRegistrationService } from \"@/services/patient_registration_service\"\nimport App from \"@/apps/app_lib\"\nimport { AppInterface } from \"@/apps/interfaces/AppInterface\"\nimport { nextTask } from \"@/utils/WorkflowTaskHelper\"\nimport { isValueEmpty } from \"@/utils/Strs\"\nimport { PatientDemographicsExchangeService } from \"@/services/patient_demographics_exchange_service\"\nimport { toastDanger, toastWarning } from \"@/utils/Alerts\"\nimport { PatientTypeService } from \"@/apps/ART/services/patient_type_service\";\nimport { infoActionSheet } from \"@/utils/ActionSheets\"\nimport GLOBAL_PROP from \"@/apps/GLOBAL_APP/global_prop\";\nimport dayjs from \"dayjs\";\nimport { delayPromise } from \"@/utils/Timers\";\nimport Store from \"@/composables/ApiStore\"\nimport { Offline, isOfflineMode, isOnline } from \"@/composables/offline\";\n\nexport default defineComponent({\n  components: { HisStandardForm },\n  data: () => ({\n    formLabel: 'Find / Register',\n    app: App.getActiveApp() as AppInterface,\n    ddeInstance: {} as any,\n    ddeDocID: '' as string,\n    ddeIsReassign: false as boolean,\n    skipSummary: false as boolean,\n    currentAddressAttributes: [\n        'current_region',\n        'current_district',\n        'current_village',\n        'current_traditional_authority'\n    ] as string[],\n    homeAddressAttributes: [\n        'home_region',\n        'home_district',\n        'home_traditional_authority',\n        'home_village'\n    ] as string[],\n    hasIncompleteData: false as boolean,\n    patient: {} as any,\n    editPersonData: {} as any,\n    editPerson: -1 as number,\n    personAttribute: '' as string,\n    activeField: '' as string,\n    fieldComponent: '' as string,\n    fields: [] as Array<Field>,\n    isMilitarySite: false,\n    presets: {} as any,\n    registrationSummary: {} as any,\n    form: {} as Record<string, Option> | Record<string, null>,\n    ddeEnabled: false as boolean,\n  }),\n  watch: {\n    '$route': {\n        async handler({query}: any) {\n           this.ddeInstance = new PatientDemographicsExchangeService()\n           if (query.edit_person) {\n                this.ddeIsReassign = query.dde_reassign\n                this.ddeDocID = query.doc_id\n                this.ddeInstance.setPatientID(query.edit_person)\n                if(query.person_attribute) this.personAttribute = query.person_attribute\n                await this.initEditMode(query.edit_person)\n            } else {\n                this.presets = query\n            }\n            this.fields = this.getFields()\n        },\n        immediate: true,\n        deep: true\n    }\n  },\n  methods: {\n    getFields(): Array<Field> {\n        let fields: Array<Field> = []\n        fields.push(this.personIndexField())\n        if (this.hasScannedNationalID()) {\n            fields = fields.concat(this.hiddenFieldsForScannedNationalID())\n        } else {\n            fields.push(this.givenNameField())\n            fields.push(this.familyNameField())\n            fields.push(this.genderField())\n        }\n        fields.push(this.searchResultField())\n        fields.push(this.hasNpidField())\n        fields.push(this.scanNpid())\n        if (!this.hasScannedNationalID()) {\n            fields = fields.concat(this.dobFields())\n        }\n        fields.push(this.homeRegionField())\n        fields.push(this.homeDistrictField())\n        fields.push(this.homeTAField())\n        fields.push(this.homeVillageField())\n        fields.push(this.currentRegionField())\n        fields.push(this.currentDistrictField())\n        fields.push(this.currentTAField())\n        fields.push(this.currentVillage())\n        fields = fields.concat(this.landmarkFields())\n        fields.push(this.cellPhoneField())\n        fields.push(this.patientTypeField())\n        fields.push(this.facilityLocationField())\n        fields.push(this.occupationField())\n        // fields.push(this.regimentField())\n        // fields = fields.concat(this.dateJoinedMilitaryFields())\n        // fields.push(this.rankField())\n        fields.push(this.relationshipField())\n        fields.push(this.possibleDuplicatesField())\n        return fields\n    },\n    isEditMode() {\n        return this.editPerson >= 1\n    },\n    hasScannedNationalID() {\n        return this.presets.nationalIDStatus === 'true'\n    },\n    async initEditMode(personId: number) {\n        this.editPerson = personId\n        this.patient = await Store.get('ACTIVE_PATIENT', { patientID: parseInt(`${this.editPerson}`)})\n        const {\n            ancestryDistrict,\n            ancestryTA,\n            ancestryVillage,\n            currentDistrict,\n            currentVillage,\n            currentTA\n        } = this.patient.getAddresses()\n        this.editPersonData = {\n            'given_name': this.patient.getGivenName(),\n            'family_name': this.patient.getFamilyName(),\n            'gender': this.patient.getGender(),\n            'birthdate': this.patient.getBirthdate(),\n            'home_district': ancestryDistrict,\n            'home_traditional_authority': ancestryTA,\n            'home_village': ancestryVillage,\n            'current_district': currentDistrict,\n            'current_village': currentVillage,\n            'current_traditional_authority': currentTA,\n            'cell_phone_number': this.patient.getPhoneNumber(),\n            'landmark': this.patient.getClosestLandmark(),\n            'occupation': this.patient.getOccupation()\n        }\n        this.presets = this.editPersonData\n        this.skipSummary = true\n        if(this.personAttribute) {\n            this.activeField = this.personAttribute\n            this.fieldComponent = this.activeField\n        }\n    },\n    async onFinish(form: Record<string, Option> | Record<string, null>, computedData: any) {\n        if (!isOnline.value) {\n            this.createOffline(form, computedData)\n            return\n        }        \n        if (!this.isEditMode()) {\n            this.create(form, computedData)\n        } else {\n            this.update(computedData)\n        }\n        isOfflineMode.value = false\n    },\n    createOffline(form: any, computedData: any) {\n        const { savePersonOffline } = Offline()\n        const person: any = PersonField.resolvePerson(computedData)\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const offlineID = savePersonOffline('Client registration', person, attributes, form?.npid)\n        nextTask(offlineID, this.$router)\n    },\n    async create(_: any, computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const registration: any = new PatientRegistrationService()\n        const patient = new Patientservice((await registration.registerPatient(person, attributes)))\n        const patientID = registration.getPersonID()\n\n        Store.set('ACTIVE_PATIENT', patient) // update patient store\n \n        if(this.presets.nationalIDStatus == \"true\"){ \n            this.patient = patient\n            await this.patient.updateMWNationalId(this.presets.malawiNationalID)\n        }\n\n        if (this.app.onRegisterPatient) {\n            const exit = await this.app.onRegisterPatient(\n                patientID, person, attributes, this.$router, this.$route,\n                computedData\n            )\n            if (exit) return\n        }\n        if (person.relationship === 'Yes') {\n            return this.$router.push(`/guardian/registration/${patientID}`)\n        }\n        await nextTask(patientID, this.$router)\n    },\n    async update(computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const update = new PatientRegistrationService()\n\n        update.setPersonID(this.editPerson)\n        await update.updatePerson(person)\n        for(const attr in person) {\n            if (attr in this.editPersonData) {\n                this.editPersonData[attr] = person[attr]\n            }\n        }\n        Store.invalidate('ACTIVE_PATIENT')\n        if(!this.personAttribute) return this.fieldComponent = 'edit_user'\n        this.$router.back()\n    },\n    editConditionCheck(attributes=[] as Array<string>): boolean {\n        if (this.isEditMode() && !attributes.includes(this.activeField)) {\n            return false\n        }\n        return true\n    },\n    async confirmPatient() {\n        // Attempt to assign or reassign a patient's NPID if they dont have a valid one\n        if (this.ddeEnabled && (!this.patient.getDocID() \n            || (this.patient.getDocID() && this.patient.getNationalID().match(/unknown/i)))) {\n                try {\n                    await this.patient.assignNpid()\n                    await this.patient.printNationalID()\n                    await delayPromise(300)\n               } catch (e) {\n                    toastDanger(`Failed to assign new NPID: ${e}`)\n                }\n        }\n        this.$router.push(`/patients/confirm?person_id=${this.patient.getID()}`)\n    },\n    resolvePersonAttributes(form: Record<string, Option> | Record<string, null>) {\n        return Object.values(form)\n                    .filter((d: any) => isPlainObject(d) && 'personAttributes' in d)\n                    .map(({personAttributes}: any) => personAttributes)\n    },\n    async resolveOnRegistrationCallbacks(patientID: number, computedData: any) {\n        for (const i of Object.values(computedData)) {\n            const item: any = i\n            if (typeof item.onRegisterPatient === 'function') {\n                try {\n                    await item.onRegisterPatient(patientID)\n                } catch (e) {\n                    console.error(`${e}`)\n                    toastDanger(`${e}`)\n                }\n            }\n        }\n    },\n    mapToOption(listOptions: Array<string>): Array<Option> {\n        return listOptions.map((item: any) => ({ label: item, value: item }))\n    },\n    hiddenFieldsForScannedNationalID(): Field[] {\n        const d = (val: string | boolean) => ({label: val, value: val})\n        return [\n            {\n                id: 'given_name',\n                helpText: 'First name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.given_name),\n                computedValue: () => ({person : this.presets.given_name})\n            },\n            {\n                id: 'family_name',\n                helpText: 'Last name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.family_name),\n                computedValue: () => ({person : this.presets.family_name})\n            },\n            {\n                id: 'gender',\n                helpText: 'Gender',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => ({\n                    label: this.presets.gender,\n                    value: this.presets.gender.toLowerCase() === 'male'\n                        ? 'M'\n                        : this.presets.gender.toLowerCase() === 'female'\n                        ? 'F'\n                        : 'N/A'\n                }),\n                computedValue: () => ({person : this.presets.gender})\n            },\n            {\n                id: 'scanned_birthdate',\n                helpText: 'Birth date',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.birthdate),\n                computedValue: () => ({\n                    person : {\n                        'birthdate': this.presets.birthdate,\n                        'birthdate_estimated': false\n                    }\n                })\n            },\n            {\n                id: 'scanned_national_id',\n                helpText: 'Scanned National ID',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.malawiNationalID),\n                computedValue: () => ({\n                    onRegisterPatient : async (patientID: number) => {\n                        const patient = await Patientservice.findByID(patientID)\n                        this.patient = new Patientservice(patient)\n                        this.patient.updateMWNationalId(this.presets.malawiNationalID)\n                    }\n                })\n            }\n        ]\n    },\n    givenNameField(): Field {\n        const name: Field = PersonField.getGivenNameField()\n        name.condition = () => this.editConditionCheck(['given_name'])\n        name.defaultValue = () => this.presets.given_name\n        return name\n    },\n    familyNameField(): Field {\n        const name: Field = PersonField.getFamilyNameField()\n        name.condition = () => this.editConditionCheck(['family_name'])\n        name.defaultValue = () => this.presets.family_name\n        return name\n    },\n    genderField(): Field {\n        const IS_ANC_APP = this.app.applicationName === 'ANC'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const gender: Field = PersonField.getGenderField()\n        gender.requireNext = this.isEditMode()\n        gender.defaultValue = () => this.presets.gender\n        gender.condition = () => {\n            if (!this.isEditMode() && (IS_ANC_APP || IS_CXCA)) {\n                return false\n            }\n            return this.editConditionCheck(['gender'])\n        }\n        if ((IS_ANC_APP || IS_CXCA) && !this.isEditMode()) {\n            gender.defaultOutput = () => ({ label: 'Female', value: 'F' })\n            gender.defaultComputedOutput = () => ({ person: 'F' })\n        } \n\n        gender.beforeNext = async (data: Option) => {\n            /**\n             * Provide warning when changing gender in edit mode\n            */\n            const newGender = data.value\n            const oldGender = this.presets.gender\n            if (this.isEditMode() && newGender != oldGender) {\n                const action = await infoActionSheet(\n                    'Warning',\n                    `Changing gender from ${oldGender} to ${newGender}`,\n                    \"This change will cause data inconsistency and will affect alot of Reports.\",\n                    [\n                        {\n                            name: 'Cancel', slot: 'start'\n                        },\n                        {\n                            name: 'Change gender', slot: 'end', color: 'danger'\n                        }\n                    ]\n                )\n                return action === 'Change gender'\n            }\n            return true\n        }\n        return gender\n    },\n    dobFields(): Array<Field> {\n        const dobConfig = PersonField.getDobConfig()\n        dobConfig.defaultValue = () => this.presets.birthdate\n        dobConfig.condition = () => this.editConditionCheck([\n            'year_birth_date', 'month_birth_date', 'day_birth_date'\n        ])\n        // ANC validation to ensure that we are not registering\n        // Non child bearing youngsters\n        if (this.app.applicationName === 'ANC') {\n            const sdate = Patientservice.getSessionDate()\n            const childBearingAgeInYrs = 12\n            dobConfig.maxDate = () => dayjs(sdate)\n                .subtract(childBearingAgeInYrs, 'years')\n                .format(STANDARD_DATE_FORMAT)\n        }\n        return generateDateFields(dobConfig)\n    },\n    hasNpidField() : Field {\n        return {\n            id: \"has_npid\",\n            helpText: \"National Patient Identifier (NPID) Barcode\",\n            type: FieldType.TT_YES_NO,\n            isRequired: () => true,\n            condition: () => !this.isEditMode() && isOfflineMode.value || !isOnline.value,\n            options: () => {\n                return [\n                    {\n                        label: \"Has client brought NPID barcode?\",\n                        value: \"\",\n                        values: [\n                            { label: \"Yes\", value: \"Yes\" },\n                            { label: \"No\", value: \"No\" }\n                        ]\n                    }\n                ]\n            }\n        }\n    },\n    scanNpid(): Field {\n        return {\n            id: \"npid\",\n            helpText: \"Scan National Patient Identifier (NPID)\",\n            type: FieldType.TT_BARCODE,\n            requireNext: false,\n            condition: (f: any) => /yes/i.test(`${f.has_npid}`),\n            config: {\n                hiddenFooterBtns: [\n                    'Clear'\n                ]\n            },\n            isRequired: () => true\n        }\n    },\n    homeRegionField(): Field { \n        return {\n            ...PersonField.getHomeRegionField(),\n            condition: () => this.editConditionCheck(this.homeAddressAttributes)\n        }\n    },\n    homeDistrictField(): Field {\n        return {\n            ...PersonField.getHomeDistrictField(),\n            condition: () => this.editConditionCheck(this.homeAddressAttributes)\n        }\n    },\n    homeTAField(): Field {\n        return {\n            ...PersonField.getHomeTaField(),\n            condition: (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n                && !form.home_region.label.match(/foreign|use home/i)\n        }\n    },\n    homeVillageField(): Field {\n        return {\n            ...PersonField.getHomeVillageField(),\n            condition: (form: any) => this.editConditionCheck(this.homeAddressAttributes)\n                && !form.home_region.label.match(/foreign|use home/i)\n        }\n    },\n    currentRegionField(): Field {\n        const currentRegion: Field = PersonField.getCurrentRegionField()\n        currentRegion.summaryMapValue = (v: Option, f: any, computedData: any) => {\n            if (/use home/i.test(`${v.value}`)) {\n                return [\n                    { label: 'Current region', value: computedData.person?.current_region},\n                    { label: 'Current District/Country', value: computedData.person?.current_district },\n                    { label: 'Current Traditional Authority', value: computedData.person?.current_traditional_authority },\n                    { label: 'Current village', value: computedData.person?.current_village}\n                ]\n            }\n            return { label: 'Current Region', value: v.label }\n        }\n        if (this.isEditMode()) {\n            currentRegion.computedValue = (val: Option) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_district': this.editPersonData.home_district,\n                            'current_traditional_authority': this.editPersonData.home_traditional_authority,\n                            'current_village': this.editPersonData.home_village\n                        }\n                    }\n                }\n            }\n        }\n        currentRegion.condition = () => this.editConditionCheck(this.currentAddressAttributes)\n        return currentRegion\n    },\n    currentDistrictField(): Field {\n        const currentDistrict: Field = PersonField.getCurrentDistrictField()\n        currentDistrict.condition = (f: any) => !/use home/i.test(f.current_region.label) &&\n             this.editConditionCheck(this.currentAddressAttributes)\n        return currentDistrict\n    },\n    currentTAField(): Field {\n        const currentTA: Field = PersonField.getCurrentTAfield()\n        currentTA.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentTA\n    },\n    currentVillage(): Field {\n        const currentVillage: Field = PersonField.getCurrentVillageField()\n        currentVillage.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentVillage\n    },\n    cellPhoneField(): Field {\n        const cellPhone: Field = PersonField.getCellNumberField()\n        cellPhone.condition = () => this.editConditionCheck(['cell_phone_number'])\n        cellPhone.defaultValue = () => this.presets.cell_phone_number\n        return cellPhone\n    },\n    facilityLocationField(): Field {\n       const facility: Field = PersonField.getFacilityLocationField()\n       facility.condition = (form: any) => [\n           'Drug Refill',\n           'External consultation'\n       ].includes(form.patient_type.value)\n       return facility\n    },\n    landmarkFields(): Field[] {\n        const landmarks: Field[] = PersonField.getLandmarkFields()\n        landmarks[0].condition = () => this.editConditionCheck(['default_landmarks'])\n        return landmarks\n    },\n    patientTypeField(): Field {\n        return {\n            id: 'patient_type',\n            helpText: 'Type of patient',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['patient_type'])\n                && this.app.applicationName === 'ART',\n            validation: (val: any) => Validation.required(val),\n            options: () => PatientTypeService.getPatientTypes()\n        }\n    },\n    occupationField(): Field {\n        return {\n            id: 'occupation',\n            helpText: 'Occupation',\n            type: FieldType.TT_SELECT,\n            init: async () => {\n               this.isMilitarySite = await Store.get('IS_MILITARY_SITE')\n               return true\n            },\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['occupation']) && this.isMilitarySite,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption([\n                'Military',\n                'Civilian'\n            ])\n        }\n    },\n    regimentField(): Field {\n        return {\n            id: 'person_regiment_id',\n            helpText: 'Regiment ID',\n            type: FieldType.TT_TEXT,\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 35,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['person_regiment_id', 'occupation']) && form.occupation && form.occupation.value.match(/Military/i),\n            validation: (val: any) => Validation.required(val)\n        }\n    },\n    rankField(): Field {\n        return {\n            id: 'rank',\n            helpText: 'Rank',\n            type: FieldType.TT_SELECT,\n            validation: (val: any) => Validation.required(val),\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 36,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['rank', 'occupation']) && form.occupation && form.occupation.value.match(/Military/i),\n            options: () => this.mapToOption([\n                'First Lieutenant',\n                'Captain',\n                'Major',\n                'Lieutenant Colonel',\n                'Colonel',\n                'Brigadier General',\n                'Lieutenant General',\n                'General',\n                'Private',\n                'Corporal',\n                'Lance Corporal',\n                'Seargent',\n                'Staff Seargent',\n                'Warrant Officer class 1',\n                'Warrant Officer class 2'\n            ])\n        }\n    },\n    dateJoinedMilitaryFields(): Array<Field> {\n        return generateDateFields({\n            id: 'person_date_joined_military',\n            helpText: 'Joined Military',\n            required: true,\n            condition: (form: any) =>  this.editConditionCheck([\n                'year_person_date_joined_military',\n                'month_person_date_joined_military',\n                'day_person_date_joined_military',\n                'occupation'\n            ]) && form.occupation && form.occupation.value.match(/Military/i),\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => WorkflowService.getSessionDate(),\n            estimation: {\n                allowUnknown: false\n            },\n            computeValue: (date: string) => ({\n                date,\n                personAttributes : {\n                    'person_attribute_type_id': 37, 'value': date\n                }\n            })\n        })\n    },\n    relationshipField(): Field {\n        const IS_HTS = this.app.applicationName === 'ITS'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const OPD = this.app.applicationName === 'OPD'\n        const Registration = this.app.applicationName === 'Registration'\n        return {\n            id: 'relationship',\n            helpText: 'Register guardian?',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['relationship']) && !IS_CXCA && !OPD && !Registration && !IS_HTS,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption(['Yes', 'No'])\n        }\n    },\n    searchResultField(): Field {\n        return {\n            id: 'results',\n            helpText: 'Search results',\n            type: FieldType.TT_PERSON_RESULT_VIEW,\n            init: async () => {\n                if (!this.isEditMode()) { \n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                }\n                return true\n            },\n            dynamicHelpText: (form: any) => {\n                return `Search results for \"${form.given_name.value} ${form.family_name.value} | ${form.gender.label}\"`;\n            },\n            appearInSummary: () => false,\n            condition: () => !this.isEditMode() && !isOfflineMode.value,\n            options: async (form: any) => {\n                const payload = {\n                    'given_name': form.given_name.value,\n                    'family_name': form.family_name.value,\n                    'gender': form.gender.value\n                }\n                // DDE enabled search\n                if (this.ddeEnabled) {\n                    const patients = await this.ddeInstance.searchDemographics(payload)\n                    return patients.map((item: any) => {\n                        const itemData = PersonField.getPersonAttributeOptions(item)\n                        itemData.other.options.push({\n                            label: 'Patient Type',\n                            value: item.patient_type\n                        })\n                        itemData.other.options.push({\n                            label: 'Doc ID',\n                            value: item.doc_id\n                        })\n                        return itemData\n                    })\n                }\n                // Regular search\n                const patients = await Patientservice.search(payload);\n                return patients.map((item: any) => PersonField.getPersonAttributeOptions(item))\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next',\n                    'Back'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Edit Search',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = 'given_name'\n                        },\n                        state: {\n                            disabled: {\n                                default: () => this.hasScannedNationalID()\n                            }\n                        }\n                        \n                    },\n                    {\n                        name: 'New Client',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Continue',\n                        color: 'success',\n                        slot: 'end',\n                        state: {\n                            disabled: {\n                                default: () => true,\n                                onValue(_: any,form: any) {\n                                    return isEmpty(form.results)\n                                }\n                            }\n                        },\n                        onClick: (form: any) => {\n                            if (form.results.other.patientID) {\n                                return this.$router.push(`/patients/confirm?person_id=${form.results.value}`)\n                            }\n                            return this.$router.push(`/patients/confirm?patient_barcode=${form.results.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    possibleDuplicatesField(): Field {\n        let createdPerson: any = {}\n        let duplicatePatients: any = {}\n        return {\n            id: 'possible_duplicates',\n            helpText: 'Possible Duplicate(s)',\n            type: FieldType.TT_PERSON_MATCH_VIEW,\n            condition: async (_: any, c: any) => {\n                if (this.ddeEnabled && this.editPerson <= 0) {\n                    createdPerson = PersonField.resolvePerson(c)\n                    duplicatePatients = await this.ddeInstance\n                        .checkPotentialDuplicates(createdPerson)\n                    return duplicatePatients.length >= 1\n                }\n                return false\n            },\n            options: async () => {\n                const toDate = (date: string) => HisDate.toStandardHisDisplayFormat(date)\n                return duplicatePatients.map(({ score, person }: any) => {\n                    const name = `${person.given_name} ${person.family_name}`\n                    return {\n                        label: name,\n                        value: person.patient_id,\n                        other: {\n                            score: `${score * 100}%`,\n                            newPerson: createdPerson,\n                            foundPerson: person,\n                            docID: person.id,\n                            comparisons: [\n                                [\n                                    'Name',\n                                    `${createdPerson.given_name} ${createdPerson.family_name}`,\n                                    `${person.given_name} ${person.family_name}`\n                                ],\n                                [\n                                    'Gender',\n                                    createdPerson.gender,\n                                    person.gender\n                                ],\n                                [\n                                    'Birthdate',\n                                    toDate(createdPerson.birthdate),\n                                    toDate(person.birthdate)\n                                ],\n                                [\n                                    'Home District',\n                                    createdPerson.home_district,\n                                    person.home_district\n                                ],\n                                [\n                                    'Home TA',\n                                    createdPerson.home_traditional_authority,\n                                    person.home_traditional_authority\n                                ]\n                            ]\n                        }\n                    }\n                })\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Not Duplicate',\n                        slot: 'start',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Select',\n                        slot: 'end',\n                        color: 'success',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: (form: any) => {\n                            this.ddeInstance.importPatient(form.possible_duplicates.other.docID)\n                                .then((result: any) => {\n                                    this.$router.push(`/patients/confirm?person_id=${result.patient_id}`)\n                                }).catch(() => {\n                                    this.$router.push(`/patients/confirm?person_id=${form.possible_duplicates.value}`)\n                                })\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    personIndexField(): Field {\n        return {\n            id: 'edit_user',\n            helpText: 'Edit Demographics',\n            type: FieldType.TT_TABLE_VIEWER,\n            init: async () => {\n                if (this.isEditMode()) {\n                    this.formLabel = 'View / Edit'\n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                    this.isMilitarySite = await Store.get('IS_MILITARY_SITE')\n                }\n                return true\n            },\n            condition: () => this.isEditMode(),\n            options: async () => {\n                const editButton = (attribute: string) => ({\n                    name: 'Edit',\n                    type: 'button',\n                    action: () => {\n                        this.activeField = attribute\n                        this.fieldComponent = this.activeField\n                    }\n                })\n                const columns = ['Attributes', 'Values', 'Edit']\n                const rows = [\n                    ['Given Name', this.editPersonData.given_name, editButton('given_name')],\n                    ['Family Name', this.editPersonData.family_name, editButton('family_name')],\n                    ['Gender', this.editPersonData.gender,  editButton('gender')],\n                    ['Birthdate', HisDate.toStandardHisDisplayFormat(this.editPersonData.birthdate),  editButton('year_birth_date')],\n                    ['Cell Phone Number', this.editPersonData.cell_phone_number, editButton('cell_phone_number')],\n                    ['Home District', this.editPersonData.home_district, editButton('home_region')],\n                    ['Home TA', this.editPersonData.home_traditional_authority,  editButton('home_region')],\n                    ['Home Village', this.editPersonData.home_village,  editButton('home_region')],\n                    ['Current district',this.editPersonData.current_district, editButton('current_region')],\n                    ['Current Village',this.editPersonData.current_village, editButton('current_region')],\n                    ['Current T/A', this.editPersonData.current_traditional_authority, editButton('current_region')],\n                    ['Landmark', this.editPersonData.landmark, editButton('default_landmarks')]\n                ]\n                if (this.isMilitarySite) {\n                    rows.push(['Occupation', this.editPersonData.occupation, editButton('occupation')])\n                }\n                // Tag rows with empty values\n                const emptySets: any = {indexes: [], class: 'his-empty-set-color'}\n                rows.forEach((r: any, i: number) => {\n                    if (isValueEmpty(r[1])) \n                        emptySets.indexes.push(i)\n                })\n                this.hasIncompleteData = emptySets.indexes.length >= 1\n                return [{\n                    label: '', \n                    value: '',\n                    other: {\n                        rows,\n                        columns,\n                        rowColors: [emptySets]\n                    }\n                }]\n            },\n            config: {\n                footerBtns: [\n                    /**\n                     * Custom button that Appears when DDE wants to\n                     * Reassign a patient with incomplete data\n                    */\n                    {\n                        name: 'Reassign',\n                        slot: 'end',\n                        color: 'success',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onload: () => (\n                                    this.ddeEnabled\n                                    && this.ddeIsReassign\n                                    && !this.hasIncompleteData\n                                )\n                            }\n                        },\n                        onClick: async () => {\n                            try {\n                                await this.ddeInstance.reassignNpid(this.ddeDocID, this.editPerson)\n                                await this.ddeInstance.printNpid()\n                                this.$router.push(`/patients/confirm?person_id=${this.editPerson}`)\n                            } catch(e) {\n                                toastWarning(`${e}`)\n                            }\n                        }\n                    },\n                    /**\n                     * Custom button that redirects to patient confirmation page\n                     */\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                onload: () => !this.ddeIsReassign && !this.hasIncompleteData\n                            }\n                        },\n                        onClick: async () => this.confirmPatient()\n                    }\n                ],\n                hiddenFooterBtns: ['Clear', 'Next']\n            }\n        }\n    }\n  }\n})\n","import { render } from \"./PatientRegistration.vue?vue&type=template&id=34070fc6&ts=true\"\nimport script from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {LocationService} from \"@/services/location_service\"\nimport { Option } from \"@/components/Forms/FieldInterface\"\nimport { isEmpty } from \"lodash\"\n\nexport async function getFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getFacilities({name: filter})\n    return facilities.filter((f: any) => !isEmpty(f) && f.name.trim() !='')\n        .map((facility: any) => ({\n            label: facility.name,\n            value: facility.location_id,\n            other: facility\n        }))\n}\n\nexport async function getLabFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getLabs({'search_name': filter})\n    return facilities.map((facility: any) => ({\n            label: facility,\n            value: facility\n        }))\n}\n\nexport async function getFacilityWards(filter=''): Promise<Option[]> {\n    const wards = await LocationService.getFacilities({\n        name: filter,\n        tag: 'Facility adult sections'\n    })\n\n    return wards.map((ward: any) => ({\n        label: ward.name,\n        value: ward.name,\n        other: ward\n    }))\n}\n\nexport async function getSpecialistClinics(): Promise<Option[]> {\n    const clinics = await LocationService.getSpecialistClinics()\n    return clinics.map((clinic: any) => ({\n        label: clinic.name,\n        value: clinic.name,\n        other: clinic\n    }))\n}\n\nexport async function getRegions(): Promise<Option[]> {\n    const regions = await LocationService.getRegions()\n    return regions.map((region: any) => ({\n        label: region.name,\n        value: region.region_id,\n        other: region\n    }))\n}\n\nexport async function getDistricts(regionID: number): Promise<Option[]> {\n    const districts = await LocationService.getDistricts(regionID)\n    return districts.map((district: any) => ({\n        label: district.name,\n        value: district.district_id,\n        other: district\n    }))\n}\n\nexport async function getTraditionalAuthorities(districtID: number, name=''): Promise<Option[]> {\n    const TAs = await LocationService.getTraditionalAuthorities(districtID, name)\n    return TAs.map((TA: any) => ({\n        label: TA.name,\n        value: TA.traditional_authority_id,\n        other: TA\n    }))\n}\n\nexport async function getVillages(traditionalAuthorityID: number, name=''): Promise<Option[]> {\n    const villages = await LocationService.getVillages(traditionalAuthorityID, name)\n    return villages.map((village: any) => ({\n        label: village.name,\n        value: village.village_id,\n        other: village\n    }))\n}\n"],"sourceRoot":""}