(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-405c9842"],{1769:function(e,t,r){"use strict";r.r(t);var n=r("7a23");function a(e,t,r,a,i,u){var c=Object(n["resolveComponent"])("his-standard-form");return Object(n["openBlock"])(),Object(n["createBlock"])(c,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}var i=r("1da1"),u=(r("96cf"),r("ac1f"),r("1276"),r("5319"),r("99af"),r("d95e")),c=r("7920"),s=r("2706"),o=r("b5e4"),p=r("7365"),f=r("3e53"),b=r("fb25"),d=r("ad60"),l=Object(n["defineComponent"])({mixins:[p["a"]],components:{HisStandardForm:c["a"]},data:function(){return{patientHasARVNumber:!1,currentArvNumber:"",prependValue:""}},watch:{ready:{handler:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:if(n=t.patient.getArvNumber(),"Unknown"===n){r.next=10;break}a=n.split("-"),t.currentArvNumber=a[2].replace(/^\D+|\s/g,""),t.prependValue="".concat(a[0],"-").concat(a[1],"-"),t.patientHasARVNumber=!0,r.next=14;break;case 10:return r.next=12,d["a"].getNextSuggestedARVNumber();case 12:i=r.sent,t.currentArvNumber=i.arv_number.replace(/^\D+|\s/g,"");case 14:t.fields=t.getFields();case 15:case"end":return r.stop()}}),r)})))()},immediate:!0}},methods:{onFinish:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e["arv_number"].value,n!==t.patient.getArvNumber()){r.next=3;break}return r.abrupt("return",t.$router.back());case 3:return r.next=5,b["a"].arvNumberExists(n);case 5:if(a=r.sent,!a){r.next=10;break}Object(o["e"])("ARV number already exists",5e3),r.next=24;break;case 10:if(r.prev=10,!t.patientHasARVNumber){r.next=16;break}return r.next=14,t.patient.updateARVNumber(n);case 14:r.next=18;break;case 16:return r.next=18,t.patient.createArvNumber(n);case 18:t.$router.back(),r.next=24;break;case 21:r.prev=21,r.t0=r["catch"](10),Object(o["e"])(r.t0);case 24:case"end":return r.stop()}}),r,null,[[10,21]])})))()},getFields:function(){var e=this;return[{id:"arv_number",helpText:"Update ARV Number",type:u["b"].TT_TEXT,validation:function(e){return s["a"].required(e)},defaultValue:function(){return e.currentArvNumber},config:{initialKb:"0-9",prependValue:function(){if(e.prependValue)return e.prependValue;var t=f["a"].getActiveApp();if(t&&t.programPatientIdentifiers){var r=t.programPatientIdentifiers["ARV Number"];return r.prefix()}return""},footerBtns:[{name:"Void ARV Number",slot:"end",color:"danger",onClick:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.patient.updateARVNumber("Unknown");case 2:e.$router.back();case 3:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}()}]}}]}}}),m=r("6b0d"),v=r.n(m);const h=v()(l,[["render",a]]);t["default"]=h},fb25:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("1da1"),a=r("d4ec"),i=r("bee2"),u=r("45eb"),c=r("7e84"),s=r("262e"),o=r("2caf"),p=(r("96cf"),r("99af"),r("1c74")),f=function(e){Object(s["a"])(r,e);var t=Object(o["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.call(this),e.identifierType=-1,e}return Object(i["a"])(r,[{key:"getIdentifierType",value:function(){return this.identifierType}},{key:"setIdentifierType",value:function(e){this.identifierType=e}},{key:"getDuplicateIndentifiers",value:function(){return p["e"].getJson("search/identifiers/duplicates",{type_id:this.identifierType})}},{key:"getPatientsByIdentifier",value:function(e){return p["e"].getJson("search/patients/by_identifier",{type_id:this.identifierType,identifier:e})}}],[{key:"getIdentifierTypes",value:function(){return Object(u["a"])(Object(c["a"])(r),"getJson",this).call(this,"types/patient_identifiers")}},{key:"arvNumberExists",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["a"])(Object(c["a"])(r),"getJson",this).call(this,"programs/".concat(Object(u["a"])(Object(c["a"])(r),"getProgramID",this).call(this),"/lookup_arv_number/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.exists);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(p["e"])}}]);
//# sourceMappingURL=chunk-405c9842.11bd317b.js.map