(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-89cb263e"],{3800:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"l",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"k",(function(){return u})),n.d(e,"i",(function(){return c})),n.d(e,"g",(function(){return s})),n.d(e,"a",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"c",(function(){return g})),n.d(e,"h",(function(){return f})),n.d(e,"f",(function(){return p}));var i=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","Del"],["","Done",""]],r=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","Del"],["Clear","%","/"]],a=[["1","2","3"],["4","5","6"],["7","8","9"],["Del.","0","Clear"]],o=[["1","2","3","<"],["4","5","6",">"],["7","8","9","="],["","0",""]],u=[["1","2","3","+","-","/","*"],["4","5","6","%","=","<",">","Qwerty"],["7","8","9",".",","],["","0",""]],c=[["1","2","3"],["4","5","6"],["7","8","9"],["","0",""]],s=[["1","2","3","4","5","6","7"],["8","9","10","11","12","13","14"],["15","16","17","18","19","20","21"],["22","23","24","25","26","27","28"],["29","30","31"]],d=[["a","b","c","d","e","f","g","h","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],l=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","'"],["z","x","c","v","b","n","m",",",".","A-Z"]],g=[["1","2","3","4","5","6","7","8","9","0"],["a","b","c","d","e","f","g","h","-","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],f=[["1","2","3","4","5","6","7","8","9","0","Del"],["q","w","e","r","t","y","u","i","o","p","Clear"],["a","s","d","f","g","h","j","k","l",".","Caps"],["z","x","c","v","b","n","m","<",">","/","Enter"]],p=[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","Del."],["z","x","c","v","b","n","m","Caps","Login"]]},"6be2":function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"g",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return d})),n.d(e,"h",(function(){return g})),n.d(e,"a",(function(){return f}));var i=n("3800"),r=[i["k"],[["","Delete"]]],a=[i["i"],[["Delete"]]],o=[i["i"],[["Delete","Unknown"]]],u=[i["i"],[["N/A"],["Delete","Unknown"]]],c=[i["i"],[["Delete"]]],s=[i["i"],[["Unknown","Delete"],["Qwerty","A-Z"]]],d=[i["g"],[["Unknown"]]],l=[i["a"],[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]],g=[i["j"],[["","Delete"],["?123","0-9"],["Space","Unknown"]]],f=[{btn:"0-9",keyboard:s},{btn:"?123",keyboard:r},{btn:"A-Z",keyboard:l},{btn:"Qwerty",keyboard:g}]},7365:function(t,e,n){"use strict";var i,r=n("5530"),a=n("1da1"),o=n("3835"),u=(n("96cf"),n("ac1f"),n("1276"),n("d3b7"),n("ddb0"),n("b0c0"),n("25f0"),n("d81d"),n("4e82"),n("99af"),n("4de4"),n("07ac"),n("3ca3"),n("7a23")),c=n("ad60"),s=n("2ef0"),d=n("0fa1"),l=n("7f35"),g=n("9283");(function(t){t["SET_PROVIDER"]="SET_PROVIDER",t["CHANGE_SESSION_DATE"]="change_session_date",t["GO_TO_PATIENT_DASHBOARD"]="go_to_patient_dashboard",t["CHANGE_PATIENT_OUTCOME"]="change_outcome",t["CONTINUE"]="continue",t["EXIT"]="exit"})(i||(i={}));var f=function(t){return g["b"].toStandardHisDisplayFormat(t)},p={"Warn if attempting to create new encounters for a deceased patient":{priority:1,actions:{alert:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.outcomeStartDate,t.next=3,Object(l["a"])("Data Integrity Issue Found","Patient died on ".concat(f(n)),"Proceeding with this outcome might affect accuracy of some reports",[{name:"Cancel",slot:"end",color:"primary"},{name:"Change outcome",slot:"end",color:"primary"},{name:"Continue Anyway",slot:"end",color:"danger"}]);case 3:return r=t.sent,t.abrupt("return","Cancel"===r?i.GO_TO_PATIENT_DASHBOARD:"Change outcome"===r?i.CHANGE_PATIENT_OUTCOME:i.CONTINUE);case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},conditions:{outcome:function(t){return"Patient died"===t},outcomeStartDate:function(t,e){var n=e.sessionDate;return n>=t}}},"A patient's date of birth must not be less than Session Date":{priority:2,actions:{alert:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.birthDate,r=e.sessionDate,t.next=3,Object(l["a"])("Data integrity issue found","","Session date ".concat(f(r)," is less than birth date of ").concat(f(n)),[{name:"Cancel",slot:"end",color:"danger"},{name:"Change session date",slot:"end",color:"success"}]);case 3:return a=t.sent,t.abrupt("return","Change session date"===a?i.CHANGE_SESSION_DATE:i.GO_TO_PATIENT_DASHBOARD);case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},conditions:{birthDate:function(t,e){var n=e.sessionDate;return n<t}}},"Select Encounter provider when in back data entry":{priority:3,actions:{selection:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,r,a,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.providers,r=e.encounterName,a=e.sessionDate,o=e.apiDate,t.next=3,Object(l["c"])("Please select a provider for ".concat(r),"BDE: ".concat(f(a)," | Current: ").concat(f(o)),n,[{name:"Cancel",color:"danger",slot:"start",role:"default"},{name:"Confirm",slot:"end",role:"action"}]);case 3:return u=t.sent,t.abrupt("return","Cancel"===u.action?{value:-1,flowState:i.GO_TO_PATIENT_DASHBOARD}:{value:u.selection,flowState:i.SET_PROVIDER});case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},conditions:{isBdeMode:function(t){return t}}}},h=n("c21d"),m=n("7920"),b=n("b5e4"),v=n("8e8b"),y=Object(u["defineComponent"])({components:{HisStandardForm:m["a"]},data:function(){return{patient:{},fields:[],patientID:"",providerID:-1,providers:[],facts:{sessionDate:"",apiDate:"",encounterName:"N/A",providers:[],isBdeMode:!1,birthDate:"",outcome:"",outcomeStartDate:""},ready:!1}},watch:{$route:{handler:function(t){var e=this;t.params.patient_id&&this.patientID!=t.params.patient_id&&(this.patientID=parseInt(t.params.patient_id),v["a"].get("ACTIVE_PATIENT",{patientID:this.patientID}).then((function(t){e.patient=t,e.setEncounterFacts().then((function(){e.checkEncounterGuidelines().then((function(){e.ready=!0}))}))})))},immediate:!0,deep:!0}},computed:{cancelDestination:function(){return this.patientDashboardUrl()}},methods:{runflowState:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r={};if(r[i.SET_PROVIDER]=function(t){var n=t.split(" "),r=Object(o["a"])(n,1),a=r[0],u=Object(s["find"])(e.providers,{username:a});return u&&(e.providerID=u.person_id),i.CONTINUE},r[i.CHANGE_SESSION_DATE]=function(){return e.$router.push("/session/date?patient_dashboard_redirection_id=".concat(e.patientID)),i.EXIT},r[i.CHANGE_PATIENT_OUTCOME]=function(){return e.$router.push("/patient/programs/".concat(e.patientID)),i.EXIT},r[i.GO_TO_PATIENT_DASHBOARD]=function(){return e.gotoPatientDashboard(),i.EXIT},t in r)return r[t](n)},checkEncounterGuidelines:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,r,a,o,u,c,s,d,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=Object(h["a"])(t.facts,p),e.t0=regeneratorRuntime.keys(n);case 2:if((e.t1=e.t0()).done){e.next=20;break}if(r=e.t1.value,u=n[r],null===u||void 0===u||null===(a=u.actions)||void 0===a||!a.alert){e.next=13;break}return e.t2=t,e.next=9,null===u||void 0===u||null===(c=u.actions)||void 0===c?void 0:c.alert(t.facts);case 9:if(e.t3=e.sent,s=e.t2.runflowState.call(e.t2,e.t3),s!==i.EXIT){e.next=13;break}return e.abrupt("return");case 13:if(null===u||void 0===u||null===(o=u.actions)||void 0===o||!o.selection){e.next=18;break}return e.next=16,null===u||void 0===u||null===(d=u.actions)||void 0===d?void 0:d.selection(t.facts);case 16:l=e.sent,t.runflowState(l.flowState,l.value);case 18:e.next=2;break;case 20:case"end":return e.stop()}}),e)})))()},setEncounterFacts:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v["a"].get("PATIENT_PROGRAM",{patientID:t.patientID});case 3:n=e.sent,t.facts.outcome=n.outcome,t.facts.outcomeStartDate=n.startDate,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](0),console.error(e.t0),Object(b["c"])("".concat(e.t0));case 12:if(t.facts.sessionDate=c["a"].getSessionDate(),t.facts.apiDate=c["a"].getCachedApiDate(),t.facts.isBdeMode=c["a"].isBDE(),t.facts.birthDate=t.patient.getBirthdate(),t.facts.encounterName=t.$route.name?t.$route.name.toString().toUpperCase():"N/A",!c["a"].isBDE()){e.next=22;break}return e.next=20,v["a"].get("PROVIDERS");case 20:t.providers=e.sent,t.facts.providers=t.providers.sort((function(t,e){var n=t.username.toUpperCase(),i=e.username.toUpperCase();return n<i?-1:n>i?1:0})).map((function(t){var e,n="".concat(t.username);if(!Object(s["isEmpty"])(null===t||void 0===t||null===(e=t.person)||void 0===e?void 0:e.names)){var i,r=(null===(i=t.person)||void 0===i?void 0:i.names)||[],a=Object(o["a"])(r,1),u=a[0];n+=" (".concat(u.given_name," ").concat(u.family_name,")")}return n}));case 22:case"end":return e.stop()}}),e,null,[[0,8]])})))()},toOption:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{label:t,value:t,other:e}},mapStrToOptions:function(t){return t.map((function(t){return{label:t,value:t}}))},patientDashboardUrl:function(){return"/patient/dashboard/".concat(this.patientID)},gotoPatientDashboard:function(){return this.$router.push({path:this.patientDashboardUrl()})},nextTask:function(){return Object(d["b"])(this.patientID,this.$router)},yesNoOptions:function(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},toYesNoOption:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{label:t,value:"",other:Object(r["a"])(Object(r["a"])({},e),{},{values:this.yesNoOptions()})}},mapOptions:function(t){return t.map((function(t){return{label:t,value:t}}))},yesNoUnknownOptions:function(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"},{label:"Unknown",value:"Unknown"}]},resolveObs:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object.values(t).filter((function(t){return t&&(t.tag===e||""===e)})).reduce((function(t,e){var n=e.obs?e.obs:e;return Array.isArray(n)?t=t.concat(n):"function"===typeof n?t.push(n()):t.push(n),t}),[]);return Promise.all(n)},inArray:function(t,e){try{return t.filter((function(t){return e(t)})).length>0}catch(n){return!1}},validateSeries:function(t){try{for(var e in t){var n=t[e]();if(n)return n}}catch(i){return[i]}}}});const T=y;e["a"]=T},7920:function(t,e,n){"use strict";var i=n("7a23");function r(t,e,n,r,a,o){return Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(t.formType),{fields:t.fields,skipSummary:t.skipSummary,activeField:t.activeField,cancelDestinationPath:t.cancelDestinationPath,onOnFinish:t.onFinish,onFinish:t.onFinishAction,onOnIndex:t.onIndex},null,8,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var a=n("9441"),o=Object(i["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:a["a"]},emits:["onFinish","onIndex"],data:()=>({formType:"touch-screen-form"}),props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish(t,e){this.$emit("onFinish",t,e)},onIndex(t){this.$emit("onIndex",t)}}}),u=n("6b0d"),c=n.n(u);const s=c()(o,[["render",r]]);e["a"]=s},b446:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return E}));var i,r=n("2909"),a=n("3835"),o=n("5530"),u=n("1da1"),c=(n("96cf"),n("99af"),n("caad"),n("a15b"),n("d3b7"),n("25f0"),n("ac1f"),n("466d"),n("1276"),n("d95e")),s=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}],d=n("9283"),l=n("2706"),g=n("3800"),f=n("6be2"),p=n("5a0c"),h=n.n(p),m=n("1c74");function b(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=[];return n&&i.push("UNKNOWN"),{id:t,helpText:"".concat(e," Year"),appearInSummary:function(){return!1},type:c["b"].TT_TEXT,config:{customKeyboard:[g["i"],[i,["DELETE"]]]}}}function v(t,e){return{id:t,helpText:"".concat(e," Month"),appearInSummary:function(){return!1},type:c["b"].TT_SELECT,options:function(){return s}}}function y(t,e){return{id:t,helpText:"".concat(e," Day"),type:c["b"].TT_MONTHLY_DAYS,appearInSummary:function(){return!1}}}function T(t,e){return{id:t,helpText:"".concat(e," Estimated period"),type:c["b"].TT_SELECT,appearInSummary:function(){return!1},options:function(){return[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}}function w(t,e){return{id:t,helpText:"".concat(e," Age Estimate"),type:c["b"].TT_NUMBER,appearInSummary:function(){return!1},config:{keypad:f["e"]}}}function S(t){return parseInt(t)<10?"0".concat(t):t}function A(t,e,n){return D.apply(this,arguments)}function D(){return D=Object(u["a"])(regeneratorRuntime.mark((function t(e,n,i){var r,o,u,c,s,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n.defaultValue){t.next=12;break}return t.next=3,n.defaultValue(e);case 3:if(r=t.sent,!r){t.next=12;break}o=r.split("-"),u=Object(a["a"])(o,3),c=u[0],s=u[1],d=u[2],t.t0=i,t.next="Year"===t.t0?9:"Month"===t.t0?10:"Day"===t.t0?11:12;break;case 9:return t.abrupt("return",c||"");case 10:return t.abrupt("return",parseInt(s)||"");case 11:return t.abrupt("return",parseInt(d)||"");case 12:return t.abrupt("return","");case 13:case"end":return t.stop()}}),t)}))),D.apply(this,arguments)}function C(t){return d["b"].toStandardHisDisplayFormat(t)}function O(t,e,n,i){if(e.minDate){var r=e.minDate(n,i);if(new Date(t)<new Date(r))return["".concat(C(t)," is less than minimum date of ").concat(C(r))]}if(e.maxDate){var a=e.maxDate(n,i);if(a&&new Date(t)>new Date(a))return["".concat(C(t)," is greater than max date of  ").concat(C(a))]}}function E(t){var e="",n="",u="",c="",g="year_".concat(t.id),f="month_".concat(t.id),p="day_".concat(t.id),D="age_estimate_".concat(t.id),E="duration_estimate_".concat(t.id),_=b(g,t.helpText,t.estimation.allowUnknown),I=v(f,t.helpText),x=y(p,t.helpText),F=w(D,t.helpText),k=T(E,t.helpText),N="boolean"===typeof t.estimation.allowUnknownMonthDay&&t.estimation.allowUnknownMonthDay,R=function(e){return!(e[g]&&e[g].value&&["Unknown"].includes(e[g].value))&&(!t.condition||t.condition(e))},j=function(t,e){var i=[{type:"year",value:n,default:"YYYY"},{type:"month",value:u,default:"MM"},{type:"day",value:c,default:"DD"}];return i.reduce((function(n,i){var r=[null,void 0,"Unknown",""];return e===i.type?r.includes(t)?n.push(i.default):n.push(t):r.includes(i.value)?n.push(i.default):n.push(i.value),n}),[]).join("-")};"function"===typeof t.init&&(_.init=t.init),_.updateHelpTextOnValue=function(t){return"".concat(_.helpText," (").concat(j(null===t||void 0===t?void 0:t.label,"year"),")")},_.proxyID=t.id,_.unload=function(t){return n=t.value.toString()},_.config=Object(o["a"])(Object(o["a"])({},_.config),t.config),_.defaultValue=function(e){return A(e,t,"Year")},_.condition=function(e){return!t.condition||t.condition(e)},_.validation=function(e,n,i){if(t.required&&l["a"].required(e))return["Year cannot be empty"];var r=e?e.value:"";if(!t.estimation.allowUnknown&&r.toString().match(/unknown/i))return["Value unknown is not permitted"];if(r&&!["Unknown"].includes(r)&&isNaN(r)||r<1900)return["Invalid Year"];if(r&&"function"===typeof t.minDate){var a=d["b"].getYear(t.minDate(n,i));if(parseInt(r)<a)return["Year of ".concat(r," is less than Minimum year of ").concat(a)]}if(r&&"function"===typeof t.maxDate){var o=t.maxDate(n,i);if(o&&r>d["b"].getYear(o))return["Year of ".concat(r," exceeds Maximum year of ").concat(d["b"].getYear(o))]}return null},_.summaryMapValue=function(){return{label:t.summaryLabel||t.helpText,value:e?C(e):"Unknown"}},_.appearInSummary=function(e,n){return n===t.id},_.computedValue=function(n){if(e){var i=e.split("-"),r=Object(a["a"])(i,3),o=(r[0],r[1]),u=r[2];return e="".concat(n.value,"-").concat(o,"-").concat(u),t.computeValue(e,!1)}if(n&&"Unknown"===n.value)return e="",t.computeValue("Unknown",!1)},I.updateHelpTextOnValue=function(t){return"".concat(I.helpText," (").concat(j(null===t||void 0===t?void 0:t.label,"month"),")")},I.proxyID=t.id,I.unload=function(t){return u=S(t.value.toString())},I.condition=function(t){return R(t)},I.validation=function(t){return l["a"].required(t)},I.defaultValue=function(e){return A(e,t,"Month")},N&&(I.options=function(){return[].concat(Object(r["a"])(s),[{label:"Unknown",value:"Unknown"}])}),I.computedValue=function(n,i){if("".concat(n.value).match(/unknown/i))return e="".concat(i[g].value,"-07-15"),t.computeValue(e,!0);if(e){var r=e.split("-"),o=Object(a["a"])(r,3),u=o[0],c=(o[1],o[2]),s=S("".concat(n.value));return e="".concat(u,"-").concat(s,"-").concat(c),t.computeValue(e,!1)}},x.proxyID=t.id,x.updateHelpTextOnValue=function(t){return"".concat(x.helpText," (").concat(j(null===t||void 0===t?void 0:t.label,"day"),")")},x.condition=function(t){return!"".concat(t[f].value).match(/unknown/i)&&R(t)},x.validation=function(n,i,r){return l["a"].required(n)?["Day is required for date"]:O(e,t,i,r)},x.defaultValue=function(e){return A(e,t,"Day")},x.computedValue=function(i){var r=!!"".concat(i.value).match(/unknown/i);return c=r?"15":S("".concat(i.value)),e="".concat(n,"-").concat(u,"-").concat(c),t.computeValue(e,r)},x.unload=function(e,n,i,r){t.unload&&t.unload(e,n,i,r)},x.beforeNext=function(n,i){return!t.beforeNext||t.beforeNext(e,i)},x.config={year:function(t){return t[g].value},month:function(t){return t[f].value}},N||(x.config.keyboardActions=[]);var M=function(e,n){var i=["Unknown"===e[g].value,!t.condition||t.condition(e),t.estimation.estimationFieldType===n];return i.every(Boolean)};return F.proxyID=t.id,F.validation=function(n,i,r){if(n&&n.value>300)return["Age estimate is too high and exceeding hard limit of 300"];if(isNaN(parseInt(n.value.toString())))return["Please enter a valid number"];var a=/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/;return n.value.toString().match(a)?O(e,t,i,r):["Not a valid age estimate"]},F.condition=function(t){return M(t,i.AGE_ESTIMATE_FIELD)},F.computedValue=function(n){var i=h()(m["e"].getSessionDate()).subtract(n.value,"years").year();return e="".concat(i,"-07-15"),t.computeValue(e,!0)},F.beforeNext=function(n,i){return!t.beforeNext||t.beforeNext(e,i)},k.proxyID=t.id,k.validation=function(n,i,r){return l["a"].required(n)?["Please select an estimate"]:O(e,t,i,r)},k.condition=function(t){return M(t,i.MONTH_ESTIMATE_FIELD)},k.computedValue=function(n){return e=h()(m["e"].getSessionDate()).subtract(n.value,"day").format(d["a"]),t.computeValue(e,!0)},k.beforeNext=function(n,i){return!t.beforeNext||t.beforeNext(e,i)},[_,I,x,F,k]}(function(t){t["AGE_ESTIMATE_FIELD"]="age-estimate-field",t["MONTH_ESTIMATE_FIELD"]="month-period-estimate-field"})(i||(i={}))},daa6:function(t,e,n){"use strict";var i,r=n("2909"),a=n("1da1"),o=(n("d3b7"),n("3ca3"),n("ddb0"),n("99af"),n("d81d"),n("caad"),n("2532"),n("b0c0"),n("a4d3"),n("e01a"),n("4de4"),n("ac1f"),n("466d"),n("25f0"),n("96cf"),n("7a23")),u=n("d95e"),c=n("d4ec"),s=n("bee2"),d=n("262e"),l=n("2caf"),g=n("cc6f"),f=n("5713"),p=n("8158"),h=n("b5e4"),m={"Adults with stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:function(t){return 4===t}}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{reasonForArt:function(t){return"WHO STAGE IV ADULT"===t}}},"Adults with stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:function(t){return 3===t}}},"Adults with stage 2 conditions":{concept:"WHO STAGE II ADULT",priority:4,conditions:{stage:function(t){return 2===t}}},"Adults with stage 1 conditions":{concept:"WHO STAGE I ADULT",priority:5,conditions:{stage:function(t){return 1===t}}}},b={"Children with stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:1,conditions:{stage:function(t){return 4===t}}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV PEDS",priority:2,conditions:{reasonForArt:function(t){return"WHO STAGE IV PEDS"===t}}},"For children with stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:3,conditions:{stage:function(t){return 3===t}}},"Children with stage 2 conditions":{concept:"WHO STAGE II PEDS",priority:4,conditions:{stage:function(t){return 2===t}}},"Children with stage 1 conditions":{concept:"WHO STAGE I PEDS",priority:5,conditions:{stage:function(t){return 1===t}}}},v={"Warn if Severe weight loss is selected when actual patient BMI is acceptable":{priority:1,actions:{alert:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(h["a"])("Patient's BMI of ".concat(e.bmi," greater than 18.5, do you wish to proceed?"),{confirmBtnLabel:"Yes, keep severe weightloss",cancelBtnLabel:"No, cancel"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},conditions:{selectedCondition:function(t){return"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===t},bmi:function(t){return t>18.5}}},"Warn for contradicting stage defining conditions":{priority:1,actions:{alert:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(h["a"])("CONTRADICTING STAGE DEFINING CONDITIONS",{confirmBtnLabel:"Keep Asymptomatic",cancelBtnLabel:"Keep other(s)"});case 2:if(n=t.sent,!n){t.next=10;break}return e.stage=1,e.selectedConditions=[],e.stageThreeConditions=[],e.stageFourConditions=[],e.stageTwoConditions=[],t.abrupt("return",!0);case 10:return t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},conditions:{selectedCondition:function(t){return"Asymptomatic HIV infection"===t},stage:function(t){return t>=2}}}},y={"For children whose current weight percentile is less than 70":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:function(t){return"Child has a low weight percentile of ".concat(t.weightPercentile)}},conditions:{selectedCondition:function(t){return"Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)"===t},weightPercentile:function(t){return t<70}}},"Enable Moderate unexplained malnutrition for children whose weight for height is 70-79%":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:function(t){return"Child has weight percentile of ".concat(t.weightPercentile)}},conditions:{selectedCondition:function(t){return"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===t},weightPercentile:function(t){return t>=70&&t<=79}}},"Disable moderate weight loss when Severe unexplained weight loss is chosen":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:function(){return"Severe weight loss/manutrition was already selected"}},conditions:{selectedCondition:function(t){return"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===t},selectedConditions:function(t){return t.includes("Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)")}}}},T={"Adults with a BMI less than 16":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:function(t){return"Adult has a low BMI of ".concat(t.bmi)}},conditions:{selectedCondition:function(t){return"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===t},bmi:function(t){return t<16}}},"Adults whose BMI is between 16 and 18":{priority:3,actions:{isChecked:!0},description:{color:"warning",show:"onChecked",info:function(t){return"BMI of ".concat(t.bmi," is between 16 and 18")}},conditions:{selectedCondition:function(t){return"Moderate weight loss less than or equal to 10 percent, unexplained"===t},bmi:function(t){return t>=16&&t<=18.5}}},"Disable Moderate weight loss if severe weightloss is selected":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:function(){return"Severe weight loss was already selected"}},conditions:{selectedCondition:function(t){return"Moderate weight loss less than or equal to 10 percent, unexplained"===t},selectedConditions:function(t){return t.includes("Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained")}}}},w={"Has stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:1,conditions:{stage:function(t){return 4===t}}},"Has stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:2,conditions:{stage:function(t){return 3===t}}},"Children under twelve months who tested positive on Rapid test and have presumed severe HIV":{concept:"PRESUMED SEVERE HIV",priority:3,conditions:{ageInMonths:function(t){return t<12},selectedConditions:function(t){var e=p["a"].getConceptsByCategory("pshd_condition");for(var n in e)if(t.includes(n))return!0;return!1},testType:function(t){return"HIV rapid test"===t}}},"Children under twelve who tested positive via HIV DNA Polymerase Chain Reaction test":{concept:"HIV DNA POLYMERASE CHAIN REACTION",priority:4,conditions:{ageInMonths:function(t){return t<12},testType:function(t){return"HIV DNA POLYMERASE CHAIN REACTION"===t}}},"Children who are less than 24 months":{concept:"HIV infected",priority:5,conditions:{ageInMonths:function(t){return t<24}}},"Children between 24 and 56 months who have stage 2 or 1 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 750",priority:6,conditions:{ageInMonths:function(t){return t>=24&&t<=56},cd4:function(t){return t<=750},cd4Modifier:function(t){return"<"===t||"="===t},stage:function(t){return t<=2}}},"Children with CD4 count less than 500 and have stage 1 and stage 2 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:7,conditions:{cd4:function(t){return t<=500},cd4Modifier:function(t){return"<"===t||"="===t},stage:function(t){return t<=2}}},"Children over the date 2014-04-01 who are more than five years old and have cd4 count less than 500":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:9,conditions:{date:function(t){return t>="2014-04-01"},age:function(t){return t>5},cd4:function(t){return t<=500},cd4Modifier:function(t){return"<"===t||"="===t}}},"Children over date 2014-04-01 and less than Five years old":{concept:"HIV infected",priority:10,conditions:{date:function(t){return t>="2014-04-01"},age:function(t){return t<=5}}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:11,conditions:{stage:function(t){return t<=2}}}},S={"Has stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:function(t){return 4===t}}},"Has HIV wasting syndrome identified in stage 3":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{selectedConditions:function(t){var e=p["a"].getConceptsByCategory("severe_hiv_wasting_syndrome"),n=e.reduce((function(e,n){return t.includes(n.name)?e+1:0}),0);return n>=2}}},"Has stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:function(t){return 3===t}}},"CD4 less than 350 for adults before 2014":{concept:"cd4 less than or equal to 350",priority:4,conditions:{date:function(t){return t<"2014-04-01"},cd4:function(t){return t<=350},cd4Modifier:function(t){return"<"===t||"="===t}}},"CD4 less than 250 for adults after 2014":{concept:"cd4 less than or equal to 250",priority:4,conditions:{date:function(t){return t>="2014-04-01"},cd4:function(t){return t<=250},cd4Modifier:function(t){return"<"===t||"="===t}}},"CD4 less than 350 for adults after 2014":{concept:"cd4 less than or equal to 350",priority:5,conditions:{date:function(t){return t>="2014-04-01"},cd4:function(t){return t<=350},cd4Modifier:function(t){return"<"===t||"="===t}}},"CD4 less than 500 for adults after 2014":{concept:"cd4 less than or equal to 500",priority:6,conditions:{date:function(t){return t>="2014-04-01"},cd4:function(t){return t<=500},cd4Modifier:function(t){return"<"===t||"="===t}}},"Women who are breast feeding":{concept:"BREASTFEEDING",priority:8,conditions:{gender:function(t){return"F"===t},breastFeeding:function(t){return"Yes"===t},stage:function(t){return t<=2}}},"Women who are pregnant":{concept:"PATIENT PREGNANT",priority:7,conditions:{gender:function(t){return"F"===t},pregnant:function(t){return"Yes"===t},stage:function(t){return t<=2}}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:9,conditions:{stage:function(t){return t<=2}}}};(function(t){t["ADULT_STAGE_4"]="stage_4_conditions_adults",t["ADULT_STAGE_3"]="stage_3_conditions_adults",t["ADULT_STAGE_2"]="stage_2_conditions_adults",t["ADULT_STAGE_1"]="stage_1_conditions_adults",t["PEDAID_STAGE_4"]="stage_4_conditions_pedaids",t["PEDAID_STAGE_3"]="stage_3_conditions_pedaids",t["PEDAID_STAGE_2"]="stage_2_conditions_pedaids",t["PEDAID_STAGE_1"]="stage_1_conditions_pedaids"})(i||(i={}));var A=function(t){Object(d["a"])(n,t);var e=Object(l["a"])(n);function n(t,i,r){var a;return Object(c["a"])(this,n),a=e.call(this,t,52,r),a.age=i,a.confirmatoryTest=null,a}return Object(s["a"])(n,[{key:"isAdult",value:function(){return this.age>=15}},{key:"isPedaid",value:function(){return this.age<=14}},{key:"setAge",value:function(t){this.age=t}},{key:"getFacilities",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return f["a"].getFacilities({name:t})}},{key:"getConfirmatoryTestType",value:function(){return this.confirmatoryTest}},{key:"cd4CountIsValid",value:function(t){try{return!!t.match(/^(=|<|>)([0-9]*)$/m)}catch(e){return!1}}},{key:"getAlertGuidelines",value:function(){return v}},{key:"getWhoStageGuidelines",value:function(){return this.isAdult()?m:b}},{key:"getProgramEligibilityGuidelines",value:function(){return this.isAdult()?S:w}},{key:"getRecommendedConditionGuidelines",value:function(){return this.isAdult()?T:y}},{key:"getStagingConditions",value:function(t){var e=this.getStagingCategoryByNum(t);return g["a"].getConceptsByCategory(e)}},{key:"buildWhoStageObs",value:function(t){return this.buildValueCoded("Who stage",t)}},{key:"buildWhoCriteriaObs",value:function(t){return this.buildValueCoded("Who stages criteria present",t)}},{key:"buildReasonForArtObs",value:function(t){return this.buildValueCoded("Reason for ART eligibility",t)}},{key:"getStagingCategoryByNum",value:function(t){switch(t){case 1:return this.isAdult()?i.ADULT_STAGE_1:i.PEDAID_STAGE_1;case 2:return this.isAdult()?i.ADULT_STAGE_2:i.PEDAID_STAGE_2;case 3:return this.isAdult()?i.ADULT_STAGE_3:i.PEDAID_STAGE_3;case 4:return this.isAdult()?i.ADULT_STAGE_4:i.PEDAID_STAGE_4;default:return""}}},{key:"loadHivConfirmatoryTestType",value:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,g["a"].getFirstValueCoded(this.patientID,"Confirmatory hiv test type");case 2:e=t.sent,e&&(this.confirmatoryTest=e);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}]),n}(g["a"]),D=n("7365"),C=n("2706"),O=n("b446"),E=n("9283"),_=n("2ef0"),I=n("3800"),x=n("c21d"),F=n("e86e"),k=Object(o["defineComponent"])({mixins:[D["a"]],data:function(){return{staging:{},showStagingWeightChart:!0,canShowStagingFields:!0,bmiObj:{},stagingFacts:{age:-1,bmi:-1,gender:"",stage:-1,cd4:-1,date:"",isChildBearing:!1,stageOneConditions:[],stageTwoConditions:[],stageThreeConditions:[],stageFourConditions:[],reasonForArt:"",testType:"",pregnant:"",breastFeeding:"",selectedCondition:"",selectedConditions:[],weightPercentile:-1,ageInMonths:-1,cd4Modifier:"",whoStage:""}}},watch:{ready:{handler:function(t){t&&(this.staging=new A(this.patient.getID(),this.patient.getAge(),this.providerID))},immediate:!0}},methods:{initStaging:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.staging.loadHivConfirmatoryTestType();case 2:return n.next=4,t.getBMI();case 4:if(e.bmiObj=n.sent,e.stagingFacts.age=t.getAge(),e.stagingFacts.bmi=e.bmiObj["index"],e.stagingFacts.date=A.getSessionDate(),e.stagingFacts.gender=t.isMale()?"M":"F",e.stagingFacts.testType=e.staging.getConfirmatoryTestType(),e.stagingFacts.ageInMonths=t.getAgeInMonths(),e.stagingFacts.isChildBearing=t.isChildBearing(),!e.staging.isPedaid()){n.next=16;break}return n.next=15,t.calculateWeightPercentile();case 15:e.stagingFacts.weightPercentile=n.sent;case 16:case"end":return n.stop()}}),n)})))()},submitStaging:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,a,o,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.staging.createEncounter();case 2:if(i=n.sent,i){n.next=5;break}throw"Unable to create staging encounter";case 5:return n.next=7,e.resolveObs(t,"staging");case 7:return a=n.sent,n.next=10,Promise.all([e.buildReasonForArtObs(),e.buildWhoStageObs()]);case 10:return o=n.sent,n.next=13,e.staging.saveObservationList([].concat(Object(r["a"])(a),Object(r["a"])(o)));case 13:if(u=n.sent,u){n.next=16;break}throw"Unable to save patient observations";case 16:case"end":return n.stop()}}),n)})))()},onStagingCondition:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,r,a,o,u,c,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.label,e.stagingFacts.selectedCondition=a,o=e.staging.getAlertGuidelines(),u=Object(x["a"])(e.stagingFacts,o),!Object(_["isEmpty"])(u)){n.next=6;break}return n.abrupt("return",!0);case 6:if(null===(i=u[0])||void 0===i||!i.actions||null===(r=u[0])||void 0===r||!r.actions.alert){n.next=11;break}return n.next=9,null===(c=u[0])||void 0===c?void 0:c.actions.alert(e.stagingFacts);case 9:return s=n.sent,n.abrupt("return",!!s);case 11:return n.abrupt("return",!0);case 12:case"end":return n.stop()}}),n)})))()},getFacilities:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(F["b"])(t)},updateStagingFacts:function(){var t=[this.stagingFacts.stageOneConditions,this.stagingFacts.stageTwoConditions,this.stagingFacts.stageThreeConditions,this.stagingFacts.stageFourConditions];this.stagingFacts.stage=t.reduce((function(t,e,n){return Object(_["isEmpty"])(e)?t:n+1}),0),this.stagingFacts.selectedConditions=t.reduce((function(t,e){return t.concat(e)}),[])},buildReasonForArtObs:function(){return this.staging.buildReasonForArtObs(this.stagingFacts.reasonForArt)},buildWhoStageObs:function(){return this.staging.buildWhoStageObs(this.stagingFacts.whoStage)},buildStagingOptions:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.staging.getRecommendedConditionGuidelines();return this.staging.getStagingConditions(t).map((function(t){var r,a=!1,o=n.includes(t.name);e.stagingFacts.selectedCondition=t.name;var u=Object(x["a"])(e.stagingFacts,i);if(!Object(_["isEmpty"])(u)){var c,s,d=u[0];null!==d&&void 0!==d&&null!==(c=d.actions)&&void 0!==c&&c.isChecked&&(o=!0),null!==d&&void 0!==d&&null!==(s=d.actions)&&void 0!==s&&s.disabled&&(a=!0),r=d.description}return{label:t.name,value:t.concept_id,isChecked:o,disabled:a,description:r}}))},setWhoStage:function(){var t,e=this.staging.getWhoStageGuidelines(),n=Object(x["a"])(this.stagingFacts,e);this.stagingFacts.whoStage=(null===(t=n[0])||void 0===t?void 0:t.concept)||""},setReasonForArt:function(){var t,e=this.staging.getProgramEligibilityGuidelines(),n=Object(x["a"])(this.stagingFacts,e);this.stagingFacts.reasonForArt=(null===(t=n[0])||void 0===t?void 0:t.concept)||""},notAsymptomatic:function(t){var e=t.stage_1_conditions;if(e){var n=e.filter((function(t){return t.label.match(/asymptomatic/i)&&t.isChecked}));return Object(_["isEmpty"])(n)}return!0},hasTransferLater:function(t){return"has_transfer_letter"in t&&(t.has_transfer_letter&&"Yes"===t.has_transfer_letter.value)},hasStaging:function(t){return!!this.hasTransferLater(t)||this.canShowStagingFields},getStagingSummaryField:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Summary";return{id:"summary",helpText:e,type:u["b"].TT_ART_STAGING_SUMMARY,condition:function(e){return t.hasStaging(e)},onload:function(){t.setReasonForArt(),t.setWhoStage()},options:function(){return[{label:"WHO Stage",value:t.stagingFacts.whoStage,other:{type:"title-section"}},{label:"Condition on starting ART",value:t.stagingFacts.reasonForArt,other:{type:"title-section"}}].concat(Object(r["a"])(t.stagingFacts.selectedConditions.map((function(t){return{label:t,value:t}}))))},config:{title:"Selected stage defining conditions",hiddenFooterBtns:["Clear"]}}},isANCclient:function(){return"ANC"===A.getSuspendedProgram()},getStagingFields:function(){var t=this;return[{id:"pregnancy_status",helpText:"Pregnant / Breastfeeding",type:u["b"].TT_MULTIPLE_YES_NO,validation:function(t){return C["a"].anyEmpty(t)},summaryMapValue:function(t){return{label:t.label,value:t.value}},computedValue:function(e,n){var i=[];return t.isANCclient()&&!t.hasTransferLater(n)&&(t.stagingFacts["pregnant"]="Yes",i.push(t.staging.buildValueCoded("Is patient pregnant","Yes"))),i=i.concat(e.map((function(e){var n=e.value,i=e.other,r=i.factID;return t.stagingFacts[r]="".concat(n).match(/Yes/i)?"Yes":"No",t.staging.buildValueCoded(i.concept,n)}))),{obs:i,tag:"staging"}},options:function(e){if(Object(_["isEmpty"])(e.pregnancy_status)){var n=[];return t.isANCclient()&&!t.hasTransferLater(e)||n.push({label:"Pregnant?",value:"",other:{values:t.yesNoOptions(),concept:"Is patient pregnant",factID:"pregnant"}}),n.push({label:"Breastfeeding?",value:"",other:{values:t.yesNoOptions(),concept:"Is patient breast feeding",factID:"breastFeeding"}}),n}return e.pregnancy_status},condition:function(e){return t.hasStaging(e)&&t.stagingFacts.isChildBearing}},{id:"patient_weight_chart",helpText:"Weight history",type:u["b"].TT_WEIGHT_CHART,options:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.patient.getWeightHistory();case 2:return n=e.sent,n=n.map((function(t){return{x:E["b"].toStandardHisDisplayFormat(t.date),y:t.weight}})),e.abrupt("return",[{label:"Weight for patient",value:"Weight trail",other:{values:n,age:t.patient.getAge(),bmi:t.bmiObj}}]);case 5:case"end":return e.stop()}}),e)})));function n(){return e.apply(this,arguments)}return n}(),config:{hiddenFooterBtns:["Clear"]},condition:function(e){return t.hasStaging(e)&&t.showStagingWeightChart}},{id:"stage_4_conditions",helpText:"Stage 4 conditions",type:u["b"].TT_MULTIPLE_SELECT,options:function(){return t.buildStagingOptions(4,t.stagingFacts.stageFourConditions)},onValue:function(e){return t.onStagingCondition(e)},computedValue:function(e){return{tag:"staging",obs:e.map((function(e){return t.staging.buildWhoCriteriaObs(e.label)}))}},unload:function(e){t.stagingFacts.stageFourConditions=e.map((function(t){return t.label})),t.updateStagingFacts()},onConditionFalse:function(){t.stagingFacts.stageFourConditions=[],t.updateStagingFacts()},condition:function(e){return t.hasStaging(e)&&t.notAsymptomatic(e)}},{id:"stage_3_conditions",helpText:"Stage 3 conditions",type:u["b"].TT_MULTIPLE_SELECT,options:function(){return t.buildStagingOptions(3,t.stagingFacts.stageThreeConditions)},onValue:function(e){return t.onStagingCondition(e)},computedValue:function(e){return{tag:"staging",obs:e.map((function(e){return t.staging.buildWhoCriteriaObs(e.label)}))}},unload:function(e){t.stagingFacts.stageThreeConditions=e.map((function(t){return t.label})),t.updateStagingFacts()},onConditionFalse:function(){t.stagingFacts.stageThreeConditions=[],t.updateStagingFacts()},condition:function(e){return t.hasStaging(e)&&t.notAsymptomatic(e)}},{id:"stage_2_conditions",helpText:"Stage 2 conditions",type:u["b"].TT_MULTIPLE_SELECT,options:function(){return t.buildStagingOptions(2,t.stagingFacts.stageTwoConditions)},onValue:function(e){return t.onStagingCondition(e)},computedValue:function(e){return{tag:"staging",obs:e.map((function(e){return t.staging.buildWhoCriteriaObs(e.label)}))}},unload:function(e){t.stagingFacts.stageTwoConditions=e.map((function(t){return t.label})),t.updateStagingFacts()},onConditionFalse:function(){t.stagingFacts.stageTwoConditions=[],t.updateStagingFacts()},condition:function(e){return t.hasStaging(e)&&t.notAsymptomatic(e)}},{id:"stage_1_conditions",helpText:"Stage 1 conditions",type:u["b"].TT_MULTIPLE_SELECT,validation:function(e){if(Object(_["isEmpty"])(e)&&Object(_["isEmpty"])(t.stagingFacts.selectedConditions))return["Please provide atleast one staging condition"]},options:function(){return t.buildStagingOptions(1,t.stagingFacts.stageOneConditions)},onValue:function(e){return t.onStagingCondition(e)},computedValue:function(e){var n=e.map((function(t){return t.label}));return t.stagingFacts.stageOneConditions=n,t.updateStagingFacts(),{tag:"staging",obs:n.map((function(e){return t.staging.buildWhoCriteriaObs(e)}))}},condition:function(e){return t.hasStaging(e)}},{id:"cd4_available",helpText:"Recent CD4 count results available?",type:u["b"].TT_SELECT,condition:function(e){return t.hasStaging(e)},validation:function(t){return C["a"].required(t)},options:function(){return t.yesNoOptions()}},{id:"cd4_count",helpText:"CD4 Count",type:u["b"].TT_TEXT,computedValue:function(e){var n=e.value.toString(),i=n.charAt(0),r=parseInt(n.substring(1));return{tag:"staging",modifier:i,count:r,obs:t.staging.buildValueNumber("CD4 count",r,i)}},unload:function(e,n,i,r){var a=r["cd4_count"],o=a.count,u=a.modifier;t.stagingFacts.cd4=o,t.stagingFacts.cd4Modifier=u},onConditionFalse:function(){t.stagingFacts.cd4=-1,t.stagingFacts.cd4Modifier=""},validation:function(e){var n=function(){return t.staging.cd4CountIsValid(e.value)};return t.validateSeries([function(){return C["a"].required(e)},function(){return n()?null:["Please start with either modifier first: >, <, or ="]}])},config:{customKeyboard:[I["b"],[["Unknown","Delete"]]]},condition:function(e){return t.hasStaging(e)&&"Yes"===e.cd4_available.value}}].concat(Object(r["a"])(Object(O["b"])({id:"cd4_result_date",helpText:"Cd4 Results",required:!0,minDate:function(){return t.patient.getBirthdate()},maxDate:function(){return t.staging.getDate()},condition:function(e){return t.hasStaging(e)&&"Yes"===e.cd4_available.value},estimation:{allowUnknown:!1},computeValue:function(e,n){return{date:e,tag:"staging",isEstimate:n,obs:t.staging.buildValueDate("Cd4 count datetime",e)}}},this.staging.getDate())),[{id:"location",helpText:"CD4 Location",type:u["b"].TT_SELECT,defaultValue:function(){return A.getLocationName()},computedValue:function(e){var n=e.label;return{tag:"staging",obs:t.staging.buildValueText("Cd4 count location",n)}},validation:function(t){return C["a"].required(t)},options:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.getFacilities(n)},config:{showKeyboard:!0,isFilterDataViaApi:!0},condition:function(e){return t.hasStaging(e)&&"Yes"===e.cd4_available.value}}])}}});const N=k;e["a"]=N},e86e:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"f",(function(){return g})),n.d(e,"e",(function(){return p})),n.d(e,"a",(function(){return m})),n.d(e,"g",(function(){return v})),n.d(e,"h",(function(){return T}));var i=n("1da1"),r=(n("96cf"),n("d81d"),n("4de4"),n("d3b7"),n("b0c0"),n("5713")),a=n("2ef0");function o(){return u.apply(this,arguments)}function u(){return u=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,n,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,r["a"].getFacilities({name:e});case 3:return n=t.sent,t.abrupt("return",n.filter((function(t){return!Object(a["isEmpty"])(t)})).map((function(t){return{label:t.name,value:t.location_id,other:t}})));case 5:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function c(){return s.apply(this,arguments)}function s(){return s=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,n,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,r["a"].getLabs({search_name:e});case 3:return n=t.sent,t.abrupt("return",n.map((function(t){return{label:t,value:t}})));case 5:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}function d(){return l.apply(this,arguments)}function l(){return l=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,n,i=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"",t.next=3,r["a"].getFacilities({name:e,tag:"Facility adult sections"});case 3:return n=t.sent,t.abrupt("return",n.map((function(t){return{label:t.name,value:t.name,other:t}})));case 5:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function g(){return f.apply(this,arguments)}function f(){return f=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].getSpecialistClinics();case 2:return e=t.sent,t.abrupt("return",e.map((function(t){return{label:t.name,value:t.name,other:t}})));case 4:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return h=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].getRegions();case 2:return e=t.sent,t.abrupt("return",e.map((function(t){return{label:t.name,value:t.region_id,other:t}})));case 4:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}function m(t){return b.apply(this,arguments)}function b(){return b=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r["a"].getDistricts(e);case 2:return n=t.sent,t.abrupt("return",n.map((function(t){return{label:t.name,value:t.district_id,other:t}})));case 4:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function v(t){return y.apply(this,arguments)}function y(){return y=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,i,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",t.next=3,r["a"].getTraditionalAuthorities(e,n);case 3:return i=t.sent,t.abrupt("return",i.map((function(t){return{label:t.name,value:t.traditional_authority_id,other:t}})));case 5:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function T(t){return w.apply(this,arguments)}function w(){return w=Object(i["a"])(regeneratorRuntime.mark((function t(e){var n,i,a=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"",t.next=3,r["a"].getVillages(e,n);case 3:return i=t.sent,t.abrupt("return",i.map((function(t){return{label:t.name,value:t.village_id,other:t}})));case 5:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}}}]);
//# sourceMappingURL=chunk-89cb263e.1b8a72aa.js.map