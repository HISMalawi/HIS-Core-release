(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d2a20e8a"],{"6f07":function(e,t,a){"use strict";a.r(t);var n=a("7a23");function o(e,t,a,o,r,i){const s=Object(n["resolveComponent"])("report-template"),l=Object(n["resolveComponent"])("ion-page");return Object(n["openBlock"])(),Object(n["createBlock"])(l,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(s,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,config:{showIndex:!0},onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])]),_:1})}var r=a("fa94");class i extends r["a"]{generateDisaggregated(e){return r["a"].getJson("anc_cohort_disaggregated",{date:this.date,start_date:e,rebuild_outcome:!1,program_id:r["a"].getProgramID()})}}var s=a("44e3"),l=a("4ba2"),d=a("9ceb"),c=a("8a30"),u=a("5a0c"),h=a.n(u),p=a("e90e"),m=Object(n["defineComponent"])({mixins:[s["a"]],components:{ReportTemplate:l["a"],IonPage:c["D"]},data:()=>({title:"Facility Pepfar Report",rows:[],fields:[],columns:[[d["a"].thTxt("District"),d["a"].thTxt("Site"),d["a"].thTxt("Month"),d["a"].thTxt("Year"),d["a"].thTxt("ANC Indicator"),d["a"].thTxt("Age Category"),d["a"].thTxt("Value")]],months:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"},ageGroups:["<10","10-14","15-19","20-24","25-29","30-34","35-39","40-49","50+","Unknown","All"],indicators:["Already on ART","Known at entry positive","Known status","New ANC client","Newly identified negative","Newly identified positive","Newly on ART"],drillPatients:null}),created(){this.report=new i,this.fields=this.getDateDurationFields(),this.drillPatients=Object(p["a"])()["drillPatientByIDs"]},methods:{f(e){return h()(e).format("MMM YYYY")},async onPeriod(e,t){this.rows=[],this.period=`${this.f(t.start_date)} - ${this.f(t.end_date)}`;const a=this.generateIndicatorDates(t.start_date,t.end_date);await this.generateRows(a)},generateIndicatorDates(e,t){const a=[e];let n=e;while(n<h()(t).add(-1,"months").format("YYYY-MM-DD"))a.push(n=h()(n).add(1,"months").format("YYYY-MM-DD"));return a},async generateRows(e){for(const a of e)try{const e=await this.report.generateDisaggregated(a);this.indicators.forEach(t=>{this.ageGroups.forEach(n=>{const o=e[this.f(a)][t][n];this.rows.push([d["a"].td(""),d["a"].td(i.getLocationName()||"N/A"),d["a"].td(this.months[h()(a).month()]),d["a"].td(h()(a).year()),d["a"].td(t),d["a"].td(n),d["a"].tdLink(o.length,()=>this.drillPatients(`${a}-${t}-${n}`,o))])})})}catch(t){console.warn(""+t)}}}}),b=a("6b0d"),g=a.n(b);const f=g()(m,[["render",o]]);t["default"]=f},e90e:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a("2706"),o=a("d95e"),r=a("2ef0"),i=a("9283"),s=a("1c74"),l=a("8a30"),d=a("d6aa"),c=a("9ceb"),u=a("23e6"),h=a("6c02");function p(){const e=Object(h["f"])();function t(e){return i["b"].toStandardHisDisplayFormat(e)}function a(e){const t=open("","","width:1024px, height:768px"),a=document.getElementById(e.containerID);a&&t&&(t.document.write(`\n                <html>\n                <head>\n                    <title>Print Cohort</title>\n                    <link rel="stylesheet" media="print"  href="${e.cssFile}"/>\n                </head>\n                <body>\n                    ${a.innerHTML}\n                </body>\n                </html>\n            `),setTimeout(()=>{t.print(),t.close()},3500))}async function p(t,a){(await l["X"].create({component:d["a"],cssClass:"large-modal",componentProps:{title:t,rows:a,columns:[[c["a"].thTxt("National ID"),c["a"].thTxt("First name",{exportable:!1}),c["a"].thTxt("Last name",{exportable:!1}),c["a"].thTxt("Birth date"),c["a"].thTxt("Action")]],rowParser:async t=>{const a=t.map(async t=>{const a=new u["a"](await u["a"].findByID(t));return[c["a"].td(a.getNationalID()),c["a"].td(a.getGivenName()),c["a"].td(a.getFamilyName()),c["a"].tdDate(a.getBirthdate().toString()),c["a"].tdBtn("Show",async()=>{await l["X"].dismiss({}),e.push({path:"/patient/dashboard/"+t})})]});return await Promise.all(a)},showFilters:!0,rowsPerPage:50,paginated:!0,showReportStamp:!1,footerColor:"light",onFinish:()=>l["X"].dismiss()}})).present()}function m(){return[{id:"year",helpText:"Select Year",type:o["b"].TT_NUMBER,computedValue:e=>e.value,validation:e=>{const t=Object(r["isPlainObject"])(e)?e.value:-1;return n["a"].validateSeries([()=>n["a"].required(e),()=>isNaN(parseInt(""+t))?["Invalid year"]:null,()=>n["a"].rangeOf(e,2e3,i["b"].getYear(s["e"].getSessionDate()))])}},{id:"month",helpText:"Select Month",type:o["b"].TT_SELECT,validation:e=>n["a"].required(e),computedValue:e=>e.value,options:()=>[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}]}]}return{fd:t,drillPatientByIDs:p,getMonthlyReportFields:m,showPrintWindow:a}}}}]);
//# sourceMappingURL=chunk-d2a20e8a.89a456db.js.map