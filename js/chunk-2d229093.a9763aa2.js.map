{"version":3,"sources":["webpack:///./src/apps/ANC/Views/Encounters/VisitType.vue?c064","webpack:///./src/apps/ANC/Services/anc_visit_type_service.ts","webpack:///./src/apps/ANC/Views/Encounters/VisitType.vue","webpack:///./src/apps/ANC/Views/Encounters/VisitType.vue?adb1"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","fields","skipSummary","onFinishAction","onFinish","cancelDestinationPath","cancelDestination","_","AncVisitTypeService","patientID","providerID","lastVisitNumber","AppEncounterService","getJson","this","programID","visitNumbers","isEmpty","visit_number","length","visitNumber","saveValueNumericObs","defineComponent","components","IonPage","mixins","EncounterMixinVue","data","service","helpText","watch","ready","handler","loadLastVisitNumber","getFields","immediate","methods","c","visit","createEncounter","saveVisitNumber","nextTask","id","dynamicHelpText","type","FieldType","TT_NUMBER","computedValue","v","value","validation","validateSeries","Validation","required","rangeOf","__exports__"],"mappings":"uIAEM,SAAUA,EAAOC,EAAMC,EAAQC,EAAQC,EAAQC,EAAOC,GAC1D,IAAMC,EAA+BC,8BAAkB,qBACjDC,EAAsBD,8BAAkB,YAE9C,OAAQE,yBAAcC,yBAAaF,EAAqB,KAAM,CAC5DG,QAASC,sBAAS,iBAAM,CACtBC,yBAAaP,EAA8B,CACzCQ,OAAQd,EAAKc,OACbC,aAAa,EACbC,eAAgBhB,EAAKiB,SACrBC,sBAAuBlB,EAAKmB,mBAC3B,KAAM,EAAG,CAAC,SAAU,iBAAkB,8BAE3CC,EAAG,I,8JCZMC,EAAb,wDAEI,WAAYC,EAAmBC,GAAkB,oCAC7C,cAAMD,EAAW,IAAKC,GACtB,EAAKC,gBAAgB,EAFwB,EAFrD,mHAOI,oHAC+BC,OAAoBC,QAApB,mBACXC,KAAKC,UADM,qBACgBD,KAAKL,UADrB,eAD/B,OACUO,EADV,QAISC,qBAAQD,IAAiBA,EAAaE,aAAaC,SACpDL,KAAKH,gBAAkBK,EAAaE,aAChCF,EAAaE,aAAaC,OAAU,IANhD,gDAPJ,sFAkBI,SAAgBC,GACZ,OAAON,KAAKO,oBAAoB,gBAAiBD,OAnBzD,GAAyCR,QCM1BU,+BAAgB,CAC7BC,WAAY,CAAEC,gBACdC,OAAQ,CAACC,QACTC,KAAM,iBAAO,CACXC,QAAS,GACTC,SAAU,qBAEZC,MAAO,CACLC,MAAO,CACCC,QADD,SACSD,GAAc,4JACtBA,EADwB,CAAF,sBAExB,EAAKH,QAAU,IAAIpB,EAAoB,EAAKC,UAAW,EAAKC,YAFpC,SAGlB,EAAKkB,QAAQK,sBAHK,OAIxB,EAAKhC,OAAS,EAAKiC,YAJK,8CAO5BC,WAAW,IAGfC,QAAS,CACDhC,SADC,SACQG,EAAQ8B,GAAM,qKACrBC,EAAQ,IAAI9B,EAAoB,EAAKC,UAAW,EAAKC,YADhC,SAErB4B,EAAMC,kBAFe,uBAGrBD,EAAME,gBAAgBH,EAAE,iBAHH,OAI3B,EAAKI,WAJsB,8CAM7BP,UAPO,WAOE,WACP,MAAO,CACL,CACEQ,GAAI,eACJb,SAAUf,KAAKe,SACfc,gBAAiB,WACf,OAAI,EAAKf,QAAQjB,gBACf,UAAU,EAAKkB,SAAf,gCAA+C,EAAKD,QAAQjB,gBAA5D,KAEK,EAAKkB,UAEde,KAAMC,OAAUC,UAChBC,cAAe,SAACC,GAAD,OAAeA,EAAEC,OAChCC,WAAY,SAACF,GAAD,OAAe,EAAKG,eAAe,CAC7C,kBAAMC,OAAWC,SAASL,IAC1B,kBAAMI,OAAWE,QAAQN,EAAG,EAAKpB,QAAQjB,gBAAgB,EAAG,c,qBC7CxE,MAAM4C,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASrE,KAErD","file":"js/chunk-2d229093.a9763aa2.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_his_standard_form, {\n        fields: _ctx.fields,\n        skipSummary: true,\n        onFinishAction: _ctx.onFinish,\n        cancelDestinationPath: _ctx.cancelDestination\n      }, null, 8, [\"fields\", \"onFinishAction\", \"cancelDestinationPath\"])\n    ]),\n    _: 1\n  }))\n}","import { AppEncounterService } from \"@/services/app_encounter_service\";\nimport { isEmpty } from \"lodash\";\n\nexport class AncVisitTypeService extends AppEncounterService {\n    lastVisitNumber: number ;\n    constructor(patientID: number, providerID: number) {\n        super(patientID, 107, providerID)\n        this.lastVisitNumber=0\n    }\n\n    async loadLastVisitNumber() {\n        const visitNumbers = await AppEncounterService.getJson(\n            `programs/${this.programID}/patients/${this.patientID}/anc_visit`\n        )\n        if (!isEmpty(visitNumbers) && visitNumbers.visit_number.length) {\n            this.lastVisitNumber = visitNumbers.visit_number[\n                visitNumbers.visit_number.length  - 1\n            ]\n        }\n    }\n\n    saveVisitNumber(visitNumber: number) {\n        return this.saveValueNumericObs('Type of visit', visitNumber)\n    }\n}\n","\nimport EncounterMixinVue from '@/views/EncounterMixin.vue'\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { defineComponent } from 'vue'\nimport { Option } from '@/components/Forms/FieldInterface'\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { IonPage } from \"@ionic/vue\"\nimport { AncVisitTypeService } from \"@/apps/ANC/Services/anc_visit_type_service\"\n\nexport default defineComponent({\n  components: { IonPage },\n  mixins: [EncounterMixinVue],\n  data: () => ({\n    service: {} as any,\n    helpText: 'ANC Visit Number' as string\n  }),\n  watch: {\n    ready: {\n      async handler(ready: boolean) {\n        if (ready) {\n          this.service = new AncVisitTypeService(this.patientID, this.providerID)\n          await this.service.loadLastVisitNumber()\n          this.fields = this.getFields()\n        }\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    async onFinish(_: any, c: any) {\n      const visit = new AncVisitTypeService(this.patientID, this.providerID)\n      await visit.createEncounter()\n      await visit.saveVisitNumber(c['visit_number'])\n      this.nextTask()\n    },\n    getFields() {\n      return [\n        {\n          id: 'visit_number',\n          helpText: this.helpText,\n          dynamicHelpText: () => {\n            if (this.service.lastVisitNumber) {\n              return `${this.helpText} (Last visit number: ${this.service.lastVisitNumber})`\n            }\n            return this.helpText\n          },\n          type: FieldType.TT_NUMBER,\n          computedValue: (v: Option) => v.value,\n          validation: (v: Option) => this.validateSeries([\n            () => Validation.required(v),\n            () => Validation.rangeOf(v, this.service.lastVisitNumber+1, 40)\n          ])\n        }\n      ]\n    }\n  }\n})\n","import { render } from \"./VisitType.vue?vue&type=template&id=4db970bb&ts=true\"\nimport script from \"./VisitType.vue?vue&type=script&lang=ts\"\nexport * from \"./VisitType.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}