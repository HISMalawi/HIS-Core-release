(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab2c7"],{"13c2":function(e,t,r){"use strict";r.r(t);var n=r("7a23");function a(e,t,r,a,i,o){var c=Object(n["resolveComponent"])("his-standard-form");return Object(n["openBlock"])(),Object(n["createBlock"])(c,{cancelDestinationPath:e.cancelDestination,fields:e.fields,activeField:e.activeField,onFinishAction:e.onSubmit,skipSummary:!0},null,8,["cancelDestinationPath","fields","activeField","onFinishAction"])}var i=r("2909"),o=r("1da1"),c=(r("d81d"),r("7db0"),r("d3b7"),r("99af"),r("b0c0"),r("96cf"),r("9441")),u=r("7365"),s=r("2706"),d=r("d95e"),l=r("2ef0"),p=r("996c"),f=r("9283"),h=r("b5e4"),m=r("fe70"),b=Object(n["defineComponent"])({components:{HisStandardForm:c["a"]},mixins:[u["a"]],data:function(){return{activeField:"",prescriptionService:{},showMalariaDrugs:!1,hasMalaria:!1}},watch:{ready:{handler:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e){r.next=6;break}return t.prescriptionService=new p["c"](t.patientID,t.providerID),r.next=4,t.prescriptionService.hasMalaria();case 4:t.hasMalaria=r.sent,t.fields=t.getFields();case 6:case"end":return r.stop()}}),r)})))()},immediate:!0,deep:!0}},methods:{onSubmit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t.mapToOrders(e["drugs_details"]),r.next=3,t.prescriptionService.createEncounter();case 3:if(a=r.sent,a){r.next=6;break}return r.abrupt("return",Object(h["e"])("Unable to create treatment encounter"));case 6:return r.next=8,t.prescriptionService.createDrugOrder(n);case 8:if(i=r.sent,i){r.next=11;break}return r.abrupt("return",Object(h["e"])("Unable to create drug orders!"));case 11:Object(h["d"])("Drug order has been created"),t.nextTask();case 13:case"end":return r.stop()}}),r)})))()},calculateExpireDate:function(e,t){var r=new Date(e);return r.setDate(r.getDate()+t),f["b"].toStandardHisFormat(r)},mapToOrders:function(e){var t=this;return e.map((function(e){var r=p["c"].getSessionDate(),n=p["b"].find((function(t){return t.label===e.other.frequency}));return{drug_inventory_id:e.other.drug_id,equivalent_daily_dose:e.other.dosage*n.value,start_date:r,auto_expire_date:t.calculateExpireDate(r,e.other.duration),units:e.other.units,instructions:"".concat(e.label,": ").concat(n.value," ").concat(n.code," for ").concat(e.other.duration),dose:e.other.dosage,frequency:n.code}}))},isOrderComplete:function(e){return e.every((function(e){return e.other.frequency&&e.other.duration&&e.other.dosage}))},getFields:function(){var e=this;return[{id:"malaria_drugs",helpText:"select Malaria Drugs",validation:function(e){return s["a"].required(e)},type:d["b"].TT_SELECT,condition:function(){return"malaria_drugs"===e.activeField&&e.showMalariaDrugs},unload:function(){e.showMalariaDrugs=!1,e.activeField="drugs_details"},options:function(){return p["a"].map((function(e){return{label:"".concat(e.name,", ").concat(e.frequency," time(s) a day, for ").concat(e.duration," days"),value:e.name,other:e}}))}},{id:"drugs",helpText:"Select drugs",type:d["b"].TT_MULTIPLE_SELECT,validation:function(e){return s["a"].required(e)},options:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(r){var n,a,i,o=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",t.next=3,m["e"].create({message:"Loading drugs...",translucent:!0});case 3:return a=t.sent,t.next=6,a.present();case 6:return t.next=8,e.prescriptionService.loadDrugs(n);case 8:return i=t.sent,t.next=11,a.dismiss();case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));function r(e){return t.apply(this,arguments)}return r}(),onload:function(){return e.activeField=""},config:{showKeyboard:!0,hiddenFooterBtns:["Back"],footerBtns:[{name:"Predefined Malaria Drugs",color:"primary",size:"large",visible:!1,slot:"end",onClick:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=!e.hasMalaria,!t.t0){t.next=5;break}return t.next=4,Object(h["a"])("Patient has no malaria. Do you still want to prescribe anti malaria drugs?");case 4:t.t0=!t.sent;case 5:if(!t.t0){t.next=7;break}return t.abrupt("return");case 7:e.activeField="malaria_drugs",e.showMalariaDrugs=!0;case 9:case"end":return t.stop()}}),t)})));function r(){return t.apply(this,arguments)}return r}()}]}},{id:"drugs_details",helpText:"Complete prescribed drug details",type:d["b"].TT_PRESCRIPTION_INPUT,validation:function(e){return s["a"].required(e)},options:function(e){return[].concat(Object(i["a"])(e.drugs),Object(i["a"])(e.malaria_drugs?[e.malaria_drugs]:[]))},beforeNext:function(t){return!Object(l["isEmpty"])(t)&&(!!e.isOrderComplete(t)||(Object(h["e"])("Please complete all fields"),!1))}},{id:"summary",helpText:"Summary",type:d["b"].TT_TABLE_VIEWER,options:function(e){var t=e["drugs_details"],r=["Drug Name","Frequency","Dosage","Duration"],n=t.map((function(e){return[e.other.name,e.other.frequency,"".concat(e.other.dosage," ").concat(e.other.units),"".concat(e.other.duration," days")]}));return[{label:"",value:"",other:{columns:r,rows:n}}]}}]}}}),g=r("d959"),v=r.n(g);const w=v()(b,[["render",a]]);t["default"]=w}}]);
//# sourceMappingURL=chunk-2d0ab2c7.d31fa6a2.js.map