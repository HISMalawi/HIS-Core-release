(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56873b06"],{"668a":function(e,t,n){"use strict";n.r(t);var r=n("7a23");function a(e,t,n,a,i,u){var s=Object(r["resolveComponent"])("his-standard-form"),o=Object(r["resolveComponent"])("ion-page");return Object(r["openBlock"])(),Object(r["createBlock"])(o,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{key:e.hisFormKey,activeField:e.fieldComponent,skipSummary:!0,fields:e.fields,onOnIndex:t[1]||(t[1]=function(t){return e.fieldComponent=""}),onOnFinish:e.onFinish},null,8,["activeField","fields","onOnFinish"])]})),_:1})}var i=n("1da1"),u=(n("ac1f"),n("466d"),n("d81d"),n("b0c0"),n("d3b7"),n("b64b"),n("96cf"),n("d95e")),s=n("7920"),o=n("2706"),c=n("8a30"),d=n("2ef0"),l=n("76f1"),f=n("8ee8"),p=n("c84b"),g=n("b5e4"),h=Object(r["defineComponent"])({components:{HisStandardForm:s["a"],IonPage:c["IonPage"]},data:function(){return{hisFormKey:0,fields:[],allDrugs:[],fieldComponent:"",service:{}}},created:function(){this.fields=this.getFields()},methods:{onFinish:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p["a"].saveDrugSet(t);case 3:if(!e.sent){e.next=6;break}return Object(g["d"])("Drugset saved successfully"),e.abrupt("return",n.$router.back());case 6:Object(g["e"])("Unable to save drugset"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),Object(g["e"])("".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},getFields:function(){var e=this;return[{id:"name",helpText:"Enter drug set name",type:u["b"].TT_TEXT,computedValue:function(e){return e.value},validation:function(e){return o["a"].validateSeries([function(){return o["a"].required(e)},function(){return"".concat(e.value).match(/^([a-zA-Z_ ]{2,17})'?-?([a-zA-Z_ ]{1,17})$/)?null:["Enter a valid drug set name."]}])}},{id:"description",helpText:"Drug set description",type:u["b"].TT_TEXT,computedValue:function(e){return e.value},validation:function(e){return o["a"].validateSeries([function(){return o["a"].required(e)},function(){return"".concat(e.value).match(/^([a-zA-Z_ ]{2,100})'?-?([a-zA-Z_ ]{1,100})$/)?null:["Enter a valid drug set description"]}])}},{id:"drug_selection",helpText:"Select drugs to add",type:u["b"].TT_MULTIPLE_SELECT,validation:function(e){return o["a"].required(e)},config:{showKeyboard:!0},options:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!Object(d["isEmpty"])(e.allDrugs)){t.next=4;break}return t.next=3,l["a"].getDrugs({page_size:1e3});case 3:e.allDrugs=t.sent.map((function(e){return{label:e.name,value:e.id,other:{drug:e.name,quantity:0,frequency:""}}}));case 4:return t.abrupt("return",e.allDrugs);case 5:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{id:"drugs",helpText:"Set drugs",type:u["b"].TT_ANC_DRUGSET_INPUT,computedValue:function(e){return e.map((function(e){return e.other}))},validation:function(e){return o["a"].validateSeries([function(){return o["a"].required(e)},function(){return e.map((function(e){return e.other.quantity&&e.other.frequency})).every(Boolean)?null:["Data is not complete"]}])},options:function(e){return e.drug_selection},config:{drugFrequencies:Object.keys(f["b"]).map((function(e){return{label:e,value:e}}))}}]}}}),v=n("d959"),m=n.n(v);const b=m()(h,[["render",a]]);t["default"]=b},"71c3":function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("5530"),a=n("d4ec"),i=n("bee2"),u=n("262e"),s=n("2caf"),o=(n("d81d"),n("99af"),n("1c74")),c=function(e){Object(u["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(a["a"])(this,n),t.call(this)}return Object(i["a"])(n,null,[{key:"create",value:function(e){return this.postJson("drug_orders",e)}},{key:"updateDispensationOrders",value:function(e){var t=this;return this.postJson("dispensations",{program_id:this.getProgramID(),dispensations:e.map((function(e){return{date:t.getSessionDate(),drug_order_id:e["order_id"],quantity:e["quantity"]}}))})}},{key:"getDrugOrderHistory",value:function(e){return this.getJson("drug_orders",{patient_id:e})}},{key:"getDrugOrders",value:function(e){return this.getJson("drug_orders",{patient_id:e,date:this.getSessionDate(),program_id:this.getProgramID()})}},{key:"getAllDrugOrders",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return this.getJson("drug_orders",{patient_id:e,program_id:o["e"].getProgramID(),page_size:t})}},{key:"getLastDrugsReceived",value:function(e){return this.getJson("patients/".concat(e,"/last_drugs_received"),{date:this.getSessionDate(),program_id:this.getProgramID()})}},{key:"getDrugDosages",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getSessionDate(),r={drug_id:t,date:n};return this.getJson("programs/".concat(this.getProgramID(),"/patients/").concat(e,"/drug_doses"),r)}},{key:"getOrderByPatient",value:function(e,t){return this.getJson("/drug_orders",Object(r["a"])({patient_id:e,program_id:this.getProgramID()},t))}}]),n}(o["e"])},"76f1":function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("d4ec"),a=n("bee2"),i=n("45eb"),u=n("7e84"),s=n("262e"),o=n("2caf"),c=n("1c74"),d=function(e){Object(s["a"])(n,e);var t=Object(o["a"])(n);function n(){return Object(r["a"])(this,n),t.call(this)}return Object(a["a"])(n,null,[{key:"getDrugs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])(Object(u["a"])(n),"getJson",this).call(this,"/drugs",e)}}]),n}(c["e"])},7920:function(e,t,n){"use strict";var r=n("7a23");function a(e,t,n,a,i,u){return Object(r["openBlock"])(),Object(r["createBlock"])(Object(r["resolveDynamicComponent"])(e.formType),{fields:e.fields,skipSummary:e.skipSummary,activeField:e.activeField,cancelDestinationPath:e.cancelDestinationPath,onOnFinish:e.onFinish,onFinish:e.onFinishAction,onOnIndex:e.onIndex},null,8,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var i=n("9441"),u=Object(r["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:i["a"]},emits:["onFinish","onIndex"],data:function(){return{formType:"touch-screen-form"}},props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish:function(e,t){this.$emit("onFinish",e,t)},onIndex:function(e){this.$emit("onIndex",e)}}}),s=n("d959"),o=n.n(s);const c=o()(u,[["render",a]]);t["a"]=c},"8ee8":function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n("1da1"),a=n("d4ec"),i=n("bee2"),u=n("262e"),s=n("2caf"),o=(n("d81d"),n("d3b7"),n("159b"),n("96cf"),n("cc6f")),c=n("71c3"),d=n("2ef0"),l=n("9283"),f={"Once a day (OD)":1,"Twice a day (BD)":2,"Three a day (TDS)":3,"Four times a day (QID)":4,"Five times a day (5X/D)":5,"Six times a day (Q4HRS)":6,"In the morning (QAM)":.5,"Once a week (QWK)":.14,"Once a month":.03,"Twice a month":.071},p=function(e){Object(u["a"])(n,e);var t=Object(s["a"])(n);function n(e,r){return Object(a["a"])(this,n),t.call(this,e,25,r)}return Object(i["a"])(n,[{key:"ttvDrugObj",value:function(){return{drug_inventory_id:609,dose:.5,equivalent_daily_dose:.5,frequency:"Once a day (od)",start_date:this.date,auto_expire_date:this.date,instructions:"Once a day",units:"ml"}}},{key:"updateTTvOrder",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.dispenseTTV();case 2:if(t=e.sent,Object(d["isEmpty"])(t)){e.next=6;break}return n=t[0].order_id,e.abrupt("return",c["a"].updateDispensationOrders([{order_id:n,quantity:1}]));case 6:throw"Unable to dispense";case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"dispenseTTV",value:function(){return this.createOrders([this.ttvDrugObj()])}},{key:"createOrders",value:function(e){return c["a"].create({drug_orders:e,encounter_id:this.getEncounterID()})}},{key:"submitTreatment",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.createEncounter();case 2:return e.next=4,this.createOrders(t.map((function(e){return a.buildDrugOrderObj(e)})));case 4:return n=e.sent,r=new o["a"](this.patientID,54,this.providerID),e.next=8,r.createEncounter();case 8:return t.forEach((function(e){var t=f[e.frequency]*e.duration;n.forEach((function(n){n.drug_inventory_id===e.id&&(n.quantity=t)}))})),e.next=11,c["a"].updateDispensationOrders(n);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"buildDrugOrderObj",value:function(e){var t=new Date(this.date),n=t.setDate(t.getDate()+parseInt("".concat(e.duration))),r=e.dose||f[e.frequency],a=parseFloat(r)*f[e.frequency];return{drug_inventory_id:e.id,dose:r,equivalent_daily_dose:a,frequency:e.frequency,start_date:this.date,auto_expire_date:l["c"].toStandardHisFormat(new Date(n)),instructions:e.drug_name+":"+e.dose+" "+e.units+" "+e.frequency+"days",units:e.units}}}]),n}(o["a"])},c84b:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("2909"),a=n("1da1"),i=n("5530"),u=n("d4ec"),s=n("bee2"),o=n("262e"),c=n("2caf"),d=(n("96cf"),n("d3b7"),n("b64b"),n("99af"),n("1c74")),l=function(e){Object(o["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(u["a"])(this,n),t.apply(this,arguments)}return Object(s["a"])(n,null,[{key:"saveDrugSet",value:function(e){var t=Object(i["a"])({},e);return t["datetime"]=d["e"].getSessionDate(),this.postJson("/drug_sets",e)}},{key:"voidDrugSet",value:function(e){return this.void("/drug_sets/".concat(e),{date:this.getSessionDate()})}},{key:"getDrugSets",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getJson("drug_sets");case 2:if(t=e.sent,!t){e.next=5;break}return e.abrupt("return",Object.keys(t["set_names"]).reduce((function(e,n){var a=t["set_names"][n],u=t["set_descriptions"][n],s=t["drug_sets"][n];return e.push({id:parseInt(n),name:a,description:u,drugs:Object.keys(s).reduce((function(e,t){return[].concat(Object(r["a"])(e),[Object(i["a"])(Object(i["a"])({id:parseInt(t)},s[t]),{},{drug_name:s[t].drug_name,duration:parseInt(s[t].duration),frequency:s[t].frequency,units:s[t].units})])}),[])}),e}),[]));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(d["e"])}}]);
//# sourceMappingURL=chunk-56873b06.5dbaefe6.js.map