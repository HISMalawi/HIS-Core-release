{"version":3,"sources":["webpack:///./src/components/Forms/HisStandardForm.vue?f008","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/components/Forms/HisStandardForm.vue?6820","webpack:///./src/utils/HisFormHelpers/PersonFieldHelper.ts","webpack:///./src/views/PatientRegistration.vue?7823","webpack:///./src/views/PatientRegistration.vue","webpack:///./src/views/PatientRegistration.vue?ad61","webpack:///./src/utils/HisFormHelpers/LocationFieldOptions.ts"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createBlock","_resolveDynamicComponent","formType","fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onFinishAction","onOnIndex","onIndex","defineComponent","name","components","TouchScreenForm","emits","data","props","type","Function","Boolean","default","String","Object","required","methods","formData","computedData","this","$emit","i","__exports__","mapToOption","listOptions","map","item","label","value","resolvePerson","computedForm","attr","values","isPlainObject","person","getGivenNameField","id","helpText","FieldType","TT_TEXT","computedValue","val","validation","Validation","isName","options","async","form","given_name","names","PersonService","searchGivenName","getFamilyNameField","family_name","searchFamilyName","getGenderField","customOptions","TT_SELECT","isEmpty","getDobConfig","includeHelpText","summaryLabel","minDate","HisDate","estimateDateFromAge","maxDate","getSessionDate","estimation","allowUnknown","allowUnknownMonthDay","estimationFieldType","EstimationFieldType","AGE_ESTIMATE_FIELD","computeValue","date","isEstimate","birthdate","getHomeRegionField","group","requireNext","getRegions","getHomeDistrictField","dynamicHelpText","f","home_region","match","getDistricts","addCustomLocationBtnForTAorVillage","BtnName","formParentAddressRef","slot","color","onClick","c","field","filter","length","toastWarning","filtered","ok","alertConfirmation","address","LocationService","createAddress","toUpperCase","getHomeTaField","config","showKeyboard","isFilterDataViaApi","footerBtns","defaultOutput","defaultComputedOutput","getTraditionalAuthorities","home_district","getHomeVillageField","getVillages","home_traditional_authority","getCurrentRegionField","test","home_village","onClickComponentEvents","setValue","getCurrentDistrictField","current_region","getCurrentTAfield","current_district","getCurrentVillageField","current_traditional_authority","getCellNumberField","number","split","isMWPhoneNumber","customKeyboard","getLandmarkFields","proxyID","appearInSummary","default_landmarks","TT_NOTE","condition","v","getFacilityLocationField","_","getFacilities","getPersonNameFromPersonObj","personObj","getAttrFromPersonObj","Array","isArray","person_attributes","reduce","getAddressFromPersonObj","addresses","addressMap","mapPersonData","givenName","familyName","homeDistrict","homeVillage","homeTA","person_id","gender","birthdate_estimated","getPersonAttributeOptions","patient","Patientservice","prop","getPatientInfoString","getID","getNationalID","other","npid","show","Service","getProgramName","_component_his_standard_form","_resolveComponent","formLabel","$event","fieldComponent","HisStandardForm","app","App","getActiveApp","ddeInstance","ddeDocID","ddeIsReassign","currentAddressAttributes","homeAddressAttributes","hasIncompleteData","editPersonData","editPerson","personAttribute","isMilitarySite","presets","registrationSummary","ddeEnabled","watch","query","PatientDemographicsExchangeService","edit_person","dde_reassign","doc_id","setPatientID","person_attribute","initEditMode","getFields","immediate","deep","push","personIndexField","hasScannedNationalID","concat","hiddenFieldsForScannedNationalID","givenNameField","familyNameField","genderField","searchResultField","hasNpidField","scanNpid","dobFields","homeRegionField","homeDistrictField","homeTAField","homeVillageField","currentRegionField","currentDistrictField","currentTAField","currentVillage","landmarkFields","cellPhoneField","patientTypeField","facilityLocationField","occupationField","regimentField","dateJoinedMilitaryFields","rankField","relationshipField","possibleDuplicatesField","isEditMode","nationalIDStatus","personId","Store","get","patientID","parseInt","ancestryDistrict","ancestryTA","ancestryVillage","currentDistrict","currentTA","getAddresses","getGivenName","getFamilyName","getGender","getBirthdate","getPhoneNumber","getClosestLandmark","isOnline","update","create","isOfflineMode","createOffline","savePersonOffline","Offline","PersonField","attributes","resolvePersonAttributes","offlineID","nextTask","$router","registration","PatientRegistrationService","registerPatient","getPersonID","set","updateMWNationalId","malawiNationalID","onRegisterPatient","exit","$route","relationship","setPersonID","updatePerson","invalidate","back","editConditionCheck","includes","getDocID","assignNpid","printNationalID","delayPromise","e","toastDanger","d","personAttributes","console","error","TT_HIDDEN","defaultValue","toLowerCase","findByID","IS_ANC_APP","applicationName","IS_CXCA","beforeNext","newGender","oldGender","action","infoActionSheet","dobConfig","sdate","childBearingAgeInYrs","dayjs","subtract","format","STANDARD_DATE_FORMAT","generateDateFields","TT_YES_NO","isRequired","TT_BARCODE","has_npid","hiddenFooterBtns","currentRegion","summaryMapValue","current_village","cellPhone","cell_phone_number","facility","patient_type","landmarks","PatientTypeService","getPatientTypes","init","GLOBAL_PROP","militarySiteEnabled","occupation","WorkflowService","IS_HTS","OPD","Registration","TT_PERSON_RESULT_VIEW","payload","patients","searchDemographics","itemData","search","state","disabled","onValue","results","createdPerson","duplicatePatients","TT_PERSON_MATCH_VIEW","checkPotentialDuplicates","toDate","toStandardHisDisplayFormat","score","patient_id","newPerson","foundPerson","comparisons","visible","possible_duplicates","TT_TABLE_VIEWER","editButton","attribute","columns","rows","landmark","emptySets","indexes","class","forEach","r","isValueEmpty","rowColors","onload","reassignNpid","printNpid","confirmPatient","facilities","trim","location_id","getLabFacilities","getLabs","getFacilityWards","wards","tag","ward","getSpecialistClinics","clinics","clinic","regions","region","region_id","regionID","districts","district","district_id","districtID","TAs","TA","traditional_authority_id","traditionalAuthorityID","villages","village","village_id"],"mappings":"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","file":"js/chunk-6349c9bc.2686a440.js","sourcesContent":["import { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.formType), {\n    fields: _ctx.fields,\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.activeField,\n    cancelDestinationPath: _ctx.cancelDestinationPath,\n    onOnFinish: _ctx.onFinish,\n    onFinish: _ctx.onFinishAction,\n    onOnIndex: _ctx.onIndex\n  }, null, 40, [\"fields\", \"skipSummary\", \"activeField\", \"cancelDestinationPath\", \"onOnFinish\", \"onFinish\", \"onOnIndex\"]))\n}","\nimport TouchScreenForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport { defineComponent, PropType } from \"vue\";\nimport { Field } from \"./FieldInterface\";\n\nexport default defineComponent({\n    name: \"HisStandardForm\",\n    components: { TouchScreenForm },\n    emits: [\n        'onFinish',\n        'onIndex'\n    ],\n    data: () => ({\n        formType: 'touch-screen-form' as string\n    }),\n    props: {\n        onFinishAction: {\n            type: Function\n        },\n        skipSummary: {\n            type: Boolean,\n            default: false\n        },\n        activeField: {\n            type: String\n        },\n        fields: {\n            type: Object as PropType<Field[]>,\n            required: true\n        },\n        cancelDestinationPath: {\n            type: String,\n            required: false,\n        }\n    },\n    methods: {\n        onFinish(formData: any, computedData: any) {\n            this.$emit('onFinish', formData, computedData)\n        },\n        onIndex(i: number) {\n            this.$emit('onIndex', i)\n        }\n    }\n})\n","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {\n    getFacilities,\n    getRegions,\n    getDistricts,\n    getTraditionalAuthorities,\n    getVillages\n} from '@/utils/HisFormHelpers/LocationFieldOptions'\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport {PersonService} from \"@/services/person_service\"\nimport { EstimationFieldType } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport HisDate from \"@/utils/Date\"\nimport { DateFieldInterface } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport { alertConfirmation, toastWarning } from '../Alerts'\nimport { LocationService } from '@/services/location_service'\nimport { Service } from '@/services/service'\n\nfunction mapToOption(listOptions: Array<string>): Array<Option> {\n    return listOptions.map((item: any) => ({ \n        label: item, value: item \n    })) \n}\nexport default {\n    resolvePerson(computedForm: any) {\n        let data: any = {}\n        for(const attr in computedForm) {\n            const values = computedForm[attr]\n            if (isPlainObject(values) && 'person' in values) {\n                if (isPlainObject(values.person)) {\n                    data = {...data, ...values.person}\n                } else {\n                    data[attr] = values['person']\n                }\n            }\n        }\n        return data   \n    },\n    getGivenNameField(): Field {\n        return {\n            id: 'given_name',\n            helpText: 'First name',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.given_name) {\n                    const names = await PersonService.searchGivenName(form.given_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getFamilyNameField(): Field {\n        return {\n            id: 'family_name',\n            helpText: \"Last name\",\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.isName(val),\n            options: async (form: any) => {\n                if (form.family_name) {\n                    const names = await PersonService.searchFamilyName(form.family_name.value)\n                    return mapToOption(names)\n                } \n                return []\n            }\n        }\n    },\n    getGenderField(customOptions?: Option[]): Field {\n        return  {\n            id: 'gender',\n            helpText: 'Sex',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            validation: (val: any) => Validation.required(val),\n            options: () => !isEmpty(customOptions)\n                ? customOptions as Option[]\n                : ([\n                    {\n                        label: 'Female',\n                        value: 'F'\n                    },\n                    { \n                        label: 'Male',\n                        value: 'M'\n                    }\n                ])\n        }\n    },\n    getDobConfig(includeHelpText = true): DateFieldInterface {\n        return  {\n            id: 'birth_date',\n            summaryLabel: 'Date of Birth',\n            helpText: includeHelpText ? 'Birth' : '',\n            required: true,\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => PersonService.getSessionDate(),\n            estimation: {\n                allowUnknown: true,\n                allowUnknownMonthDay: true,\n                estimationFieldType: EstimationFieldType.AGE_ESTIMATE_FIELD\n            },\n            computeValue: (date: string, isEstimate: boolean) => {\n                return {\n                    date,\n                    isEstimate,\n                    person: {\n                        birthdate: date,\n                        'birthdate_estimated': isEstimate\n                    }\n                }\n            }\n        }\n    },\n    getHomeRegionField(): Field {\n        return {\n            id: 'home_region',\n            helpText: 'Region of origin',\n            type: FieldType.TT_SELECT,\n            group: 'person',\n            requireNext: false,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions()\n        }\n    },\n    getHomeDistrictField() {\n        return  {\n            id: 'home_district',\n            helpText: 'District of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            dynamicHelpText: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return 'Home Country'\n                }\n                return 'District of origin'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            options: (form: any) => getDistricts(form.home_region.value)\n        }\n    },\n    addCustomLocationBtnForTAorVillage(BtnName: string, formParentAddressRef: string) {\n        return {\n            name: `Add ${BtnName}`,\n            slot: \"end\",\n            color: \"success\",\n            onClick: async (f: any, c: any, field: any) => {\n                 if (typeof field.filter != 'string' || field.filter.length < 3) {\n                    return toastWarning(`Please enter a valid ${BtnName}`)\n                 }\n                 if (!isEmpty(field.filtered)) {\n                    return toastWarning(`Can't add existing ${BtnName}`)\n                 } \n                 const ok = await alertConfirmation(`Do you want to add ${BtnName} ${field.filter}?`)\n\n                 if (!ok) return\n\n                 const address = await LocationService.createAddress(BtnName, field.filter, f[formParentAddressRef].value)\n                 if (address) {\n                    // Hack to force the list to reload the list with new data\n                    field.filter = field.filter.toUpperCase() \n                 } else {\n                    return toastWarning(`Unable to add ${BtnName}`)\n                 }\n            }\n         }\n    },\n    getHomeTaField() {\n        return  {\n            id: 'home_traditional_authority',\n            helpText: 'TA of origin',\n            type: FieldType.TT_SELECT,\n            requireNext: false,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'home_district')\n                ]\n            },\n            defaultOutput: () => ({label: 'N/A', value: 'N/A'}),\n            defaultComputedOutput: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.home_district.value, filter)\n        }\n    },\n    getHomeVillageField() {\n        return {\n            id: 'home_village',\n            helpText: 'Village of origin',\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'home_traditional_authority')\n                ]\n            },\n            requireNext: false,\n            defaultOutput: () => ({ label: 'N/A', value: 'N/A' }),\n            defaultComputedOutput: (f: any) => {\n                if (f.home_region && f.home_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.home_traditional_authority.value, filter)\n        }\n    },\n    getCurrentRegionField() {\n        return {\n            id: 'current_region',\n            helpText: 'Current Region of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option, f: any) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_region': f.home_region.label,\n                            'current_district': f.home_district.label,\n                            'current_traditional_authority': f.home_traditional_authority.label,\n                            'current_village': f.home_village.label \n                        }\n                    }\n                }\n                return { person: val.label }\n            },\n            validation: (val: any) => Validation.required(val),\n            options: () => getRegions(),\n            config: {\n                footerBtns: [\n                  {\n                    name: \"Same as origin\",\n                    slot: \"end\",\n                    onClickComponentEvents: {\n                      setValue: () => 'Use Home Address'\n                    },\n                    onClick: () => \"Use Home Address\"\n                  }\n                ]\n            }\n        }\n    },\n    getCurrentDistrictField() {\n        return {\n            id: 'current_district',\n            helpText: 'District',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            dynamicHelpText: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return 'Current Country'\n                }\n                return 'Current District of Residence'\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any) => getDistricts(form.current_region.value),\n        }\n    },\n    getCurrentTAfield() {\n        return    {\n            id: 'current_traditional_authority',\n            helpText: 'Current TA of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('TA', 'current_district')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            defaultComputedOutput: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getTraditionalAuthorities(form.current_district.value, filter)\n        }\n    },\n    getCurrentVillageField() {\n        return {\n            id: 'current_village',\n            helpText: 'Current Village of Residence',\n            requireNext: false,\n            type: FieldType.TT_SELECT,\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true,\n                footerBtns: [\n                    this.addCustomLocationBtnForTAorVillage('Village', 'current_traditional_authority')\n                ]\n            },\n            defaultOutput: (f: any) => {\n                if (!/use home/i.test(`${f.current_region?.label}`)) {\n                    return { label: 'N/A', value: 'N/A'}\n                }\n            },\n            defaultComputedOutput: (f: any) => {\n                if (f.current_region && f.current_region.label.match(/foreign/i)) {\n                    return { person: 'Unknown'}\n                }\n                return null\n            },\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (form: any, filter: string) => getVillages(form.current_traditional_authority.value, filter)\n        }\n    },\n    getCellNumberField() {\n        return   {\n            id: 'cell_phone_number',\n            helpText: 'Cell phone number',\n            group: 'person',\n            type: FieldType.TT_TEXT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => {\n                if (val) {\n                    if (val.value.match(/Unknown|n\\/a/i)) {\n                        return null\n                    }\n                    for(const number of `${val.value}`.split('/')) {\n                        if (Validation.isMWPhoneNumber({label: number, value: number})) {\n                            return [`\"${number}\" is not a valid phone number`]\n                        }\n                    }\n                    return null\n                }\n                return ['Phone number cannot be empty']\n            },\n            config: {\n                customKeyboard: [\n                    [\n                        ['1', '2', '3'],\n                        ['4', '5', '6'],\n                        ['7', '8', '9'],\n                        ['',  '0', '']\n                    ],\n                    [ \n                        [ '+265', '/'],\n                        [ 'Unknown', 'N/A' ],\n                        [ 'Delete' ]\n                    ]\n                ]\n            }\n        }\n    },\n    getLandmarkFields(): Field[] {\n        return [\n            {\n                id: 'default_landmarks',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_SELECT,\n                appearInSummary: (f: any) => f.default_landmarks.value != 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (val: any) => Validation.required(val),\n                options: () => mapToOption([\n                    'Catholic Church',\n                    'CCAP',\n                    'Seventh Day',\n                    'Mosque',\n                    'Primary School',\n                    'Borehole',\n                    'Secondary School',\n                    'College',\n                    'Market',\n                    'Football Ground',\n                    'Other'\n                ])\n            },\n            {\n                id: 'other_landmark',\n                proxyID: 'landmark',\n                helpText: 'Closest Landmark or Plot Number',\n                type: FieldType.TT_NOTE,\n                appearInSummary: (f: any) => f.default_landmarks.value === 'Other',\n                condition: (f: any) => f.default_landmarks.value === 'Other',\n                computedValue: (val: Option) => ({person: val.value}),\n                validation: (v: Option) => Validation.required(v)\n            }\n        ]\n    },\n    getFacilityLocationField() {\n        return  {\n            id: 'location',\n            helpText: 'Please select facility name',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.label}),\n            validation: (val: any) => Validation.required(val),\n            options: (_: any, filter='') => getFacilities(filter),\n            config: {\n                showKeyboard: true,\n                isFilterDataViaApi: true\n            }\n        }\n    },\n    getPersonNameFromPersonObj(personObj: any, type: 'given_name' | 'family_name') {\n        if (personObj.names.length) {\n            return personObj.names[0][type]\n        }\n        return ''\n    },\n    getAttrFromPersonObj(personObj: any, type: 'Landmark Or Plot Number' | 'Cell Phone Number') {\n        if (Array.isArray(personObj.person_attributes) && personObj.person_attributes.length) {\n            return personObj.person_attributes.reduce((v: string, c: any) => {\n                if (c.type.name === type) {\n                    return c.value\n                }\n                return v\n            }, '')\n        }\n        return ''\n    },\n    getAddressFromPersonObj(personObj: any, \n        type: 'home_region' | \n        'home_district' | \n        'home_region' | \n        'home_village' | \n        'home_traditional_authority' | \n        'current_region' |\n        'current_traditional_authority' | \n        'current_district') {\n        if (Array.isArray(personObj.addresses) && personObj.addresses.length) {\n            const address: any = personObj.addresses[0]\n            const addressMap: Record<string, string> = {\n                'home_district': 'address2', \n                'home_village': 'neighborhood_cell',\n                'home_traditional_authority': 'county_district', \n                'current_village': 'city_village',\n                'current_traditional_authority' : 'township_division',\n                'current_district': 'state_province'\n            }\n            return address[addressMap[type]]\n        }\n        return ''\n    },\n    mapPersonData(personObj: any) {\n        const givenName = this.getPersonNameFromPersonObj(personObj, 'given_name')\n        const familyName = this.getPersonNameFromPersonObj(personObj, 'family_name')\n        const homeDistrict = this.getAddressFromPersonObj(personObj, 'home_district')\n        const homeVillage = this.getAddressFromPersonObj(personObj, 'home_village')\n        const homeTA = this.getAddressFromPersonObj(personObj, 'home_traditional_authority')\n        return {\n            'id': personObj.person_id,\n            'name': `${givenName} ${familyName}`,\n            'given_name': givenName,\n            'family_name': familyName,\n            'gender': personObj.gender,\n            'birth_date': personObj.birthdate,\n            'birthdate_estimated': personObj.birthdate_estimated,\n            'home_district': homeDistrict,\n            'home_village': homeVillage,\n            'home_traditional_authority': homeTA,\n            'home_address': `${homeDistrict} ${homeVillage}`,\n            'current_district': this.getAddressFromPersonObj(personObj, 'current_district'),\n            'current_traditional_authority': this.getAddressFromPersonObj(personObj, 'current_traditional_authority'),\n            'cell_phone_number': this.getAttrFromPersonObj(personObj, 'Cell Phone Number'),\n            'landmark': this.getAttrFromPersonObj(personObj, 'Landmark Or Plot Number')\n        }\n    },\n    getPersonAttributeOptions(person: any) {\n        const patient = new Patientservice(person);\n        const prop = (patient: any, prop: string) => prop in patient ? patient[prop]() : '-'\n        return {\n            label: patient.getPatientInfoString(),\n            value: patient.getID() || patient.getNationalID(),\n            other: {\n                npid: patient.getNationalID(),\n                person,\n                options: [\n                    {\n                        label: \"National ID\",\n                        value: prop(patient, 'getNationalID')\n                    },\n                    {\n                        label: 'ARV Number',\n                        value: prop(patient, 'getArvNumber'),\n                        other: {\n                            show: () => Service.getProgramName() === \"ART\" \n                        }\n                    },\n                    {\n                        label: \"Name\",\n                        value: prop(patient, 'getFullName'),\n                    },\n                    {\n                        label: \"Sex\",\n                        value: prop(patient, 'getGender'),\n                    },\n                    {\n                        label: \"Birthdate\",\n                        value: prop(patient, 'getBirthdate'),\n                    },\n                    {\n                        label: \"Home District\",\n                        value: prop(patient, 'getHomeDistrict'),\n                    },\n                    {\n                        label: \"Home Village\",\n                        value: prop(patient, 'getHomeVillage'),\n                    },\n                    {\n                        label: \"Current District\",\n                        value: prop(patient, 'getCurrentDistrict'),\n                    },\n                    {\n                        label: \"Current T/A\",\n                        value: prop(patient, 'getCurrentTA'),\n                    },\n                    {\n                        label: 'Cellphone',\n                        value: prop(patient, 'getPhoneNumber')\n                    }\n                ]\n            }\n        }    \n    }\n}\n","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")!\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    formLabel: _ctx.formLabel,\n    onOnIndex: _cache[0] || (_cache[0] = ($event: any) => (_ctx.fieldComponent='')),\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.fieldComponent,\n    fields: _ctx.fields,\n    onFinishAction: _ctx.onFinish\n  }, null, 8, [\"formLabel\", \"skipSummary\", \"activeField\", \"fields\", \"onFinishAction\"]))\n}","\nimport { defineComponent } from \"vue\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport { generateDateFields } from \"@/utils/HisFormHelpers/MultiFieldDateHelper\"\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { Patientservice } from \"@/services/patient_service\"\nimport HisDate from \"@/utils/Date\"\nimport { STANDARD_DATE_FORMAT } from \"@/utils/Date\"\nimport { WorkflowService } from \"@/services/workflow_service\"\nimport { isPlainObject, isEmpty } from \"lodash\"\nimport PersonField from \"@/utils/HisFormHelpers/PersonFieldHelper\"\nimport { PatientRegistrationService } from \"@/services/patient_registration_service\"\nimport App from \"@/apps/app_lib\"\nimport { AppInterface } from \"@/apps/interfaces/AppInterface\"\nimport { nextTask } from \"@/utils/WorkflowTaskHelper\"\nimport { isValueEmpty } from \"@/utils/Strs\"\nimport { PatientDemographicsExchangeService } from \"@/services/patient_demographics_exchange_service\"\nimport { toastDanger, toastWarning } from \"@/utils/Alerts\"\nimport { PatientTypeService } from \"@/apps/ART/services/patient_type_service\";\nimport { infoActionSheet } from \"@/utils/ActionSheets\"\nimport GLOBAL_PROP from \"@/apps/GLOBAL_APP/global_prop\";\nimport dayjs from \"dayjs\";\nimport { delayPromise } from \"@/utils/Timers\";\nimport Store from \"@/composables/ApiStore\"\nimport { Offline, isOfflineMode, isOnline } from \"@/composables/offline\";\n\nexport default defineComponent({\n  components: { HisStandardForm },\n  data: () => ({\n    formLabel: 'Find / Register',\n    app: App.getActiveApp() as AppInterface,\n    ddeInstance: {} as any,\n    ddeDocID: '' as string,\n    ddeIsReassign: false as boolean,\n    skipSummary: false as boolean,\n    currentAddressAttributes: [\n        'current_region',\n        'current_district',\n        'current_village',\n        'current_traditional_authority'\n    ] as string[],\n    homeAddressAttributes: [\n        'home_region',\n        'home_district',\n        'home_traditional_authority',\n        'home_village'\n    ] as string[],\n    hasIncompleteData: false as boolean,\n    patient: {} as any,\n    editPersonData: {} as any,\n    editPerson: -1 as number,\n    personAttribute: '' as string,\n    activeField: '' as string,\n    fieldComponent: '' as string,\n    fields: [] as Array<Field>,\n    isMilitarySite: false,\n    presets: {} as any,\n    registrationSummary: {} as any,\n    form: {} as Record<string, Option> | Record<string, null>,\n    ddeEnabled: false as boolean,\n  }),\n  watch: {\n    '$route': {\n        async handler({query}: any) {\n           this.ddeInstance = new PatientDemographicsExchangeService()\n           if (query.edit_person) {\n                this.ddeIsReassign = query.dde_reassign\n                this.ddeDocID = query.doc_id\n                this.ddeInstance.setPatientID(query.edit_person)\n                if(query.person_attribute) this.personAttribute = query.person_attribute\n                await this.initEditMode(query.edit_person)\n            } else {\n                this.presets = query\n            }\n            this.fields = this.getFields()\n        },\n        immediate: true,\n        deep: true\n    }\n  },\n  methods: {\n    getFields(): Array<Field> {\n        let fields: Array<Field> = []\n        fields.push(this.personIndexField())\n        if (this.hasScannedNationalID()) {\n            fields = fields.concat(this.hiddenFieldsForScannedNationalID())\n        } else {\n            fields.push(this.givenNameField())\n            fields.push(this.familyNameField())\n            fields.push(this.genderField())\n        }\n        fields.push(this.searchResultField())\n        fields.push(this.hasNpidField())\n        fields.push(this.scanNpid())\n        if (!this.hasScannedNationalID()) {\n            fields = fields.concat(this.dobFields())\n        }\n        fields.push(this.homeRegionField())\n        fields.push(this.homeDistrictField())\n        fields.push(this.homeTAField())\n        fields.push(this.homeVillageField())\n        fields.push(this.currentRegionField())\n        fields.push(this.currentDistrictField())\n        fields.push(this.currentTAField())\n        fields.push(this.currentVillage())\n        fields = fields.concat(this.landmarkFields())\n        fields.push(this.cellPhoneField())\n        fields.push(this.patientTypeField())\n        fields.push(this.facilityLocationField())\n        fields.push(this.occupationField())\n        fields.push(this.regimentField())\n        fields = fields.concat(this.dateJoinedMilitaryFields())\n        fields.push(this.rankField())\n        fields.push(this.relationshipField())\n        fields.push(this.possibleDuplicatesField())\n        return fields\n    },\n    isEditMode() {\n        return this.editPerson >= 1\n    },\n    hasScannedNationalID() {\n        return this.presets.nationalIDStatus === 'true'\n    },\n    async initEditMode(personId: number) {\n        this.editPerson = personId\n        this.patient = await Store.get('ACTIVE_PATIENT', { patientID: parseInt(`${this.editPerson}`)})\n        const {\n            ancestryDistrict,\n            ancestryTA,\n            ancestryVillage,\n            currentDistrict,\n            currentVillage,\n            currentTA\n        } = this.patient.getAddresses()\n        this.editPersonData = {\n            'given_name': this.patient.getGivenName(),\n            'family_name': this.patient.getFamilyName(),\n            'gender': this.patient.getGender(),\n            'birthdate': this.patient.getBirthdate(),\n            'home_district': ancestryDistrict,\n            'home_traditional_authority': ancestryTA,\n            'home_village': ancestryVillage,\n            'current_district': currentDistrict,\n            'current_village': currentVillage,\n            'current_traditional_authority': currentTA,\n            'cell_phone_number': this.patient.getPhoneNumber(),\n            'landmark': this.patient.getClosestLandmark()\n        }\n        this.presets = this.editPersonData\n        this.skipSummary = true\n        if(this.personAttribute) {\n            this.activeField = this.personAttribute\n            this.fieldComponent = this.activeField\n        }\n    },\n    async onFinish(form: Record<string, Option> | Record<string, null>, computedData: any) {\n        if (!isOnline.value) {\n            this.createOffline(form, computedData)\n            return\n        }        \n        if (!this.isEditMode()) {\n            this.create(form, computedData)\n        } else {\n            this.update(computedData)\n        }\n        isOfflineMode.value = false\n    },\n    createOffline(form: any, computedData: any) {\n        const { savePersonOffline } = Offline()\n        const person: any = PersonField.resolvePerson(computedData)\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const offlineID = savePersonOffline('Client registration', person, attributes, form?.npid)\n        nextTask(offlineID, this.$router)\n    },\n    async create(_: any, computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const attributes: Array<any> = this.resolvePersonAttributes(computedData)\n        const registration: any = new PatientRegistrationService()\n        const patient = new Patientservice((await registration.registerPatient(person, attributes)))\n        const patientID = registration.getPersonID()\n\n        Store.set('ACTIVE_PATIENT', patient) // update patient store\n \n        if(this.presets.nationalIDStatus == \"true\"){ \n            this.patient = patient\n            await this.patient.updateMWNationalId(this.presets.malawiNationalID)\n        }\n\n        if (this.app.onRegisterPatient) {\n            const exit = await this.app.onRegisterPatient(\n                patientID, person, attributes, this.$router, this.$route,\n                computedData\n            )\n            if (exit) return\n        }\n        if (person.relationship === 'Yes') {\n            return this.$router.push(`/guardian/registration/${patientID}`)\n        }\n        await nextTask(patientID, this.$router)\n    },\n    async update(computedData: any) {\n        const person: any = PersonField.resolvePerson(computedData)\n        const update = new PatientRegistrationService()\n\n        update.setPersonID(this.editPerson)\n        await update.updatePerson(person)\n        for(const attr in person) {\n            if (attr in this.editPersonData) {\n                this.editPersonData[attr] = person[attr]\n            }\n        }\n        Store.invalidate('ACTIVE_PATIENT')\n        if(!this.personAttribute) return this.fieldComponent = 'edit_user'\n        this.$router.back()\n    },\n    editConditionCheck(attributes=[] as Array<string>): boolean {\n        if (this.isEditMode() && !attributes.includes(this.activeField)) {\n            return false\n        }\n        return true\n    },\n    async confirmPatient() {\n        // Attempt to assign or reassign a patient's NPID if they dont have a valid one\n        if (this.ddeEnabled && (!this.patient.getDocID() \n            || (this.patient.getDocID() && this.patient.getNationalID().match(/unknown/i)))) {\n                try {\n                    await this.patient.assignNpid()\n                    await this.patient.printNationalID()\n                    await delayPromise(300)\n               } catch (e) {\n                    toastDanger(`Failed to assign new NPID: ${e}`)\n                }\n        }\n        this.$router.push(`/patients/confirm?person_id=${this.patient.getID()}`)\n    },\n    resolvePersonAttributes(form: Record<string, Option> | Record<string, null>) {\n        return Object.values(form)\n                    .filter((d: any) => isPlainObject(d) && 'personAttributes' in d)\n                    .map(({personAttributes}: any) => personAttributes)\n    },\n    async resolveOnRegistrationCallbacks(patientID: number, computedData: any) {\n        for (const i of Object.values(computedData)) {\n            const item: any = i\n            if (typeof item.onRegisterPatient === 'function') {\n                try {\n                    await item.onRegisterPatient(patientID)\n                } catch (e) {\n                    console.error(`${e}`)\n                    toastDanger(`${e}`)\n                }\n            }\n        }\n    },\n    mapToOption(listOptions: Array<string>): Array<Option> {\n        return listOptions.map((item: any) => ({ label: item, value: item }))\n    },\n    hiddenFieldsForScannedNationalID(): Field[] {\n        const d = (val: string | boolean) => ({label: val, value: val})\n        return [\n            {\n                id: 'given_name',\n                helpText: 'First name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.given_name),\n                computedValue: () => ({person : this.presets.given_name})\n            },\n            {\n                id: 'family_name',\n                helpText: 'Last name',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.family_name),\n                computedValue: () => ({person : this.presets.family_name})\n            },\n            {\n                id: 'gender',\n                helpText: 'Gender',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => ({\n                    label: this.presets.gender,\n                    value: this.presets.gender.toLowerCase() === 'male'\n                        ? 'M'\n                        : this.presets.gender.toLowerCase() === 'female'\n                        ? 'F'\n                        : 'N/A'\n                }),\n                computedValue: () => ({person : this.presets.gender})\n            },\n            {\n                id: 'scanned_birthdate',\n                helpText: 'Birth date',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.birthdate),\n                computedValue: () => ({\n                    person : {\n                        'birthdate': this.presets.birthdate,\n                        'birthdate_estimated': false\n                    }\n                })\n            },\n            {\n                id: 'scanned_national_id',\n                helpText: 'Scanned National ID',\n                type: FieldType.TT_HIDDEN,\n                defaultValue: () => d(this.presets.malawiNationalID),\n                computedValue: () => ({\n                    onRegisterPatient : async (patientID: number) => {\n                        const patient = await Patientservice.findByID(patientID)\n                        this.patient = new Patientservice(patient)\n                        this.patient.updateMWNationalId(this.presets.malawiNationalID)\n                    }\n                })\n            }\n        ]\n    },\n    givenNameField(): Field {\n        const name: Field = PersonField.getGivenNameField()\n        name.condition = () => this.editConditionCheck(['given_name'])\n        name.defaultValue = () => this.presets.given_name\n        return name\n    },\n    familyNameField(): Field {\n        const name: Field = PersonField.getFamilyNameField()\n        name.condition = () => this.editConditionCheck(['family_name'])\n        name.defaultValue = () => this.presets.family_name\n        return name\n    },\n    genderField(): Field {\n        const IS_ANC_APP = this.app.applicationName === 'ANC'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const gender: Field = PersonField.getGenderField()\n        gender.requireNext = this.isEditMode()\n        gender.defaultValue = () => this.presets.gender\n        gender.condition = () => {\n            if (!this.isEditMode() && (IS_ANC_APP || IS_CXCA)) {\n                return false\n            }\n            return this.editConditionCheck(['gender'])\n        }\n        if ((IS_ANC_APP || IS_CXCA) && !this.isEditMode()) {\n            gender.defaultOutput = () => ({ label: 'Female', value: 'F' })\n            gender.defaultComputedOutput = () => ({ person: 'F' })\n        } \n\n        gender.beforeNext = async (data: Option) => {\n            /**\n             * Provide warning when changing gender in edit mode\n            */\n            const newGender = data.value\n            const oldGender = this.presets.gender\n            if (this.isEditMode() && newGender != oldGender) {\n                const action = await infoActionSheet(\n                    'Warning',\n                    `Changing gender from ${oldGender} to ${newGender}`,\n                    \"This change will cause data inconsistency and will affect alot of Reports.\",\n                    [\n                        {\n                            name: 'Cancel', slot: 'start'\n                        },\n                        {\n                            name: 'Change gender', slot: 'end', color: 'danger'\n                        }\n                    ]\n                )\n                return action === 'Change gender'\n            }\n            return true\n        }\n        return gender\n    },\n    dobFields(): Array<Field> {\n        const dobConfig = PersonField.getDobConfig()\n        dobConfig.defaultValue = () => this.presets.birthdate\n        dobConfig.condition = () => this.editConditionCheck([\n            'year_birth_date', 'month_birth_date', 'day_birth_date'\n        ])\n        // ANC validation to ensure that we are not registering\n        // Non child bearing youngsters\n        if (this.app.applicationName === 'ANC') {\n            const sdate = Patientservice.getSessionDate()\n            const childBearingAgeInYrs = 12\n            dobConfig.maxDate = () => dayjs(sdate)\n                .subtract(childBearingAgeInYrs, 'years')\n                .format(STANDARD_DATE_FORMAT)\n        }\n        return generateDateFields(dobConfig)\n    },\n    hasNpidField() : Field {\n        return {\n            id: \"has_npid\",\n            helpText: \"NPID\",\n            type: FieldType.TT_YES_NO,\n            isRequired: () => true,\n            condition: () => !this.isEditMode() && isOfflineMode.value || !isOnline.value,\n            options: () => {\n                return [\n                    {\n                        label: \"Has client brought NPID barcode?\",\n                        value: \"\",\n                        values: [\n                            { label: \"Yes\", value: \"Yes\" },\n                            { label: \"No\", value: \"No\" }\n                        ]\n                    }\n                ]\n            }\n        }\n    },\n    scanNpid(): Field {\n        return {\n            id: \"npid\",\n            helpText: \"Scan NPID\",\n            type: FieldType.TT_BARCODE,\n            requireNext: false,\n            condition: (f: any) => /yes/i.test(`${f.has_npid}`),\n            config: {\n                hiddenFooterBtns: [\n                    'Clear'\n                ]\n            },\n            isRequired: () => true\n        }\n    },\n    homeRegionField(): Field {\n        return PersonField.getHomeRegionField()\n    },\n    homeDistrictField(): Field {\n        return PersonField.getHomeDistrictField()\n    },\n    homeTAField(): Field {\n        return PersonField.getHomeTaField()\n    },\n    homeVillageField(): Field {\n        return PersonField.getHomeVillageField()\n    },\n    currentRegionField(): Field {\n        const currentRegion: Field = PersonField.getCurrentRegionField()\n        currentRegion.summaryMapValue = (v: Option, f: any, computedData: any) => {\n            if (/use home/i.test(`${v.value}`)) {\n                return [\n                    { label: 'Current region', value: computedData.person?.current_region},\n                    { label: 'Current District/Country', value: computedData.person?.current_district },\n                    { label: 'Current Traditional Authority', value: computedData.person?.current_traditional_authority },\n                    { label: 'Current village', value: computedData.person?.current_village}\n                ]\n            }\n            return { label: 'Current Region', value: v.label }\n        }\n        if (this.isEditMode()) {\n            currentRegion.computedValue = (val: Option) => {\n                if (/use home/i.test(`${val.value}`)) {\n                    return {\n                        person: {\n                            'current_district': this.editPersonData.home_district,\n                            'current_traditional_authority': this.editPersonData.home_traditional_authority,\n                            'current_village': this.editPersonData.home_village\n                        }\n                    }\n                }\n            }\n        }\n        currentRegion.condition = () => this.editConditionCheck(this.currentAddressAttributes)\n        return currentRegion\n    },\n    currentDistrictField(): Field {\n        const currentDistrict: Field = PersonField.getCurrentDistrictField()\n        currentDistrict.condition = (f: any) => !/use home/i.test(f.current_region.label) &&\n             this.editConditionCheck(this.currentAddressAttributes)\n        return currentDistrict\n    },\n    currentTAField(): Field {\n        const currentTA: Field = PersonField.getCurrentTAfield()\n        currentTA.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentTA\n    },\n    currentVillage(): Field {\n        const currentVillage: Field = PersonField.getCurrentVillageField()\n        currentVillage.condition = (form: any) => this.editConditionCheck(this.currentAddressAttributes)\n            && !form.current_region.label.match(/foreign|use home/i)\n        return currentVillage\n    },\n    cellPhoneField(): Field {\n        const cellPhone: Field = PersonField.getCellNumberField()\n        cellPhone.condition = () => this.editConditionCheck(['cell_phone_number'])\n        cellPhone.defaultValue = () => this.presets.cell_phone_number\n        return cellPhone\n    },\n    facilityLocationField(): Field {\n       const facility: Field = PersonField.getFacilityLocationField()\n       facility.condition = (form: any) => [\n           'Drug Refill',\n           'External consultation'\n       ].includes(form.patient_type.value)\n       return facility\n    },\n    landmarkFields(): Field[] {\n        const landmarks: Field[] = PersonField.getLandmarkFields()\n        landmarks[0].condition = () => this.editConditionCheck(['default_landmarks'])\n        return landmarks\n    },\n    patientTypeField(): Field {\n        return {\n            id: 'patient_type',\n            helpText: 'Type of patient',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['patient_type'])\n                && this.app.applicationName === 'ART',\n            validation: (val: any) => Validation.required(val),\n            options: () => PatientTypeService.getPatientTypes()\n        }\n    },\n    occupationField(): Field {\n        return {\n            id: 'occupation',\n            helpText: 'Occupation',\n            type: FieldType.TT_SELECT,\n            init: async () => {\n               this.isMilitarySite = await GLOBAL_PROP.militarySiteEnabled()\n               return true \n            },\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['occupation']) && this.isMilitarySite,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption([\n                'Military',\n                'Civilian'\n            ])\n        }\n    },\n    regimentField(): Field {\n        return {\n            id: 'person_regiment_id',\n            helpText: 'Regiment ID',\n            type: FieldType.TT_TEXT,\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 35,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['person_regiment_id']) && form.occupation && form.occupation.value.match(/Military/i),\n            validation: (val: any) => Validation.required(val)\n        }\n    },\n    rankField(): Field {\n        return {\n            id: 'rank',\n            helpText: 'Rank',\n            type: FieldType.TT_SELECT,\n            validation: (val: any) => Validation.required(val),\n            computedValue: ({value}: Option) => ({\n                personAttributes: {\n                    'person_attribute_type_id': 36,\n                    'value': value\n                }\n            }),\n            condition: (form: any) => this.editConditionCheck(['rank']) && form.occupation && form.occupation.value.match(/Military/i),\n            options: () => this.mapToOption([\n                'First Lieutenant',\n                'Captain',\n                'Major',\n                'Lieutenant Colonel',\n                'Colonel',\n                'Brigadier General',\n                'Lieutenant General',\n                'General',\n                'Private',\n                'Corporal',\n                'Lance Corporal',\n                'Seargent',\n                'Staff Seargent',\n                'Warrant Officer class 1',\n                'Warrant Officer class 2'\n            ])\n        }\n    },\n    dateJoinedMilitaryFields(): Array<Field> {\n        return generateDateFields({\n            id: 'person_date_joined_military',\n            helpText: 'Joined Military',\n            required: true,\n            condition: (form: any) =>  this.editConditionCheck([\n                'year_person_date_joined_military',\n                'month_person_date_joined_military',\n                'day_person_date_joined_military'\n            ]) && form.occupation && form.occupation.value.match(/Military/i),\n            minDate: () => HisDate.estimateDateFromAge(100),\n            maxDate: () => WorkflowService.getSessionDate(),\n            estimation: {\n                allowUnknown: false\n            },\n            computeValue: (date: string) => ({\n                date,\n                personAttributes : {\n                    'person_attribute_type_id': 37, 'value': date\n                }\n            })\n        })\n    },\n    relationshipField(): Field {\n        const IS_HTS = this.app.applicationName === 'ITS'\n        const IS_CXCA = this.app.applicationName === 'CxCa'\n        const OPD = this.app.applicationName === 'OPD'\n        const Registration = this.app.applicationName === 'Registration'\n        return {\n            id: 'relationship',\n            helpText: 'Register guardian?',\n            type: FieldType.TT_SELECT,\n            computedValue: (val: Option) => ({person: val.value}),\n            condition: () => this.editConditionCheck(['relationship']) && !IS_CXCA && !OPD && !Registration && !IS_HTS,\n            validation: (val: any) => Validation.required(val),\n            options: () => this.mapToOption(['Yes', 'No'])\n        }\n    },\n    searchResultField(): Field {\n        return {\n            id: 'results',\n            helpText: 'Search results',\n            type: FieldType.TT_PERSON_RESULT_VIEW,\n            init: async () => {\n                if (!this.isEditMode()) { \n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                }\n                return true\n            },\n            dynamicHelpText: (form: any) => {\n                return `Search results for \"${form.given_name.value} ${form.family_name.value} | ${form.gender.label}\"`;\n            },\n            appearInSummary: () => false,\n            condition: () => !this.isEditMode() && !isOfflineMode.value,\n            options: async (form: any) => {\n                const payload = {\n                    'given_name': form.given_name.value,\n                    'family_name': form.family_name.value,\n                    'gender': form.gender.value\n                }\n                // DDE enabled search\n                if (this.ddeEnabled) {\n                    const patients = await this.ddeInstance.searchDemographics(payload)\n                    return patients.map((item: any) => {\n                        const itemData = PersonField.getPersonAttributeOptions(item)\n                        itemData.other.options.push({\n                            label: 'Patient Type',\n                            value: item.patient_type\n                        })\n                        itemData.other.options.push({\n                            label: 'Doc ID',\n                            value: item.doc_id\n                        })\n                        return itemData\n                    })\n                }\n                // Regular search\n                const patients = await Patientservice.search(payload);\n                return patients.map((item: any) => PersonField.getPersonAttributeOptions(item))\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next',\n                    'Back'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Edit Search',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = 'given_name'\n                        },\n                        state: {\n                            disabled: {\n                                default: () => this.hasScannedNationalID()\n                            }\n                        }\n                        \n                    },\n                    {\n                        name: 'New Client',\n                        slot: 'end',\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Continue',\n                        color: 'success',\n                        slot: 'end',\n                        state: {\n                            disabled: {\n                                default: () => true,\n                                onValue(_: any,form: any) {\n                                    return isEmpty(form.results)\n                                }\n                            }\n                        },\n                        onClick: (form: any) => {\n                            return this.$router.push(`/patients/confirm?person_id=${form.results.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    possibleDuplicatesField(): Field {\n        let createdPerson: any = {}\n        let duplicatePatients: any = {}\n        return {\n            id: 'possible_duplicates',\n            helpText: 'Possible Duplicate(s)',\n            type: FieldType.TT_PERSON_MATCH_VIEW,\n            condition: async (_: any, c: any) => {\n                if (this.ddeEnabled && this.editPerson <= 0) {\n                    createdPerson = PersonField.resolvePerson(c)\n                    duplicatePatients = await this.ddeInstance\n                        .checkPotentialDuplicates(createdPerson)\n                    return duplicatePatients.length >= 1\n                }\n                return false\n            },\n            options: async () => {\n                const toDate = (date: string) => HisDate.toStandardHisDisplayFormat(date)\n                return duplicatePatients.map(({ score, person }: any) => {\n                    const name = `${person.given_name} ${person.family_name}`\n                    return {\n                        label: name,\n                        value: person.patient_id,\n                        other: {\n                            score: `${score * 100}%`,\n                            newPerson: createdPerson,\n                            foundPerson: person,\n                            comparisons: [\n                                [\n                                    'Name',\n                                    `${createdPerson.given_name} ${createdPerson.family_name}`,\n                                    `${person.given_name} ${person.family_name}`\n                                ],\n                                [\n                                    'Gender',\n                                    createdPerson.gender,\n                                    person.gender\n                                ],\n                                [\n                                    'Birthdate',\n                                    toDate(createdPerson.birthdate),\n                                    toDate(person.birthdate)\n                                ],\n                                [\n                                    'Home District',\n                                    createdPerson.home_district,\n                                    person.home_district\n                                ],\n                                [\n                                    'Home TA',\n                                    createdPerson.home_traditional_authority,\n                                    person.home_traditional_authority\n                                ]\n                            ]\n                        }\n                    }\n                })\n            },\n            config: {\n                hiddenFooterBtns: [\n                    'Clear',\n                    'Next'\n                ],\n                footerBtns: [\n                    {\n                        name: 'Not Duplicate',\n                        slot: 'start',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: () => {\n                            this.fieldComponent = '_NEXT_FIELD_'\n                        }\n                    },\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onValue: (_: any, f: any) => !isEmpty(f.possible_duplicates)\n                            }\n                        },\n                        onClick: (form: any) => {\n                            this.$router.push(`/patients/confirm?person_id=${form.possible_duplicates.value}`)\n                        }\n                    }\n                ]\n            }\n        }\n    },\n    personIndexField(): Field {\n        return {\n            id: 'edit_user',\n            helpText: 'Edit Demographics',\n            type: FieldType.TT_TABLE_VIEWER,\n            init: async () => {\n                if (this.isEditMode()) {\n                    this.formLabel = 'View / Edit'\n                    this.ddeEnabled = await Store.get('IS_DDE_ENABLED')\n                }\n                return true\n            },\n            condition: () => this.isEditMode(),\n            options: async () => {\n                const editButton = (attribute: string) => ({\n                    name: 'Edit',\n                    type: 'button',\n                    action: () => {\n                        this.activeField = attribute\n                        this.fieldComponent = this.activeField\n                    }\n                })\n                const columns = ['Attributes', 'Values', 'Edit']\n                const rows = [\n                    ['Given Name', this.editPersonData.given_name, editButton('given_name')],\n                    ['Family Name', this.editPersonData.family_name, editButton('family_name')],\n                    ['Gender', this.editPersonData.gender,  editButton('gender')],\n                    ['Birthdate', HisDate.toStandardHisDisplayFormat(this.editPersonData.birthdate),  editButton('year_birth_date')],\n                    ['Cell Phone Number', this.editPersonData.cell_phone_number, editButton('cell_phone_number')],\n                    ['Home District', this.editPersonData.home_district, editButton('home_region')],\n                    ['Home TA', this.editPersonData.home_traditional_authority,  editButton('home_region')],\n                    ['Home Village', this.editPersonData.home_village,  editButton('home_region')],\n                    ['Current district',this.editPersonData.current_district, editButton('current_region')],\n                    ['Current Village',this.editPersonData.current_village, editButton('current_region')],\n                    ['Current T/A', this.editPersonData.current_traditional_authority, editButton('current_region')],\n                    ['Landmark', this.editPersonData.landmark, editButton('default_landmarks')],\n                ]\n                // Tag rows with empty values\n                const emptySets: any = {indexes: [], class: 'his-empty-set-color'}\n                rows.forEach((r: any, i: number) => {\n                    if (isValueEmpty(r[1])) \n                        emptySets.indexes.push(i)\n                })\n                this.hasIncompleteData = emptySets.indexes.length >= 1\n                return [{\n                    label: '', \n                    value: '',\n                    other: {\n                        rows,\n                        columns,\n                        rowColors: [emptySets]\n                    }\n                }]\n            },\n            config: {\n                footerBtns: [\n                    /**\n                     * Custom button that Appears when DDE wants to\n                     * Reassign a patient with incomplete data\n                    */\n                    {\n                        name: 'Reassign',\n                        slot: 'end',\n                        color: 'success',\n                        state: {\n                            visible: {\n                                default: () => false,\n                                onload: () => (\n                                    this.ddeEnabled\n                                    && this.ddeIsReassign\n                                    && !this.hasIncompleteData\n                                )\n                            }\n                        },\n                        onClick: async () => {\n                            try {\n                                await this.ddeInstance.reassignNpid(this.ddeDocID, this.editPerson)\n                                await this.ddeInstance.printNpid()\n                                this.$router.push(`/patients/confirm?person_id=${this.editPerson}`)\n                            } catch(e) {\n                                toastWarning(`${e}`)\n                            }\n                        }\n                    },\n                    /**\n                     * Custom button that redirects to patient confirmation page\n                     */\n                    {\n                        name: 'Confirm',\n                        slot: 'end',\n                        color: 'warning',\n                        state: {\n                            visible: {\n                                onload: () => !this.ddeIsReassign && !this.hasIncompleteData\n                            }\n                        },\n                        onClick: async () => this.confirmPatient()\n                    }\n                ],\n                hiddenFooterBtns: ['Clear', 'Next']\n            }\n        }\n    }\n  }\n})\n","import { render } from \"./PatientRegistration.vue?vue&type=template&id=6107194a&ts=true\"\nimport script from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientRegistration.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import {LocationService} from \"@/services/location_service\"\nimport { Option } from \"@/components/Forms/FieldInterface\"\nimport { isEmpty } from \"lodash\"\n\nexport async function getFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getFacilities({name: filter})\n    return facilities.filter((f: any) => !isEmpty(f) && f.name.trim() !='')\n        .map((facility: any) => ({\n            label: facility.name,\n            value: facility.location_id,\n            other: facility\n        }))\n}\n\nexport async function getLabFacilities(filter=''): Promise<Option[]> {\n    const facilities = await LocationService.getLabs({'search_name': filter})\n    return facilities.map((facility: any) => ({\n            label: facility,\n            value: facility\n        }))\n}\n\nexport async function getFacilityWards(filter=''): Promise<Option[]> {\n    const wards = await LocationService.getFacilities({\n        name: filter,\n        tag: 'Facility adult sections'\n    })\n\n    return wards.map((ward: any) => ({\n        label: ward.name,\n        value: ward.name,\n        other: ward\n    }))\n}\n\nexport async function getSpecialistClinics(): Promise<Option[]> {\n    const clinics = await LocationService.getSpecialistClinics()\n    return clinics.map((clinic: any) => ({\n        label: clinic.name,\n        value: clinic.name,\n        other: clinic\n    }))\n}\n\nexport async function getRegions(): Promise<Option[]> {\n    const regions = await LocationService.getRegions()\n    return regions.map((region: any) => ({\n        label: region.name,\n        value: region.region_id,\n        other: region\n    }))\n}\n\nexport async function getDistricts(regionID: number): Promise<Option[]> {\n    const districts = await LocationService.getDistricts(regionID)\n    return districts.map((district: any) => ({\n        label: district.name,\n        value: district.district_id,\n        other: district\n    }))\n}\n\nexport async function getTraditionalAuthorities(districtID: number, name=''): Promise<Option[]> {\n    const TAs = await LocationService.getTraditionalAuthorities(districtID, name)\n    return TAs.map((TA: any) => ({\n        label: TA.name,\n        value: TA.traditional_authority_id,\n        other: TA\n    }))\n}\n\nexport async function getVillages(traditionalAuthorityID: number, name=''): Promise<Option[]> {\n    const villages = await LocationService.getVillages(traditionalAuthorityID, name)\n    return villages.map((village: any) => ({\n        label: village.name,\n        value: village.village_id,\n        other: village\n    }))\n}\n"],"sourceRoot":""}