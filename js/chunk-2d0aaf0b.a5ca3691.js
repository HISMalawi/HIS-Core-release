(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0aaf0b"],{"12c7":function(e,t,n){"use strict";n.r(t);var r=n("7a23");function i(e,t,n,i,a,u){var c=Object(r["resolveComponent"])("his-standard-form");return Object(r["openBlock"])(),Object(r["createBlock"])(c,{skipSummary:!0,activeField:e.fieldComponent,onOnIndex:t[1]||(t[1]=function(t){return e.fieldComponent=""}),fields:e.fields},null,8,["activeField","fields"])}var a=n("2909"),u=n("1da1"),c=(n("b0c0"),n("99af"),n("d81d"),n("ac1f"),n("466d"),n("96cf"),n("2ef0")),s=n("d95e"),o=n("8a30"),l=n("23e6"),m=n("3835"),f=n("d4ec"),p=n("bee2"),d=n("262e"),g=n("2caf"),v=(n("841c"),n("1276"),n("4d63"),n("2c3e"),n("25f0"),n("1c74")),b=n("b89f"),h=n("d1ca"),x=function(e){Object(d["a"])(n,e);var t=Object(g["a"])(n);function n(){var e;return Object(f["a"])(this,n),e=t.call(this),e.patientID=0,e.activePrefix="",e.dormantPrefix="",e}return Object(p["a"])(n,[{key:"getActivePrx",value:function(){return this.activePrefix}},{key:"getDormantPrx",value:function(){return this.dormantPrefix}},{key:"getPatientID",value:function(){return this.patientID}},{key:"setPatientID",value:function(e){this.patientID=e}},{key:"formatNumber",value:function(e){var t=e.search(this.activePrefix)>=0?this.activePrefix:e.search(this.dormantPrefix)>=0?this.dormantPrefix:"";return t?e.substring(t.length,e.length):e}},{key:"loadFilingPrefix",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,r,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,h["b"].filingNumberPrefix();case 2:t=e.sent,t&&(n=t.split(","),r=Object(m["a"])(n,2),i=r[0],a=r[1],this.activePrefix=i,this.dormantPrefix=a);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isActiveFilingNum",value:function(e){return!!e.match(new RegExp(this.activePrefix,"i"))}},{key:"isDormantFilingNum",value:function(e){return!!e.match(new RegExp(this.dormantPrefix,"i"))}},{key:"assignFilingNumber",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",v["e"].postJson("patients/".concat(this.patientID,"/filing_number"),{}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getFilingNumber",value:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="".concat(this.activePrefix).concat(t),e.next=3,v["e"].getJson("search/patients/by_identifier",{type_id:17,identifier:n});case 3:if(r=e.sent,!r){e.next=6;break}return e.abrupt("return",r.map((function(e){var t=new l["a"](e);return{identifier:n,patient_id:t.getID(),given_name:t.getGivenName(),family_name:t.getFamilyName(),state:"N/A",appointment_date:""}})));case 6:return e.abrupt("return",[]);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"archiveFilingNumber",value:function(){return v["e"].getJson("archive_active_filing_number",{patient_id:this.patientID})}},{key:"archivePatient",value:function(e,t){return v["e"].postJson("swap_active_number",{primary_patient_id:this.patientID,secondary_patient_id:e,identifier:t})}},{key:"getArchivingCandidates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return v["e"].getJson("archiving_candidates",{page:e,page_size:t})}},{key:"getPastFilingNumbers",value:function(){return v["e"].getJson("patients/".concat(this.patientID,"/past_filing_numbers"))}},{key:"printFilingNumber",value:function(){var e=new b["a"];return e.printLbl("patients/".concat(this.patientID,"/labels/filing_number"))}}]),n}(v["e"]),w=n("7920"),N=n("2706"),k=n("b5e4"),F=n("9283"),D=n("10be"),_=n("0fa1"),y=Object(r["defineComponent"])({components:{HisStandardForm:w["a"]},data:function(){return{service:{},patient:{},fieldComponent:"",fields:[],nextWorkflowRouteName:"",filingNumberAssignment:{}}},watch:{$route:{handler:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e.query,i=e.params,!i||!i.patient_id){n.next=9;break}return t.service=new x,t.service.setPatientID(i.patient_id),n.next=6,t.getPatient(i.patient_id);case 6:return t.patient=n.sent,n.next=9,t.service.loadFilingPrefix();case 9:if(!r){n.next=20;break}if(t.fields=[t.getFilingNumberField(),t.getCandidateSelectionField(),t.getFilingNumberHistoryField()],"true"!==r.archive){n.next=15;break}return n.next=14,t.archiveFilingNumber();case 14:return n.abrupt("return");case 15:if("true"!==r.assign){n.next=18;break}return n.next=18,t.onAssignFilingNumber();case 18:"true"===r.trail&&(t.fieldComponent="view_filing_history"),r.next_workflow_task&&(t.nextWorkflowRouteName=r.next_workflow_task);case 20:case"end":return n.stop()}}),n)})))()},immediate:!0,deep:!0}},methods:{toFID:function(e){return this.service.formatNumber(e)},onAssignFilingNumber:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.newFilingNumber();case 2:n=t.sent,n?(e.filingNumberAssignment=n,e.fieldComponent="filing_number_management"):(e.fieldComponent="select_candidate_to_swap",Object(k["e"])("Out of filing numbers, Please select eligible candidate"));case 4:case"end":return t.stop()}}),t)})))()},newFilingNumber:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n={primary:{label:"Dormant → Active",value:e.patient.name,other:{activeNumber:e.patient.filingID?e.toFID(e.patient.filingID):"N/A",dormantNumber:"N/A"}},archived:{label:"Active → Dormant",value:"N/A",other:{activeNumber:"N/A",dormantNumber:"N/A"}}},!e.service.isActiveFilingNum(e.patient.filingID)){t.next=3;break}return t.abrupt("return",n);case 3:return t.next=5,e.presentLoading();case 5:return t.next=7,e.service.assignFilingNumber();case 7:if(r=t.sent,o["ab"].dismiss(),!Object(c["isEmpty"])(r)){t.next=11;break}return t.abrupt("return");case 11:if(n.primary.other={activeNumber:e.toFID(r.new_identifier.identifier),dormantNumber:e.service.isDormantFilingNum(e.patient.filingID)?e.toFID(e.patient.filingID):"N/A"},Object(c["isEmpty"])(r.archived_identifier)){t.next=17;break}return t.next=15,e.getPatient(r.archived_identifier.patient_id);case 15:i=t.sent,n.archived={label:"Active → Dormant",value:i.name,other:{activeNumber:e.toFID(r.archived_identifier.identifier),dormantNumber:e.toFID(r.new_identifier.identifier)}};case 17:return t.abrupt("return",n);case 18:case"end":return t.stop()}}),t)})))()},swapExistingFilingNumbers:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.service.archivePatient(e.patient_id,e.identifier);case 2:if(r=n.sent,!r){n.next=5;break}return n.abrupt("return",{primary:{label:"Dormant → Active",value:t.patient.name,other:{activeNumber:t.toFID(r.active_number),dormantNumber:t.toFID(t.patient.filingID)||"N/A"}},archived:{label:"Active → Dormant",value:"".concat(e.given_name," ").concat(e.family_name),other:{patientID:e.patient_id,activeNumber:t.toFID(r.dormant_number),dormantNumber:t.toFID(r.active_number)}}});case 5:case"end":return n.stop()}}),n)})))()},presentLoading:function(){var e=arguments;return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:"Please wait...",t.next=3,o["ab"].create({message:n,backdropDismiss:!1});case 3:return r=t.sent,t.next=6,r.present();case 6:case"end":return t.stop()}}),t)})))()},getPatient:function(e){return Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l["a"].findByID(e);case 2:if(n=t.sent,!n){t.next=6;break}return r=new l["a"](n),t.abrupt("return",{id:r.getID(),filingID:r.getFilingNumber(),name:"".concat(r.getGivenName()," ").concat(r.getFamilyName())});case 6:return t.abrupt("return",{});case 7:case"end":return t.stop()}}),t)})))()},archiveFilingNumber:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.presentLoading("Archiving filing number");case 2:return t.prev=2,t.next=5,e.service.archiveFilingNumber();case 5:return t.next=7,e.service.printFilingNumber();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),Object(k["c"])(t.t0);case 12:return t.next=14,o["ab"].dismiss();case 14:e.$router.back();case 15:case"end":return t.stop()}}),t,null,[[2,9]])})))()},filingNumberSearchKeypad:function(){return Object(u["a"])(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["cb"].create({component:D["a"],backdropDismiss:!1,cssClass:"keypad-modal",componentProps:{title:"Find Active number",strictNumbers:!1,onKeyPress:function(){}}});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.next=7,t.onDidDismiss();case 7:return n=e.sent,r=n.data,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})))()},getArchivingCandidates:function(){var e=arguments,t=this;return Object(u["a"])(regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:0,n.next=3,t.service.getArchivingCandidates(r);case 3:return i=n.sent,n.abrupt("return",t.formatCandidateOptions(i));case 5:case"end":return n.stop()}}),n)})))()},formatCandidateOptions:function(e){var t=this;return e.map((function(e){return{label:"".concat(e.given_name," ").concat(e.family_name," (").concat(e.state,")"),value:e.identifier,other:{data:e,list:[{label:"Filing #",value:t.toFID(e.identifier),style:{color:"green",fontWeight:"bold"}},{label:"Given name",value:e.given_name},{label:"Family name",value:e.family_name},{label:"Outcome",value:e.state.match(/trans/i)?"TO":e.state.match(/stop/i)?"Tx stopped":e.state},{label:"LAD",value:F["b"].toStandardHisDisplayFormat(e.appointment_date)}]}}}))},getFilingNumberHistoryField:function(){var e=this;return{id:"view_filing_history",type:s["b"].TT_TABLE_VIEWER,helpText:"Filing Number Trail",condition:function(){return!1},options:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var n,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=["Status","Filing #","Date Created","Date voided"],t.next=3,e.service.getPastFilingNumbers();case 3:return r=t.sent,i=r.map((function(t){var n=0===t.voided;return[n?"Active":"Voided",e.toFID(t.identifier),F["b"].toStandardHisDisplayFormat(t.date_created),n?"N/A":F["b"].toStandardHisDisplayFormat(t.date_voided)]})),t.abrupt("return",[{label:"Filing Number Trail",value:"Trail",other:{columns:n,rows:i}}]);case 6:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),config:{toolbarInfo:[{label:"Current filing #",value:this.toFID(this.patient.filingID)},{label:"Status",value:this.service.isActiveFilingNum(this.patient.filingID)?"Active":this.service.isDormantFilingNum(this.patient.filingID)?"Dormant":"N/A"}],hiddenFooterBtns:["Clear","Next","Back","Finish"],footerBtns:[{name:"Get filing #",slot:"end",state:{visible:{default:function(){return e.service.isDormantFilingNum(e.patient.filingID)}}},onClick:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.onAssignFilingNumber();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()}]}}},getCandidateSelectionField:function(){var e=this,t={},n=0,r="",i=[];return{id:"select_candidate_to_swap",type:s["b"].TT_CARD_SELECTOR,helpText:"Filing Number (Archive)",condition:function(){return!1},validation:function(e){return N["a"].required(e)},onload:function(e){return t=e},onValue:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=12;break}return t.next=3,Object(k["a"])("Do you want to archive ".concat(n.value));case 3:if(r=t.sent,!r){t.next=12;break}return t.next=7,e.swapExistingFilingNumbers(n.other.data);case 7:if(i=t.sent,!i){t.next=12;break}return e.filingNumberAssignment=i,e.fieldComponent="filing_number_management",t.abrupt("return",!0);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),options:function(){return e.getArchivingCandidates()},config:{hiddenFooterBtns:["Clear","Back","Finish","Next"],footerBtns:[{name:"Reset",slot:"end",color:"warning",state:{visible:{default:function(){return!!r}}},onClick:function(){r="",t.listData=i,i=[]}},{name:"Specify",slot:"end",color:"success",onClick:function(){var n=Object(u["a"])(regeneratorRuntime.mark((function n(){var u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.filingNumberSearchKeypad();case 2:if(r=n.sent,!r){n.next=9;break}return n.next=6,e.service.getFilingNumber(r);case 6:u=n.sent,i=Object(a["a"])(t.listData),t.listData=e.formatCandidateOptions(u);case 9:case"end":return n.stop()}}),n)})));function c(){return n.apply(this,arguments)}return c}()},{name:"Previous batch",slot:"end",state:{visible:{default:function(){return!r}},disabled:{default:function(){return n<=0}}},onClick:function(){var r=Object(u["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n-=1,r.next=3,e.getArchivingCandidates(n);case 3:t.listData=r.sent;case 4:case"end":return r.stop()}}),r)})));function i(){return r.apply(this,arguments)}return i}()},{name:"Next batch",slot:"end",state:{visible:{default:function(){return!r}},disabled:{default:function(){return t.listData&&t.listData.length<=1}}},onClick:function(){var r=Object(u["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n+=1,r.next=3,e.getArchivingCandidates(n);case 3:t.listData=r.sent;case 4:case"end":return r.stop()}}),r)})));function i(){return r.apply(this,arguments)}return i}()}]}}},getFilingNumberField:function(){var e=this;return{id:"filing_number_management",type:s["b"].TT_FILING_NUMBER_VIEW,helpText:"Filing Number Management",onload:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.service.printFilingNumber();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}(),condition:function(){return!1},options:function(){return[e.filingNumberAssignment.primary,e.filingNumberAssignment.archived]},config:{hiddenFooterBtns:["Cancel","Clear","Next"],footerBtns:[{name:"Print #",slot:"start",onClick:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",e.service.printFilingNumber());case 1:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{name:"Print Dormant#",slot:"start",state:{visible:{default:function(){var t,n,r;return!(null===(t=e.filingNumberAssignment)||void 0===t||null===(n=t.archived)||void 0===n||null===(r=n.other)||void 0===r||!r.patientID)}}},onClick:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new x,n.setPatientID(e.filingNumberAssignment.archived.other.patientID),t.next=4,n.printFilingNumber();case 4:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{name:"Continue",color:"success",slot:"end",onClick:function(){return Object(_["b"])(e.patient.id,e.$router,e.$route)}}]}}}}}),R=n("6b0d"),I=n.n(R);const O=I()(y,[["render",i]]);t["default"]=O}}]);
//# sourceMappingURL=chunk-2d0aaf0b.a5ca3691.js.map