(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab2c7"],{"13c2":function(e,r,t){"use strict";t.r(r);var n=t("7a23");function a(e,r,t,a,i,o){var c=Object(n["resolveComponent"])("his-standard-form");return Object(n["openBlock"])(),Object(n["createBlock"])(c,{cancelDestinationPath:e.cancelDestination,fields:e.fields,activeField:e.activeField,onFinishAction:e.onSubmit,skipSummary:!0},null,8,["cancelDestinationPath","fields","activeField","onFinishAction"])}var i=t("2909"),o=t("5530"),c=t("1da1"),u=(t("d81d"),t("7db0"),t("d3b7"),t("99af"),t("b0c0"),t("96cf"),t("9441")),s=t("7365"),d=t("2706"),l=t("d95e"),p=t("2ef0"),f=t("996c"),h=t("9283"),m=t("b5e4"),b=Object(n["defineComponent"])({components:{HisStandardForm:u["a"]},mixins:[s["a"]],data:function(){return{activeField:"",prescriptionService:{},showMalariaDrugs:!1,hasMalaria:!1}},watch:{ready:{handler:function(e){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=8;break}return r.prescriptionService=new f["c"](r.patientID,r.providerID),t.next=4,r.prescriptionService.loadDrugs();case 4:return t.next=6,r.prescriptionService.hasMalaria();case 6:r.hasMalaria=t.sent,r.fields=r.getFields();case 8:case"end":return t.stop()}}),t)})))()},immediate:!0,deep:!0}},methods:{onSubmit:function(e){var r=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var n,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=r.mapToOrders(e["drugs_details"]),t.next=3,r.prescriptionService.createEncounter();case 3:if(a=t.sent,a){t.next=6;break}return t.abrupt("return",Object(m["e"])("Unable to create treatment encounter"));case 6:return t.next=8,r.prescriptionService.createDrugOrder(n);case 8:if(i=t.sent,i){t.next=11;break}return t.abrupt("return",Object(m["e"])("Unable to create drug orders!"));case 11:Object(m["d"])("Drug order has been created"),r.nextTask();case 13:case"end":return t.stop()}}),t)})))()},calculateExpireDate:function(e,r){var t=new Date(e);return t.setDate(t.getDate()+r),h["a"].toStandardHisFormat(t)},mapToOrders:function(e){var r=this;return e.map((function(e){var t=f["c"].getSessionDate(),n=f["b"].find((function(r){return r.label===e.other.frequency}));return{drug_inventory_id:e.other.drug_id,equivalent_daily_dose:e.other.dosage*n.value,start_date:t,auto_expire_date:r.calculateExpireDate(t,e.other.duration),units:e.other.units,instructions:"".concat(e.label,": ").concat(n.value," ").concat(n.code," for ").concat(e.other.duration),dose:e.other.dosage,frequency:n.code}}))},isOrderComplete:function(e){return e.every((function(e){return e.other.frequency&&e.other.duration&&e.other.dosage}))},getFields:function(){var e=this;return[{id:"malaria_drugs",helpText:"select Malaria Drugs",validation:function(e){return d["a"].required(e)},type:l["b"].TT_SELECT,condition:function(){return"malaria_drugs"===e.activeField&&e.showMalariaDrugs},unload:function(){e.showMalariaDrugs=!1,e.activeField="drugs"},options:function(){return f["a"].map((function(e){return{label:"".concat(e.name,", ").concat(e.frequency," time(s) a day, for ").concat(e.duration," days"),value:e.name,other:e}}))}},{id:"drugs",helpText:"Select drugs",type:l["b"].TT_MULTIPLE_SELECT,validation:function(e){return d["a"].required(e)},options:function(){var r=Object(c["a"])(regeneratorRuntime.mark((function r(t){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.prescriptionService.getDrugOptions();case 2:if(n=r.sent,!Object(p["isEmpty"])(t["malaria_drugs"])){r.next=5;break}return r.abrupt("return",n);case 5:return a=t["malaria_drugs"],r.abrupt("return",n.map((function(e){return e.other.drug_id!==a.other.drug_id||(e.other=Object(o["a"])({},a.other),e.isChecked=!0),e})));case 7:case"end":return r.stop()}}),r)})));function t(e){return r.apply(this,arguments)}return t}(),onload:function(){return e.activeField=""},config:{showKeyboard:!0,hiddenFooterBtns:["Back"],footerBtns:[{name:"Predefined Malaria Drugs",color:"primary",size:"large",visible:!1,slot:"end",onClick:function(){var r=Object(c["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.t0=!e.hasMalaria,!r.t0){r.next=5;break}return r.next=4,Object(m["a"])("Patient has no malaria. Do you still want to prescribe anti malaria drugs?");case 4:r.t0=!r.sent;case 5:if(!r.t0){r.next=7;break}return r.abrupt("return");case 7:e.activeField="malaria_drugs",e.showMalariaDrugs=!0;case 9:case"end":return r.stop()}}),r)})));function t(){return r.apply(this,arguments)}return t}()}]}},{id:"drugs_details",helpText:"Complete prescribed drug details",type:l["b"].TT_PRESCRIPTION_INPUT,validation:function(e){return d["a"].required(e)},options:function(e){return Object(i["a"])(e.drugs)},beforeNext:function(r){return!Object(p["isEmpty"])(r)&&(!!e.isOrderComplete(r)||(Object(m["e"])("Please complete all fields"),!1))}},{id:"summary",helpText:"Summary",type:l["b"].TT_TABLE_VIEWER,options:function(e){var r=e["drugs_details"],t=["Drug Name","Frequency","Dosage","Duration"],n=r.map((function(e){return[e.other.name,e.other.frequency,"".concat(e.other.dosage," ").concat(e.other.units),"".concat(e.other.duration," days")]}));return[{label:"",value:"",other:{columns:t,rows:n}}]}}]}}}),g=t("d959"),v=t.n(g);const w=v()(b,[["render",a]]);r["default"]=w}}]);
//# sourceMappingURL=chunk-2d0ab2c7.e646e2cb.js.map