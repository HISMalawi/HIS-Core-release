(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b79078aa"],{"1c9e":function(t,e,n){"use strict";n.r(e);var a=n("7a23");function i(t,e,n,i,o,s){const p=Object(a["resolveComponent"])("his-standard-form");return Object(a["openBlock"])(),Object(a["createBlock"])(p,{fields:t.fields,onFinishAction:t.onFinish,skipSummary:!0,cancelDestinationPath:t.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}n("caad");var o=n("d95e"),s=n("7920"),p=n("2706"),c=n("b5e4"),r=n("7365"),d=n("83af"),u=n("4db7"),m=n("3e53"),h=Object(a["defineComponent"])({mixins:[r["a"]],components:{HisStandardForm:s["a"]},data:()=>({appointmentDate:"",medicationRunOutDate:"",appointment:{},app:m["a"].getActiveApp()}),watch:{ready:{async handler(t){t&&(this.appointment=new d["a"](this.patientID,this.providerID),this.init())},immediate:!0}},methods:{async onFinish(t,e){const n=await this.appointment.createEncounter();if(!n)return Object(c["e"])("Unable to create encounter");const a=await this.resolveObs(e,"obs"),i=await this.appointment.buildValueDate("Estimated date",this.appointmentDate);a.push(i);const o=await this.appointment.saveObservationList(a);if(!o)return Object(c["e"])("Unable to create Obs");Object(c["d"])("Encounter created");const s=new u["a"](this.patientID),p=["CxCa","ANC"];p.includes(this.app.applicationName)||await s.printVisitSummaryLbl(),this.nextTask()},async init(){try{const t=await this.appointment.getNextAppointment();this.appointmentDate=t.appointment_date,this.medicationRunOutDate=t.drugs_run_out_date,this.fields=this.getFields()}catch(t){Object(c["e"])("Next appointment is not available"),this.gotoPatientDashboard()}},getFields(){return[{id:"set_appointment",helpText:"Appointments booking",type:o["b"].TT_APPOINTMENTS_ENTRY,validation:t=>p["a"].required(t),computedValue:t=>({tag:"obs",obs:this.appointment.buildValueDate("Appointment date",t.value)}),config:{patientAge:this.patient.getAge(),hiddenFooterBtns:["Clear"]},options:()=>[{label:"",value:"",other:{runOutDate:this.medicationRunOutDate,appointmentDate:this.appointmentDate}}]}]}}}),l=n("6b0d"),b=n.n(l);const g=b()(h,[["render",i]]);e["default"]=g},"83af":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var a=n("cc6f");class i extends a["a"]{constructor(t,e){super(t,7,e)}async getNextAppointment(){const t=a["a"].getProgramID();return a["a"].getJson(`/programs/${t}/patients/${this.patientID}/next_appointment_date`,{date:this.date})}static async getDailiyAppointments(t){const e=a["a"].getProgramID();return a["a"].getJson(`/programs/${e}/booked_appointments`,{date:t,paginate:!1})}}}}]);
//# sourceMappingURL=chunk-b79078aa.90366e66.js.map