(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eb64d678"],{1648:function(e,t,n){"use strict";n.r(t);var r=n("7a23");function a(e,t,n,a,o,c){var i=Object(r["resolveComponent"])("date-range-picker"),u=Object(r["resolveComponent"])("ion-col"),s=Object(r["resolveComponent"])("line-chart"),l=Object(r["resolveComponent"])("ion-row"),d=Object(r["resolveComponent"])("ion-grid"),p=Object(r["resolveComponent"])("layout");return Object(r["openBlock"])(),Object(r["createBlock"])(p,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{size:"5",offset:"7",class:"ion-padding"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(i,{range:e.range,onRangeChange:e.fetchData},null,8,["range","onRangeChange"])]})),_:1}),Object(r["createVNode"])(u,{size:"12"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{series:e.series,options:e.options,onPointSelection:e.pointSelection,placeholder:"select date period"},null,8,["series","options","onPointSelection"])]})),_:1})]})),_:1})]})),_:1})]})),_:1})}var o=n("5530"),c=n("b85c"),i=n("1da1"),u=n("2909"),s=n("3835"),l=(n("96cf"),n("d81d"),n("4de4"),n("d3b7"),n("4fad"),n("99af"),n("b64b"),n("8d56")),d=n("c5be"),p=n("8a30"),f=n("2ef0"),b=n("7717"),h=n("ad8d"),m=n("b211"),O=n("23e6"),g=n("da44"),v=n("564f"),j=n("6c02"),y=n("9283"),w=n("5a0c"),C=n.n(w),I=n("0011"),x=Object(r["defineComponent"])({components:{Layout:l["a"],LineChart:d["a"],IonGrid:p["IonGrid"],IonRow:p["IonRow"],IonCol:p["IonCol"],DateRangePicker:b["a"]},setup:function(){var e=Object(j["f"])(),t=Object(r["reactive"])({}),n=Object(r["ref"])([]),a={title:{text:"Patient Vists Statistics",align:"left"}},l=function(e,t){return t.map((function(t){return e[t]}))},d=function(e,t){return t.map((function(t){return[new Date(t).getTime(),e[t].length]}))},p=function(e,t,n,r){t in n||(n[t]=[]);var a=Object.entries(e[t]).filter((function(e){var t=Object(s["a"])(e,2),n=(t[0],t[1]);return r(n.patient_present,n.guardian_present)})).map((function(e){var t=Object(s["a"])(e,1),n=t[0];return n}));return n[t]=[].concat(Object(u["a"])(n[t]),Object(u["a"])(a)),n},b=function(e){var t=Object(f["uniq"])(Object.keys(e)),n={},r={},a={};for(var o in e)p(e,o,n,(function(e,t){return e&&!t})),p(e,o,r,(function(e,t){return!e&&t})),p(e,o,a,(function(e,t){return e&&t}));return[{name:"Patient present",raw:l(n,t),data:d(n,t)},{name:"Guardian present",raw:l(r,t),data:d(r,t)},{name:"Both patient and guardian present",raw:l(a,t),data:d(a,t)}]},w=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(r){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return m["a"].show(),Object.assign(t,r),a=new h["b"],a.setStartDate(r.startDate),a.setEndDate(r.endDate),e.next=7,a.getPatientVisitTypes();case 7:o=e.sent,n.value=b(o),m["a"].hide();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var u,s,l,d,p,b,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!Object(f["isEmpty"])(n.value)){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,u=a.dataPointIndex,s=a.seriesIndex,l=s<=0?0:s,d=[{path:"arv_number",label:"ARV Number",initialSort:!0,initialSortOrder:"asc"},{path:"birthdate",label:"Date of Birth",formatter:function(e){return C()(e).format(y["a"])}},{path:"gender",label:"Gender",formatter:I["f"]},{path:"address",label:"Address"}],p=Object(r["ref"])([]),b=function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r,a,i,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=Object(c["a"])(n.value[l].raw[u]),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=12;break}return a=r.value,e.next=7,O["a"].findByID(a);case 7:i=e.sent,s=new O["a"](i),p.value.push(Object(o["a"])({arv_number:s.getArvNumber(),birthdate:s.getBirthdate(),gender:s.getGender(),address:"".concat(s.getCurrentVillage())},i));case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](1),t.e(e.t0);case 17:return e.prev=17,t.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[1,14,17,20]])})));return function(){return e.apply(this,arguments)}}(),b(),h=[{label:"Select",default:!0,action:function(t){e.push("/emc/patient/".concat(t["patient_id"]))}}],t.next=12,g["a"].show(v["a"],{title:"Patient Drilldown",columns:d,rows:p.value,rowActionButtons:h});case 12:t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](2),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}();return{range:t,series:n,options:a,fetchData:w,pointSelection:x}}}),D=n("d959"),k=n.n(D);const _=k()(x,[["render",a]]);t["default"]=_},"564f":function(e,t,n){"use strict";var r=n("7a23"),a=Object(r["createTextVNode"])("Close");function o(e,t,n,o,c,i){var u=Object(r["resolveComponent"])("IonIcon"),s=Object(r["resolveComponent"])("IonButton"),l=Object(r["resolveComponent"])("IonButtons"),d=Object(r["resolveComponent"])("IonTitle"),p=Object(r["resolveComponent"])("IonToolbar"),f=Object(r["resolveComponent"])("IonHeader"),b=Object(r["resolveComponent"])("data-table"),h=Object(r["resolveComponent"])("IonContent"),m=Object(r["resolveComponent"])("IonFooter"),O=Object(r["resolveComponent"])("IonPage");return Object(r["openBlock"])(),Object(r["createBlock"])(O,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(f,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(p,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,{slot:"end"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{slot:"end",onClick:t[1]||(t[1]=function(t){return e.modal.hide()}),"icon-only":""},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{icon:e.close},null,8,["icon"])]})),_:1})]})),_:1}),Object(r["createVNode"])(d,null,{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.title),1)]})),_:1})]})),_:1})]})),_:1}),Object(r["createVNode"])(h,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(b,{rows:e.rows,"async-rows":e.asyncRows,columns:e.columns,"row-actions-buttons":e.rowActionButtons,color:"custom"},null,8,["rows","async-rows","columns","row-actions-buttons"])]})),_:1}),Object(r["createVNode"])(m,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{class:"ion-margin ion-float-right",onClick:t[2]||(t[2]=function(t){return e.modal.hide()})},{default:Object(r["withCtx"])((function(){return[a]})),_:1})]})),_:1})]})),_:1})}var c=n("8a30"),i=n("4971"),u=n("ff79"),s=n("da44"),l=Object(r["defineComponent"])({name:"DrilldownTable",components:{DataTable:i["DataTable"],IonButton:c["IonButton"],IonPage:c["IonPage"],IonHeader:c["IonHeader"],IonContent:c["IonContent"],IonToolbar:c["IonToolbar"],IonButtons:c["IonButtons"],IonFooter:c["IonFooter"],IonTitle:c["IonTitle"],IonIcon:c["IonIcon"]},props:{title:{type:String,default:"Report"},rows:{type:Array,default:function(){return[]}},asyncRows:{type:Function},columns:{type:Array,default:function(){return[]}},rowActionButtons:{type:Array,default:function(){return[]}},actionButtons:{type:Array,default:function(){return[]}},canExportCsv:{type:Boolean,default:!1},period:{type:String,default:""}},setup:function(){return{close:u["close"],modal:s["a"]}}}),d=n("d959"),p=n.n(d);const f=p()(l,[["render",o]]);t["a"]=f},5969:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("5530"),a=n("d4ec"),o=n("bee2"),c=n("262e"),i=n("2caf"),u=(n("99af"),n("1c74")),s=n("9283"),l=n("5a0c"),d=n.n(l),p=function(e){Object(c["a"])(n,e);var t=Object(i["a"])(n);function n(){var e;return Object(a["a"])(this,n),e=t.call(this),e.endDate="",e.startDate="",e.quarter="",e.date=u["e"].getSessionDate(),e.programID=u["e"].getProgramID(),e}return Object(o["a"])(n,[{key:"getDateIntervalPeriod",value:function(){return"".concat(s["c"].toStandardHisDisplayFormat(this.startDate)," - ").concat(s["c"].toStandardHisDisplayFormat(this.endDate))}},{key:"setStartDate",value:function(e){this.startDate=e}},{key:"setEndDate",value:function(e){this.endDate=e}},{key:"setQuarter",value:function(e){this.quarter=e}},{key:"getReport",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u["e"].getJson(e,this.buildRequest(t))}},{key:"buildRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={date:this.date,program_id:this.programID};return this.startDate&&this.endDate&&(t["start_date"]=this.startDate,t["end_date"]=this.endDate),this.quarter&&(t["quarter"]=this.quarter),Object(r["a"])(Object(r["a"])({},t),e)}}],[{key:"getQuarterBounds",value:function(e){var t=function(t){return d()("".concat(e,"-").concat(t,"-01")).daysInMonth()},n=function(t){return"".concat(e,"-").concat(t,"-01 00:00")},r=function(n){return"".concat(e,"-").concat(n,"-").concat(t(n)," 00:00")};return{Q1:{qtr:1,start:n("01"),end:r("03")},Q2:{qtr:2,start:n("04"),end:r("06")},Q3:{qtr:3,start:n("07"),end:r("09")},Q4:{qtr:4,start:n("10"),end:r("12")}}}},{key:"getQtrByDate",value:function(e){var t=this.getQuarterBounds(e.getFullYear());for(var n in t){var r=t[n],a=r.start,o=r.end;if(e>=new Date(a)&&e<=new Date(o))return t[n]}return null}},{key:"buildQtrObj",value:function(e,t){var n=this.getQuarterBounds(t),r=n[e],a=r.start,o=r.end;return{start:a,end:o,name:"".concat(e," ").concat(t)}}},{key:"getReportQuarters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=new Date,r=n.getFullYear(),a=r;n=new Date("".concat(a,"-").concat(n.getMonth()+1,"-").concat(n.getDate()," 00:00"));var o=this.getQtrByDate(n),c=o.qtr,i=0;4===c&&t.push(this.buildQtrObj("Q1",r+1));while(i<e)0===i&&c<4&&t.push(this.buildQtrObj("Q".concat(c+1),r)),t.push(this.buildQtrObj("Q".concat(c),r)),c=c>0?c-=1:c,r=0==c?r-1:r,c=0==c?c+=4:c,i++;return t}}]),n}(u["e"])},7717:function(e,t,n){"use strict";var r=n("7a23");function a(e,t,n,a,o,c){var i=Object(r["resolveComponent"])("ion-input"),u=Object(r["resolveComponent"])("ion-col"),s=Object(r["resolveComponent"])("ion-icon"),l=Object(r["resolveComponent"])("ion-row"),d=Object(r["resolveComponent"])("ion-grid");return Object(r["openBlock"])(),Object(r["createBlock"])(d,{class:"ion-no-padding ion-no-margin",style:{height:"100%"}},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(l,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,{size:"6"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(i,{modelValue:e.start,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.start=t}),type:"date",class:"box",style:{width:"100%",height:"100%"}},null,8,["modelValue"])]})),_:1}),Object(r["createVNode"])(u,{size:"1",style:{display:"flex","justify-content":"center"}},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(s,{icon:e.arrowForward,style:{fontSize:"24px",padding:".5rem"}},null,8,["icon"])]})),_:1}),Object(r["createVNode"])(u,{size:"5"},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(i,{modelValue:e.end,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.end=t}),type:"date",class:"box",style:{width:"100%",height:"100%"}},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1})}var o=n("8a30"),c=n("ff79"),i=n("5a0c"),u=n.n(i),s=n("b5e4"),l=Object(r["defineComponent"])({name:"DateRangePicker",components:{IonInput:o["IonInput"],IonGrid:o["IonGrid"],IonRow:o["IonRow"],IonCol:o["IonCol"],IonIcon:o["IonIcon"]},props:{range:{type:Object,default:function(){return{startDate:"",endDate:""}}}},emits:["rangeChange"],setup:function(e,t){var n=t.emit,a=Object(r["ref"])(e.range.startDate),o=Object(r["ref"])(e.range.endDate),i=function(e,t){return!(!u()(e).isSame(t)&&!u()(e).isBefore(t))||(Object(s["e"])("Start date must be before or equal to end date"),!1)},l=Object(r["computed"])((function(){if(a.value&&o.value&&i(a.value,o.value))return{startDate:a.value,endDate:o.value}}));return Object(r["watch"])(l,(function(e){e&&n("rangeChange",e)})),{arrowForward:c["arrowForward"],start:a,end:o}}}),d=n("d959"),p=n.n(d);const f=p()(l,[["render",a]]);t["a"]=f},ad8d:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n("d4ec"),a=n("bee2"),o=n("262e"),c=n("2caf"),i=n("5969"),u=["<1 year","1-4 years","5-9 years","10-14 years","15-19 years","20-24 years","25-29 years","30-34 years","35-39 years","40-44 years","45-49 years","50-54 years","55-59 years","60-64 years","65-69 years","70-74 years","75-79 years","80-84 years","85-89 years","90 plus years"],s=function(e){Object(o["a"])(n,e);var t=Object(c["a"])(n);function n(){return Object(r["a"])(this,n),t.call(this)}return Object(a["a"])(n,[{key:"getBookedAppointments",value:function(e){return i["a"].getJson("programs/".concat(this.programID,"/scheduled_appointments"),{date:e})}},{key:"getViralLoadResults",value:function(e){return this.getReport("/programs/".concat(this.programID,"/reports/high_vl_patients"),{range:e})}},{key:"getOtherOutcome",value:function(e){return this.getReport("patient_outcome_list",{outcome:e})}},{key:"getPatientVisitTypes",value:function(){return this.getReport("patient_visit_types")}},{key:"getClientsDueForVl",value:function(){return this.getReport("clients_due_vl")}},{key:"getClientRentention",value:function(){return this.getReport("/programs/".concat(this.programID,"/reports/retention"))}},{key:"getExternalConsultationClients",value:function(){return this.getReport("".concat(this.programID,"/external_consultation_clients"))}},{key:"getMissedAppointments",value:function(){return this.getReport("missed_appointments")}},{key:"getPregnantWomen",value:function(){return this.getReport("/programs/".concat(this.programID,"/reports/pregnant_patients"))}},{key:"getArchivingCandidates",value:function(){return i["a"].getJson("programs/".concat(this.programID,"/reports/archiving_candidates"),{start_date:this.date})}},{key:"getIncompleteVisits",value:function(){return this.getReport("incomplete_visits",{tool_name:"INCOMPLETE VISITS"})}}]),n}(i["a"])},c5be:function(e,t,n){"use strict";var r=n("7a23");function a(e,t,n,a,o,c){var i=Object(r["resolveComponent"])("apex-chart"),u=Object(r["resolveComponent"])("ion-card-content"),s=Object(r["resolveComponent"])("ion-card");return Object(r["openBlock"])(),Object(r["createBlock"])(s,{class:"his-card",style:{height:"100%"}},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(u,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(i,{width:"100%",height:e.height,type:"line",options:e.chartOptions,series:e.series,onClick:t[1]||(t[1]=function(t,n,r){return e.$emit("pointSelection",r)})},null,8,["height","options","series"])]})),_:1})]})),_:1})}var o=n("5530"),c=(n("a9e3"),n("8a30")),i=n("ae27"),u=n.n(i),s=Object(r["defineComponent"])({name:"LineChart",props:{series:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return[]}},height:{type:[String,Number],default:560},placeholder:{type:String,default:"Loading data..."}},components:{IonCard:c["IonCard"],IonCardContent:c["IonCardContent"],ApexChart:u.a},emits:["pointSelection"],setup:function(e){var t=Object(r["computed"])((function(){var t={chart:{id:"line-chart",type:"line"},xaxis:{type:"datetime",tickAmount:2,labels:{show:!0,rotate:-75}},tooltip:{x:{format:"dd/MMM/yyyy"}},title:{text:"Line Chart",align:"left"},noData:{text:e.placeholder,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:"#a7a7a7",fontSize:"25px",fontFamily:"Helvetica"}}};for(var n in e.options)t[n]=Object(o["a"])(Object(o["a"])({},t[n]),e.options[n]);return t}));return{chartOptions:t}}}),l=n("d959"),d=n.n(l);const p=d()(s,[["render",a]]);t["a"]=p},da44:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("1da1"),a=(n("96cf"),n("8a30")),o={show:function(e,t){var n=arguments;return Object(r["a"])(regeneratorRuntime.mark((function r(){var o,c,i,u,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=n.length>2&&void 0!==n[2]?n[2]:"custom-modal",c=!(n.length>3&&void 0!==n[3])||n[3],r.next=4,a["modalController"].create({component:e,cssClass:o,backdropDismiss:c,componentProps:t});case 4:return i=r.sent,i.present(),r.next=8,i.onWillDismiss();case 8:if(u=r.sent,s=u.data,!s){r.next=12;break}return r.abrupt("return",s);case 12:case"end":return r.stop()}}),r)})))()},hide:function(e){return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a["modalController"].dismiss(e);case 2:case"end":return t.stop()}}),t)})))()}}}}]);
//# sourceMappingURL=chunk-eb64d678.7ca200bf.js.map