(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3fd7"],{"5eb3":function(e,t,a){"use strict";a.r(t);var o=a("7a23");const i=Object(o["createTextVNode"])(" HIV Clinic Registration "),l=Object(o["createTextVNode"])("Next"),r=Object(o["createTextVNode"])("Clear"),n=Object(o["createTextVNode"])("Back");function d(e,t,a,d,c,u){const m=Object(o["resolveComponent"])("ion-title"),s=Object(o["resolveComponent"])("text-input"),b=Object(o["resolveComponent"])("ion-col"),p=Object(o["resolveComponent"])("DateInput"),v=Object(o["resolveComponent"])("yes-no-input"),f=Object(o["resolveComponent"])("SelectInput"),V=Object(o["resolveComponent"])("NumberInput"),g=Object(o["resolveComponent"])("ion-button"),O=Object(o["resolveComponent"])("ion-row");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(m,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:Object(o["withCtx"])(()=>[i]),_:1}),Object(o["createVNode"])(O,{class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(s,{modelValue:e.form.arvNumber,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.arvNumber=t),form:e.form,prefix:e.sitePrefix+"-ARV-",disabled:!e.isNewPatient},null,8,["modelValue","form","prefix","disabled"])]),_:1}),Object(o["createVNode"])(b,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:e.form.initialVisitDate,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.initialVisitDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),Object(o["createVNode"])(b,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(v,{modelValue:e.form.shouldFollowUp,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.shouldFollowUp=t),inline:""},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(b,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(v,{modelValue:e.form.receivedArvTreatmentBefore,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.receivedArvTreatmentBefore=t),inline:""},null,8,["modelValue"])]),_:1}),"Yes"===e.form.receivedArvTreatmentBefore.value?(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:0},[Object(o["createVNode"])(b,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:e.form.dateLastTakenArvs,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.dateLastTakenArvs=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(o["createVNode"])(b,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(v,{modelValue:e.form.everRegisteredAtClinic,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.everRegisteredAtClinic=t),inline:""},null,8,["modelValue"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0),"Yes"===e.form.everRegisteredAtClinic.value?(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:1},[Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.artInitiationLocation,"onUpdate:modelValue":t[7]||(t[7]=t=>e.form.artInitiationLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:e.form.artStartDate,"onUpdate:modelValue":t[8]||(t[8]=t=>e.form.artStartDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(o["createVNode"])(b,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(V,{modelValue:e.form.initialWeight,"onUpdate:modelValue":t[9]||(t[9]=t=>e.form.initialWeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(o["createVNode"])(b,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(V,{modelValue:e.form.initialHeight,"onUpdate:modelValue":t[10]||(t[10]=t=>e.form.initialHeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.initialTBStatus,"onUpdate:modelValue":t[11]||(t[11]=t=>e.form.initialTBStatus=t),form:e.form,options:e.initialTbStatusOptions},null,8,["modelValue","form","options"])]),_:1}),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.tptHistory,"onUpdate:modelValue":t[12]||(t[12]=t=>e.form.tptHistory=t),form:e.form,options:e.tptHistoryOptions},null,8,["modelValue","form","options"])]),_:1}),e.tptDrugs.length?(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:0},[Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:e.form.tptStartDate,"onUpdate:modelValue":t[13]||(t[13]=t=>e.form.tptStartDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),e.tptDrugs.includes("INH or H (Isoniazid 300mg tablet)")?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:0,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(V,{modelValue:e.form.inhQty,"onUpdate:modelValue":t[14]||(t[14]=t=>e.form.inhQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),e.tptDrugs.includes("Rifapentine (150mg)")?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:1,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(V,{modelValue:e.form.rifapentineQty,"onUpdate:modelValue":t[15]||(t[15]=t=>e.form.rifapentineQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),e.tptDrugs.includes("INH 300 / RFP 300 (3HP)")?(Object(o["openBlock"])(),Object(o["createBlock"])(b,{key:2,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(V,{modelValue:e.form.threeHPQty,"onUpdate:modelValue":t[16]||(t[16]=t=>e.form.threeHPQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.tptStartLocation,"onUpdate:modelValue":t[17]||(t[17]=t=>e.form.tptStartLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0)],64)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.confirmatoryTest,"onUpdate:modelValue":t[18]||(t[18]=t=>e.form.confirmatoryTest=t),form:e.form,options:e.HIVTestOptions},null,8,["modelValue","form","options"])]),_:1}),"Not done"!==e.form.confirmatoryTest.value.label?(Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],{key:2},[Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(f,{modelValue:e.form.confirmatoryTestLocation,"onUpdate:modelValue":t[19]||(t[19]=t=>e.form.confirmatoryTestLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(o["createVNode"])(b,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(p,{modelValue:e.form.confirmatoryTestDate,"onUpdate:modelValue":t[20]||(t[20]=t=>e.form.confirmatoryTestDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(b,{size:"12",class:"ion-margin-top"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(g,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:Object(o["withCtx"])(()=>[l]),_:1},8,["onClick"]),Object(o["createVNode"])(g,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:Object(o["withCtx"])(()=>[r]),_:1},8,["onClick"]),e.isNewPatient?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(g,{key:0,class:"ion-margin-top ion-float-right",size:"large",onClick:t[21]||(t[21]=t=>e.$router.back()),color:"primary"},{default:Object(o["withCtx"])(()=>[n]),_:1}))]),_:1})]),_:1})],64)}var c=a("8a30"),u=a("23e6"),m=a("b5e4"),s=a("9283"),b=a("2ef0"),p=a("0db2"),v=a("5ab5"),f=a("6b6c"),V=a("ad60"),g=a("519d"),O=a("be95"),j=a("e86e"),y=a("f27f"),N=a("403e"),C=a("5a0c"),h=a.n(C),T=a("b515"),w=a("2706"),D=a("5e76"),x=a("8df6"),H=a("3b8c"),R=a("6d32"),I=a("0ba8"),A=a("b5b2"),k=Object(o["defineComponent"])({components:{IonRow:c["IonRow"],IonCol:c["IonCol"],IonTitle:c["IonTitle"],TextInput:p["a"],DateInput:v["a"],YesNoInput:f["a"],SelectInput:O["a"],NumberInput:y["a"]},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},sitePrefix:{type:String,required:!0}},emits:["onValue","onNext"],setup(e,{emit:t}){const a=Object(o["ref"])([]),i=new g["a"](e.patient.getID(),-1),l=new H["a"](e.patient.getID(),-1),r=new T["a"](e.patient.getID(),-1),n=new x["a"](e.patient.getID(),-1),d=h()().format(s["b"]),c=Object(o["computed"])(()=>{const t=e.patient.getBirthdate();return t?h()(t).format(s["b"]):""}),p=Object(o["reactive"])({arvNumber:{value:"",label:"ARV Number",placeholder:"Enter ARV Number",required:!0,validation:async(t,a)=>{if(a.arvNumber.disabled)return null;const o=w["a"].isNumber(t);if(null!==o)return o;const i=await u["a"].findByOtherID(4,`${e.sitePrefix}-ARV-${t.value}`);return Object(b["isEmpty"])(i)?null:["ARV Number already exists"]}},initialVisitDate:{value:"",label:"Registration Date",required:!0},shouldFollowUp:{value:"",label:"Agrees to follow up ?",computedValue:e=>({tag:"registration",obs:[i.buildGroupValueCoded("Agrees to followup","Home visit",e),i.buildGroupValueCoded("Agrees to followup","Phone",e)]}),required:!0},receivedArvTreatmentBefore:{value:"",label:"Ever received ARVs for treatment or prophylaxis?",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever received ART",e)}),required:!0},dateLastTakenArvs:{value:"",label:"Date last taken ARVs",placeholder:"Enter Date last taken ARVs",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART last taken",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&w["a"].required(e)},everRegisteredAtClinic:{value:"",label:"Ever registred at an ART clinic",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever registered at ART clinic",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&w["a"].required(e)},artInitiationLocation:{value:"",label:"Location of ART Initiation",computedValue:async e=>({tag:"registration",obs:i.buildValueText("Location of ART initiation",e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].required(e)},artStartDate:{value:"",label:"Date started ART",placeholder:"Date started ART",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART started",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].required(e)},initialWeight:{value:"",label:"Initial Weight",placeholder:"Enter weight",computedValue:e=>({tag:"vitals",obs:r.buildValueNumber("weight",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].validateSeries([()=>w["a"].required(e),()=>r.validator({...e,label:"Weight"})])},initialHeight:{value:"",label:"Initial Height",placeholder:"Enter height",computedValue:e=>({tag:"vitals",obs:i.buildValueNumber("Height",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].validateSeries([()=>w["a"].required(e),()=>r.validator({...e,label:"Height"})])},initialTBStatus:{value:"",label:"Initial TB Status",placeholder:"select TB status",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("TB Status at Initiation",e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].required(e)},tptHistory:{value:"",label:"TPT History",placeholder:"Select TPT history",computedValue:e=>({tag:"consultation",obs:l.buildValueText("Previous TB treatment history",e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&w["a"].required(e)},tptStartDate:{value:"",label:"Date started TPT",validation:async(e,t)=>{var a,o,i;return(null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o||null===(i=o.label)||void 0===i?void 0:i.match(/currently/i))&&w["a"].required(e)}},inhQty:{value:"",label:"INH Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&(i.match(/ipt/i)||i.includes("3HP (RFP + INH)"))&&w["a"].required(e)},computedValue:(e,t)=>{const o=a.value.find(e=>"INH or H (Isoniazid 300mg tablet)"===e.name);return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===o||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},rifapentineQty:{value:"",label:"Rifapentine Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("3HP (RFP + INH)")&&w["a"].required(e)},computedValue:(e,t)=>{const o=a.value.find(e=>"Rifapentine (150mg)"===e.name);return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===o||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},threeHPQty:{value:"",label:"INH / RFP Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("INH 300 / RFP 300 (3HP)")&&w["a"].required(e)},computedValue:(e,t)=>{const o=a.value.find(e=>"INH 300 / RFP 300 (3HP)"===e.name);return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===o||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},tptStartLocation:{value:"",label:"TPT Transfer From",validation:async(e,t)=>{var a,o,i;return(null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o||null===(i=o.label)||void 0===i?void 0:i.match(/currently/i))&&w["a"].required(e)},computedValue:e=>({tag:"consultation",obs:l.buildValueText("Location TPT last received",e.label)})},confirmatoryTest:{value:"",label:"Confirmatory Test",placeholder:"Select confirmatory test",required:!0,computedValue(e){return{tag:"registration",obs:i.buildValueCoded("Confirmatory hiv test type",e.value)}}},confirmatoryTestLocation:{value:"",label:"Location of Confirmatory",placeholder:"Select location",validation:async(e,t)=>"Not done"!==t.confirmatoryTest.value.label&&w["a"].required(e),computedValue(e){return{tag:"registration",obs:i.buildValueText("Confirmatory HIV test location",e.label)}}},confirmatoryTestDate:{value:"",label:"Confirmatory HIV Test Date",validation:async(e,t)=>"Not done"!==t.confirmatoryTest.value.label&&w["a"].required(e),computedValue:e=>({tag:"registration",obs:i.buildValueDate("Confirmatory HIV test date",e)})},patientType:{value:"New patient",computedValue:e=>({tag:"patient type",obs:n.buildValueCoded("Type of patient",e)})}});Object(o["watch"])(p.receivedArvTreatmentBefore,e=>{"No"===e.value&&(p.everRegisteredAtClinic.value="")});const v=Object(o["computed"])(()=>{var e;const t=null===(e=p.tptHistory.value)||void 0===e?void 0:e.label;if(null!==t&&void 0!==t&&t.match(/currently/i)){if(t.match(/ipt/i))return["INH or H (Isoniazid 300mg tablet)"];if(t.includes("3HP (RFP + INH)"))return["INH or H (Isoniazid 300mg tablet)","Rifapentine (150mg)"];if(t.includes("INH 300 / RFP 300 (3HP)"))return["INH 300 / RFP 300 (3HP)"]}return[]}),f=async()=>{if(await Object(m["a"])("Are you sure you want to clear all fields?"))for(const e in p)"patientType"!==e&&(p[e].value=void 0,p[e].error="");I["b"].emit(A["a"].ON_CLEAR)},O=async()=>{n.setDate(p.initialVisitDate.value),i.setDate(p.initialVisitDate.value),r.setDate(p.initialVisitDate.value),l.setDate(p.initialVisitDate.value),await Object(D["e"])(p,async(e,a)=>{t("onValue",{type:"registration",data:{formData:e,computedData:a,arvNumberEditable:!p.arvNumber.disabled}}),t("onNext")})};return Object(o["onMounted"])(async()=>{const t=e.patient.getArvNumber();if(t&&"Unknown"!==t)p.arvNumber.value=t.split("-")[2],p.arvNumber.disabled=!0;else{const e=await V["a"].getNextSuggestedARVNumber();p.arvNumber.value=e.arv_number.replace(/^\D+|\s/g,"")}R["a"].getCustomIngridients().then(e=>a.value=e)}),{today:d,patientDob:c,form:p,initialTbStatusOptions:N["c"],tptHistoryOptions:N["e"],HIVTestOptions:N["a"],tptDrugs:v,getFacilities:j["b"],onClear:f,onSubmit:O}}}),_=a("d959"),B=a.n(_);const P=B()(k,[["render",d]]);t["default"]=P}}]);
//# sourceMappingURL=chunk-2d0d3fd7.dc0ff54c.js.map