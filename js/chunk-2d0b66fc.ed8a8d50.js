(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b66fc"],{"1cc7":function(e,t,i){"use strict";i.r(t);var o=i("7a23");const n=Object(o["createVNode"])("br",null,null,-1),c=Object(o["createTextVNode"])(" Current District: "),a=Object(o["createTextVNode"])(" Home Village: "),r=Object(o["createTextVNode"])(" Re-Assign "),d=Object(o["createTextVNode"])(" Update Missing Data "),s=Object(o["createTextVNode"])(" Cancel "),l=Object(o["createTextVNode"])(" Clear ");function b(e,t,i,b,p,h){const m=Object(o["resolveComponent"])("ion-title"),O=Object(o["resolveComponent"])("ion-toolbar"),j=Object(o["resolveComponent"])("ion-header"),u=Object(o["resolveComponent"])("ion-checkbox"),C=Object(o["resolveComponent"])("ion-label"),g=Object(o["resolveComponent"])("ion-button"),k=Object(o["resolveComponent"])("ion-item"),w=Object(o["resolveComponent"])("ion-list"),N=Object(o["resolveComponent"])("ion-content"),f=Object(o["resolveComponent"])("ion-footer"),D=Object(o["resolveComponent"])("ion-page");return Object(o["openBlock"])(),Object(o["createBlock"])(D,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(j,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{class:"his-lg-text"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(o["createVNode"])(N,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(w,null,{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.items,(t,i)=>(Object(o["openBlock"])(),Object(o["createBlock"])(k,{class:"his-md-text",key:i},{default:Object(o["withCtx"])(()=>[e.ddeEnabled?(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:0,slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e},null,8,["modelValue","onUpdate:modelValue"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(C,{color:t.isComplete?"":"danger"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.name)+" ("+Object(o["toDisplayString"])(t.gender)+") "+Object(o["toDisplayString"])(t.birthdate)+" ",1),n,c,Object(o["createVNode"])("b",null,Object(o["toDisplayString"])(t.curDistrict||"Unknown"),1),a,Object(o["createVNode"])("b",null,Object(o["toDisplayString"])(t.homeVillage||"Unknown"),1)]),_:2},1032,["color"]),Object(o["createVNode"])(g,{size:"medium",onClick:()=>e.reassignIdentifier(t)},{default:Object(o["withCtx"])(()=>[r]),_:1},8,["onClick"]),t.isComplete?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(g,{key:1,size:"medium",color:"warning","router-link":"/patient/registration?edit_person="+t.patientID},{default:Object(o["withCtx"])(()=>[d]),_:2},1032,["router-link"]))]),_:2},1024))),128))]),_:1})]),_:1}),Object(o["createVNode"])(f,null,{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(O,{color:"dark"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(g,{"router-link":"/",color:"danger",slot:"start",size:"large"},{default:Object(o["withCtx"])(()=>[s]),_:1}),e.itemsChecked.length>0?(Object(o["openBlock"])(),Object(o["createBlock"])(g,{key:0,onClick:e.clear,color:"warning",slot:"end",size:"large"},{default:Object(o["withCtx"])(()=>[l]),_:1},8,["onClick"])):Object(o["createCommentVNode"])("",!0),e.itemsChecked.length>1?(Object(o["openBlock"])(),Object(o["createBlock"])(g,{key:1,onClick:t[1]||(t[1]=t=>e.onAction(e.mergeSelected,"merge")),color:"primary",size:"large",slot:"end"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" Merge ("+Object(o["toDisplayString"])(e.itemsChecked.length)+") ",1)]),_:1})):Object(o["createCommentVNode"])("",!0)]),_:1})]),_:1})]),_:1})}var p=i("8a30"),h=i("fa73"),m=i("23e6"),O=i("b5e4"),j=i("0fa1"),u=i("9283"),C=Object(o["defineComponent"])({components:{IonPage:p["D"],IonCheckbox:p["k"],IonButton:p["d"],IonList:p["y"],IonItem:p["w"],IonToolbar:p["Q"],IonHeader:p["q"],IonTitle:p["P"],IonContent:p["n"],IonFooter:p["o"]},data:()=>({dde:{},ddeEnabled:!1,items:[],title:"",npid:""}),watch:{$route:{handler({params:e}){e&&(this.npid=e.npid,this.title=`Duplicates for NPID (${this.npid})`,this.init(this.npid))},deep:!0,immediate:!0}},computed:{itemsChecked(){return this.items.filter(e=>e.isChecked)}},methods:{async onAction(e,t="proceed"){const i=await Object(O["a"])(`\n                Are you sure you want to ${t}?\n            `);if(i)try{await e()}catch(o){Object(O["e"])(""+o),console.error(o)}},async mergeSelected(){if(!this.itemsChecked.every(e=>e.isComplete))return Object(O["e"])("One or more patients have missing data. Please update them before merging.",5e3);await this.dde.postMerge(this.itemsChecked)&&(await this.dde.printNpid(this.dde.patientID),Object(j["b"])(this.dde.patientID,this.$router))},async reassignIdentifier(e){if(!e.isComplete&&this.ddeEnabled){const t=await Object(O["a"])("Do you want to update missing information?",{header:"Incomplete Demographics"});if(t){let t="edit_person="+e.patientID;t+="&dde_reassign=true",t+="&doc_id="+e.docID,this.$router.push("/patient/registration?"+t)}}else this.onAction(async()=>{this.ddeEnabled?await this.dde.reassignNpid(e.docID,e.patientID)&&await this.dde.printNpid(e.patientID):"function"===typeof e.assignLocalNpidAndPrint&&await e.assignLocalNpidAndPrint(),Object(j["b"])(e.patientID,this.$router)},"Reassign")},buildItems(e){return e.map(e=>{try{const t=new m["a"](e);return{isChecked:!1,patientID:t.getID(),name:t.getFullName(),gender:t.getGender(),birthdate:u["b"].toStandardHisDisplayFormat(t.getBirthdate()),curDistrict:t.getCurrentDistrict(),homeVillage:t.getHomeVillage(),docID:t.getPatientIdentifier(27),isComplete:t.patientIsComplete(),assignLocalNpidAndPrint:async()=>{await t.assignNpid(),await t.printNationalID()}}}catch(t){Object(O["c"])("An error has occured while building data"),console.error(t)}return{isChecked:!1,patientID:"N/A",name:"N/A",gender:"N/A",birthdate:"N/A",curDistrict:"N/A",homeVillage:"N/A",docID:"N/A",isComplete:!1}})},clear(){this.items=this.items.map(e=>(e.isChecked=!1,e))},async init(e){try{if(this.dde=new h["a"],await this.dde.loadDDEStatus(),this.ddeEnabled=this.dde.isEnabled(),this.ddeEnabled){const{locals:t,remotes:i}=await this.dde.findNpid(e);this.items=[...this.buildItems(t),...this.buildItems(i)]}else{const t=await m["a"].findByNpid(e);t&&(this.items=this.buildItems(t))}}catch(t){Object(O["c"])(""+t,5e3)}}}}),g=i("6b0d"),k=i.n(g);const w=k()(C,[["render",b]]);t["default"]=w}}]);
//# sourceMappingURL=chunk-2d0b66fc.ed8a8d50.js.map