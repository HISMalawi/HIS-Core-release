(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-770d622c"],{c7512:function(e,t,n){"use strict";n.r(t);var r=n("7a23");function a(e,t,n,a,i,o){var u=Object(r["resolveComponent"])("his-standard-form");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{cancelDestinationPath:e.cancelDestination,fields:e.fields,onFinishAction:e.onSubmit},null,8,["cancelDestinationPath","fields","onFinishAction"])}var i=n("5530"),o=n("1da1"),u=(n("d3b7"),n("25f0"),n("96cf"),n("9441")),c=n("7365"),s=n("bee2"),l=n("d4ec"),d=n("262e"),f=n("2caf"),p=n("cc6f"),b=function(e){Object(d["a"])(n,e);var t=Object(f["a"])(n);function n(e,r){return Object(l["a"])(this,n),t.call(this,e,104,r)}return Object(s["a"])(n)}(p["a"]),v=n("2706"),m=n("d95e"),h=n("e86e"),g=n("b5e4"),w=n("23e6"),x=28,T=Object(r["defineComponent"])({components:{HisStandardForm:u["a"]},mixins:[c["a"]],data:function(){return{registrationService:{}}},watch:{ready:{handler:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e&&(t.registrationService=new b(t.patient.getID(),t.providerID),t.fields=t.getFields());case 1:case"end":return n.stop()}}),n)})))()},immediate:!0,deep:!0}},methods:{onSubmit:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.asignNID(e);case 2:return r.next=4,n.registrationService.createEncounter();case 4:if(a=r.sent,a){r.next=7;break}return r.abrupt("return",Object(g["e"])("Unable to create registration encounter"));case 7:return r.next=9,n.resolveObs(Object(i["a"])({},t));case 9:return o=r.sent,r.next=12,n.registrationService.saveObservationList(o);case 12:if(u=r.sent,u){r.next=15;break}return r.abrupt("return",Object(g["e"])("Unable to save observations"));case 15:n.nextTask();case 16:case"end":return r.stop()}}),r)})))()},asignNID:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=e["national_id_available"],a=e["national_id"],!r||"Yes"!==r.value){n.next=5;break}return n.next=5,t.patient.updateMWNationalId(a.value);case 5:case"end":return n.stop()}}),n)})))()},mwIdExists:function(e){return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",!1);case 2:return t.next=4,w["a"].findByOtherID(x,e);case 4:return n=t.sent,t.abrupt("return",n.length>0);case 6:case"end":return t.stop()}}),t)})))()},getFields:function(){var e=this;return[{id:"visit_type",helpText:"Type of visit",type:m["b"].TT_SELECT,validation:function(e){return v["a"].required(e)},computedValue:function(t){return{obs:e.registrationService.buildValueCoded("Type of visit",t.value)}},options:function(){return[{label:"New",value:"New patient"},{label:"Referral",value:"Referral"},{label:"Re-visiting",value:"Re-visiting"}]}},{id:"referring_facility_name",helpText:"Referred from",type:m["b"].TT_SELECT,validation:function(e){return v["a"].required(e)},computedValue:function(t){var n=t.label;return{obs:e.registrationService.buildValueText("Referred from",n)}},condition:function(e){return"Referral"===e.visit_type.value},options:function(){return Object(h["b"])("")},config:{showKeyboard:!0,isFilterDataViaApi:!0}},{id:"national_id_available",helpText:"National ID avalable",type:m["b"].TT_SELECT,validation:function(e){return v["a"].required(e)},condition:function(){return"Unknown"===e.patient.getMWNationalID()},options:function(){return e.yesNoUnknownOptions()},appearInSummary:function(){return!1}},{id:"national_id",helpText:"Enter National ID",type:m["b"].TT_TEXT,validation:function(e){return v["a"].isMWNationalID(e)},condition:function(e){return"Yes"===e.national_id_available.value},beforeNext:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=n.value,!t.t0){t.next=5;break}return t.next=4,e.mwIdExists(n.value.toString());case 4:t.t0=t.sent;case 5:if(!t.t0){t.next=8;break}return Object(g["e"])("National ID already exists"),t.abrupt("return",!1);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}(),summaryMapValue:function(e){var t=e.value;return{value:t,label:"National ID"}},config:{casing:"uppercase"}},{id:"patient_pregnant",helpText:"Patient pregnant",type:m["b"].TT_SELECT,validation:function(e){return v["a"].required(e)},computedValue:function(t){var n=t.value;return{obs:e.registrationService.buildValueCoded("PATIENT PREGNANT",n)}},condition:function(){return e.patient.isChildBearing()},options:function(){return e.yesNoUnknownOptions()}}]}}}),O=n("d959"),k=n.n(O);const y=k()(T,[["render",a]]);t["default"]=y}}]);
//# sourceMappingURL=chunk-770d622c.ba04fb08.js.map