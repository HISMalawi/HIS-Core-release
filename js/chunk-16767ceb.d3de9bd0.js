(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16767ceb"],{7920:function(e,t,n){"use strict";var i=n("7a23");function r(e,t,n,r,a,o){return Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(e.formType),{fields:e.fields,skipSummary:e.skipSummary,activeField:e.activeField,cancelDestinationPath:e.cancelDestinationPath,onOnFinish:e.onFinish,onFinish:e.onFinishAction,onOnIndex:e.onIndex},null,8,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var a=n("9441"),o=Object(i["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:a["a"]},emits:["onFinish","onIndex"],data:function(){return{formType:"touch-screen-form"}},props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish:function(e,t){this.$emit("onFinish",e,t)},onIndex:function(e){this.$emit("onIndex",e)}}}),c=n("d959"),s=n.n(c);const u=s()(o,[["render",r]]);t["a"]=u},"7dd5":function(e,t,n){"use strict";n.r(t);var i=n("7a23");function r(e,t,n,r,a,o){var c=Object(i["resolveComponent"])("his-standard-form");return Object(i["openBlock"])(),Object(i["createBlock"])(c,{fields:e.fields,activeField:e.activeField,onFinishAction:e.onFinish,skipSummary:!0},null,8,["fields","activeField","onFinishAction"])}var a=n("1da1"),o=(n("d81d"),n("d3b7"),n("159b"),n("96cf"),n("d95e")),c=n("7920"),s=n("2706"),u=n("9283"),d=n("3d6c"),l=n("b5e4"),h=n("0011"),p=Object(i["defineComponent"])({components:{HisStandardForm:c["a"]},data:function(){return{activeField:"",fields:[],drugs:[],selectedDrugs:[],barcode:"",stockService:{}}},methods:{onFinish:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var i,r,a,o,c,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:i=e.enter_batches,r=[],a=0;case 3:if(!(a<i.length)){n.next=13;break}return o=i[a].value,c={current_quantity:o["current_quantity"],reason:e.reason.value},n.next=8,t.stockService.updateItem(o["id"],c);case 8:s=n.sent,s||r.push("could not stock for "+i[a].shortName);case 10:a++,n.next=3;break;case 13:0===r.length?(Object(l["d"])("Stock succesfully updated"),t.$router.push("/")):Object(l["c"])("Could not save stock");case 14:case"end":return n.stop()}}),n)})))()},getFields:function(){var e=this;return[{id:"date",helpText:"Verfication Date",type:o["b"].TT_FULL_DATE,validation:function(e){return s["a"].required(e)}},{id:"enter_batches",helpText:"Batch entry",type:o["b"].TT_BATCH_VERIFICATION,options:function(){return e.drugs},validation:function(e){return s["a"].required(e)}},{id:"reason",helpText:"Select reason",type:o["b"].TT_SELECT,validation:function(e){return s["a"].required(e)},options:function(){return[{label:"Monthly stock take",value:"Monthly stock take"},{label:"Audit",value:"Audit"},{label:"Adhoc (due to stock imbalance)",value:"Adhoc (due to stock imbalance)"},{label:"Supervision",value:"Supervision"}]}},{id:"verification_summary",helpText:"Summary",type:o["b"].TT_TABLE_VIEWER,options:function(t){return e.buildResults(t.enter_batches)},config:{hiddenFooterBtns:["Clear"]}}]},buildResults:function(e){var t=["Drug","Total units","Expiry date"],n=e.map((function(e){var t=e.value;return[t.shortName,Object(h["g"])(t["current_quantity"]),u["c"].toStandardHisDisplayFormat(t.expiry_date)]}));return[{label:"Confirm entry",value:"Table",other:{columns:t,rows:n}}]},prepDrugs:function(e){var t=[],n=this.barcode;return e.enter_batches.value.forEach((function(i){t.push({batch_number:i.batchNumber,items:[{barcode:n,drug_id:i.drugID,expiry_date:i.expiry,quantity:parseInt(i.tabs)*parseInt(i.tins),delivery_date:e.date.value}]})})),t},selectAll:function(e){return e.map((function(e){return e.isChecked=!0,e}))},formatDrugs:function(){return this.stockService.drugList().map((function(e){return{label:e.shortName,value:e}}))}},created:function(){this.stockService=new d["a"],this.fields=this.getFields(),this.drugs=this.formatDrugs()}}),f=n("d959"),m=n.n(f);const b=m()(p,[["render",r]]);t["default"]=b}}]);
//# sourceMappingURL=chunk-16767ceb.d3de9bd0.js.map