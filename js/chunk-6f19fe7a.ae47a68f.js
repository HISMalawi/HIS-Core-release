(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6f19fe7a"],{3822:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n("b85c"),o=n("2909"),a=n("3835"),i=n("d4ec"),s=n("bee2"),c=n("262e"),l=n("2caf"),u=(n("4fad"),n("99af"),n("b0c0"),n("fcd5")),d=function(e){Object(c["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(i["a"])(this,n),e=t.call(this),e.regenerate=!1,e}return Object(s["a"])(n,[{key:"setRegenerate",value:function(e){this.regenerate=e}},{key:"requestHMIS15",value:function(){return this.getReport("generate_hmis_15_report",{request:"true"})}},{key:"requestHMIS17",value:function(){return this.getReport("generate_hmis_17_report",{request:"true"})}},{key:"renderResults",value:function(e){for(var t=[],n=1,r=0,i=Object.entries(e);r<i.length;r++){var s=Object(a["a"])(i[r],2),c=s[0],l=s[1],u=[],d=l,p={id:0,name:"",total:0,totalPatientIds:""};p.name=c;var m=0;p.id=n,n+=1;for(var b=0,f=Object.entries(d);b<f.length;b++){var h=Object(a["a"])(f[b],2),g=(h[0],h[1]),v=g;null!=v&&(m+=v.length,p.total=m,v.length&&(u.push.apply(u,Object(o["a"])(v)),p.totalPatientIds=u))}t.push(p)}return t}},{key:"getCSVString",value:function(e){var t,n="Diseases/Events/Conditions, #,\n",o=Object(r["a"])(e);try{for(o.s();!(t=o.n()).done;){var a=t.value,i="".concat(a.name,",").concat(a.total,",\n");n+=i}}catch(s){o.e(s)}finally{o.f()}return{CSVString:n}}}]),n}(u["d"])},"39a4":function(e,t,n){"use strict";n.r(t);var r=n("7a23"),o={id:"report-content"},a=Object(r["createVNode"])("div",{id:"print"},null,-1);function i(e,t,n,i,s,c){var l=Object(r["resolveComponent"])("ion-loading"),u=Object(r["resolveComponent"])("his-standard-form"),d=Object(r["resolveComponent"])("hmis-header"),p=Object(r["resolveComponent"])("hmis-template"),m=Object(r["resolveComponent"])("ion-content"),b=Object(r["resolveComponent"])("his-footer"),f=Object(r["resolveComponent"])("ion-page");return Object(r["openBlock"])(),Object(r["createBlock"])(r["Fragment"],null,[Object(r["createVNode"])(l,{"is-open":e.isLoading,message:"Please wait..."},null,8,["is-open"]),e.reportReady?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createBlock"])(u,{key:0,onOnFinish:e.onPeriod,skipSummary:!0,fields:e.fields},null,8,["onOnFinish","fields"])),e.reportReady?(Object(r["openBlock"])(),Object(r["createBlock"])(f,{key:1},{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(m,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])("div",o,[Object(r["createVNode"])(d,{key:e.componentKey,reportName:e.reportName,ref:"header",periodLabel:e.periodLabel,periodDates:e.periodDates,clinicName:e.clinicName,totalOPDVisits:e.TotalOPDVisits},null,8,["reportName","periodLabel","periodDates","clinicName","totalOPDVisits"]),Object(r["createVNode"])(p,{key:e.componentKey,reportName:e.reportName,onDrillDown:e.onDrillDown,params:e.hmis15Data,periodDates:e.periodDates,ref:"rep"},null,8,["reportName","onDrillDown","params","periodDates"])])]})),_:1}),Object(r["createVNode"])(b,{btns:e.btns},null,8,["btns"])]})),_:1})):Object(r["createCommentVNode"])("",!0),a],64)}var s=n("1da1"),c=(n("96cf"),n("0f25")),l=n("8a30"),u=n("7920"),d=n("c2b0"),p=n("3822"),m=n("cb01"),b=n("9d7f"),f=n("9283"),h=Object(r["defineComponent"])({mixins:[d["a"]],components:{IonLoading:l["z"],HmisHeader:m["a"],HmisTemplate:b["a"],HisStandardForm:u["a"],HisFooter:c["a"],IonPage:l["F"],IonContent:l["n"]},data:function(){return{formData:{},componentKey:0,computedFormData:{},hmis15Data:{},btns:[],isLoading:!1,fields:[],reportID:-1,periodLabel:"Period",periodDates:"",reportName:"HMIS 15",TotalOPDVisits:0,clinicName:p["a"].getLocationName(),reportReady:!1}},created:function(){this.btns=this.getBtns(),this.fields=this.getDateDurationFields()},methods:{onPeriod:function(e,t){var n=arguments,r=this;return Object(s["a"])(regeneratorRuntime.mark((function o(){var a,i,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=n.length>2&&void 0!==n[2]&&n[2],r.componentKey+=1,r.formData=e,r.computedFormData=t,r.reportReady=!0,r.isLoading=!0,r.report=new p["a"],r.report.setRegenerate(a),r.report.setStartDate(f["b"].toStandardHisFormat(t.start_date)),r.report.setEndDate(f["b"].toStandardHisFormat(t.end_date)),r.periodDates=r.report.getReportPeriod(),o.prev=11,o.next=14,r.report.requestHMIS15();case 14:return i=o.sent,o.next=17,r.report.getClinicRegistrations();case 17:s=o.sent,i&&s&&(r.reportID="data",r.TotalOPDVisits=s.length,r.hmis15Data=i),o.next=24;break;case 21:o.prev=21,o.t0=o["catch"](11),console.log(o.t0);case 24:return o.prev=24,r.isLoading=!1,o.finish(24);case 27:case"end":return o.stop()}}),o,null,[[11,21,24,27]])})))()},getBtns:function(){var e=this;return[{name:"CSV",size:"large",slot:"start",color:"primary",visible:!0,onClick:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.$refs.rep,n.onDownload();case 2:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{name:"PDF",size:"large",slot:"start",color:"primary",visible:!0,onClick:function(){return e.exportToCustomPDF(e.reportName)}},{name:"Back",size:"large",slot:"end",color:"warning",visible:!0,onClick:function(){return e.reportReady=!1}},{name:"Refresh",size:"large",slot:"end",color:"warning",visible:!0,onClick:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.onPeriod(e.formData,e.computedFormData,!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{name:"Finish",size:"large",slot:"end",color:"success",visible:!0,onClick:function(){return e.$router.push({path:"/"})}}]}}}),g=n("6b0d"),v=n.n(g);const D=v()(h,[["render",i]]);t["default"]=D},"9d7f":function(e,t,n){"use strict";var r=n("7a23"),o={class:"my-table",style:{margin:"auto",width:"95%","margin-top":"3%","margin-bottom":"3%"}};function a(e,t,n,a,i,s){var c=Object(r["resolveComponent"])("report-table");return Object(r["openBlock"])(),Object(r["createBlock"])("div",o,[Object(r["createVNode"])(c,{columns:e.columns,rows:e.rows,config:{tableCssTheme:e.tableCssTheme}},null,8,["columns","rows","config"])])}var i=n("1da1"),s=(n("96cf"),n("99af"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("159b"),n("b0c0"),n("3822")),c=n("1c74"),l=n("5a0c"),u=n.n(l),d=n("80e3"),p=n("9ceb"),m=Object(r["defineComponent"])({components:{ReportTable:d["a"]},data:function(){return{conditions:[],tableCssTheme:"opd-report-theme",total:" Total ",rows:[],columns:[[p["a"].thTxt(""),p["a"].thTxt("Diseases/Events/Conditions"),p["a"].thTxt("UNVERIFIED"),p["a"].thTxt("VERIFIED")]]}},props:["params","periodDates","quarter","onDrillDown","reportName"],methods:{renderResults:function(){var e=new s["a"],t=e.renderResults(this.params);t.length&&(this.conditions=t,this.rows=this.buildRows(t))},onDownload:function(){var e=new s["a"],t=e.getCSVString(this.conditions),n=t.CSVString;n+="\n          Date Created: ".concat(u()().format("DD/MMM/YYYY HH:MM:ss"),"\n          His-Core Version: ").concat(c["e"].getCoreVersion(),"\n          API Version: ").concat(c["e"].getApiVersion(),"\n          Report Period: ").concat(this.periodDates,"\n          Site: ").concat(c["e"].getLocationName(),"\n          Site UUID: ").concat(c["e"].getSiteUUID());var r=new Blob([n],{type:"text/csv;charset=utf-8;"}),o="".concat(c["e"].getLocationName()," ").concat(this.reportName," ").concat(this.quarter);if(navigator.msSaveBlob)navigator.msSaveBlob(r,"exportFilename");else{var a=document.createElement("a");a.href=window.URL.createObjectURL(r),a.setAttribute("download","".concat(o,".csv")),document.body.appendChild(a),a.click(),document.body.removeChild(a)}},buildRows:function(e){var t=this,n=[];return e.forEach((function(e){n.push([p["a"].td(e.id,{style:{textAlign:"left"}}),p["a"].td(e.name,{style:{textAlign:"left"}}),t.buildRow(t.total+"("+e.name+")",e.total,e.totalPatientIds),p["a"].td("")])})),n},buildRow:function(e,t,n){var r=this;return t>0?p["a"].tdLink(t,Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",r.onDrillDown(e,n));case 1:case"end":return t.stop()}}),t)})))):p["a"].td(0)}},watch:{params:{immediate:!0,handler:function(){this.renderResults()}}}}),b=n("6b0d"),f=n.n(b);const h=f()(m,[["render",a]]);t["a"]=h}}]);
//# sourceMappingURL=chunk-6f19fe7a.ae47a68f.js.map