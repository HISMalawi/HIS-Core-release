(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4381"],{"0605":function(e,t,a){"use strict";a.r(t);var i=a("7a23");function o(e,t,a,o,n,s){const r=Object(i["resolveComponent"])("his-standard-form");return Object(i["openBlock"])(),Object(i["createBlock"])(r,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!1,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}a("caad");var n=a("d95e"),s=a("7920"),r=a("2706"),l=a("7365"),c=a("cc6f");class p extends c["a"]{constructor(e,t){super(e,182,t)}async getSummary(){const e=await this.getFirstValueCoded("Screening results"),t=await this.getFirstValueCoded("Directly observed treatment option"),a=await this.getFirstValueCoded("Referral reason");return{"Screening Result":e,"Treatment Type":t,"Referral Reason":a||"N/A"}}}var d=a("b5e4"),m=a("ad60"),u=a("9ceb"),h=Object(i["defineComponent"])({mixins:[l["a"]],components:{HisStandardForm:s["a"]},data:()=>({reception:{},summaryData:{},referralReason:""}),watch:{patient:{async handler(){this.reception=new p(this.patientID,this.providerID),this.summaryData=await this.reception.getSummary(),await this.setReason(),this.fields=this.getFields()},deep:!0}},methods:{async setReason(){const e=await this.reception.getFirstValueCoded("Referral reason");this.referralReason=e||"N/A"},showSampleCollected(){const e=["Large Lesion (>75%)","Suspect cancer","Further Investigation and Management"];return e.includes(this.referralReason)},async onFinish(e,t){const a=await this.reception.createEncounter();if(!a)return Object(d["e"])("Unable to create encounter");const i=m["a"].getProgramID(),o=await m["a"].getProgramWorkflows(m["a"].getProgramID()),n={};o.forEach(e=>{e.states.forEach(e=>{const t=e.program_workflow_state_id,a=e.concept.concept_names[0].name;n[a]=t})});const s=e.patient_outcome?e.patient_outcome.value:"Continue follow-up",r={location_id:m["a"].getLocationName(),state:n[s],date:m["a"].getSessionDate()},l=await m["a"].createState(this.patientID,i,r);if(!l)return Object(d["e"])("Unable to update state");const c=[];Object.keys(t).forEach(e=>{c.push(t[e].obs)});const p=await Promise.all([...c]),u=await this.reception.saveObservationList(p);if(!u)return Object(d["e"])("Unable to save patient observations");Object(d["d"])("Observations and encounter created!"),this.nextTask()},getFields(){return[{id:"screening_summary",helpText:"Screening Summary",type:n["b"].TT_DATA_TABLE,config:{rows:()=>Object.keys(this.summaryData).map(e=>[u["a"].td(e),u["a"].td(this.summaryData[e])]),dataTableConfig:{showIndex:!1}}},{id:"figo_staging_results",helpText:"FIGO staging results",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:()=>this.referralReason.match(/suspect/gi),options:()=>this.mapOptions(["Cervical stage 1","Cervical stage 2","Cervical stage 3","Cervical stage 4","Not available"]),computedValue:e=>({obs:this.reception.buildValueText("FIGO staging of cervical cancer",e.label)})},{id:"type_of_sample_collected",helpText:"Type of sample collected",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:()=>this.showSampleCollected(),options:()=>this.mapOptions(["Punch Biopsy","LLETZ sample","Not available"]),computedValue:e=>({obs:this.reception.buildValueText("Sample",e.label)})},{id:"histology_results",helpText:"Histology results",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>"Not available"!==e.type_of_sample_collected.value&&this.showSampleCollected(),options:()=>this.mapOptions(["Normal","CIN 1","CIN 2","CIN 3","Carcinoma in Situ","Invasive cancer of cervix","Benign cervical warts","Not available"]),computedValue:e=>({obs:this.reception.buildValueText("Sample",e.label)})},{id:"complications",helpText:"Complications",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:e=>"Not available"!==e.type_of_sample_collected.value&&this.showSampleCollected(),options:()=>this.mapOptions(["Bleeding","Pain","None"]),computedValue:e=>({obs:this.reception.buildValueText("Complications",e.label)})},{id:"referral_outcome",helpText:"Treatment performed",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),options:()=>this.mapOptions(["Hysterectomy","Cryotherapy","Leep","Palliative Care","LLETZ","Conisation","Thermocoagulation","Chronic cervicitis","Patient refused"]),computedValue:e=>({obs:this.reception.buildValueText("Treatment",e.label)})},{id:"recommended_plan_of_care",helpText:"Recommended plan of care",type:n["b"].TT_SELECT,validation:e=>r["a"].required(e),condition:()=>"Same day treatment"!==this.summaryData["Treatment Type"],options:()=>this.mapOptions(["Hysterectomy","Trachelectomy","Discharged","Continue follow-up"]),computedValue:e=>({obs:this.reception.buildValueText("Recommended Plan of care",e.label)})},{id:"patient_outcome",helpText:"Patient outcome",type:n["b"].TT_SELECT,condition:()=>"Same day treatment"!==this.summaryData["Treatment Type"],validation:e=>r["a"].required(e),options:()=>this.mapOptions(["Continue follow-up","Pallialative care","No Dysplasia/Cancer","Patient died"])}]}}}),b=a("6b0d"),T=a.n(b);const y=T()(h,[["render",o]]);t["default"]=y}}]);
//# sourceMappingURL=chunk-2d0a4381.0fe82cc1.js.map