(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d56df1c4"],{"7bdc":function(e,t,i){"use strict";i.r(t);var n=i("7a23");function o(e,t,i,o,r,s){const a=Object(n["resolveComponent"])("report-template");return Object(n["openBlock"])(),Object(n["createBlock"])(a,{title:e.title,period:e.period,rows:e.rows,fields:e.fields,columns:e.columns,canExportCsv:!1,canExportPDf:!1,onReportConfiguration:e.onPeriod},null,8,["title","period","rows","fields","columns","onReportConfiguration"])}var r=i("4ba2"),s=i("d95e"),a=i("9ceb"),c=i("fb25"),d=i("2706");const l={key:0},p={key:1},u=Object(n["createTextVNode"])(" Close ");function b(e,t,i,o,r,s){const a=Object(n["resolveComponent"])("ion-title"),c=Object(n["resolveComponent"])("ion-toolbar"),d=Object(n["resolveComponent"])("ion-header"),b=Object(n["resolveComponent"])("his-basic-table"),f=Object(n["resolveComponent"])("text-skeloton"),m=Object(n["resolveComponent"])("ion-content"),h=Object(n["resolveComponent"])("ion-button"),w=Object(n["resolveComponent"])("ion-footer");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Fragment"],null,[Object(n["createVNode"])(d,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(a,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])(()=>[e.ready?(Object(n["openBlock"])(),Object(n["createBlock"])("div",l,[Object(n["createVNode"])(b,{columns:e.columns,rows:e.rows},null,8,["columns","rows"])])):(Object(n["openBlock"])(),Object(n["createBlock"])("div",p,[Object(n["createVNode"])(f)]))]),_:1}),Object(n["createVNode"])(w,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(h,{color:"danger",onClick:e.closeModal,slot:"end"},{default:Object(n["withCtx"])(()=>[u]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}var f=i("a3a5"),m=i("8a30"),h=i("ded6"),w=Object(n["defineComponent"])({components:{HisBasicTable:f["a"],IonHeader:m["q"],IonToolbar:m["Q"],IonContent:m["n"],IonFooter:m["o"],IonButton:m["d"],TextSkeloton:h["a"]},props:{title:{type:String,required:!0},columns:{type:Object,required:!0},onRows:{type:Function,required:!0}},data:()=>({rows:[],ready:!1}),watch:{onRows:{async handler(e){e&&(this.rows=await e(),this.ready=!0)},immediate:!0,deep:!0}},methods:{async closeModal(){await m["X"].dismiss({})}}}),y=i("6b0d"),j=i.n(y);const O=j()(w,[["render",b]]);var g=O,v=i("23e6"),C=i("9283"),T=i("fa73"),x=i("b5e4"),I=Object(n["defineComponent"])({components:{ReportTemplate:r["a"]},data:()=>({service:{},dde:{},title:"Duplicate Identifiers",fields:[],rows:[],columns:[[a["a"].thTxt("Identifier"),a["a"].thTxt("Count"),a["a"].thTxt("View"),a["a"].thTxt("Resolve")]]}),async created(){this.fields=this.getFormFields(),this.dde=new T["a"],await this.dde.loadDDEStatus()},methods:{async onPeriod({identifier:e}){const t=parseInt(e.value.toString());this.title=e.label+" Duplicates",this.service=new c["a"],this.service.setIdentifierType(t),this.rows=await this.getRows()},getFormFields(){return[{id:"identifier",helpText:"Select Identifier type",type:s["b"].TT_SELECT,validation:e=>d["a"].required(e),options:async()=>(await c["a"].getIdentifierTypes()).map(e=>({label:e.name,value:e.patient_identifier_type_id}))}]},toDate(e){return C["b"].toStandardHisDisplayFormat(e)},async drillDuplicates(e){const t=await m["X"].create({component:g,cssClass:"custom-modal",componentProps:{title:"Persons using identifier "+e,columns:["Given name","Family name","Gender","Birth date","Action"],onRows:async()=>{const t=await this.service.getPatientsByIdentifier(e);return t.map(e=>{try{const t=new v["a"](e);return[t.getGivenName(),t.getFamilyName(),t.getGender(),this.toDate(t.getBirthdate()),{type:"button",name:"View",action:()=>{m["X"].dismiss().then(()=>{this.$router.push("/patient/dashboard/"+t.getID())})}}]}catch(t){return Object(x["c"])("Unable to load patient details"),["N/A","N/A","N/A","N/A","N/A"]}})}}});t.present()},async getRows(){return(await this.service.getDuplicateIndentifiers()).map(e=>[a["a"].td(e.identifier),a["a"].td(e.count),a["a"].tdBtn("Select",()=>this.drillDuplicates(e.identifier)),a["a"].tdBtn("Resolve",()=>{this.$router.push("/npid/duplicates/"+e.identifier)},{event:{disabled:3!=this.service.getIdentifierType()}},"danger")])}}});const N=j()(I,[["render",o]]);t["default"]=N},fb25:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("1c74");class o extends n["e"]{constructor(){super(),this.identifierType=-1}static getIdentifierTypes(){return super.getJson("types/patient_identifiers")}static async arvNumberExists(e){const t=await super.getJson(`programs/${super.getProgramID()}/lookup_arv_number/${e}`);return t.exists}getIdentifierType(){return this.identifierType}setIdentifierType(e){this.identifierType=e}getDuplicateIndentifiers(){return n["e"].getJson("search/identifiers/duplicates",{type_id:this.identifierType})}getPatientsByIdentifier(e){return n["e"].getJson("search/patients/by_identifier",{type_id:this.identifierType,identifier:e})}}}}]);
//# sourceMappingURL=chunk-d56df1c4.a876ea3f.js.map