(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-182277b5","TouchFormElement38"],{"0a79":function(t,e,n){"use strict";var i=n("7a23");function o(t,e,n,o,r,a){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{id:"view-port",class:Object(i["normalizeClass"])(t.showFull?"":"half")},[Object(i["renderSlot"])(t.$slots,"default",{},void 0,!0)],2)}var r=Object(i["defineComponent"])({name:"ViewPort",props:{showFull:{type:Boolean,default:()=>!0}}}),a=(n("a4d3"),n("6b0d")),l=n.n(a);const c=l()(r,[["render",o],["__scopeId","data-v-7c293cad"]]);e["a"]=c},"2b47":function(t,e,n){"use strict";var i=n("7a23");const o={class:"tool-bar-medium-card"};function r(t,e,n,r,a,l){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",o,[Object(i["renderSlot"])(t.$slots,"default")])}var a=Object(i["defineComponent"])({name:"ToolBarMediumCard"}),l=n("6b0d"),c=n.n(l);const s=c()(a,[["render",r]]);e["a"]=s},"369d":function(t,e,n){"use strict";n("88b2")},"4a21":function(t,e,n){},"7e73":function(t,e,n){"use strict";n("13d5"),n("14d9");function i(t,e=2){return t.reduce((n,i,o)=>(o%e===0&&n.push(t.slice(o,o+e)),n),[])}function o(t,e){return Object.keys(t).sort((t,n)=>e(t,n)).reduce((e,n)=>(e[n]=t[n],e),{})}e["a"]={convertArrayToTurples:i,orderObj:o}},"88b2":function(t,e,n){},9441:function(t,e,n){"use strict";var i=n("7a23");function o(t,e,n,o,r,a){const l=Object(i["resolveComponent"])("ion-title"),c=Object(i["resolveComponent"])("ion-col"),s=Object(i["resolveComponent"])("info-card"),d=Object(i["resolveComponent"])("ion-row"),u=Object(i["resolveComponent"])("ion-toolbar"),h=Object(i["resolveComponent"])("ion-header"),m=Object(i["resolveComponent"])("ion-content"),f=Object(i["resolveComponent"])("ion-button"),p=Object(i["resolveComponent"])("ion-footer"),b=Object(i["resolveComponent"])("ion-page");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.currentField)+" ",1),Object(i["createVNode"])(b,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(h,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(u,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(d,null,{default:Object(i["withCtx"])(()=>{var e;return[Object(i["createVNode"])(c,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(l,{class:"his-lg-text"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(t.helpText),1)]),_:1})]),_:1}),null!==(e=t.currentField)&&void 0!==e&&null!==(e=e.config)&&void 0!==e&&e.toolbarInfo?(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0},{default:Object(i["withCtx"])(()=>{var e;return[Object(i["createVNode"])(s,{style:{height:"100%"},items:null===(e=t.currentField)||void 0===e||null===(e=e.config)||void 0===e?void 0:e.toolbarInfo},null,8,["items"])]}),_:1})):Object(i["createCommentVNode"])("",!0)]}),_:1})]),_:1})]),_:1}),Object(i["createVNode"])(m,null,{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(),Object(i["createBlock"])(i["KeepAlive"],null,[(Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(t.currentField.type),{key:t.currentField.id,config:t.currentField.config,options:t.currentField.options,preset:t.currentField.preset,clear:t.valueClearIndex,fdata:t.formData,cdata:t.computedFormData,activationState:t.state,onValue:t.currentField.onValue,defaultValue:t.currentField.defaultValue,onValueUpdate:t.currentField.onValueUpdate,footerButtonEvent:t.ftBtnEvent,onOnValue:t.onFieldValue,onOnFieldActivated:t.onFieldActivated},null,40,["config","options","preset","clear","fdata","cdata","activationState","onValue","defaultValue","onValueUpdate","footerButtonEvent","onOnValue","onOnFieldActivated"]))],1024))]),_:1}),Object(i["createVNode"])(p,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(u,{color:"dark"},{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.footerBtns,(e,n)=>Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createBlock"])(f,{key:n,slot:e.slot||"start",class:Object(i["normalizeClass"])(e.styleClass),onClick:n=>t.onFtButtonClicked(e),color:e.color||"primary",size:e.size||"large",disabled:t.onDisabledBtnState(e,"disabled",!1)},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.name),1)]),_:2},1032,["slot","class","onClick","color","size","disabled"])),[[i["vShow"],t.onVisibleBtnState(e,"visible")]])),128))]),_:1})]),_:1})]),_:1})],64)}n("14d9");var r=n("d95e"),a=n("2ef0"),l=n("d867"),c=n("b5e4");function s(t,e,n,o,r,a){const l=Object(i["resolveComponent"])("ion-col"),c=Object(i["resolveComponent"])("ion-row"),s=Object(i["resolveComponent"])("ion-grid"),d=Object(i["resolveComponent"])("tool-bar-medium-card");return Object(i["openBlock"])(),Object(i["createBlock"])(d,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(s,null,{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.rowItems,(t,e)=>(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:e},{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t,(t,e)=>(Object(i["openBlock"])(),Object(i["createBlock"])(l,{class:"col his-sm-text",key:e},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("b",null,Object(i["toDisplayString"])(t.label)+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(t.value),1)]),_:2},1024))),128))]),_:2},1024))),128))]),_:1})]),_:1})}var d=n("2b47"),u=n("7e73"),h=Object(i["defineComponent"])({name:"HisResultCard",components:{ToolBarMediumCard:d["a"],IonGrid:l["p"],IonCol:l["m"],IonRow:l["H"]},props:{items:{type:Object,required:!0}},computed:{rowItems(){return u["a"].convertArrayToTurples(this.items,2)}}}),m=(n("369d"),n("6b0d")),f=n.n(m);const p=f()(h,[["render",s],["__scopeId","data-v-1842fa50"]]);var b=p;const F=t=>(Object(i["pushScopeId"])("data-v-0c98acd2"),t=t(),Object(i["popScopeId"])(),t),v=F(()=>Object(i["createElementVNode"])("div",{class:"linear-background"},[Object(i["createElementVNode"])("div",{class:"inter-draw"}),Object(i["createElementVNode"])("div",{class:"inter-crop"}),Object(i["createElementVNode"])("div",{class:"inter-right--top"}),Object(i["createElementVNode"])("div",{class:"inter-right--bottom"})],-1));function O(t,e,n,o,r,a){const l=Object(i["resolveComponent"])("view-port");return Object(i["openBlock"])(),Object(i["createBlock"])(l,null,{default:Object(i["withCtx"])(()=>[v]),_:1})}var j=n("0a79"),C=Object(i["defineComponent"])({components:{ViewPort:j["a"]}});n("9761");const y=f()(C,[["render",O],["__scopeId","data-v-0c98acd2"]]);var B=y;const x=Object(i["createElementVNode"])("div",{class:"vertically-align"}," Error Loading form element. Exit app and try again and check your network. ",-1);function k(t,e,n,o,r,a){const l=Object(i["resolveComponent"])("view-port");return Object(i["openBlock"])(),Object(i["createBlock"])(l,null,{default:Object(i["withCtx"])(()=>[x]),_:1})}var D=Object(i["defineComponent"])({components:{ViewPort:j["a"]}});const g=f()(D,[["render",k]]);var V=g;function w(){const t={};return r["a"].forEach(e=>{t[e]=Object(i["defineAsyncComponent"])({loader:()=>n("f159")(`./${e}.vue`),loadingComponent:B,errorComponent:V,delay:150,timeout:5e4})}),t}var I=Object(i["defineComponent"])({name:"TouchscreenForm",components:{InfoCard:b,IonButtons:l["e"],IonPage:l["D"],IonContent:l["n"],IonFooter:l["o"],IonToolbar:l["S"],IonButton:l["d"],IonHeader:l["q"],IonTitle:l["R"],IonCol:l["m"],IonRow:l["H"],...w()},emits:["onFinish","onIndex"],props:{onFinish:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String},disableAutoModalDismiss:{type:Boolean},cancelAction:{type:Function}},data:()=>({ftBtnEvent:{eventIndex:0,btnName:"",btnOutput:null},helpText:"",valueClearIndex:0,currentIndex:0,currentField:{},currentFieldContext:null,formData:{},computedFormData:{},footerBtns:[],currentFields:[],fieldsInitialisedOnce:{},state:""}),watch:{fields:{async handler(t){if(!Object(a["isEmpty"])(t)){this.buildFormData(t);let e=t;this.skipSummary||(e=[...e,this.getDefaultSummaryField()]),this.currentFields=e,this.activeField?this.mountField(this.activeField):await this.onNext()}},immediate:!0,deep:!0},state:{handler(t){["onValue","onClear","next","prev","onfinish","onload","unload"].includes(t)&&(l["X"].getTop().then(t=>t?l["X"].dismiss():null),this.disableAutoModalDismiss||l["Z"].getTop().then(t=>t&&l["Z"].dismiss()),l["V"].getTop().then(t=>t?l["V"].dismiss():null),l["ab"].getTop().then(t=>t?l["ab"].dismiss():null))},immediate:!0,deep:!0},activeField:{async handler(t){t&&this.mountField(t)}}},mounted(){this.footerBtns=[this.getCancelBtn()]},methods:{clearValue(){this.valueClearIndex+=1,this.setActiveFieldValue(null)},async onFtButtonClicked(t){this.ftBtnEvent.eventIndex+=1,this.ftBtnEvent.btnName=t.name,this.ftBtnEvent.btnOutput=await t.onClick(this.formData,this.computedFormData,this.currentFieldContext),t.onClickComponentEvents?this.ftBtnEvent.onClickComponentEvents=t.onClickComponentEvents:this.ftBtnEvent.onClickComponentEvents&&delete this.ftBtnEvent.onClickComponentEvents},async mountField(t){if("_NEXT_FIELD_"===t)return await this.goNext(),this.$emit("onIndex",this.currentIndex);const e=Object(a["findIndex"])(this.currentFields,{id:t});e>=0&&e<=this.currentFields.length&&(this.setActiveFieldComputedValue(),this.setActiveField(e),this.$emit("onIndex",e))},getCancelBtn(t={}){const e=t||{};return{name:e.name||"Cancel",color:e.color||"danger",onClick:async()=>{if(e.onClick)return e.onClick();if(await Object(c["a"])("Are you sure you want to cancel?")){if("function"===typeof this.cancelAction)return this.cancelAction();this.cancelDestinationPath?this.$router.push(this.cancelDestinationPath):this.$router.back()}}}},getClearBtn(t={}){const e=t||{};return{name:e.name||"Clear",color:e.color||"warning",slot:"end",onClick:async()=>{if(e.onClick)return e.onClick();const t=await Object(c["a"])("Are you sure you want to clear field data?");t&&this.clearValue()}}},getBackBtn(t={}){const e=t||{},n=()=>!(1===this.currentFields.length||this.currentIndex<=0);return{name:(null===e||void 0===e?void 0:e.name)||"Back",slot:"end",state:{disabled:{default:()=>!1,onsubmit:()=>!0},visible:{onload:()=>n(),default:()=>n()}},onClick:()=>e.onClick?e.onClick():this.goBack()}},getNextBtn(t={}){const e=t||{},n=()=>!(this.currentIndex+1>=this.currentFields.length||this.currentFields.length<=1);return{name:(null===e||void 0===e?void 0:e.name)||"Next",color:(null===e||void 0===e?void 0:e.color)||"success",slot:"end",state:(null===e||void 0===e?void 0:e.state)||{disabled:{onsubmit:()=>!0,default(t){return"requireNext"in t&&!t.requireNext}},visible:{onsubmit:()=>!1,onfinish:()=>!1,default:()=>n(),onload:()=>n()}},onClick:()=>e.onClick?e.onClick():this.goNext()}},getFinishBtn(t={}){const e=t||{},n=()=>this.currentIndex+1>=this.currentFields.length;return{name:(null===e||void 0===e?void 0:e.name)||"Finish",color:(null===e||void 0===e?void 0:e.color)||"success",slot:"end",state:{disabled:{default:()=>!1,onsubmit:()=>!0},visible:{onfinish:()=>!0,onsubmit:()=>!0,default:()=>n(),onload:()=>n()}},onClick:()=>e.onClick?e.onClick():this.goNext()}},onVisibleBtnState(t){var e;try{var n;if(null!==(n=this.currentField)&&void 0!==n&&null!==(n=n.config)&&void 0!==n&&n.hiddenFooterBtns.includes(t.name))return!1}catch(i){}if(null!==t&&void 0!==t&&null!==(e=t.state)&&void 0!==e&&e.visible){if(this.state in t.state.visible)return t.state.visible[this.state](this.currentField,this.formData);if("default"in t.state.visible)return t.state.visible["default"](this.currentField,this.formData)}return!0},onDisabledBtnState(t){var e;if(null!==t&&void 0!==t&&null!==(e=t.state)&&void 0!==e&&e.disabled){if(this.state in t.state.disabled)return t.state.disabled[this.state](this.currentField,this.formData);if("default"in t.state.disabled)return t.state.disabled["default"](this.currentField,this.formData)}return!1},getDefaultSummaryField(){return{id:"__form_summary__",helpText:"Summary",type:r["b"].TT_SUMMARY,config:{hiddenFooterBtns:["Clear"]},options:(t,e)=>{const n=[];for(const i in t){const o=this.currentFields.filter(t=>t.id===i||t.proxyID===i)[0],r=t[i];if(!r||void 0!=o.appearInSummary&&!o.appearInSummary(t,i))continue;const a=Array.isArray(r)?r:[r];a.forEach(r=>{o.summaryMapValue?n.push(o.summaryMapValue(r,t,e[i])):n.push({label:o.helpText,value:r.label})})}return n}}},resolveFormValues(t){const e={};for(const n in t)null!=t[n]&&(e[n]=t[n]);return e},async onFinishAction(){const t=this.resolveFormValues(this.formData),e=this.resolveFormValues(this.computedFormData);if(this.onFinish)try{this.state="onsubmit",await this.onFinish(t,e)}catch(n){console.error(n),Object(c["c"])(""+n)}this.state="onfinish",this.$emit("onFinish",t,e)},async goNext(){if(this.currentField.validation){const t=this.formData[this.currentField.id],e=this.currentField.validation(t,this.formData,this.computedFormData);if(e)return Object(c["e"])(e.join(", "),2e3)}this.currentField.beforeNext&&!await this.currentField.beforeNext(this.formData[this.currentField.id],this.formData,this.computedFormData,this)||await this.onNext()},async goBack(){for(let e=this.currentIndex;e>=0;--e){const n=this.currentFields[e];if(Object(a["isEmpty"])(this.currentField)||this.currentField.id!==n.id){await this.initFieldOnce(n);try{if(!await this.checkFieldCondition(n))continue}catch(t){continue}return void await this.setActiveField(e,"prev")}}},async checkFieldCondition(t){return!(t.condition&&!await t.condition(this.formData,this.computedFormData))||("function"===typeof t.onConditionFalse&&t.onConditionFalse(),this.formData[t.id]=t.defaultOutput?t.defaultOutput(this.formData,this.computedFormData):null,t.computedValue&&(this.computedFormData[t.id]=t.defaultComputedOutput?t.defaultComputedOutput(this.formData,this.computedFormData):null),!1)},onFieldActivated(t){this.state="onload",this.currentFieldContext=t,this.currentField.onload&&this.currentField.onload(t)},async onUnload(t=""){try{if(this.state="unload",!Object(a["isEmpty"])(this.currentField)&&this.currentField.unload){const e=this.formData[this.currentField.id];await this.currentField.unload(e,t,this.formData,this.computedFormData,this)}}catch(e){console.error(e)}},buildFormData(t){this.formData={},t.forEach(t=>{t.proxyID&&(this.formData[t.proxyID]=null),this.formData[t.id]=null})},async setActiveFieldValue(t){this.state="onValue";const e=this.currentField.proxyID,n=this.currentField.id;e&&(this.formData[e]=t),this.formData[n]=t,"function"===typeof this.currentField.updateHelpTextOnValue&&(this.helpText=this.currentField.updateHelpTextOnValue(t,this.formData))},async onNext(){const t=this.currentFields.length;for(let n=this.currentIndex;n<t;++n){const t=this.currentFields[n];if(Object(a["isEmpty"])(this.currentField)||this.currentField.id!==t.id){await this.initFieldOnce(t);try{if(!await this.checkFieldCondition(t))continue}catch(e){continue}if("function"===typeof this.currentField.exitsForm&&this.currentField.exitsForm(this.formData,this.computedFormData))break;return this.setActiveFieldComputedValue(),void this.setActiveField(n,"next")}}this.setActiveFieldComputedValue(),await this.onFinishAction()},async setActiveField(t,e=""){var n;await this.onUnload(e),this.state=e,this.currentIndex=t,this.currentField=this.currentFields[this.currentIndex],await this.initFieldOnce(this.currentField),this.helpText=this.currentField.dynamicHelpText?this.currentField.dynamicHelpText(this.formData):"function"===typeof this.currentField.updateHelpTextOnValue?this.currentField.updateHelpTextOnValue(this.formData[this.currentField.id],this.computedFormData[this.currentField.id]):this.currentField.helpText,this.footerBtns=[this.getCancelBtn()],this.currentField.config&&this.currentField.config.footerBtns&&(this.footerBtns=this.footerBtns.concat(this.currentField.config.footerBtns));const i=null===(n=this.currentField.config)||void 0===n?void 0:n.overrideDefaultFooterBtns;this.footerBtns.push(this.getClearBtn(null===i||void 0===i?void 0:i.clearBtn)),this.footerBtns.push(this.getBackBtn(null===i||void 0===i?void 0:i.backBtn)),this.footerBtns.push(this.getNextBtn(null===i||void 0===i?void 0:i.nextBtn)),this.footerBtns.push(this.getFinishBtn(null===i||void 0===i?void 0:i.finishBtn))},setActiveFieldComputedValue(){if("object"===typeof this.currentField&&"function"===typeof this.currentField.computedValue){const t=this.currentField.proxyID||this.currentField.id,e=this.formData[t];this.computedFormData[t]=null==e&&e?null:this.currentField.computedValue(e,this.formData,this.computedFormData)}},onFieldValue(t){this.setActiveFieldValue(t),"requireNext"in this.currentField&&!this.currentField.requireNext&&this.onNext()},async initFieldOnce(t){"function"===typeof t.init&&(this.fieldsInitialisedOnce[t.id]||(this.fieldsInitialisedOnce[""+t.id]=await t.init(this.formData,this.computedFormData)))}}});const N=f()(I,[["render",o]]);e["a"]=N},9761:function(t,e,n){"use strict";n("4a21")},a4d3:function(t,e,n){"use strict";n("a6f7")},a6f7:function(t,e,n){}}]);
//# sourceMappingURL=chunk-182277b5.0e16ed05.js.map