{"version":3,"sources":["webpack:///./src/apps/HTS/views/NewKits.vue?fd81","webpack:///./src/apps/HTS/views/NewKits.vue?f318","webpack:///./src/apps/HTS/views/NewKits.vue","webpack:///./src/apps/HTS/views/NewKits.vue?4cae","webpack:///./src/apps/HTS/composables/testKits.ts"],"names":["_hoisted_1","class","render","_ctx","_cache","$props","$setup","$data","$options","_component_ion_title","_resolveComponent","_component_ion_toolbar","_component_barcode_input","_component_ion_header","_component_ion_label","_component_ion_item","_component_ion_col","_component_ion_text","_component_ion_row","_component_ion_grid","_component_ion_content","_component_ion_button","_component_ion_footer","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_createVNode","color","_createElementVNode","_toDisplayString","kits","activeIndex","kitName","_","style","onOnScan","onScan","_createElementBlock","_Fragment","_renderList","kit","index","onClick","_normalizeClass","key","size","lines","_createTextVNode","slot","expiryDate","lotNo","$event","updateLot","updateExpiryDate","expiryDateError","_createCommentVNode","clear","save","disabled","canFinish","hasErrors","defineComponent","components","IonGrid","IonCol","IonRow","IonPage","IonTitle","IonHeader","IonToolbar","IonContent","IonFooter","IonButton","BarcodeInput","IonItem","IonLabel","IonText","setup","initKits","saveKits","TestKit","ref","computed","value","some","checkExpiryDates","forEach","Date","Service","getSessionDate","HiSForm","id","helpText","type","FieldType","TT_TEXT","defaultValue","val","testGroup","switchIndex","TT_FULL_DATE","length","text","async","alertConfirmation","toastWarning","every","k","toastSuccess","router","back","e","toastDanger","onMounted","then","__exports__","KitProp","UNIGOLD","DETERMINE","DETERMINE_REPEAT","BIOLINE","HIV_SELF_KIT","SYPHILIS","HEPATITIS","req","getJson","property","TEST_KIT_USER_PROPERTY","JSON","parse","property_value","console","error","getLotNo","data","find","getExpiryDate","date","res","postJson","stringify"],"mappings":"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","file":"js/chunk-0d4d81d1.d09597d3.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./NewKits.vue?vue&type=style&index=0&id=7c39b777&scoped=true&lang=css\"","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, createBlock as _createBlock, createCommentVNode as _createCommentVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-7c39b777\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"his-card\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ion_title = _resolveComponent(\"ion-title\")!\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")!\n  const _component_barcode_input = _resolveComponent(\"barcode-input\")!\n  const _component_ion_header = _resolveComponent(\"ion-header\")!\n  const _component_ion_label = _resolveComponent(\"ion-label\")!\n  const _component_ion_item = _resolveComponent(\"ion-item\")!\n  const _component_ion_col = _resolveComponent(\"ion-col\")!\n  const _component_ion_text = _resolveComponent(\"ion-text\")!\n  const _component_ion_row = _resolveComponent(\"ion-row\")!\n  const _component_ion_grid = _resolveComponent(\"ion-grid\")!\n  const _component_ion_content = _resolveComponent(\"ion-content\")!\n  const _component_ion_button = _resolveComponent(\"ion-button\")!\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")!\n  const _component_ion_page = _resolveComponent(\"ion-page\")!\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_ion_header, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_toolbar, { color: \"light\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_ion_title, { class: \"ion-text-center his-md-text\" }, {\n                default: _withCtx(() => [\n                  _createElementVNode(\"b\", null, _toDisplayString(_ctx.kits[_ctx.activeIndex].kitName), 1)\n                ]),\n                _: 1\n              })\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_ion_toolbar, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_barcode_input, {\n                style: {\"margin\":\"0px auto\",\"width\":\"90%\"},\n                onOnScan: _ctx.onScan\n              }, null, 8, [\"onOnScan\"])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_ion_content, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_grid, null, {\n            default: _withCtx(() => [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.kits, (kit, index) => {\n                return (_openBlock(), _createBlock(_component_ion_row, {\n                  onClick: () => _ctx.activeIndex = index,\n                  class: _normalizeClass(_ctx.activeIndex === index ? 'his-card active' : ''),\n                  key: index\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_col, { size: \"4\" }, {\n                      default: _withCtx(() => [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                          _createVNode(_component_ion_item, { lines: \"none\" }, {\n                            default: _withCtx(() => [\n                              _createVNode(_component_ion_label, null, {\n                                default: _withCtx(() => [\n                                  _createTextVNode(\" Kit name \")\n                                ]),\n                                _: 1\n                              }),\n                              _createVNode(_component_ion_label, { slot: \"end\" }, {\n                                default: _withCtx(() => [\n                                  _createElementVNode(\"b\", null, _toDisplayString(kit.kitName), 1)\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ]),\n                            _: 2\n                          }, 1024)\n                        ])\n                      ]),\n                      _: 2\n                    }, 1024),\n                    _createVNode(_component_ion_col, { size: \"4\" }, {\n                      default: _withCtx(() => [\n                        _createElementVNode(\"div\", {\n                          class: _normalizeClass([\"his-card\", kit.expiryDate && !kit.lotNo ? 'error' : ''])\n                        }, [\n                          _createVNode(_component_ion_item, {\n                            onClick: ($event: any) => (_ctx.updateLot(index)),\n                            lines: \"none\"\n                          }, {\n                            default: _withCtx(() => [\n                              _createVNode(_component_ion_label, null, {\n                                default: _withCtx(() => [\n                                  _createTextVNode(\" Lot No. \")\n                                ]),\n                                _: 1\n                              }),\n                              _createVNode(_component_ion_label, { slot: \"end\" }, {\n                                default: _withCtx(() => [\n                                  _createElementVNode(\"b\", null, _toDisplayString(kit.lotNo), 1)\n                                ]),\n                                _: 2\n                              }, 1024)\n                            ]),\n                            _: 2\n                          }, 1032, [\"onClick\"])\n                        ], 2)\n                      ]),\n                      _: 2\n                    }, 1024),\n                    _createVNode(_component_ion_col, { size: \"4\" }, {\n                      default: _withCtx(() => [\n                        _createElementVNode(\"div\", {\n                          class: _normalizeClass([\"his-card\", !kit.expiryDate && kit.lotNo ? 'error' : ''])\n                        }, [\n                          _createVNode(_component_ion_item, {\n                            onClick: ($event: any) => (_ctx.updateExpiryDate(index)),\n                            lines: \"none\"\n                          }, {\n                            default: _withCtx(() => [\n                              _createVNode(_component_ion_label, null, {\n                                default: _withCtx(() => [\n                                  _createTextVNode(\" Expiry Date \")\n                                ]),\n                                _: 1\n                              }),\n                              _createVNode(_component_ion_label, {\n                                color: kit.expiryDateError ? 'danger' : '',\n                                slot: \"end\"\n                              }, {\n                                default: _withCtx(() => [\n                                  _createElementVNode(\"b\", null, _toDisplayString(kit.expiryDate), 1)\n                                ]),\n                                _: 2\n                              }, 1032, [\"color\"])\n                            ]),\n                            _: 2\n                          }, 1032, [\"onClick\"]),\n                          (kit.expiryDateError)\n                            ? (_openBlock(), _createBlock(_component_ion_text, {\n                                key: 0,\n                                color: \"danger\",\n                                class: \"ion-text-center\"\n                              }, {\n                                default: _withCtx(() => [\n                                  _createTextVNode(_toDisplayString(kit.expiryDateError), 1)\n                                ]),\n                                _: 2\n                              }, 1024))\n                            : _createCommentVNode(\"\", true)\n                        ], 2)\n                      ]),\n                      _: 2\n                    }, 1024)\n                  ]),\n                  _: 2\n                }, 1032, [\"onClick\", \"class\"]))\n              }), 128))\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_ion_footer, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_toolbar, { color: \"light\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_ion_button, {\n                onClick: _ctx.clear,\n                slot: \"end\",\n                color: \"warning\",\n                size: \"large\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\" Clear \")\n                ]),\n                _: 1\n              }, 8, [\"onClick\"]),\n              _createVNode(_component_ion_button, {\n                onClick: _ctx.save,\n                disabled: !_ctx.canFinish || _ctx.hasErrors,\n                slot: \"end\",\n                color: \"success\",\n                size: \"large\"\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\" Finish \")\n                ]),\n                _: 1\n              }, 8, [\"onClick\", \"disabled\"])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}","\nimport { \n    computed, \n    defineComponent, \n    onMounted, \n    ref \n} from 'vue';\nimport {\n    IonGrid,\n    IonRow,\n    IonCol,\n    IonPage,\n    IonTitle,\n    IonHeader,\n    IonToolbar,\n    IonContent,\n    IonFooter,\n    IonButton,\n    IonItem,\n    IonLabel,\n    IonText\n} from \"@ionic/vue\"\nimport BarcodeInput from '@/components/BarcodeInput.vue';\nimport HiSForm from \"@/utils/PopupKeyboard\"\nimport { FieldType } from '@/components/Forms/BaseFormElements';\nimport { Option } from \"@/components/Forms/FieldInterface\"\nimport { alertConfirmation, toastDanger, toastSuccess, toastWarning } from '@/utils/Alerts';\nimport router from '@/router';\nimport { TestKit } from \"@/apps/HTS/composables/testKits\"\nimport { Service } from '@/services/service';\n\nexport default defineComponent({\n    components: {\n        IonGrid,\n        IonCol,\n        IonRow,\n        IonPage,\n        IonTitle,\n        IonHeader,\n        IonToolbar,\n        IonContent,\n        IonFooter,\n        IonButton,\n        BarcodeInput,\n        IonItem,\n        IonLabel,\n        IonText\n    },\n    setup() {\n        const { \n            kits, \n            initKits, \n            saveKits \n        } = TestKit()\n        \n        const activeIndex = ref(0)\n\n        const canFinish = ref(false)\n\n        const hasErrors = computed(() => kits.value.some((kit: any) => \n            (!kit.lotNo && kit.expiryDate || !kit.expiryDate && kit.lotNo) ||\n            kits.value.some((kit: any) => kit.expiryDateError)\n        ))\n\n        const checkExpiryDates = () => {\n            kits.value.forEach((kit: any) => {\n                if (kit.expiryDate && new Date(kit.expiryDate) <= new Date(Service.getSessionDate())) {\n                    kit.expiryDateError = \"Kit has expired!!\"                    \n                } else {\n                    kit.expiryDateError = ''\n                }\n                return kit\n            })\n        }\n\n        function updateLot(index: number) {\n            HiSForm({\n                id: 'lot',\n                helpText: kits.value[index].kitName + \" Lot No.\",\n                type: FieldType.TT_TEXT,\n                defaultValue: () => kits.value[index].lotNo\n            }, \n            (val: Option) => {\n                const value = val?.value || ''\n                if (activeIndex.value === 0) {\n                    kits.value.forEach((kits: any) => {\n                        if (kits.testGroup === 'profession_hiv_kit') {\n                            kits.lotNo = value\n                        }\n                    })\n                    if (kits.value[index].expiryDate) activeIndex.value = 5\n                    return\n                }\n                if (kits.value[index].expiryDate) switchIndex()\n                kits.value[index].lotNo = value\n            })\n        }\n\n        function updateExpiryDate(index: number) {\n            HiSForm({\n                id: 'expiry',\n                helpText: kits.value[index].kitName + \" Expiry Date\",\n                type: FieldType.TT_FULL_DATE,\n                defaultValue: () => kits.value[index].expiryDate\n            }, \n            (val: Option) => {\n                const value = val?.value || ''\n                if (activeIndex.value === 0) {\n                    kits.value.forEach((kits: any) => {\n                        if (kits.testGroup === 'profession_hiv_kit') {\n                            kits.expiryDate = value\n                        }\n                    })\n                    if (kits.value[index].lotNo) activeIndex.value = 5\n                    checkExpiryDates()\n                    return \n                }\n                if (kits.value[index].lotNo) switchIndex()\n                kits.value[index].expiryDate = value\n                checkExpiryDates()\n            })\n        }\n\n        function switchIndex() {\n            if ((activeIndex.value + 1) === kits.value.length) {\n                activeIndex.value = 0\n            } else {\n                ++activeIndex.value\n            }\n        }\n        \n        function onScan(text: string) {\n            if (activeIndex.value === 0) {\n                kits.value.forEach((kits: any) => {\n                    if (kits.testGroup === 'profession_hiv_kit') {\n                        kits.lotNo = text\n                    }\n                })\n            }\n            kits.value[activeIndex.value].lotNo = text\n            if (!kits.value[activeIndex.value].expiryDate) {\n                updateExpiryDate(activeIndex.value)\n            } else {\n                switchIndex()\n            }\n        }\n        \n        async function clear() {\n            if ((await alertConfirmation('Are you sure you want to clear everything?'))) {\n                kits.value.forEach((kits: any) => {\n                    kits.expiryDate = ''\n                    kits.lotNo = ''\n                    kits.expiryDateError = ''\n                })\n                activeIndex.value = 0\n            }\n        }\n\n        async function save() {\n            checkExpiryDates()\n            if (hasErrors.value) {\n                return toastWarning('Some kits have errors! please fix them below')\n            }\n            if (kits.value.every((k: any) => !(k.lotNo && k.expiryDate))) {\n                if (!(await alertConfirmation(\"Do you want to continue without updating test kits?\")))\n                    return\n            }\n            canFinish.value = false\n            try {\n                await saveKits()\n                toastSuccess('Testkits updated!')\n                return router.back()\n            } catch (e) {\n                toastDanger('General error has occured!')\n            }\n            canFinish.value = true\n        }\n\n        onMounted(() => initKits().then(() => { checkExpiryDates(); canFinish.value = true }))\n\n        return {\n            kits,\n            activeIndex,\n            hasErrors,\n            canFinish,\n            save,\n            switchIndex,\n            onScan,\n            updateLot,\n            updateExpiryDate,\n            clear\n        }\n    }\n})\n","import { render } from \"./NewKits.vue?vue&type=template&id=7c39b777&scoped=true&ts=true\"\nimport script from \"./NewKits.vue?vue&type=script&lang=ts\"\nexport * from \"./NewKits.vue?vue&type=script&lang=ts\"\n\nimport \"./NewKits.vue?vue&type=style&index=0&id=7c39b777&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7c39b777\"]])\n\nexport default __exports__","import { Service } from \"@/services/service\";\nimport { find } from \"lodash\";\nimport { ref } from \"vue\";\n\nexport enum KitProp {\n    TEST_KIT_USER_PROPERTY = 'hts_user_assigned_kits',\n    HIV_SELF_KIT = 'HIV self-kit',\n    SYPHILIS = 'Syphilis',\n    HEPATITIS = 'Hepatitis B',\n    BIOLINE = 'Bioline',\n    DETERMINE = 'Determine',\n    DETERMINE_REPEAT = 'Determine (Repeat)',\n    UNIGOLD = 'Unigold'\n}\n\nconst kits = ref<any>([\n    {\n        kitName: 'All (Determine, Unigold, Bioline)',\n        lotNo: '',\n        expiryDate: '',\n        testGroup: 'profession_hiv_kit'\n    },\n    {\n        kitName: KitProp.UNIGOLD,\n        lotNo: '',\n        expiryDate: '',\n        testGroup: 'profession_hiv_kit'\n    },\n    {\n        kitName: KitProp.DETERMINE,\n        lotNo: '',\n        expiryDate: '',\n        testGroup: 'profession_hiv_kit'\n    },\n    {\n        kitName: KitProp.DETERMINE_REPEAT,\n        lotNo: '',\n        expiryDate: '',\n        testGroup: 'profession_hiv_kit'\n    },\n    {\n        kitName: KitProp.BIOLINE,\n        lotNo: '',\n        expiryDate: '',\n        testGroup: 'profession_hiv_kit'\n    },\n    {\n        kitName: KitProp.HIV_SELF_KIT,\n        lotNo: '',\n        expiryDate: ''\n    },\n    {\n        kitName: KitProp.SYPHILIS,\n        lotNo: '',\n        expiryDate: ''\n    },\n    {\n        kitName: KitProp.HEPATITIS,\n        lotNo: '',\n        expiryDate: ''\n    }\n])\n\nexport function TestKit() {\n    const initKits = async () => {\n        try {\n            const req = await Service.getJson('user_properties', {\n                property: KitProp.TEST_KIT_USER_PROPERTY\n            })\n            kits.value = JSON.parse(req.property_value)\n        } catch (e) {\n            console.error(`${e}`)\n        }\n    }\n\n    const getLotNo = (kitName: KitProp) => {\n        const data = find(kits.value, { kitName })\n        if (data && new Date(data.expiryDate) <= new Date(Service.getSessionDate())) {\n            return ''\n        }\n        return data['lotNo'] || ''\n    }\n\n    const getExpiryDate = (kitName: KitProp) => {\n        const date = find(kits.value, { kitName })['expiryDate'] || ''\n        if (date && new Date(date) <= new Date(Service.getSessionDate())) {\n            return ''\n        }\n        return date\n    }\n\n    const saveKits = async () => {\n        const res = await Service.postJson('user_properties', { \n            property: KitProp.TEST_KIT_USER_PROPERTY,\n            property_value: JSON.stringify(kits.value)\n        })\n        return res ? true : false\n    }\n\n    return {\n        kits,\n        initKits,\n        saveKits,\n        getLotNo,\n        getExpiryDate\n    }\n}\n"],"sourceRoot":""}