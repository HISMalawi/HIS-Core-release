(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ced981c"],{"668a":function(e,t,n){"use strict";n.r(t);var r=n("7a23");function a(e,t,n,a,u,i){var c=Object(r["resolveComponent"])("his-standard-form"),s=Object(r["resolveComponent"])("ion-page");return Object(r["openBlock"])(),Object(r["createBlock"])(s,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(c,{key:e.hisFormKey,activeField:e.fieldComponent,skipSummary:!0,fields:e.fields,onOnIndex:t[1]||(t[1]=function(t){return e.fieldComponent=""}),onOnFinish:e.onFinish},null,8,["activeField","fields","onOnFinish"])]})),_:1})}var u=n("1da1"),i=(n("ac1f"),n("466d"),n("d81d"),n("b0c0"),n("d3b7"),n("b64b"),n("96cf"),n("d95e")),c=n("7920"),s=n("2706"),o=n("8a30"),d=n("2ef0"),f=n("76f1"),l=n("8ee8"),p=n("c84b"),b=n("b5e4"),h=Object(r["defineComponent"])({components:{HisStandardForm:c["a"],IonPage:o["D"]},data:function(){return{hisFormKey:0,fields:[],allDrugs:[],fieldComponent:"",service:{}}},created:function(){this.fields=this.getFields()},methods:{onFinish:function(e,t){var n=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p["a"].saveDrugSet(t);case 3:if(!e.sent){e.next=6;break}return Object(b["d"])("Drugset saved successfully"),e.abrupt("return",n.$router.back());case 6:Object(b["e"])("Unable to save drugset"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),Object(b["e"])("".concat(e.t0));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))()},getFields:function(){var e=this;return[{id:"name",helpText:"Enter drug set name",type:i["b"].TT_TEXT,computedValue:function(e){return e.value},validation:function(e){return s["a"].validateSeries([function(){return s["a"].required(e)},function(){return"".concat(e.value).match(/^([a-zA-Z_ ]{2,17})'?-?([a-zA-Z_ ]{1,17})$/)?null:["Enter a valid drug set name."]}])}},{id:"description",helpText:"Drug set description",type:i["b"].TT_TEXT,computedValue:function(e){return e.value},validation:function(e){return s["a"].validateSeries([function(){return s["a"].required(e)},function(){return"".concat(e.value).match(/^([a-zA-Z_ ]{2,100})'?-?([a-zA-Z_ ]{1,100})$/)?null:["Enter a valid drug set description"]}])}},{id:"drug_selection",helpText:"Select drugs to add",type:i["b"].TT_MULTIPLE_SELECT,validation:function(e){return s["a"].required(e)},config:{showKeyboard:!0},options:function(){var t=Object(u["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!Object(d["isEmpty"])(e.allDrugs)){t.next=4;break}return t.next=3,f["a"].getDrugs({page_size:1e3});case 3:e.allDrugs=t.sent.map((function(e){return{label:e.name,value:e.id,other:{drug:e.name,quantity:0,frequency:""}}}));case 4:return t.abrupt("return",e.allDrugs);case 5:case"end":return t.stop()}}),t)})));function n(){return t.apply(this,arguments)}return n}()},{id:"drugs",helpText:"Set drugs",type:i["b"].TT_ANC_DRUGSET_INPUT,computedValue:function(e){return e.map((function(e){return e.other}))},validation:function(e){return s["a"].validateSeries([function(){return s["a"].required(e)},function(){return e.map((function(e){return e.other.quantity&&e.other.frequency})).every(Boolean)?null:["Data is not complete"]}])},options:function(e){return e.drug_selection},config:{drugFrequencies:Object.keys(l["b"]).map((function(e){return{label:e,value:e}}))}}]}}}),v=n("6b0d"),m=n.n(v);const g=m()(h,[["render",a]]);t["default"]=g},"8ee8":function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var r=n("1da1"),a=n("d4ec"),u=n("bee2"),i=n("262e"),c=n("2caf"),s=(n("d81d"),n("d3b7"),n("159b"),n("96cf"),n("cc6f")),o=n("71c3"),d=n("2ef0"),f=n("9283"),l={"Once a day (OD)":1,"Twice a day (BD)":2,"Three a day (TDS)":3,"Four times a day (QID)":4,"Five times a day (5X/D)":5,"Six times a day (Q4HRS)":6,"In the morning (QAM)":.5,"Once a week (QWK)":.14,"Once a month":.03,"Twice a month":.071},p=function(e){Object(i["a"])(n,e);var t=Object(c["a"])(n);function n(e,r){return Object(a["a"])(this,n),t.call(this,e,25,r)}return Object(u["a"])(n,[{key:"ttvDrugObj",value:function(){return{drug_inventory_id:609,dose:.5,equivalent_daily_dose:.5,frequency:"Once a day (od)",start_date:this.date,auto_expire_date:this.date,instructions:"Once a day",units:"ml"}}},{key:"updateTTvOrder",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.dispenseTTV();case 2:if(t=e.sent,Object(d["isEmpty"])(t)){e.next=6;break}return n=t[0].order_id,e.abrupt("return",o["a"].updateDispensationOrders([{order_id:n,quantity:1}]));case 6:throw"Unable to dispense";case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"dispenseTTV",value:function(){return this.createOrders([this.ttvDrugObj()])}},{key:"createOrders",value:function(e){return o["a"].create({drug_orders:e,encounter_id:this.getEncounterID()})}},{key:"submitTreatment",value:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.createEncounter();case 2:return e.next=4,this.createOrders(t.map((function(e){return a.buildDrugOrderObj(e)})));case 4:return n=e.sent,r=new s["a"](this.patientID,54,this.providerID),e.next=8,r.createEncounter();case 8:return t.forEach((function(e){var t=l[e.frequency]*e.duration;n.forEach((function(n){n.drug_inventory_id===e.id&&(n.quantity=t)}))})),e.next=11,o["a"].updateDispensationOrders(n);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"buildDrugOrderObj",value:function(e){var t=new Date(this.date),n=t.setDate(t.getDate()+parseInt("".concat(e.duration))),r=e.dose||l[e.frequency],a=parseFloat(r)*l[e.frequency];return{drug_inventory_id:e.id,dose:r,equivalent_daily_dose:a,frequency:e.frequency,start_date:this.date,auto_expire_date:f["b"].toStandardHisFormat(new Date(n)),instructions:e.drug_name+":"+e.dose+" "+e.units+" "+e.frequency+"days",units:e.units}}}]),n}(s["a"])},c84b:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n("2909"),a=n("1da1"),u=n("5530"),i=n("d4ec"),c=n("bee2"),s=n("262e"),o=n("2caf"),d=(n("96cf"),n("d3b7"),n("b64b"),n("99af"),n("1c74")),f=function(e){Object(s["a"])(n,e);var t=Object(o["a"])(n);function n(){return Object(i["a"])(this,n),t.apply(this,arguments)}return Object(c["a"])(n,null,[{key:"saveDrugSet",value:function(e){var t=Object(u["a"])({},e);return t["datetime"]=d["e"].getSessionDate(),this.postJson("/drug_sets",e)}},{key:"voidDrugSet",value:function(e){return this.void("/drug_sets/".concat(e),{date:this.getSessionDate()})}},{key:"getDrugSets",value:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getJson("drug_sets");case 2:if(t=e.sent,!t){e.next=5;break}return e.abrupt("return",Object.keys(t["set_names"]).reduce((function(e,n){var a=t["set_names"][n],i=t["set_descriptions"][n],c=t["drug_sets"][n];return e.push({id:parseInt(n),name:a,description:i,drugs:Object.keys(c).reduce((function(e,t){return[].concat(Object(r["a"])(e),[Object(u["a"])(Object(u["a"])({id:parseInt(t)},c[t]),{},{drug_name:c[t].drug_name,duration:parseInt(c[t].duration),frequency:c[t].frequency,units:c[t].units})])}),[])}),e}),[]));case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(d["e"])}}]);
//# sourceMappingURL=chunk-0ced981c.3a4fad5f.js.map