(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["TouchFormElement13"],{"39ac":function(t,e,a){},"83af":function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));var i=a("cc6f");class n extends i["a"]{constructor(t,e){super(t,7,e)}async getNextAppointment(t=i["a"].getProgramID()){return i["a"].getJson(`/programs/${t}/patients/${this.patientID}/next_appointment_date`,{date:this.date})}static async getDailiyAppointments(t){const e=i["a"].getProgramID();return i["a"].getJson(`/programs/${e}/booked_appointments`,{date:t,paginate:!1})}}},b2eb:function(t,e,a){"use strict";a.r(e);var i=a("7a23");const n={class:"view-port-content"},s=["onClick"],o={key:0,class:"appointments"},c=Object(i["createElementVNode"])("b",null,"Medication Run out Date",-1),l=Object(i["createElementVNode"])("p",null,null,-1),r=Object(i["createElementVNode"])("b",null,"User set appointment date",-1),d=Object(i["createElementVNode"])("p",null,null,-1),p=Object(i["createElementVNode"])("b",null,"Appointment(s)",-1),u=Object(i["createElementVNode"])("p",null,null,-1),b=Object(i["createElementVNode"])("b",null,"Appointment limit (per/day)",-1),m=Object(i["createElementVNode"])("p",null,null,-1);function h(t,e,a,h,O,D){const j=Object(i["resolveComponent"])("Calendar"),w=Object(i["resolveComponent"])("ion-col"),y=Object(i["resolveComponent"])("ion-label"),g=Object(i["resolveComponent"])("ion-item"),f=Object(i["resolveComponent"])("ion-list"),C=Object(i["resolveComponent"])("ion-row"),N=Object(i["resolveComponent"])("ion-grid"),V=Object(i["resolveComponent"])("view-port");return Object(i["openBlock"])(),Object(i["createBlock"])(V,null,{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",n,[Object(i["createVNode"])(N,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(C,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(w,{size:"8"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(j,{color:"blue",ref:"calendar","is-expanded":"",class:"custom-calendar","min-date":t.sessionDate,"max-date":t.runOutDate,attributes:t.attributes,masks:t.masks,"disable-page-swipe":""},{"day-content":Object(i["withCtx"])(({day:e})=>[Object(i["createElementVNode"])("div",{onClick:a=>t.dayClicked(e),class:Object(i["normalizeClass"])({selected:e.id===t.cDate,isDisabled:e.isDisabled})},[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.day),1),e.id===t.cDate?(Object(i["openBlock"])(),Object(i["createElementBlock"])("sup",o,Object(i["toDisplayString"])(t.appointments.length),1)):Object(i["createCommentVNode"])("",!0)],10,s)]),_:1},8,["min-date","max-date","attributes","masks"])]),_:1}),Object(i["createVNode"])(w,{size:"4",class:"his-card"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(f,null,{default:Object(i["withCtx"])(()=>[t.showMedicationRunoutDate&&t.rDate?(Object(i["openBlock"])(),Object(i["createBlock"])(g,{key:0,class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(y,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[c,l,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.rDate),1)]),_:1})]),_:1})):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(g,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(y,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[r,d,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.aDate),1)]),_:1})]),_:1}),Object(i["createVNode"])(g,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(y,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[p,u,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.appointments.length),1)]),_:1})]),_:1}),Object(i["createVNode"])(g,{class:"his-sm-text"},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(y,{class:"ion-text-wrap"},{default:Object(i["withCtx"])(()=>[b,m,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.appointmentLimit),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})}var O=a("0a79"),D=a("d867"),j=a("0261"),w=a("9283"),y=a("83af"),g=a("51c8"),f=a("d1ca"),C=a("b5e4"),N=a("5a0c"),V=a.n(N),x=Object(i["defineComponent"])({components:{ViewPort:O["a"],Calendar:j["a"],IonGrid:D["p"],IonCol:D["m"],IonRow:D["H"]},mixins:[g["default"]],watch:{startDate:{async handler(t){const e=t||w["b"].toStandardHisDisplayFormat(this.sessionDate);this.$emit("onValue",{label:"",value:e})},immediate:!0}},data:()=>({rows:[],startDate:null,runOutDate:null,appointments:[],clinicHolidays:[],clinicDays:[],patientAge:0,appointmentLimit:0,sessionDate:null,masks:{weekdays:"WWW"}}),mounted(){this.$emit("onFieldActivated",this)},activated(){this.$emit("onFieldActivated",this)},async created(){this.patientAge=this.config.patientAge||0,await this.getAppointmentLimit(),await this.getClinicHolidays(),await this.getClinicDays();const t=await this.options(this.fdata);this.sessionDate=y["a"].getSessionDate();const e=t[0].other.appointmentDate;this.appointments=await this.getAppointments(e),this.setDate(e),this.runOutDate=t[0].other.runOutDate?new Date(t[0].other.runOutDate):null},methods:{getAppointments(t){return y["a"].getDailiyAppointments(w["b"].toStandardHisFormat(t))},async getAppointmentLimit(){const t=await f["b"].appointmentLimit();t&&(this.appointmentLimit=t)},async getClinicHolidays(){const t=await f["b"].clinicHolidays();t&&(this.clinicHolidays=t.split(","))},async getClinicDays(){let t="";t=this.patientAge>=18?await f["b"].adultClinicDays():await f["b"].peadsClinicDays(),t&&(this.clinicDays=t.split(","))},async isDateAvalaible(t){const e=await this.getAppointments(t);if(0!==e.length&&e.length>=this.appointmentLimit){const e=await Object(C["a"])("Appointment limit reached for the selected date "+w["b"].toStandardHisDisplayFormat(t),{header:"APPOINTMENT LIMIT REACHED",cancelBtnLabel:"Proceed with Selected Date",confirmBtnLabel:"Select Another Date"});if(e)return!1}if(this.clinicHolidays.includes(w["b"].toStandardHisFormat(t))){const t=await Object(C["a"])("Selected date is a clinic holiday, do you want to set an appointment?");if(!t)return!1}const a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=a[V()(t).day()];if(!this.clinicDays.includes(i)){const e=await Object(C["a"])(`The selected date ${w["b"].toStandardHisDisplayFormat(t)} is not a clinic day. Do you want to proceed with this date?`);if(!e)return!1}return this.appointments=e,!0},async setDate(t){this.startDate=new Date(t);const e=this.$refs.calendar;await e.move(this.startDate),await e.focusDate(this.startDate)},async dayClicked(t){!t.isDisabled&&await this.isDateAvalaible(t.id)&&this.setDate(t.id)}},computed:{showMedicationRunoutDate(){var t,e;return"boolean"!==typeof(null===(t=this.config)||void 0===t?void 0:t.hideRunoutDate)||!(null!==(e=this.config)&&void 0!==e&&e.hideRunoutDate)},aDate(){return w["b"].toStandardHisDisplayFormat(this.startDate)},rDate(){return w["b"].toStandardHisDisplayFormat(this.runOutDate)},cDate(){return w["b"].toStandardHisFormat(this.startDate)},attributes(){return[{highlight:!0,dates:this.aDate}]}}}),v=(a("d09b"),a("d959")),A=a.n(v);const k=A()(x,[["render",h]]);e["default"]=k},d09b:function(t,e,a){"use strict";a("39ac")}}]);
//# sourceMappingURL=TouchFormElement13.5f7898d4.js.map