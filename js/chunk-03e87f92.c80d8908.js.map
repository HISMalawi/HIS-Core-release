{"version":3,"sources":["webpack:///./src/apps/ART/views/encounters/BPManagement.vue?6cb1","webpack:///./src/apps/ART/views/encounters/BPManagement.vue","webpack:///./src/apps/ART/views/encounters/BPManagement.vue?6585","webpack:///./src/apps/ART/services/vitals_service.ts"],"names":["_hoisted_1","key","style","_hoisted_2","slot","_hoisted_3","_createTextVNode","_hoisted_4","_createVNode","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","render","_ctx","_cache","$props","$setup","$data","$options","_component_ion_title","_resolveComponent","_component_ion_button","_component_ion_toolbar","_component_ion_header","_component_data_table","_component_ion_content","_component_ion_label","_component_ion_radio","_component_ion_item","_component_ion_col","_component_ion_row","_component_ion_grid","_component_ion_radio_group","_component_ion_footer","_component_ion_page","_openBlock","_createBlock","default","_withCtx","_toDisplayString","date","patientOnBPDrugs","_createCommentVNode","_","totalRiskFactors","color","onClick","showRiskFactors","config","showIndex","columns","rows","modelValue","action","$event","_Fragment","_renderList","items","item","index","size","label","value","gotoPatientDashboard","showClinicianButton","referPatient","patientHasHyperTensionObs","goToDiagnosis","isEnrolledInHTN","enrollInHTN","onFinish","HEADER_STYLE","background","defineComponent","mixins","EncounterMixinVue","components","DataTable","IonTitle","IonToolbar","IonHeader","IonContent","IonGrid","IonRow","IonButton","IonRadioGroup","IonRadio","IonCol","IonFooter","IonPage","IonItem","IonLabel","data","htn","hasARVNumber","suggestedNumber","table","thTxt","bpGradeColorMap","riskFactors","trail","patientFirstVisit","normatensive","currentDrugs","isAliveOnHTN","HTNProgramID","aliveState","refer","watch","ready","handler","loadingController","create","message","backdropDismiss","loading","present","BPManagementService","patientID","providerID","getBPTrail","formatBpTrailRows","isBpNormotensive","getRiskFactors","HisDate","toStandardHisDisplayFormat","Service","getSessionDate","isTransfered","hasHyperTenstion","getTreatmentStatus","getProgramStatus","dismiss","alertTransferIn","getItems","immediate","computed","this","filter","d","length","UserService","isClinician","isDoctor","methods","createEncounter","encounter","toastWarning","saveValueCodedObs","obs","saveValueTextObs","patientState","state","enrollPatient","other","nextTask","$router","push","path","ObservationService","getFirstValueCoded","ob","match","getFirstValueText","ProgramService","getPatientPrograms","programs","program","name","programState","getPatientStates","concepts","ConceptService","getConceptsByCategory","j","map","concept","val","Promise","all","Object","keys","m","concat","colorGrade","grade","getBpGrade","parseInt","sbp","dbp","tdDate","td","join","note","modalController","component","RiskFactorModal","cssClass","componentProps","factors","modal","onDidDismiss","isEmpty","isChecked","infoActionSheet","setHtnTransferred","PatientProgramService","setProgramId","setStateDate","setStateId","enrollProgram","updateState","toastSuccess","console","error","transferred","vitals","VitalsService","__exports__","vital","modifier","min","max","p","parseFloat","validator","isArray","errors","holder","forEach","element","isValidBP","split","bpSystolic","bpDiastolic","checkMinMax","mergeErrors","values","emptyErrors","isNotEmptyandFloat","minErrors","isNotEmptyandNumber","isValidBPReading","v","AppEncounterService"],"mappings":"yIAEMA,EAAa,CACjBC,IAAK,EACLC,MAAO,CAAC,MAAQ,UAEZC,EAAa,CAAEC,KAAM,OACrBC,EAA0BC,6BAAiB,mBAC3CC,EAA0BC,yBAAa,KAAM,CAAEN,MAAO,CAAC,aAAa,WAAa,WAAY,GAC7FO,EAA0BH,6BAAiB,YAC3CI,EAA0BJ,6BAAiB,wBAC3CK,EAA0BL,6BAAiB,4BAC3CM,EAA0BN,6BAAiB,mBAC3CO,EAA0BP,6BAAiB,YAE3C,SAAUQ,EAAOC,EAAMC,EAAQC,EAAQC,EAAQC,EAAOC,GAC1D,IAAMC,EAAuBC,8BAAkB,aACzCC,EAAwBD,8BAAkB,cAC1CE,EAAyBF,8BAAkB,eAC3CG,EAAwBH,8BAAkB,cAC1CI,EAAwBJ,8BAAkB,cAC1CK,EAAyBL,8BAAkB,eAC3CM,EAAuBN,8BAAkB,aACzCO,EAAuBP,8BAAkB,aACzCQ,EAAsBR,8BAAkB,YACxCS,EAAqBT,8BAAkB,WACvCU,EAAqBV,8BAAkB,WACvCW,EAAsBX,8BAAkB,YACxCY,EAA6BZ,8BAAkB,mBAC/Ca,EAAwBb,8BAAkB,cAC1Cc,EAAsBd,8BAAkB,YAE9C,OAAQe,yBAAcC,yBAAaF,EAAqB,KAAM,CAC5DG,QAASC,sBAAS,iBAAM,CACtBhC,yBAAaiB,EAAuB,KAAM,CACxCc,QAASC,sBAAS,iBAAM,CACtBhC,yBAAagB,EAAwB,KAAM,CACzCe,QAASC,sBAAS,iBAAM,CACtBhC,yBAAaa,EAAsB,KAAM,CACvCkB,QAASC,sBAAS,iBAAM,CACtBhC,yBAAa,OAAQ,KAAM,8BAAgCiC,6BAAiB1B,EAAK2B,MAAO,GACvF3B,EAAK4B,kBACDN,yBAAcC,yBAAa,QAAStC,EAAY,mCACjD4C,gCAAoB,IAAI,OAE9BC,EAAG,IAELrC,yBAAa,OAAQL,EAAY,CAC9BY,EAAK+B,iBAAmB,GACpBT,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL8C,MAAO,SACPC,QAASjC,EAAKkC,iBACb,CACDV,QAASC,sBAAS,iBAAM,CACtBlC,6BAAiB,0BAA4BmC,6BAAiB1B,EAAK+B,kBAAmB,OAExFD,EAAG,GACF,EAAG,CAAC,aACPD,gCAAoB,IAAI,GACD,IAA1B7B,EAAK+B,kBACDT,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL+C,QAASjC,EAAKkC,iBACb,CACDV,QAASC,sBAAS,iBAAM,CACtBnC,MAEFwC,EAAG,GACF,EAAG,CAAC,aACPD,gCAAoB,IAAI,SAGhCC,EAAG,QAGPA,EAAG,IAELrC,yBAAamB,EAAwB,KAAM,CACzCY,QAASC,sBAAS,iBAAM,CACtBhC,yBAAakB,EAAuB,CAClCwB,OAAQ,CAACC,WAAW,GACpBC,QAASrC,EAAKqC,QACdC,KAAMtC,EAAKsC,MACV,KAAM,EAAG,CAAC,UAAW,aAE1BR,EAAG,IAELrC,yBAAa2B,EAAuB,KAAM,CACxCI,QAASC,sBAAS,iBAAM,CACtBhC,yBAAagB,EAAwB,KAAM,CACzCe,QAASC,sBAAS,iBAAM,CACtBjC,EACAC,yBAAa0B,EAA4B,CACvCoB,WAAYvC,EAAKwC,OACjB,sBAAuBvC,EAAO,KAAOA,EAAO,GAAK,SAAAwC,GAAM,OAAKzC,EAAKwC,OAASC,KACzE,CACDjB,QAASC,sBAAS,iBAAM,CACtBhC,yBAAayB,EAAqB,KAAM,CACtCM,QAASC,sBAAS,iBAAM,CACtBhC,yBAAawB,EAAoB,KAAM,CACrCO,QAASC,sBAAS,iBAAM,EACrBH,wBAAW,GAAOC,yBAAamB,cAAW,KAAMC,wBAAY3C,EAAK4C,OAAO,SAACC,EAAMC,GAC9E,OAAQxB,yBAAcC,yBAAaP,EAAoB,CACrD+B,KAAM,IACN7D,IAAK4D,GACJ,CACDtB,QAASC,sBAAS,iBAAM,CACtBhC,yBAAasB,EAAqB,KAAM,CACtCS,QAASC,sBAAS,iBAAM,CACtBhC,yBAAaoB,EAAsB,CAAE1B,MAAO,CAAC,YAAY,SAAS,cAAc,SAAW,CACzFqC,QAASC,sBAAS,iBAAM,CACtBlC,6BAAiBmC,6BAAiBmB,EAAKG,OAAQ,OAEjDlB,EAAG,GACF,MACHrC,yBAAaqB,EAAsB,CAAEmC,MAAOJ,GAAQ,KAAM,EAAG,CAAC,cAEhEf,EAAG,GACF,UAELA,EAAG,GACF,SACD,UAENA,EAAG,QAGPA,EAAG,QAGPA,EAAG,GACF,EAAG,CAAC,mBAETA,EAAG,IAELrC,yBAAagB,EAAwB,CAAEuB,MAAO,QAAU,CACtDR,QAASC,sBAAS,iBAAM,CACtBhC,yBAAae,EAAuB,CAClCuC,KAAM,QACNf,MAAO,SACP3C,KAAM,QACN4C,QAASjC,EAAKkD,sBACb,CACD1B,QAASC,sBAAS,iBAAM,CACtB/B,MAEFoC,EAAG,GACF,EAAG,CAAC,YACN9B,EAAKmD,qBACD7B,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL6D,KAAM,QACNf,MAAO,SACP3C,KAAM,QACN4C,QAASjC,EAAKoD,cACb,CACD5B,QAASC,sBAAS,iBAAM,CACtB9B,MAEFmC,EAAG,GACF,EAAG,CAAC,aACPD,gCAAoB,IAAI,GAC1B7B,EAAKqD,0BAYHxB,gCAAoB,IAAI,IAXvBP,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL6D,KAAM,QACN1D,KAAM,MACN4C,QAASjC,EAAKsD,eACb,CACD9B,QAASC,sBAAS,iBAAM,CACtB7B,MAEFkC,EAAG,GACF,EAAG,CAAC,aAEV9B,EAAKqD,4BAA8BrD,EAAKuD,iBACpCjC,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL6D,KAAM,QACN1D,KAAM,MACN4C,QAASjC,EAAKwD,aACb,CACDhC,QAASC,sBAAS,iBAAM,CACtB5B,MAEFiC,EAAG,GACF,EAAG,CAAC,aACPD,gCAAoB,IAAI,GAC3B7B,EAAKqD,2BACD/B,yBAAcC,yBAAaf,EAAuB,CACjDtB,IAAK,EACL6D,KAAM,QACNf,MAAO,UACP3C,KAAM,MACN4C,QAASjC,EAAKyD,UACb,CACDjC,QAASC,sBAAS,iBAAM,CACtB3B,MAEFgC,EAAG,GACF,EAAG,CAAC,aACPD,gCAAoB,IAAI,OAE9BC,EAAG,QAGPA,EAAG,QAGPA,EAAG,I,sVC7KD4B,EAAe,CACnBC,WAAY,WAECC,+BAAgB,CAC7BC,OAAQ,CAACC,QACTC,WAAY,CACVC,iBACAC,uBACAC,2BACAC,yBACAC,2BACAC,qBACAC,mBACAC,yBACAC,iCACAC,uBACAC,mBACAC,yBACAC,qBACAC,qBACAC,wBAEFC,KAAM,iBAAO,CACXC,IAAK,GACLC,cAAc,EACdC,gBAAiB,GACjB7C,QAAS,CACP,CACE8C,OAAMC,MAAM,OAAQ,CAAEjG,MAAOuE,IAC7ByB,OAAMC,MAAM,WAAY,CAAEjG,MAAOuE,IACjCyB,OAAMC,MAAM,YAAa,CAAEjG,MAAOuE,IAClCyB,OAAMC,MAAM,WAAY,CAAEjG,MAAOuE,IACjCyB,OAAMC,MAAM,gBAAiB,CAAEjG,MAAOuE,MAG1C2B,gBAAiB,CACf,MAAO,UACP,OAAU,UACV,UAAW,UACX,UAAW,UACX,UAAW,WAEb/C,KAAM,GACNgD,YAAa,GACb9C,OAAQ,KACR+C,MAAO,GACP5D,KAAM,KACNC,kBAAkB,EAClB4D,mBAAmB,EACnBC,cAAc,EACdpC,2BAA2B,EAC3BqC,aAAc,GACd9C,MAAO,GACPW,iBAAiB,EACjBoC,cAAc,EACdC,aAAc,GACdC,WAAY,IACZC,OAAO,IAETC,MAAO,CACLC,MAAO,CACCC,QADD,SACSD,GAAc,iKACrBA,EADuB,CAAF,gEAEJE,uBAAkBC,OAAO,CAC7CC,QAAS,iBACTC,iBAAiB,IAJO,cAEpBC,EAFoB,gBAMpBA,EAAQC,UANY,cAQ1B,EAAKvB,IAAM,IAAIwB,OAAoB,EAAKC,UAAW,EAAKC,YAR9B,UASP,EAAK1B,IAAI2B,aATF,eAS1B,EAAKpB,MATqB,OAU1B,EAAKjD,KAAO,EAAKsE,kBAAkB,EAAKrB,OACxC,EAAKE,aAAee,OAAoBK,iBAAiB,EAAKtB,OAXpC,UAYD,EAAKuB,iBAZJ,eAY1B,EAAKxB,YAZqB,OAa1B,EAAK3D,KAAOoF,OAAQC,2BAA2BC,OAAQC,kBAb7B,UAcpB,EAAKC,eAde,yBAepB,EAAKC,mBAfe,yBAgBpB,EAAKC,qBAhBe,yBAiBpB,EAAKC,mBAjBe,WAkB1BpB,uBAAkBqB,WACd,EAAK/B,oBAAqB,EAAK5D,iBAnBT,kCAmBiC,EAAK4F,kBAnBtC,QAoB1B,EAAKC,WApBqB,+CAsB5BC,WAAW,IAGfC,SAAU,CACR5F,iBADQ,WAEN,OAAO6F,KAAKtC,YAAYuC,QAAO,SAACC,GAAD,MAAwB,QAAZA,EAAE7E,SAAiB8E,QAEhE5E,oBAJQ,WAKN,QAAS6E,OAAYC,eAAiBD,OAAYE,cAGtDC,QAAS,CACD1E,SADC,WACO,4KACR,EAAKjB,SAAU,EAAKsD,MADZ,iCAEc,EAAKd,IAAIoD,kBAFvB,UAEJC,EAFI,OAGLA,EAHK,yCAGaC,eAAa,+BAH1B,WAIN,EAAKxC,MAJC,iCAKU,EAAKd,IAAIuD,kBACzB,6BACA,OAPM,UAKFC,EALE,OASHA,EATG,0CASSF,eAAa,yBATtB,QAUR,EAAKpF,uBAVG,yCAYU,EAAK8B,IAAIyD,iBACzB,OACA,EAAKjG,OAAOQ,OAdN,WAYFwF,EAZE,OAiBHA,EAjBG,0CAiBSF,eAAa,yBAjBtB,eAkBFI,EAAe,CACnBC,MAAO,EAAKnG,OAAOS,OAnBb,UAsBF,EAAK+B,IAAI4D,cAAcF,GAtBrB,WAwBkC,oBAAtC,UAAO,EAAKlG,cAAZ,iBAAO,EAAaqG,aAApB,aAAO,EAAoBrG,QAxBvB,0CAyBC,EAAKA,OAAOqG,MAAMrG,UAzBnB,QA2BN,EAAKsG,WA3BC,gCA+BVR,eAAa,2BA/BH,+CAkCdlF,aAnCO,WAoCLwE,KAAK9B,OAAQ,EACb8B,KAAKnE,YAEPH,cAvCO,WAwCL,OAAOsE,KAAKmB,QAAQC,KAAK,CACvBC,KAAM,0CAAF,OAA4CrB,KAAKnB,cAGnDW,iBA5CC,WA4Ce,8KACH8B,OAAmBC,mBAClC,EAAK1C,UACL,4BAHkB,OACd2C,EADc,OAKpB,EAAK/F,4BAA4B,UAAG+F,GAAKC,MAAM,WAL3B,8CAOhBlC,aAnDC,WAmDW,8KACC+B,OAAmBC,mBAClC,EAAK1C,UACL,eAHc,OACV2C,EADU,OAKhB,EAAK5D,mBAAqB4D,EALV,8CAOZ/B,mBA1DC,WA0DiB,8KACL6B,OAAmBI,kBAClC,EAAK7C,UACL,oBAHoB,OAChB2C,EADgB,OAKtB,EAAKxH,oBAAmBwH,IAAMA,EAAGC,MAAM,sBALjB,8CAOlB/B,iBAjEC,WAiEe,8KACUiC,OAAeC,mBAC3C,EAAK/C,WAFa,UACdgD,EADc,OAIpB,EAAKlG,gBACHkG,EAAS5B,QACP,SAAC6B,GAAD,MAAsC,yBAAzBA,EAAQA,QAAQC,QAC7B5B,OAAS,GACT,EAAKxE,gBARW,gCASZ,EAAKqG,eATO,8CAYhBA,aA7EC,WA6EW,8KACcL,OAAeM,iBAC3C,EAAKpD,UAAW,EAAKb,cAFP,OACV6D,EADU,OAIhB,EAAK9D,aACH8D,EAAS5B,QAAO,SAAC6B,GAAD,MAA8B,UAAjBA,EAAQC,QAAkB5B,OAAS,EALlD,8CAOZjB,eApFC,WAoFa,uKACZgD,EAAWC,OAAeC,sBAAsB,gBAChDC,EAAIH,EAASI,IAAT,yDAAa,WAAOC,GAAP,uGACHjB,OAAmBC,mBACnC,EAAK1C,UACL0D,EAAQR,MAHW,cACfS,EADe,yBAKd,CACLD,QAASA,EAAQR,KACjB1G,MAAOmH,IAPY,2CAAb,uDAFQ,kBAYXC,QAAQC,IAAIL,IAZD,8CAcpBrD,kBAlGO,SAkGWrB,GAAU,WAC1B,OAAOgF,OAAOC,KAAKjF,GAAO2E,KAAI,SAAAO,GAC5B,IAAM9I,EAAOoF,OAAQC,2BAA2ByD,GAChD,EAAK/E,aAAe,EAAKA,aAAagF,OAAOnF,EAAMkF,GAAG,UACtD,IAAME,EAAa,WACjB,IAAMC,EAAgBpE,OAAoBqE,WACxCC,SAASvF,EAAMkF,GAAGM,KAClBD,SAASvF,EAAMkF,GAAGO,MAEpB,OAAO,EAAK3F,gBAAgBuF,IAExBzL,EAAQ,CACZwE,WAAYgH,KAEd,MAAO,CACLxF,OAAM8F,OAAOtJ,EAAM,CAAExC,UACrBgG,OAAM+F,GAAG3F,EAAMkF,GAAGM,IAAK,CAAE5L,UACzBgG,OAAM+F,GAAG3F,EAAMkF,GAAGO,IAAK,CAAE7L,UACzBgG,OAAM+F,GAAG3F,EAAMkF,GAAG,SAASU,KAAK,MAAO,CAAEhM,UACzCgG,OAAM+F,GAAG3F,EAAMkF,GAAGW,KAAM,CAAEjM,eAI1B+C,gBAzHC,WAyHc,kLACCmJ,qBAAgBlF,OAAO,CACzCmF,UAAWC,OACXlF,iBAAiB,EACjBmF,SAAU,cACVC,eAAgB,CACdC,QAAS,EAAKpG,eANC,cACbqG,EADa,OASnBA,EAAMpF,UATa,SAUIoF,EAAMC,eAVV,gBAUX7G,EAVW,EAUXA,KACH8G,qBAAQ9G,KACX,EAAKO,YAAcP,EAAKmF,KAAI,SAACpC,GAC3B,IAAMsC,GAAsB,IAAhBtC,EAAEgE,UAAqB,MAAQ,KAC3C,MAAO,CACL3B,QAASrC,EAAEqC,QACXlH,MAAOmH,OAhBM,8CAqBf5C,gBA9IC,WA8Ic,8KACEuE,eACnB,cACA,2DACA,GACA,CACE,CACEpC,KAAM,MACNtK,KAAM,MACN2C,MAAO,WAET,CACE2H,KAAM,KACNtK,KAAM,QACN2C,MAAO,YAdM,UACbQ,EADa,OAkBL,QAAXA,EAlBgB,iCAmBX,EAAKgB,cAnBM,uBAoBX,EAAKwI,kBAAkB,OApBZ,cAqBjB,EAAKxG,mBAAoB,EArBR,UAsBX,EAAKiC,WAtBM,iDAwBX,EAAKuE,kBAAkB,MAxBZ,QAyBjB,EAAKlD,WAzBY,+CA4BftF,YA1KC,WA0KU,8KAEPkG,EAAW,IAAIuC,OAAsB,EAAKxF,WAChDiD,EAAQwC,aAAa,EAAKtG,cAC1B8D,EAAQyC,aAAa5C,OAAerC,kBACpCwC,EAAQ0C,WAAW,EAAKvG,YALX,SAMP6D,EAAQ2C,gBAND,uBAOP3C,EAAQ4C,cAPD,OAQb,EAAK/I,iBAAkB,EACvBgJ,eAAa,kCATA,qDAWbC,QAAQC,MAAR,MACAnE,eAAa,EAAD,IAZC,6DAeX0D,kBAzLC,SAyLiBU,GAAyB,yKACzCC,EAAS,IAAIC,OAAc,EAAKnG,UAAW,EAAKC,YADP,SAEvBiG,EAAOvE,kBAFgB,UAEzCC,EAFyC,OAG1CA,EAH0C,gBAI7CC,eAAa,+CAJgC,wCAM3BqE,EAAOpE,kBAAkB,cAAemE,GANb,QAMvClE,EANuC,OAOxCA,GACHF,eAAa,wDAR8B,+CAY3Cb,SArMC,WAqMO,wJACR,EAAK/B,aAAaqC,OAAS,EAC7B,EAAKnF,MAAQ,CACX,CACEI,MAAO,gCACPC,MAAO,eACP4F,MAAO,CACLrG,OAAQ,kBAAM,EAAKuG,QAAQC,KAAb,uCAAkD,EAAKvC,eAGzE,CACEzD,MAAO,iBACPC,MAAO,eACP4F,MAAO,CACLrG,OAAQ,kBAAM,EAAKuG,QAAQC,KAAb,uCAAkD,EAAKvC,eAGzE,CACEzD,MAAO,eACPC,MAAO,eACP4F,MAAO,CACLrG,OAAQ,kBAAM,EAAKuG,QAAQC,KAAb,uCACoB,EAAKvC,UADzB,sBAOpB,EAAK7D,MAAQ,CACX,CACEI,MAAO,yBACPC,MAAO,0BAET,CACED,MAAO,wBACPC,MAAO,oCAET,CACED,MAAO,8BACPC,MAAO,qCAGP,EAAKwC,cACP,EAAK7C,MAAMoG,KAAK,CACdhG,MAAO,6BACPC,MAAO,UAGX,EAAKL,MAAMoG,KAAK,CACdhG,MAAO,2BACPC,MAAO,eACP4F,MAAO,CACLrG,OAAQ,kBAAM,EAAKuG,QAAQC,KAAb,0CACuB,EAAKvC,iBArDpC,iD,qBCnUlB,MAAMoG,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAAS9M,KAErD,gB,4OCJF6M,EAAb,wDACE,WAAYnG,EAAmBC,GAAkB,0CACzCD,EAAW,EAAGC,GAFxB,0DAIE,SAAoBoG,GAClB,MAAO,UAAGA,EAAM7J,OAAQoG,MAAM,iBAAmB,KAAO,CAAC,qBAAD,OAAsByD,EAAM9J,UALxF,gCAOE,SAAmB8J,GAAa,MAC9B,MAAO,UAAGA,EAAM7J,OAAQoG,MAAM,sBAC1B,KACA,CAAC,qBAAD,OAAsByD,EAAM9J,MAA5B,uDAA+E,UAAA8J,EAAMjE,aAAN,eAAakE,WAAY,OAVhH,yBAYE,SAAY3C,EAAa4C,EAAaC,GACpC,IACsC,EAGA,EAJhCC,EAAI,GACNC,WAAW,GAAD,OAAI/C,EAAInH,QAAW+J,GAC/BE,EAAElE,KAAK,CAAC,GAAD,OAAIoB,EAAIpH,MAAR,yCAA8CgK,EAA9C,aAAwD,OAAH5C,QAAG,IAAHA,GAAA,UAAAA,EAAKvB,aAAL,eAAYkE,WAAY,MAElFI,WAAW,GAAD,OAAI/C,EAAInH,QAAWgK,GAC/BC,EAAElE,KAAK,CAAC,GAAD,OAAIoB,EAAIpH,MAAR,4CAAiDiK,EAAjD,aAA2D,OAAH7C,QAAG,IAAHA,GAAA,UAAAA,EAAKvB,aAAL,eAAYkE,WAAY,MAEzF,OAAOG,EAAEnF,OAAS,EAAImF,EAAI,OApB9B,yBAsBE,SAAYP,GAAgB,WACpBO,EAAS,GAKf,OAJAP,EAAOzC,KAAI,SAAC4C,GACV,IAAM7C,EAAI,EAAKmD,UAAUN,GACzB,OAAOO,qBAAQpD,GAAKiD,EAAElE,KAAKiB,GAAK,QAE3BiD,EAAEnF,OAAS,EAAImF,EAAI,OA5B9B,yBA+BE,SAAYI,GACV,IAAMC,EAAc,GAMpB,OALAD,EAAOE,SAAQ,SAAAC,GACTJ,qBAAQI,IACVF,EAAOvE,KAAKyE,MAGTF,EAAOxF,OAAS,EAAIwF,EAAS,OAtCxC,8BAwCE,SAAiBT,GACf,IAAMI,EAAI,GACJQ,EAAa,UAAGZ,EAAM7J,OAAQoG,MAAM,uBAAyB,KAAO,CAAC,sBAE3E,GADA6D,EAAElE,KAAK0E,GACS,MAAbA,EAAmB,CACpB,IAAMzK,EAAQ,UAAG6J,EAAM7J,OAAQ0K,MAAM,KAE/BC,EAAa,CACjB5K,MAAO,WACPC,MAAOA,EAAM,IAET4K,EAAc,CAClB7K,MAAO,YACPC,MAAOA,EAAM,IAEfiK,EAAElE,KAAKpB,KAAKkG,YAAYD,EAAa,GAAI,MACzCX,EAAElE,KAAKpB,KAAKkG,YAAYF,EAAY,GAAI,MAE1C,OAAOhG,KAAKmG,YAAYb,KA1D5B,uBA4DE,SAAUJ,GAAa,WACfkB,EAAS,CACb,CACErE,KAAM,SACNyD,UAAW,SAAChD,GACV,IAAM6D,EAAc,EAAKC,mBAAmB9D,GACtC+D,EAAY,EAAKL,YAAY1D,EAAK,EAAK,KAC7C,OAAO,EAAK2D,YAAY,CAACE,EAAaE,MAG1C,CACExE,KAAM,SACNyD,UAAW,SAAChD,GACV,IAAMkD,EAAS,GAGf,OAFAA,EAAOtE,KAAK,EAAKoF,oBAAoBhE,IACrCkD,EAAOtE,KAAK,EAAK8E,YAAY1D,EAAK,GAAI,MAC/B,EAAK2D,YAAYT,KAEzB,CACD3D,KAAM,KACNyD,UAAW,SAAChD,GACV,OAAO,EAAKiE,iBAAiBjE,KAE9B,CACDT,KAAM,OACNyD,UAAW,SAAChD,GACV,IAAM6D,EAAc,EAAKG,oBAAoBhE,GACvC+D,EAAY,EAAKL,YAAY1D,EAAK,GAAI,IAC5C,OAAO,EAAK2D,YAAY,CAACE,EAAaE,MAEvC,CACDxE,KAAM,OACNyD,UAAW,SAAChD,GACV,IAAM+D,EAAY,EAAKL,YAAY1D,EAAK,GAAI,KAC5C,OAAO,EAAK2D,YAAY,CAACI,MAE1B,CACDxE,KAAM,QACNyD,UAAW,SAAChD,GACV,IAAM+D,EAAY,EAAKL,YAAY1D,EAAK,GAAI,KAC5C,OAAO,EAAK2D,YAAY,CAACI,OAIzBG,EAAIN,EAAOnG,QAAO,SAAA4F,GACtB,OAAOA,EAAQ9D,OAASmD,EAAM9J,SAEhC,OAAIsL,EAAEvG,OAAS,EACNuG,EAAE,GAAGlB,UAAUN,GAEjB,SA9GX,GAAmCyB","file":"js/chunk-03e87f92.c80d8908.js","sourcesContent":["import { toDisplayString as _toDisplayString, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = {\n  key: 0,\n  style: {\"color\":\"green\"}\n}\nconst _hoisted_2 = { slot: \"end\" }\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"add riskfactors\")\nconst _hoisted_4 = /*#__PURE__*/_createVNode(\"h1\", { style: {\"text-align\":\"center\"} }, \"Actions\", -1)\nconst _hoisted_5 = /*#__PURE__*/_createTextVNode(\" cancel \")\nconst _hoisted_6 = /*#__PURE__*/_createTextVNode(\" Refer to clinician \")\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\" Hypertension Diagnosis \")\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\" Enroll in HTN \")\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\" Finish \")\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ion_title = _resolveComponent(\"ion-title\")\n  const _component_ion_button = _resolveComponent(\"ion-button\")\n  const _component_ion_toolbar = _resolveComponent(\"ion-toolbar\")\n  const _component_ion_header = _resolveComponent(\"ion-header\")\n  const _component_data_table = _resolveComponent(\"data-table\")\n  const _component_ion_content = _resolveComponent(\"ion-content\")\n  const _component_ion_label = _resolveComponent(\"ion-label\")\n  const _component_ion_radio = _resolveComponent(\"ion-radio\")\n  const _component_ion_item = _resolveComponent(\"ion-item\")\n  const _component_ion_col = _resolveComponent(\"ion-col\")\n  const _component_ion_row = _resolveComponent(\"ion-row\")\n  const _component_ion_grid = _resolveComponent(\"ion-grid\")\n  const _component_ion_radio_group = _resolveComponent(\"ion-radio-group\")\n  const _component_ion_footer = _resolveComponent(\"ion-footer\")\n  const _component_ion_page = _resolveComponent(\"ion-page\")\n\n  return (_openBlock(), _createBlock(_component_ion_page, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_ion_header, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_toolbar, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_ion_title, null, {\n                default: _withCtx(() => [\n                  _createVNode(\"span\", null, \"BP management screening on \" + _toDisplayString(_ctx.date), 1),\n                  (_ctx.patientOnBPDrugs)\n                    ? (_openBlock(), _createBlock(\"small\", _hoisted_1, \" (Patient already on BP drugs)\"))\n                    : _createCommentVNode(\"\", true)\n                ]),\n                _: 1\n              }),\n              _createVNode(\"span\", _hoisted_2, [\n                (_ctx.totalRiskFactors > 0)\n                  ? (_openBlock(), _createBlock(_component_ion_button, {\n                      key: 0,\n                      color: \"danger\",\n                      onClick: _ctx.showRiskFactors\n                    }, {\n                      default: _withCtx(() => [\n                        _createTextVNode(\"View/Edit risk factors \" + _toDisplayString(_ctx.totalRiskFactors), 1 /* TEXT */)\n                      ]),\n                      _: 1\n                    }, 8, [\"onClick\"]))\n                  : _createCommentVNode(\"\", true),\n                (_ctx.totalRiskFactors === 0)\n                  ? (_openBlock(), _createBlock(_component_ion_button, {\n                      key: 1,\n                      onClick: _ctx.showRiskFactors\n                    }, {\n                      default: _withCtx(() => [\n                        _hoisted_3\n                      ]),\n                      _: 1\n                    }, 8, [\"onClick\"]))\n                  : _createCommentVNode(\"\", true)\n              ])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_ion_content, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_data_table, {\n            config: {showIndex: false},\n            columns: _ctx.columns,\n            rows: _ctx.rows\n          }, null, 8, [\"columns\", \"rows\"])\n        ]),\n        _: 1\n      }),\n      _createVNode(_component_ion_footer, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_toolbar, null, {\n            default: _withCtx(() => [\n              _hoisted_4,\n              _createVNode(_component_ion_radio_group, {\n                modelValue: _ctx.action,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => (_ctx.action = $event))\n              }, {\n                default: _withCtx(() => [\n                  _createVNode(_component_ion_grid, null, {\n                    default: _withCtx(() => [\n                      _createVNode(_component_ion_row, null, {\n                        default: _withCtx(() => [\n                          (_openBlock(true), _createBlock(_Fragment, null, _renderList(_ctx.items, (item, index) => {\n                            return (_openBlock(), _createBlock(_component_ion_col, {\n                              size: \"4\",\n                              key: index\n                            }, {\n                              default: _withCtx(() => [\n                                _createVNode(_component_ion_item, null, {\n                                  default: _withCtx(() => [\n                                    _createVNode(_component_ion_label, { style: {\"font-size\":\"1.0rem\",\"font-weight\":\"bold\"} }, {\n                                      default: _withCtx(() => [\n                                        _createTextVNode(_toDisplayString(item.label), 1 /* TEXT */)\n                                      ]),\n                                      _: 2\n                                    }, 1024),\n                                    _createVNode(_component_ion_radio, { value: item }, null, 8, [\"value\"])\n                                  ]),\n                                  _: 2\n                                }, 1024)\n                              ]),\n                              _: 2\n                            }, 1024))\n                          }), 128 /* KEYED_FRAGMENT */))\n                        ]),\n                        _: 1\n                      })\n                    ]),\n                    _: 1\n                  })\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_ion_toolbar, { color: \"dark\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_ion_button, {\n                size: \"large\",\n                color: \"danger\",\n                slot: \"start\",\n                onClick: _ctx.gotoPatientDashboard\n              }, {\n                default: _withCtx(() => [\n                  _hoisted_5\n                ]),\n                _: 1\n              }, 8, [\"onClick\"]),\n              (_ctx.showClinicianButton)\n                ? (_openBlock(), _createBlock(_component_ion_button, {\n                    key: 0,\n                    size: \"large\",\n                    color: \"danger\",\n                    slot: \"start\",\n                    onClick: _ctx.referPatient\n                  }, {\n                    default: _withCtx(() => [\n                      _hoisted_6\n                    ]),\n                    _: 1\n                  }, 8, [\"onClick\"]))\n                : _createCommentVNode(\"\", true),\n              (!_ctx.patientHasHyperTensionObs)\n                ? (_openBlock(), _createBlock(_component_ion_button, {\n                    key: 1,\n                    size: \"large\",\n                    slot: \"end\",\n                    onClick: _ctx.goToDiagnosis\n                  }, {\n                    default: _withCtx(() => [\n                      _hoisted_7\n                    ]),\n                    _: 1\n                  }, 8, [\"onClick\"]))\n                : _createCommentVNode(\"\", true),\n              (_ctx.patientHasHyperTensionObs && !_ctx.isEnrolledInHTN)\n                ? (_openBlock(), _createBlock(_component_ion_button, {\n                    key: 2,\n                    size: \"large\",\n                    slot: \"end\",\n                    onClick: _ctx.enrollInHTN\n                  }, {\n                    default: _withCtx(() => [\n                      _hoisted_8\n                    ]),\n                    _: 1\n                  }, 8, [\"onClick\"]))\n                : _createCommentVNode(\"\", true),\n              (_ctx.patientHasHyperTensionObs)\n                ? (_openBlock(), _createBlock(_component_ion_button, {\n                    key: 3,\n                    size: \"large\",\n                    color: \"success\",\n                    slot: \"end\",\n                    onClick: _ctx.onFinish\n                  }, {\n                    default: _withCtx(() => [\n                      _hoisted_9\n                    ]),\n                    _: 1\n                  }, 8, [\"onClick\"]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}","\nimport { defineComponent } from \"vue\";\nimport {\n  IonToolbar,\n  IonTitle,\n  IonHeader,\n  IonContent,\n  IonGrid,\n  IonRow,\n  IonCol,\n  IonRadioGroup,\n  IonRadio,\n  IonButton,\n  modalController,\n  IonFooter,\n  IonPage,\n  IonItem,\n  IonLabel,\n  loadingController\n} from \"@ionic/vue\";\nimport { toastWarning, toastSuccess } from \"@/utils/Alerts\";\nimport EncounterMixinVue from \"../../../../views/EncounterMixin.vue\";\nimport RiskFactorModal from \"@/components/DataViews/RiskFactorModal.vue\";\nimport { ObservationService } from \"@/services/observation_service\";\nimport { ConceptService } from \"@/services/concept_service\";\nimport { Service } from \"@/services/service\";\nimport HisDate from \"@/utils/Date\";\nimport { isEmpty } from \"lodash\";\nimport { BPManagementService } from \"../../services/htn_service\";\nimport { UserService } from \"@/services/user_service\";\nimport { ProgramService } from \"@/services/program_service\";\nimport { VitalsService } from \"@/apps/ART/services/vitals_service\"\nimport { PatientProgramService } from \"@/services/patient_program_service\";\nimport DataTable from \"@/components/DataViews/tables/ReportDataTable.vue\"\nimport table from \"@/components/DataViews/tables/ReportDataTable\"\nimport { infoActionSheet } from \"@/utils/ActionSheets\";\n\nconst HEADER_STYLE = {\n  background: '#444444',\n}\nexport default defineComponent({\n  mixins: [EncounterMixinVue],\n  components: {\n    DataTable,\n    IonTitle,\n    IonToolbar,\n    IonHeader,\n    IonContent,\n    IonGrid,\n    IonRow,\n    IonButton,\n    IonRadioGroup,\n    IonRadio,\n    IonCol,\n    IonFooter,\n    IonPage,\n    IonItem,\n    IonLabel,\n  },\n  data: () => ({\n    htn: {} as any,\n    hasARVNumber: true,\n    suggestedNumber: \"\" as any,\n    columns: [\n      [\n        table.thTxt(\"Date\", { style: HEADER_STYLE }),\n        table.thTxt(\"Systolic\", { style: HEADER_STYLE }),\n        table.thTxt(\"Diastolic\", { style: HEADER_STYLE }),\n        table.thTxt(\"BP Drugs\", { style: HEADER_STYLE }),\n        table.thTxt(\"Action / Note\", { style: HEADER_STYLE })\n      ]\n    ] as any,\n    bpGradeColorMap: {\n      'N/A': '#ffffff',\n      'normal': '#ffffff',\n      'grade 1': '#FFC3CE',\n      'grade 2': '#F20056',\n      'grade 3': '#FF3333'\n    } as any,\n    rows: [] as any,\n    riskFactors: [] as any,\n    action: null as any,\n    trail: [] as any,\n    date: null as any,\n    patientOnBPDrugs: false,\n    patientFirstVisit: false,\n    normatensive: false,\n    patientHasHyperTensionObs: false,\n    currentDrugs: [],\n    items: [] as any,\n    isEnrolledInHTN: false,\n    isAliveOnHTN: false,\n    HTNProgramID: 20,\n    aliveState: 160,\n    refer: false,\n  }),\n  watch: {\n    ready: {\n      async handler(ready: boolean) {\n        if (!ready) return\n        const loading = await loadingController.create({\n          message: 'Please wait...',\n          backdropDismiss: false\n        })\n        await loading.present()\n               \n        this.htn = new BPManagementService(this.patientID, this.providerID);\n        this.trail = await this.htn.getBPTrail();\n        this.rows = this.formatBpTrailRows(this.trail);\n        this.normatensive = BPManagementService.isBpNormotensive(this.trail)\n        this.riskFactors = await this.getRiskFactors();\n        this.date = HisDate.toStandardHisDisplayFormat(Service.getSessionDate());\n        await this.isTransfered()\n        await this.hasHyperTenstion()\n        await this.getTreatmentStatus()\n        await this.getProgramStatus()\n        loadingController.dismiss()\n        if (this.patientFirstVisit && this.patientOnBPDrugs) await this.alertTransferIn()\n        this.getItems();\n      },\n      immediate: true,\n    },\n  },\n  computed: {\n    totalRiskFactors(): any {\n      return this.riskFactors.filter((d: any) => d.value === \"Yes\").length;\n    },\n    showClinicianButton() {\n      return !(UserService.isClinician() && UserService.isDoctor());\n    },\n  },\n  methods: {\n    async onFinish() {\n      if (this.action || this.refer) {\n        const encounter = await this.htn.createEncounter();\n        if (!encounter) return toastWarning(\"Unable to create encounter\");\n        if (this.refer) {\n          const obs = await this.htn.saveValueCodedObs(\n            \"Refer patient to clinician\",\n            \"Yes\"\n          )\n          if (!obs) return toastWarning(\"Unable to create Obs\");\n          this.gotoPatientDashboard();\n        } else {\n          const obs = await this.htn.saveValueTextObs(\n            \"Plan\",\n            this.action.label\n          );\n\n          if (!obs) return toastWarning(\"Unable to create Obs\")\n          const patientState = {\n            state: this.action.value,\n          }\n          \n          await this.htn.enrollPatient(patientState);\n\n          if (typeof this.action?.other?.action === 'function') {\n            return this.action.other.action()\n          } else {\n            this.nextTask()\n          }\n        }\n      } else {\n        toastWarning(\"Please select an action\");\n      }\n    },\n    referPatient() {\n      this.refer = true;\n      this.onFinish();\n    },\n    goToDiagnosis() {\n      return this.$router.push({\n        path: `/art/encounters/hypertension_diagnosis/${this.patientID}`,\n      })\n    },\n    async hasHyperTenstion() {\n      const ob = await ObservationService.getFirstValueCoded(\n        this.patientID,\n        \"Patient has hypertension\"\n      );\n      this.patientHasHyperTensionObs = `${ob}`.match(/yes|no/i) ? true : false\n    },\n    async isTransfered() {\n      const ob = await ObservationService.getFirstValueCoded(\n        this.patientID,\n        \"Transferred\"\n      );\n      this.patientFirstVisit = !ob\n    },\n    async getTreatmentStatus() {\n      const ob = await ObservationService.getFirstValueText(\n        this.patientID,\n        \"Treatment status\"\n      );\n      this.patientOnBPDrugs = ob && ob.match(/BP Drugs started/i) ? true : false;\n    },\n    async getProgramStatus() {\n      const programs: any[] = await ProgramService.getPatientPrograms(\n        this.patientID\n      );\n      this.isEnrolledInHTN =\n        programs.filter(\n          (program) => program.program.name === \"HYPERTENSION PROGRAM\"\n        ).length > 0;\n      if (this.isEnrolledInHTN) {\n        await this.programState();\n      }\n    },\n    async programState() {\n      const programs: any[] = await ProgramService.getPatientStates(\n        this.patientID, this.HTNProgramID\n      );\n      this.isAliveOnHTN =\n        programs.filter((program) => program.name === \"Alive\").length > 0;\n    },\n    async getRiskFactors() {\n      const concepts = ConceptService.getConceptsByCategory(\"risk factors\");\n      const j = concepts.map(async (concept) => {\n        const val = await ObservationService.getFirstValueCoded(\n          this.patientID,\n          concept.name\n        );\n        return {\n          concept: concept.name,\n          value: val,\n        }\n      })\n      return Promise.all(j);\n    },\n    formatBpTrailRows(trail: any) {\n      return Object.keys(trail).map(m => {\n        const date = HisDate.toStandardHisDisplayFormat(m);\n        this.currentDrugs = this.currentDrugs.concat(trail[m][\"drugs\"]);\n        const colorGrade = () => {\n          const grade: string = BPManagementService.getBpGrade(\n            parseInt(trail[m].sbp),\n            parseInt(trail[m].dbp)\n          )\n          return this.bpGradeColorMap[grade]\n        }\n        const style = {\n          background: colorGrade()\n        }\n        return [\n          table.tdDate(date, { style }),\n          table.td(trail[m].sbp, { style }),\n          table.td(trail[m].dbp, { style }),\n          table.td(trail[m][\"drugs\"].join(\", \"), { style }),\n          table.td(trail[m].note, { style })\n        ]\n      })\n    },\n    async showRiskFactors() {\n      const modal = await modalController.create({\n        component: RiskFactorModal,\n        backdropDismiss: false,\n        cssClass: \"large-modal\",\n        componentProps: {\n          factors: this.riskFactors,\n        },\n      });\n      modal.present();\n      const { data } = await modal.onDidDismiss();\n      if (!isEmpty(data)) {\n        this.riskFactors = data.map((d: any) => {\n          const val = d.isChecked === true ? \"Yes\" : \"No\";\n          return {\n            concept: d.concept,\n            value: val,\n          };\n        });\n      }\n    },\n    async alertTransferIn() {\n      const action = await infoActionSheet(\n        'Transfer in',\n        \"Does the patient want to transfer in for HTN management?\",\n        '',\n        [\n          { \n            name: 'Yes', \n            slot: 'end', \n            color: 'success'\n          },\n          { \n            name: 'No',  \n            slot: 'start', \n            color: 'danger'\n          }\n        ]\n      )\n      if(action === 'Yes') {\n        await this.enrollInHTN();\n        await this.setHtnTransferred('Yes')\n        this.patientFirstVisit = false;\n        await this.getItems();\n      } else {\n        await this.setHtnTransferred('No')\n        this.nextTask()\n      }\n    },\n    async enrollInHTN() {\n      try {\n        const program  = new PatientProgramService(this.patientID)\n        program.setProgramId(this.HTNProgramID)\n        program.setStateDate(ProgramService.getSessionDate())\n        program.setStateId(this.aliveState)\n        await program.enrollProgram()\n        await program.updateState()\n        this.isEnrolledInHTN = true\n        toastSuccess('Patient is now enrolled in HTN')\n      } catch (e) {\n        console.error(e)\n        toastWarning(e)\n      }\n    },\n    async setHtnTransferred(transferred: 'Yes' | 'No'){\n      const vitals = new VitalsService(this.patientID, this.providerID)\n      const encounter = await vitals.createEncounter()\n      if (!encounter) {\n        toastWarning('Unable to create patient transfer encounter')\n      } else {\n        const obs = await vitals.saveValueCodedObs('Transferred', transferred)\n        if (!obs) {\n          toastWarning('Unable to create observation Transferred for patient')\n        }\n      }\n    },\n    async getItems() {\n      if (this.currentDrugs.length > 0) {\n        this.items = [\n          {\n            label: \"Did not take prescribed drugs\",\n            value: \"on treatment\",\n            other: {\n              action: () => this.$router.push(`/art/encounters/bp_adherence/${this.patientID}`)\n            }\n          },\n          {\n            label: \"Continue drugs\",\n            value: \"on treatment\",\n            other: {\n              action: () => this.$router.push(`/art/encounters/bp_adherence/${this.patientID}`)\n            }\n          },\n          {\n            label: \"Review drugs\",\n            value: \"on treatment\",\n            other: {\n              action: () => this.$router.push(\n                `/art/encounters/bp_adherence/${this.patientID}?review=true`\n              )\n            }\n          },\n        ];\n      } else {\n        this.items = [\n          {\n            label: \"Lifestyle advice given\",\n            value: \"Lifestyle changes only\",\n          },\n          {\n            label: \"Not yet stable on ART\",\n            value: \"Symptomatic but not in treatment\",\n          },\n          {\n            label: \"Patient declining BP drugs \",\n            value: \"Symptomatic but not in treatment\",\n          },\n        ]\n        if (this.normatensive) {\n          this.items.push({\n            label: \"Return to annual screening\",\n            value: \"Alive\",\n          })\n        }\n        this.items.push({\n          label: \"Start anti hypertensives\",\n          value: \"On treatment\",\n          other: {\n            action: () => this.$router.push(\n              `/art/encounters/bp_prescription/${this.patientID}`\n            )\n          }\n        })\n      }\n    }\n  }\n})\n","import { render } from \"./BPManagement.vue?vue&type=template&id=35c7efac&ts=true\"\nimport script from \"./BPManagement.vue?vue&type=script&lang=ts\"\nexport * from \"./BPManagement.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { AppEncounterService } from \"@/services/app_encounter_service\";\nimport { isArray } from \"lodash\";\nimport { Option } from '@/components/Forms/FieldInterface';\nexport class VitalsService extends AppEncounterService{\n  constructor(patientID: number, providerID: number) {\n    super(patientID, 6, providerID);\n  }\n  isNotEmptyandNumber(vital: Option) {\n    return `${vital.value}`.match(/^-?\\d+\\.?\\d*$/) ? null : [`Invalid entry for ${vital.label}`]\n  }\n  isNotEmptyandFloat(vital: Option) {\n    return `${vital.value}`.match(/^\\d{1,3}\\.\\d{1,5}$/) \n      ? null \n      : [`Invalid entry for ${vital.label}. Don't forget to add a decimal. e.g. 56.2 ${vital.other?.modifier || ''}`]\n  }\n  checkMinMax(val: Option, min: number, max: number) {\n    const p = [];\n    if (parseFloat(`${val.value}`) < min) {\n      p.push([`${val.label} entered is less than minimum ${min} ${val?.other?.modifier || ''}`])\n    }\n    if (parseFloat(`${val.value}`) > max) {\n      p.push([`${val.label} entered is greater than maximum ${max} ${val?.other?.modifier || ''}`])\n    }\n    return p.length > 0 ? p : null;\n  }\n  validateAll(vitals: Option[]) {\n    const p: any = [];\n    vitals.map((vital: any) => {\n      const j = this.validator(vital);\n      return isArray(j) ? p.push(j) : null\n    })\n    return p.length > 0 ? p : null;\n  }\n\n  mergeErrors(errors: any[]) {\n    const holder: any = [];\n    errors.forEach(element => {\n      if (isArray(element)) {\n        holder.push(element)\n      }\n    });\n    return holder.length > 0 ? holder : null\n  }\n  isValidBPReading(vital: any) {\n    const p = [];\n    const isValidBP =  `${vital.value}`.match(/^\\d{1,3}\\/\\d{1,3}$/g) ? null : ['Invalid BP reading']\n    p.push(isValidBP);\n    if(isValidBP == null) {\n      const value = `${vital.value}`.split('/');\n      \n      const bpSystolic = {\n        label: 'Systolic',\n        value: value[0]\n      };\n      const bpDiastolic = {\n        label: 'Diastolic',\n        value: value[1]\n      };\n      p.push(this.checkMinMax(bpDiastolic, 30, 200))\n      p.push(this.checkMinMax(bpSystolic, 40, 250))\n    }\n    return this.mergeErrors(p)\n  }\n  validator(vital: Option) {\n    const values = [\n      {\n        name: \"Weight\",\n        validator: (val: Option) => {\n          const emptyErrors = this.isNotEmptyandFloat(val);\n          const minErrors = this.checkMinMax(val, 2.0, 250.0);\n          return this.mergeErrors([emptyErrors, minErrors]); \n        },\n      },\n      {\n        name: \"Height\",\n        validator: (val: Option) => {\n          const errors = []\n          errors.push(this.isNotEmptyandNumber(val))\n          errors.push(this.checkMinMax(val, 40, 220))\n          return this.mergeErrors(errors); \n        },\n      }, {\n        name: \"BP\",\n        validator: (val: any) => {\n          return this.isValidBPReading(val)\n        },\n      }, {\n        name: \"Temp\",\n        validator: (val: any) => {\n          const emptyErrors = this.isNotEmptyandNumber(val);\n          const minErrors = this.checkMinMax(val, 30, 42);\n          return this.mergeErrors([emptyErrors, minErrors]); \n        },\n      }, {\n        name: \"SP02\",\n        validator: (val: any) => {\n          const minErrors = this.checkMinMax(val, 40, 100);\n          return this.mergeErrors([minErrors]); \n        },\n      }, {\n        name: \"Pulse\",\n        validator: (val: any) => {\n          const minErrors = this.checkMinMax(val, 50, 120);\n          return this.mergeErrors([minErrors]); \n        },\n      }\n    ]\n    const v = values.filter(element => {\n      return element.name === vital.label;\n    });\n    if (v.length > 0) {\n      return v[0].validator(vital);\n    }\n    return null\n  }\n}"],"sourceRoot":""}