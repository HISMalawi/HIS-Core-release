(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72632c0e"],{9841:function(e,t,i){"use strict";i.r(t);var a=i("7a23");function n(e,t,i,n,s,o){const r=Object(a["resolveComponent"])("his-standard-form"),l=Object(a["resolveComponent"])("ion-page");return Object(a["openBlock"])(),Object(a["createBlock"])(l,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(r,{fields:e.fields,skipSummary:!0,onFinishAction:e.onFinish,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])]),_:1})}var s=i("7365"),o=i("d95e"),r=i("ff01"),l=i("2706"),c=i("8a30"),u=i("e86e"),d=i("9283"),v=i("b5e4"),h=i("1c74"),p=Object(a["defineComponent"])({components:{IonPage:c["D"]},mixins:[s["a"]],data:()=>({service:{}}),watch:{ready:{async handler(e){e&&(this.service=new r["a"](this.patientID,this.providerID),this.fields=this.getFields())},immediate:!0}},methods:{async onFinish(e,t){try{await this.service.enrollPatient()}catch(a){if(!(a instanceof h["d"]))throw a;console.warn(""+a)}const i=await this.resolveObs(t);await this.service.createEncounter(),await this.service.saveObservationList(i),this.nextTask()},buildDelieveryDateObs(e){if("Unknown"!=e)return[this.service.buildValueDate("Last menstrual period",e),this.service.buildValueDate("Estimated date of delivery",this.service.estimateDelieveryDate(e)),this.service.buildValueNumber("Week of First Visit",this.service.calculateWeekOfFirstVisit(e))]},getFields(){return[{id:"lnmp",proxyID:"delivery_date",helpText:"Last Normal Menstrual Period",type:o["b"].TT_ANC_LMP_DATE_INPUT,computedValue:e=>this.buildDelieveryDateObs(e.value),beforeNext:async e=>{const t=parseInt(e.other);return"number"!==typeof t||!(t<=0||t>42)||!!await Object(v["a"])("Gestation weeks out of range of 0-42. Are you sure you want to continue?")},validation:e=>this.validateSeries([()=>l["a"].required(e),()=>{if(e.value){const t=new Date(e.value),i=new Date;if(t>i)return["Last menstrual period cannot be in the future"]}return null}]),config:{initialDate:()=>this.service.date,calculateDelieveryDate:e=>d["b"].toStandardHisDisplayFormat(this.service.estimateDelieveryDate(e)),calculateGestationWeeks:e=>this.service.calculateWeekOfFirstVisit(e),allowUnknown:!0}},{id:"estimate_lmp",proxyID:"delivery_date",helpText:"Gestation (months)",type:o["b"].TT_NUMBER,condition:e=>"Unknown"===e.lnmp.value,computedValue:e=>this.buildDelieveryDateObs(this.service.calculateGestationDateFromPeriod(e.value)),validation:e=>this.validateSeries([()=>l["a"].required(e),()=>l["a"].rangeOf(e,1,10)])},{id:"planned_delivery_place",helpText:"Planned delivery place",type:o["b"].TT_SELECT,computedValue:e=>this.service.buildValueText("Planned Delivery Place",e.label),validation:e=>l["a"].required(e),options:(e,t="")=>Object(u["b"])(t),config:{footerBtns:[{name:"Here",slot:"end",onClickComponentEvents:{setValue:e=>e.btnOutput},onClick:()=>r["a"].getLocationName()}],showKeyboard:!0,isFilterDataViaApi:!0}},{id:"bed_net_available_for_use",helpText:"Mosquito net in good condition available for own use",type:o["b"].TT_SELECT,computedValue:e=>this.service.buildValueCoded("Do you use bed nets",e.value),validation:e=>l["a"].required(e),options:()=>this.yesNoOptions()},{id:"bed_net_given",helpText:"Bed net given today",type:o["b"].TT_SELECT,computedValue:e=>this.service.buildValueCoded("Mosquito net started",e.value),validation:e=>l["a"].required(e),condition:e=>"No"===e.bed_net_available_for_use.value,options:()=>this.yesNoOptions()},{id:"previous_ttv_given",helpText:"Previous TTV given before this pregnancy",type:o["b"].TT_NUMBER,computedValue:e=>this.service.buildValueNumber("TTV",e.value),validation:e=>l["a"].required(e)}]}}}),b=i("6b0d"),D=i.n(b);const f=D()(p,[["render",n]]);t["default"]=f},ff01:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var a=i("cc6f"),n=i("74f4"),s=i("5a0c"),o=i.n(s),r=i("0011");class l extends a["a"]{constructor(e,t){super(e,81,t)}async enrollPatient(){const e=new n["a"](this.patientID);await e.enrollProgram(),e.setStateDate(this.date),e.setStateId(118),await e.updateState()}calculateWeekOfFirstVisit(e){const t=new Date(e);t.setDate(t.getDate()+7);const i=new Date(this.getDate()),a=i-t;return String(Math.floor(a/6048e5))}calculateGestationDateFromPeriod(e){return o()(this.date).subtract(e,"months").endOf("month").format("YYYY-MM-DD")}estimateDelieveryDate(e){const t=new Date(e);t.setDate(t.getDate()+7),t.setMonth(t.getMonth()+9);const i=Object(r["a"])(t.getMonth()+1),a=Object(r["a"])(t.getDate());return`${t.getFullYear()}-${i}-${a}`}}}}]);
//# sourceMappingURL=chunk-72632c0e.dab5cbd4.js.map