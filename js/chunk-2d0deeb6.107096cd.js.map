{"version":3,"sources":["webpack:///./src/apps/ANC/Views/Encounters/AncVitals.vue?308b","webpack:///./src/apps/ANC/Views/Encounters/AncVitals.vue","webpack:///./src/apps/ANC/Views/Encounters/AncVitals.vue?28f1"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_openBlock","_createBlock","fields","onFinishAction","onFinish","skipSummary","cancelDestinationPath","cancelDestination","defineComponent","mixins","EncounterMixinVue","components","HisStandardForm","data","age","gender","recentHeight","vitals","weightForHeight","medianWeightandHeight","watch","ready","handler","init","patient","immediate","methods","VitalsService","getID","providerID","getAge","getGender","getRecentHeight","lastHeight","getMedianWeightHeight","ProgramService","getWeightForHeightValues","getFields","_","computedData","createEncounter","resolveObs","saveObservationList","nextTask","validateVitals","l","this","checkRequiredVitals","length","map","val","label","v","sanitizeVitals","validateAll","filter","element","other","required","value","id","helpText","type","FieldType","TT_VITALS_ENTRY","validation","computedValue","obs","doNotSave","forEach","d","computed","concat","push","buildValueNumber","config","hiddenFooterBtns","onUpdateAlertStatus","params","bp","find","split","parseInt","sys","dis","status","color","onChangeOption","activeItem","errs","validator","options","showHeight","modifier","icon","visible","dia","__exports__"],"mappings":"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","file":"js/chunk-2d0deeb6.107096cd.js","sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    fields: _ctx.fields,\n    onFinishAction: _ctx.onFinish,\n    skipSummary: true,\n    cancelDestinationPath: _ctx.cancelDestination\n  }, null, 8, [\"fields\", \"onFinishAction\", \"cancelDestinationPath\"]))\n}","\nimport { defineComponent } from \"vue\";\nimport { Field, Option } from \"@/components/Forms/FieldInterface\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\";\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport { VitalsService } from \"@/apps/ART/services/vitals_service\";\nimport EncounterMixinVue from \"../../../../views/EncounterMixin.vue\";\nimport { ProgramService } from \"@/services/program_service\";\nimport { find } from \"lodash\";\n\nexport default defineComponent({\n  mixins: [EncounterMixinVue],\n  components: { HisStandardForm },\n  data: () => ({\n    age: null as any,\n    gender: null as any,\n    recentHeight: null,\n    vitals: {} as any,\n    weightForHeight: {} as any,\n    medianWeightandHeight: {} as any\n  }),\n  watch: {\n    ready: {\n      async handler(ready) {\n        if (ready) await this.init(this.patient)\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    async init(patient: any) {\n        this.vitals = new VitalsService(patient.getID(), this.providerID);\n        this.age = patient.getAge();\n        this.gender = patient.getGender();\n        const lastHeight = await patient.getRecentHeight();\n        this.recentHeight = lastHeight == -1 ? null : lastHeight;\n        if (this.age <= 14) {\n            this.medianWeightandHeight = await patient.getMedianWeightHeight();\n            this.weightForHeight = await ProgramService.getWeightForHeightValues();\n        }\n        this.fields = this.getFields();\n    },\n    async onFinish(_: any, computedData: any) {\n      await this.vitals.createEncounter()\n      await this.vitals.saveObservationList(\n        (await this.resolveObs(computedData))\n      )\n      this.nextTask();\n    },\n    validateVitals(vitals: any) {\n      const l = this.checkRequiredVitals(vitals);\n      if (l.length > 0) {\n        return l.map((val) => {\n          return [`${val.label} can not be empty`];\n        });\n      }\n      const v = this.sanitizeVitals(vitals);\n      return this.vitals.validateAll(v);\n    },\n    sanitizeVitals(vitals: Array<Option>) {\n      return vitals.filter((element) => {\n        if (element.label === \"Height\" && element.other.required == false) {\n          return false;\n        }\n        return element.value !== \"\" && element.label !== \"Age\";\n      })\n    },\n    checkRequiredVitals(vitals: Array<Option>) {\n      return vitals.filter((element) => {\n        return element.value === \"\" && element.other.required === true;\n      });\n    },\n    getFields(): Array<Field> {\n      return [\n        {\n          id: \"vitals\",\n          helpText: \"Vitals entry\",\n          type: FieldType.TT_VITALS_ENTRY,\n          validation: (value: any) => this.validateVitals(value),\n          computedValue: (value: Option[]) => {\n            let obs: any = []\n            const data = value.filter(v => !v.other.doNotSave)\n            data.forEach((d: Option) => {\n                if (!d.value) {\n                    return\n                }\n                if (typeof d.other?.computed === 'function') {\n                    obs = obs.concat(d.other.computed(d.value))\n                } else {\n                    obs.push(this.vitals.buildValueNumber(d.label, d.value))\n                }\n            })\n            return obs\n          },\n          config: {\n            hiddenFooterBtns : [\n              'Clear'\n            ],\n            onUpdateAlertStatus: (params: Option[]) => {\n                const bp = find(params, { label: 'BP' })\n                if (bp && bp.value != '') {\n                    const [sys, dis] = `${bp.value}`.split('/').map(v => parseInt(v))\n                    if (sys >= 140 && dis >= 90) {\n                        return {\n                            status: 'Client is at risk of pre-eclampsia, refer for urine protein test.',\n                            color: 'brown'\n                        }\n                    }\n                    if (sys < 120 || sys > 140) {\n                        return {\n                            status: 'Systolic reading is out of normal range',\n                            color: 'brown'\n                        }\n                    }\n                    if (dis < 80 || dis > 90) {\n                        return {\n                            status: 'Diastolic reading is out of normal range',\n                            color: 'brown'\n                        }\n                    }\n                    if ((sys >= 130 && sys <= 139) && (dis >= 80 && dis <= 89)) {\n                        return {\n                            status: 'Prehypertension',\n                            color: 'brown'\n                        }\n                    }\n                }\n                return { status: '', color: ''}\n            },\n            onChangeOption: (activeItem: any) => {\n              if (!activeItem.value && activeItem.other.required) {\n                throw `Value for ${activeItem.label} is required`\n              }else if (activeItem.value) {\n                const errs = this.vitals.validator(activeItem)\n                if(errs && errs.length) throw errs\n              }\n            }\n          },\n          options: () => {\n            const recentHeight = this.recentHeight && this.age > 18? this.recentHeight : \"\";\n            const showHeight = !(recentHeight && this.age > 18);\n            return [\n                {\n                    label: \"Weight\",\n                    value: \"\",\n                    other: {\n                        modifier: \"KG\",\n                        icon: \"weight\",\n                        required: true,\n                    },\n                },\n                {\n                    label: \"Height\",\n                    value: `${recentHeight}`,\n                    other: {\n                        modifier: \"CM\",\n                        icon: \"height\",\n                        recentHeight: this.recentHeight,\n                        visible: showHeight\n                    }\n                },\n                { \n                    label: \"BP\", \n                    value: \"\", \n                    other: {\n                        computed: (bp: string) => {\n                            const  [sys, dia] = bp.split(\"/\");\n                            return [\n                                this.vitals.buildValueNumber(\"Systolic\", sys),\n                                this.vitals.buildValueNumber(\"Diastolic\", dia)\n                            ]\n                        },\n                        modifier: \"mmHG\", \n                        icon: \"bp\"\n                    } \n                },\n                {\n                    label: \"Age\",\n                    value: this.age,\n                    other: {\n                        doNotSave: true,\n                        modifier: \"Years old\", \n                        icon: \"\", \n                        visible: false \n                    }\n                }\n            ]\n          }\n        }\n      ]\n    }\n  }\n})\n","import { render } from \"./AncVitals.vue?vue&type=template&id=211590db&ts=true\"\nimport script from \"./AncVitals.vue?vue&type=script&lang=ts\"\nexport * from \"./AncVitals.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/andrew-dev/Projects/HIS-Core/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}