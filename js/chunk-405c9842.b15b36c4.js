(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-405c9842"],{1769:function(e,t,i){"use strict";i.r(t);var r=i("7a23");function n(e,t,i,n,s,a){const u=Object(r["resolveComponent"])("his-standard-form");return Object(r["openBlock"])(),Object(r["createBlock"])(u,{fields:e.fields,onFinishAction:e.onFinish,skipSummary:!0,cancelDestinationPath:e.cancelDestination},null,8,["fields","onFinishAction","cancelDestinationPath"])}var s=i("d95e"),a=i("7920"),u=i("2706"),c=i("b5e4"),o=i("7365"),p=i("3e53"),d=i("fb25"),b=i("ad60"),l=Object(r["defineComponent"])({mixins:[o["a"]],components:{HisStandardForm:a["a"]},data:()=>({patientHasARVNumber:!1,currentArvNumber:"",prependValue:""}),watch:{ready:{async handler(e){if(!e)return;const t=this.patient.getArvNumber();if("Unknown"!==t){const e=t.split("-");this.currentArvNumber=e[2].replace(/^\D+|\s/g,""),this.prependValue=`${e[0]}-${e[1]}-`,this.patientHasARVNumber=!0}else{const e=await b["a"].getNextSuggestedARVNumber();this.currentArvNumber=e.arv_number.replace(/^\D+|\s/g,"")}this.fields=this.getFields()},immediate:!0}},methods:{async onFinish(e){const t=e["arv_number"].value;if(t===this.patient.getArvNumber())return this.$router.back();const i=await d["a"].arvNumberExists(t);if(i)Object(c["e"])("ARV number already exists",5e3);else try{this.patientHasARVNumber?await this.patient.updateARVNumber(t):await this.patient.createArvNumber(t),this.$router.back()}catch(r){Object(c["e"])(r)}},getFields(){return[{id:"arv_number",helpText:"Update ARV Number",type:s["b"].TT_TEXT,validation:e=>u["a"].required(e),defaultValue:()=>this.currentArvNumber,config:{initialKb:"0-9",prependValue:()=>{if(this.prependValue)return this.prependValue;const e=p["a"].getActiveApp();if(e&&e.programPatientIdentifiers){const t=e.programPatientIdentifiers["ARV Number"];return t.prefix()}return""},footerBtns:[{name:"Void ARV Number",slot:"end",color:"danger",onClick:async e=>{await this.patient.updateARVNumber("Unknown"),this.$router.back()}}]}}]}}}),f=i("6b0d"),h=i.n(f);const m=h()(l,[["render",n]]);t["default"]=m},fb25:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i("1c74");class n extends r["e"]{constructor(){super(),this.identifierType=-1}static getIdentifierTypes(){return super.getJson("types/patient_identifiers")}static async arvNumberExists(e){const t=await super.getJson(`programs/${super.getProgramID()}/lookup_arv_number/${e}`);return t.exists}getIdentifierType(){return this.identifierType}setIdentifierType(e){this.identifierType=e}getDuplicateIndentifiers(){return r["e"].getJson("search/identifiers/duplicates",{type_id:this.identifierType})}getPatientsByIdentifier(e){return r["e"].getJson("search/patients/by_identifier",{type_id:this.identifierType,identifier:e})}}}}]);
//# sourceMappingURL=chunk-405c9842.b15b36c4.js.map